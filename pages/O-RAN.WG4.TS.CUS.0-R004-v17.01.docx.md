## O-RAN.WG4.TS.CUS.0-R004-v17.01.docx

- View in [Reader Mode](https://simewu.com/spec-reader/pages/08-WG4/O-RAN.WG4.TS.CUS.0-R004-v17.01.docx).
- Go back to [Table of Contents](../README.md).
- Download the [Original Document](https://github.com/Simewu/spec-reader/raw/refs/heads/main/documents/O-RAN.WG4.TS.CUS.0-R004-v17.01.docx).

---

![webwxgetmsgimg (7).jpeg](../assets/images/9c69df009b87.jpg)O-RAN.WG4.TS.CUS.0-R004-v17.01

*Technical Specification*

**O-RAN Working Group 4 (Open Fronthaul Interfaces WG) Control, User and Synchronization Plane Specification**

Copyright (C) 2025 by the O-RAN ALLIANCE e.V.

The copying or incorporation into any other work of part or all of the material available in this specification in any form without the prior written permission of O-RAN ALLIANCE e.V. is prohibited, save that you may print or download extracts of the material of this specification for your personal use, or copy the material of this specification for the purpose of sending to individual third parties for their information provided that you acknowledge O-RAN ALLIANCE as the source of the material and that you inform the third party that these conditions apply to them and that they must comply with them.

O-RAN ALLIANCE e.V., Buschkauler Weg 27, 53347 Alfter, Germany Register of Associations, Bonn VR 11238, VAT ID DE321720189

# Contents

Foreword 9

Modal verbs terminology 9

1. Scope 10
2. References 10
   1. Normative references 10
   2. Informative references 13
3. Definition of terms, symbols and abbreviations 13
   1. Terms 13
   2. Symbols 16
   3. Abbreviations 16
   4. Document conventions 18
      1. Terminologies 18
      2. Fields and bitmasks in messages 18
4. Architecture & requirements 20
   1. Architectural aspects 20
      1. Architectural entities 20
   2. Functional split 20
      1. Introduction 20
      2. Split 7-2x (DL) 22
      3. Split 7-2x (UL) 25
   3. Data flows 26
   4. Latency requirements 28
      1. Introduction 28
      2. Timing parameter relationships 30
      3. U-Plane/ C-Plane timing 32
      4. Computed latency methods 39
      5. Latency categories for O-DU with dynamic timing advance 47
      6. Latency categories for O-DU with fixed timing advance 50
      7. Non Delay-managed U-Plane traffic 51
   5. Reception window monitoring 52
   6. Transmission windows 52
      1. Normal transmission 52
      2. Uniformly distributed transmission 53
      3. Ordered transmission 53
      4. Scheduled transmission 53
   7. O-RU external antenna delay handling 54
      1. Introduction 54
      2. Minimal O-DU impact method (defined transport method) 55
   8. UL frame timing to DL frame 60
      1. Overview 60
      2. Carrier types and default values of n-ta-offset 61
5. Transport & Protocol Architecture 62
   1. Transport encapsulation types 62
      1. Ethernet encapsulation 62
      2. IP/UDP encapsulation 62
      3. Transport headers 63
   2. Protocol architecture 73
      1. C-Plane 73
      2. U-Plane 73
      3. S-Plane 73
   3. Quality of service 73
   4. Data flow identification 74
   5. Fragmentation 75
      1. Introduction 75
      2. Application layer fragmentation 75
      3. Radio transport layer (eCPRI or IEEE-1914.3) fragmentation 76
      4. Fragmentation considerations 76
6. Security 78
   1. General 78
7. C-Plane Protocol 79
   1. General 79
      1. C-Plane transport 79
   2. Elementary procedures 79
      1. Scheduling and beamforming commands transfer procedure 79
      2. Symbol numbering and duration 80
      3. Mixed numerology and PRACH handling 81
      4. DL precoding configuration parameters and indications 87
      5. LAA commands transfer procedure 89
      6. Dynamic Spectrum Sharing (DSS) 92
      7. Channel information based beamforming 93
      8. ACK/NACK Procedure for C-Plane Messages 93
      9. Section Type 4: Slot Configuration Control 95
      10. DMRS based beamforming 97
      11. SINR reporting 97
   3. Elements for the C-Plane protocol 104
      1. Section Types 104
      2. Section Extensions 106
   4. Section Type elements 106
      1. Overview 106
      2. Section Type 0 elements 106
      3. Section Type 1 elements 108
      4. reserved (reserved for future use) 110
      5. Section Type 3 elements 110
      6. Section Type 4 elements 112
      7. Section Type 5 elements 118
      8. Section Type 6 elements 120
      9. Section Type 7 elements 123
      10. Section Type 8 elements 127
      11. Section Type 9 elements 128
      12. Section Type 10 elements 131
      13. Section Type 11 elements 135
   5. Coding of Section Type IEs 138
      1. Transport layer 138
      2. Application layer, common 138
      3. Application layer, sections 147
   6. Section Extension elements 170
      1. Overview 170
      2. Common parameters 173
   7. Coding of Section Extension IEs 174
      1. SE 1: Beamforming weights 174
      2. SE 2: Beamforming attributes 177
      3. SE 3: DL precoding parameters 180
      4. SE 4: Modulation compression parameters 184
      5. SE 5: Modulation compression additional parameters 185
      6. SE 6: Non-contiguous PRB allocation in time and frequency domain 188
      7. SE 7: eAxC mask 191
      8. SE 8: Regularization factor 194
      9. SE 9: Dynamic Spectrum Sharing parameters 195
      10. SE 10: Group configuration of multiple ports 196
      11. SE 11: Flexible beamforming weights 201
      12. SE 12: Non-contiguous PRB allocation with frequency ranges 205
      13. SE 13: PRB allocation with frequency hopping 207
      14. SE 14: Nulling layer information for ueId based beamforming 209
      15. SE 15: Mixed numerology information for ueId based beamforming 210
      16. SE 16: Antenna mapping in UE channel information based UL beamforming 210
      17. SE 17: Indication of user port group 211
      18. SE 18: Uplink transmission management 212
      19. SE 19: Compact beamforming information for multiple port 215
      20. SE 20: Puncturing extension 220
      21. SE 21: Variable PRB group size for channel information 223
      22. SE 22: ACK/NACK request 226
      23. SE 23: Arbitrary symbol pattern modulation compression parameters 226
      24. SE 24: PUSCH DMRS configuration 232
      25. SE 25: Symbol reordering for DMRS-BF 245
      26. SE 26: Frequency offset feedback 252
      27. SE 27: O-DU controlled dimensionality reduction 253
      28. SE 28: O-DU controlled frequency resolution for SINR reporting 255
   8. Aspects of C-Plane operation 256
      1. Coupling of C-Plane and U-Plane 256
      2. O-RUs per endpoint and per C-Plane message limits 259
   9. C-Plane optimizations 260
      1. C-Plane optimization using Section Extension 6 260
      2. C-Plane Optimization using Section Extension 7 260
      3. C-Plane optimization using Section Extension 10 260
      4. C-Plane optimization using Section Extension 11 263
      5. C-Plane optimization using Section Extension 12 272
      6. C-Plane optimization using Section Extension 13 272
      7. Coupling via frequency and time with priorities 273
      8. Coupling via frequency and time with priorities (optimized) 274
      9. U-Plane Operation Without C-Plane 275
      10. Modulation compression with Section Extension 10 275
      11. Optimization with Section Extension 19 279
      12. Optimizations with Section Extension 20 280
      13. Optimizations with ueId indicating non-scheduled PRB range 280
      14. Optimization with USER-GROUP-OPTIMIZATION feature 283
8. U-Plane Protocol 285
   1. General 285
      1. U-Plane transport 285
      2. U-Plane data compression 285
      3. Digital power scaling 285
   2. Elementary procedures 294
      1. IQ data transfer procedure 294
      2. IQ data transfer procedure without C-Plane 297
   3. Elements for the U-Plane protocol 297
      1. General 297
      2. DL/UL data 298
      3. UL/DL data coding of information elements 301
      4. DL data precoding 307
      5. Data transfer for special cases 308
   4. U-Plane optimizations 309
      1. Coupling via frequency and time 309
      2. Data blanking 309
   5. Aspects of U-Plane operation 310
      1. O-RU U-Plane limits 310
9. Counters, KPIs and RRM measurements 311
   1. Counters 311
   2. RRM measurements 314
      1. Overview 314
      2. RRM measurement types 316
      3. RRM measurement support declaration and enablement via M-Plane 321
10. Specification mandatory and optional capabilities 323
    1. General 323
    2. Mandatory and optional capabilities 324
11. S-Plane Protocol 335
    1. General 335
       1. Overview 335
    2. Synchronization baseline 335
       1. List of reference documents 335
       2. Clock model and synchronization topology 335
       3. Clock Synchronization 342
       4. Profiles 343
       5. Synchronization accuracy 344
    3. Time and frequency synchronization requirements 349
       1. Allowed PTP and PLFS clock types and clock classes 349
       2. Frequency and time synchronization requirements across fronthaul network elements 351
    4. Node synchronization state behaviour 360
       1. Configurations LLS-C1 and LLS-C2 360
       2. Configurations LLS-C3 363
       3. Configurations LLS-C4 364
    5. S-Plane handling in multiple link scenarios 365
    6. Announce messages 366
    7. Elementary procedures 366
       1. PTP time synchronization procedure 366
       2. System frame number calculation from GPS time 366
12. Beamforming functionality 370
    1. General 370
    2. Hierarchy of radiation structure in O-RU 370
    3. Calibration 371
    4. beamId use for various beamforming methods 371
       1. Overview 371
       2. Predefined-beam beamforming (PDBF) 372
       3. Weight-based dynamic beamforming (WDBF) 375
       4. Attribute-based dynamic beamforming (ABBF) 383
       5. Channel-information-based beamforming (CIBF) 383
       6. DMRS based beamforming (DMRS-BF) 384
    5. O-RU antenna model 384
       1. Overview 384
       2. Coordinate systems 384
       3. O-RU antenna model parameters 385
       4. Identification and ordering of array elements 386
       5. Relations between array elements 387
       6. Model usage 387
    6. DMRS based beamforming (DMRS-BF) 390
       1. DMRS-BF common aspects 390
       2. DMRS-BF-NEQ description 400
       3. DMRS-BF-EQ description 402
13. Shared Cell 407
    1. General 407
    2. Copy and Combine function 408
       1. DL Copy function 408
       2. UL Combine function 408
    3. Selective transmission and reception using beamId 411
       1. Introduction 411
       2. Selective transmission function 412
       3. Selective reception function 413
    4. Multiple Cells Scenario in Cascade mode 414
       1. Introduction 414
       2. Multiple Cell scenario in downlink 415
       3. Multiple Cell scenario in uplink 415
    5. Delay management for Shared cell 418
       1. Introduction 418
       2. DL delay management for Shared cell 418
       3. UL delay management for Shared cell 420
       4. Section Extension 10 support for Shared Cell 423
    6. S-plane for Shared cell 424
       1. Introduction 424
       2. Node behaviour at O-RU in FREERUN state 424
    7. Cascade-FHM mode 424
       1. General 424
       2. Copy and Combine function 425
       3. Delay management 426
14. Shared O-RU 430
    1. General 430
    2. Delay management for Shared O-RU 430
       1. General 430
    3. S-Plane for Shared O-RU 430
       1. General 430
15. Narrowband-IoT 431
    1. Overview (informative) 431
    2. NB-IoT Downlink enabling methods 432
       1. Extended PRB Grid 432
    3. NB-IoT Downlink use cases 433
       1. Overview 433
       2. In-band mode with 15 kHz subcarrier spacing of host carrier 433
       3. Guard-band mode with 15 kHz subcarrier spacing of host carrier 434
    4. NB-IoT Uplink enabling methods 436
       1. Single Section Single Carrier (SSSC) 436
       2. Single Section Multiple Carriers (SSMC) 437
       3. Extended PRB Grid 438
    5. NB-IoT Uplink use cases 439
       1. Overview 439
       2. General case for in-band and guard-band mode 439
       3. Special case of in-band mode and guard-band mode NPUSCH with extended PRB Grid 441
       4. NPRACH without C-Plane 441
    6. subframeId, slotId and symbolId numbering for NB-IoT 441
       1. Overview 441
       2. NPUSCH timing 441
       3. NPRACH timing 442
16. Energy-saving functionality 443
    1. Overview 443
    2. TRX\_CONTROL 445
    3. Advanced Sleep Mode (ASM) 446
    4. Defined-duration sleep functionality 446
    5. Undefined-duration sleep functionality 447
    6. Guaranteed versus minimum wake-up durations 447
       1. Guaranteed wake-up durations 447
       2. Minimum wake-up durations 447
    7. Calibration during sleep and wake-up 448
    8. Mixed sleep modes and overlapping commands 448
       1. ASM overlapping commands 448
       2. TRX\_CONTROL overlapping sleep modes 449
       3. Overlapping ASM and TRX\_CONTROL commands 450
    9. Sleep extension 451
    10. Impact of Shared O-RU 451
    11. Command timing examples (informative) 451
    12. Emergency wake-up 456
    13. Energy-saving functionality error handling 456

Annex A (normative): Compression methods 458

* 1. Block floating point compression 458
     1. Overview 458
     2. Block floating point compression algorithm 458
     3. Block floating point decompression algorithm 459
  2. Block scaling compression 459
     1. Overview 459
     2. Block scaling compression algorithm 460
     3. Block scaling decompression algorithm 460
  3. ?-Law compression 461
     1. ?-Law compression algorithm 461
     2. ?-Law decompression algorithm 463
     3. ?-law udCompParam and IQ data format 463
  4. Beamspace compression type I and type II 464
     1. Overview 464
     2. Beamspace compression type I 464
     3. Beamspace compression type II 466
  5. Modulation compression 470
  6. Selective RE sending 472

Annex B (informative): Delay management use cases 474

* 1. Introduction 474
  2. Latency categories and sub-categories 480
  3. Example case: Evaluating O-DU / O-RU combinations 485
  4. Example case: Non-ideal transport O-DU/O-RU categories 488

Annex C (informative): Void 490

Annex D (informative): IQ sample and exponent packetization for different bitwidths 491

* 1. IQ sample ordering for big-endian byte order 491
  2. IQ sample ordering for little-endian byte order 497

Annex E (informative): OFDM phase compensation 504

Annex F (normative): Beamforming attributes frame of reference 505

Annex G (informative): LAA Algorithms and Examples 507

Annex H (informative): S-Plane detailed frequency and phase error budget analysis, and future ITU-T

clock types and classes reference 512

* 1. Void 512
  2. Frequency and time error budget analysis 512
     1. Overview 512
     2. Network limit guidelines for frequency error budget (LLS-C1 and LLS-C2) 513
     3. Network limit guidelines for time error budget (LLS-C1 and LLS-C2) 515
     4. Network limit guidelines for LLS-C1 and LLS-C2 based on the budget 516
     5. Network limit guidelines for frequency error budget (LLS-C3) 521
     6. Time error budget for network limit (LLS-C3) 523
  3. Guidelines for the allowed number of switches: 523

Annex I (informative): Precoding and examples 526

* 1. Case 1: Tx Diversity 1-CRS Port Ant0, 1 PRB 526
  2. Case 2: Tx Diversity 2-CRS Port Ant0, Ant1, and 1 PRB 526
  3. Case 3: Tx Diversity 4-CRS Port Ant0,1,2,3 and 1 PRB 527
  4. Case 4: TM3/TM4 3 layers, 4 antenna ports 530
  5. CRS location assignment 532
  6. First data layer and non-first data layer association using static eAxC\_ID and layerId mapping 534

Annex J (informative): Beamforming methods description 536

* 1. Introduction 536
  2. Predefined-beam beamforming 536
  3. Weight-based dynamic beamforming 536
  4. Attribute-based dynamic beamforming 537
  5. Channel-information-based beamforming 538

Annex K (informative): Layers of array elements 540

* 1. General 540
  2. Use Case A 540
  3. Use Case B 541

Annex L (informative): Considerations when operating in non-ideal transport environments 542

* 1. General 542
  2. Deployment scenarios and performance considerations 542
     1. Low impact 542
     2. Medium impact 542
     3. High impact 542
  3. HARQ 543
     1. Introduction 543
     2. Synchronous HARQ 543
     3. HARQ interleaving 544
     4. Predictive HARQ 544
     5. Asynchronous HARQ considerations 545
  4. RACH considerations 545
     1. Introduction 545
     2. Non-Ideal fronthaul RACH designs 546
  5. Other latency related considerations 549
  6. Bandwidth limitation considerations 550

Annex M (informative): Use case of selective transmission and reception 552

* 1. General 552
  2. Selective transmission and reception with non beamforming O-RUs and 1-to-1 mapping of global

beamId and local beamId 552

* 1. Selective transmission and reception with beamforming O-RUs and 1-to-N mapping of global beamId

and local beamId 553

Revision history 555

# Foreword

This Technical Specification (TS) has been produced by O-RAN Alliance.

# Modal verbs terminology

In the present document "**shall**", "**shall not**", "**should**", "**should not**", "**may**", "**need not**", "**will**", "**will not**", "**can**" and "**cannot**" are to be interpreted as described in clause 3.2 of the O-RAN Drafting Rules (Verbal forms for the expression of provisions).

"**must**" and "**must not**" are **NOT** allowed in O-RAN deliverables except when used in direct citation.

# Scope

The present document is subject to continuing work within O-RAN and may change following formal O-RAN approval. Should the O-RAN Alliance modify the contents of the present document, it will be re-released by O-RAN with an identifying change of version date and an increase in version number as follows:

version xx.yy.zz where:

xx: the first digit-group is incremented for all changes of substance, i.e. technical enhancements, corrections, updates, etc. (the initial approved document will have xx=01). Always 2 digits with leading zero if needed.

yy: the second digit-group is incremented when editorial only changes have been incorporated in the document.

Always 2 digits with leading zero if needed.

zz: the third digit-group included only in working versions of the document indicating incremental changes during the editing process. External versions never include the third digit-group. Always 2 digits with leading zero if needed.

The present document specifies the control plane, user plane and synchronization plane protocols used over the fronthaul interface linking the O-DU (O-RAN Distributed Unit) with the O-RU (O-RAN Radio Unit) with a Lower Layer Functional Split-7-2x based architecture (explained below). The scope of the present document includes both LTE and NR (5G). A separate document contains the O-RAN M-Plane (management plane) specification.

In the following, "Layer 1" and "Physical Layer" are assumed to be synonymous.

# References

## Normative references

References are either specific (identified by date of publication and/or edition number or version number) or

non-specific. For specific references, only the cited version applies. For non-specific references, the latest version of the referenced document (including any amendments) applies. In the case of a reference to a 3GPP document, a non- specific reference implicitly refers to the latest version of that document in Release 18, or the latest 3GPP release prior to Release 18 that includes that document.

NOTE: While any hyperlinks included in this clause were valid at the time of publication, O-RAN cannot guarantee their long-term validity.

The following referenced documents are necessary for the application of the present document.

1. Void.
2. [eCPRI Specification V1.0:](http://www.cpri.info/downloads/eCPRI_v_1_0_2017_08_22.pdf) "Common Public Radio Interface: eCPRI Interface Specification".
3. [IEEE Std 1588(TM)-2008](https://standards.ieee.org/ieee/1588/4355/): "IEEE Standard for a Precision Clock Synchronization Protocol for Networked Measurement and Control Systems".
4. 3GPP TS 38.211 Release 15: "5G; NR; Physical channels and modulation".
5. Void.
6. Void.
7. O-RAN ALLIANCE O-RAN.WG4.TS.MP.0: "Management Plane Specification".
8. 3GPP TS 38.104 Release 15: "5G; NR; Base Station (BS) radio transmission and reception".
9. 3GPP TS 36.104 Release 16: "LTE; Evolved Universal Terrestrial Radio Access (E-UTRA); Base Station (BS) radio transmission and reception".
10. [IETF RFC 1166:](https://www.rfc-editor.org/info/rfc1166) "Internet Numbers".
11. [IEEE Std 802.1CM(TM)-2018](https://standards.ieee.org/ieee/802.1CM/6236/): "IEEE Standard for Local and metropolitan area networks --- Time-Sensitive Networking for Fronthaul", 8 June 2018.
12. [Amendment to IEEE Std 802.1CM(TM)-2018:](https://standards.ieee.org/ieee/802.1CMde/7478/) "IEEE Standard for Local and metropolitan area networks --- Time-Sensitive Networking for Fronthaul - Amendment 1: Enhancements to Fronthaul Profiles to Support New Fronthaul Interface, Synchronization, and Syntonization Standards", in IEEE Std 802.1CMde(TM)-2020, Oct. 2020.
13. Void
14. 3GPP TS 36.213: "LTE; Evolved Universal Terrestrial Radio Access (E-UTRA); Physical layer procedures".
15. [Recommendation ITU-T G.781 (01/24):](https://www.itu.int/rec/T-REC-G.781) "Synchronization layer functions for frequency synchronization based on the physical layer".
16. [Recommendation ITU-T G.810 (08/1996):](https://www.itu.int/rec/T-REC-G.810-199608-I/en) "Definitions and terminology for synchronization networks".
17. [Recommendation ITU-T G.8260 (11/22):](https://www.itu.int/rec/T-REC-G.8260-202003-S/en) "Definitions and terminology for synchronization in packet networks".
18. [Recommendation ITU-T G.8261/Y.1361 (2019) Amendment 2 (10/2020):](https://www.itu.int/rec/T-REC-G.8261-202010-I%21Amd2/en) "Timing and synchronization aspects in packet networks".
19. [Recommendation ITU-T G.8262/Y.1362 (2018) Amendment 1 (03/2020):](https://www.itu.int/rec/T-REC-G.8262-202003-I%21Amd1/en) "Timing characteristics of synchronous equipment slave clock - Amendment 1".
20. [Recommendation ITU-T G.8262.1/Y.1362.1 (11/22):](https://www.itu.int/rec/T-REC-G.8262.1-202211-I) "Timing characteristics of enhanced synchronous equipment slave clock".
21. [Recommendation ITU-T G.8264/Y.1364 (2017) Amendment 2 (01/2024):](https://www.itu.int/rec/T-REC-G.8264-202401-I%21Amd2/en) "Distribution of timing information through packet networks - Amendment 1".
22. [Recommendation ITU-T G.8271/Y.1366 (03/2020):](https://www.itu.int/rec/T-REC-G.8271-202003-I/en) "Time and phase synchronization aspects of telecommunication networks".
23. [Recommendation ITU-T G.8271.1/Y.1366.1 (2022) Amendment 2 (01/24):](https://www.itu.int/rec/T-REC-G.8271.1-202401-P%21Amd2/en) "Network limits for time synchronization in packet networks with full timing support from the network".
24. [Recommendation ITU-T G.8271.2/Y.1366.2 (2021) Amendment 1 (11/22):](https://www.itu.int/rec/T-REC-G.8271.2-202211-I%21Amd1/en) "Network limits for time synchronization in packet networks with partial timing support from the network".
25. [Recommendation ITU-T G.8272/Y.1367 (2018) Amendment 2 (11/22):](https://www.itu.int/rec/T-REC-G.8272-202211-I%21Amd2/en) "Timing characteristics of primary reference time clocks".
26. [Recommendation ITU-T G.8272.1/Y.1367.1 (01/24):](https://www.itu.int/rec/T-REC-G.8272.1-202401-I/en) "Timing characteristics of enhanced primary reference time clocks".
27. [Recommendation ITU-T G.8273/Y.1368 (06/23):](https://www.itu.int/rec/T-REC-G.8273-202306-I/en) "Framework of phase and time clocks".
28. [Recommendation ITU-T G.8273.2/Y.1368.2 (06/23):](https://www.itu.int/rec/T-REC-G.8273.2-202306-I/en) "Timing characteristics of telecom boundary clocks and telecom time synchronous clocks for use with full timing support from the network".
29. [Recommendation ITU-T G.8273.3/Y.1368.3 (10/2020):](https://www.itu.int/rec/T-REC-G.8273.3-202010-I/en) "Timing characteristics of telecom transparent clocks for use with full timing support from the network".
30. [Recommendation ITU-T G.8275/Y.1369 (01/24):](https://www.itu.int/rec/T-REC-G.8275-202401-I/en) Architecture and requirements for packet-based time and phase distribution.
31. [Recommendation ITU-T G8275.1/Y.1369.1 (2022): Amendment 1 (01/24)](https://www.itu.int/rec/T-REC-G.8275.1-202401-I%21Amd1/en): "Precision time protocol telecom profile for phase/time synchronization with full timing support from the network

- Amendment 1".

1. [Recommendation ITU-T G8275.2/Y.1369.2 (2022) Amendment 1 (01/24):](https://www.itu.int/rec/T-REC-G.8275.2-202401-I%21Amd1/en) "Precision time protocol telecom profile for time/phase synchronization with partial timing support from the network - Amendment 1".
2. [IEEE Std 1588(TM)-2019:](https://standards.ieee.org/ieee/1588/6825/) "IEEE Standard for a Precision Clock Synchronization Protocol for Networked Measurement and Control Systems", November 2019.
3. [Recommendation ITU-T G.811(09/1997) Amendment 1 (04/16):](https://www.itu.int/rec/T-REC-G.811-201604-I%21Amd1/en) "Timing characteristics of primary reference clocks".
4. [Recommendation ITU-T G.8273.4/Y.1368.4 (2020) Amendment 2 (11/22):](https://www.itu.int/rec/T-REC-G.8273.4-202211-S%21Amd2/en) Timing characteristics of telecom boundary clocks and telecom time slave clocks for use with partial timing support from the network - Amendment 2.
5. [IEEE Std 802.1Q(TM)-2022:](https://standards.ieee.org/ieee/802.1Q/10323/): "IEEE Standard for Local and metropolitan area networks --- Bridges and Bridged Networks".
6. 3GPP TS 38.133 Release 15: "5G; NR; Requirements for support of radio resource management".
7. 3GPP TS 36.133 Release 15: "LTE; Evolved Universal Terrestrial Radio Access (E-UTRA); Requirements for support of radio resource management".
8. [eCPRI Transport Network V1.2 (2018-06-25)](http://www.cpri.info/downloads/Requirements_for_the_eCPRI_Transport_Network_V1_2_2018_06_25.pdf): "Common Public Radio Interface: Requirements for the eCPRI Transport Network".
9. 3GPP TS 36.141-1 Release 15: "LTE; Evolved Universal Terrestrial Radio Access (E-UTRA); Base Station (BS) conformance testing".
10. 3GPP TS 38.141-1 Release 15: "5G; NR; Base Station (BS) conformance testing Part 1: Conducted conformance testing".
11. 3GPP TS 36.211 Release 15: "LTE; Evolved Universal Terrestrial Radio Access (E-UTRA); Physical channels and modulation".
12. 3GPP TR 38.901: "5G; Study on channel model for frequencies from 0.5 to 100 GHz".
13. [IEEE Std. 802.2(TM)-1985:](https://ieeexplore.ieee.org/document/30705) "IEEE Standard for Local Area Networks - Logical Link Control".
14. [IEEE Std. 1914.3(TM):](https://ieeexplore.ieee.org/search/searchresult.jsp?newsearch=true&queryText=1914-3) "IEEE Standard for Radio over Ethernet Encapsulations and Mappings".
15. [IETF RFC 2460:](https://www.rfc-editor.org/info/rfc2460) " Internet Protocol, Version 6 (IPv6) Specification".
16. [IETF RFC 791:](https://www.rfc-editor.org/info/rfc791) "Internet Protocol".
17. [IETF RFC 826:](https://www.rfc-editor.org/info/rfc826) "An Ethernet Address Resolution Protocol: Or Converting Network Protocol Addresses to 48.bit Ethernet Address for Transmission on Ethernet Hardware".
18. [IETF RFC 768:](https://www.rfc-editor.org/info/rfc768) "User Datagram Protocol".
19. [IEEE Std 145(TM)-2013:](https://ieeexplore.ieee.org/document/6758443) "IEEE Standard for Definitions of Terms for Antennas".
20. [IEEE Std 802.1X(TM)-2020:](https://ieeexplore.ieee.org/document/9018454) "IEEE Standard for Local and Metropolitan Area Networks - Port-Based Network Access Control", February 2020.
21. 3GPP TS 38.323 V16.6.0 Release 16: "5G; NR; Packet Data Convergence Protocol (PDCP) specification".
22. [IEEE Std 802.3(TM)-2022:](https://ieeexplore.ieee.org/document/9844436) "IEEE Standard for Ethernet".
23. O-RAN.WG9.XTRP-SYN.0-v03.00: "O-RAN Synchronization Architecture and Solution Specification, Release 03.00".
24. 3GPP TS 38.211 V17.6.0 Release 17: "NR; Physical channels and modulation".
25. 3GPP TS 38.212 V17.6.0 Release 17: "NR; Multiplexing and channel coding".

## Informative references

References are either specific (identified by date of publication and/or edition number or version number) or

non-specific. For specific references, only the cited version applies. For non-specific references, the latest version of the referenced document (including any amendments) applies. In the case of a reference to a 3GPP document, a non- specific reference implicitly refers to the latest version of that document in Release 18, or the latest 3GPP release prior to Release 18 that includes that document.

NOTE: While any hyperlinks included in this clause were valid at the time of publication, O-RAN cannot guarantee their long-term validity.

The following referenced documents are not necessary for the application of the present document, but they assist the user with regard to a particular subject area.

[i.1] 3GPP TS 21.905: " Digital cellular telecommunications system (Phase 2+) (GSM); Universal Mobile Telecommunications System (UMTS); LTE; 5G; Vocabulary for 3GPP Specifications".

[i.2] 3GPP TR 36.932: "LTE; Scenarios and requirements for small cell enhancements for E-UTRA and E-UTRAN".

[i.3] 3GPP TS 36.331: "LTE; Evolved Universal Terrestrial Radio Access (E-UTRA); Radio Resource Control (RRC); Protocol specification".

[i.4] 3GPP TR 38.801 V14.0.0: "Study on new radio access technology: Radio access architecture and interfaces".

[i.5] 3GPP TS 38.213: "NR; Physical layer procedures for control".

# Definition of terms, symbols and abbreviations

## Terms

For the purposes of the present document, the terms given in 3GPP TR 21.905 [i.1] and the following apply. A term defined in the present document takes precedence over the definition of the same term, if any, in 3GPP TR 21.905 [i.1].

**beam:** beam (of the antenna) is a radiation pattern without restriction to main lobe

**Cascade mode**: Mode of Shared cell which is realized by several O-RUs cascaded in chain NOTE: See clause 13.

**category A O-RU**: O-RU within which the DL precoding is not done NOTE: See Figure 4.2.1-1.

**category B O-RU**: O-RU within which the DL precoding is performed NOTE: See Figure 4.2.1-1

**Control Plane (C-Plane)**: refers specifically to real-time control between O-DU and O-RU, and should not be confused with the UE's control plane

**extended Antenna-Carrier (eAxC)**: a data flow for a single antenna (or spatial stream) for a single carrier in a single sector

**FHM mode**: Mode of Shared cell which is realized by FHM and several O-RUs NOTE: See clause 13.

**Fractional Frequency Offset (FFO)**: defined as ?f/f\_norm which is used to describe frequency error, typically on the output of the T-TSC filter in the O-RU

NOTE: It is the same as the Fractional Frequency Deviation defined in Recommendation ITU-T G.810 [16], clause 4.5.2.

**fronthaul:** A logical link connecting O-DU and O-RU

NOTE: Fronthaul transports C-Plane, U-Plane, S-Plane and M-Plane traffic.

**GPS Time:** continuous time scale (no leap seconds) defined by the GPS Control segment. It starts at 0h UTC (midnight) of January 5th to 6th 1980

NOTE: See IEEE Std. 1588 [3], [33] Annex B for timescales.

**Hop**: physical link between two S-Plane nodes (where node can be O-DU, switch or O-RU) NOTE: As defined in IEEE 802.1CM [11], [12].

**Licensed Assisted Access (LAA)**: carrier aggregation with at least one secondary cell operating in the unlicensed spectrum

**Lower Layer Split (LLS)**: logical interface between O-DU and O-RU when using a lower layer (intra-PHY based) functional split

**Lower Layer Split Control Plane (LLS-C)**: logical interface between O-DU and O-RU when using a lower layer functional split

**Lower Layer Split User Plane (LLS-U)**: logical interface between O-DU and O-RU when using a lower layer functional split

**Lower Layer Split - synchronization Configuration x(1,2,3,4) (LLS-Cx)**: synchronization topologies defined in Clause 11.2.2

**High-PHY**: those portions of the PHY layer processing on the O-DU side of the fronthaul interface

NOTE: This includes forward error correction encode/decode, scrambling, and modulation/demodulation

**Low-PHY**: those portions of the PHY layer processing on the O-RU side of the fronthaul interface NOTE: This includes FFT/iFFT, digital beamforming, and PRACH extraction and filtering

**Management Plane (M-Plane)**: refers to non-real-time management operations between the O-DU and the O-RU

**Narrowband Internet of Things (NB-IoT)**: which is a Low Power Wide Area Network (LPWAN) radio technology standard specified in 3GPP standards to provide extended coverage such as indoor and underground scenarios, support of massive number of low throughput devices, low delay sensitivity, ultra-low device cost, low device power consumption and optimized network architecture

**O-RAN Central Unit (O-CU)**:- logical node hosting PDCP, RRC, SDAP and other control functions

**O-RAN Distributed Unit (O-DU)**: logical node hosting RLC/MAC/High-PHY layers based on a lower layer functional split

**O-RAN Radio Unit (O-RU)**: logical node hosting Low-PHY layer and RF processing based on a lower layer functional split

NOTE: This is similar to 3GPP defined TRP or RRH but more specific in including the Low-PHY layer (FFT/iFFT, PRACH extraction).

**Physical Resource Block (PRB)**: group of 12 consecutive subcarriers of an OFDM symbol.

**Port-list:** Logical term which refers to M-Plane configured unique eAxC\_ID list which is a union of {representative-tx- eaxc-id, member-tx-eaxc-id} or a union of {representative-rx-eaxc-id, member-rx-eaxc-id}.

**PRACH Symbol**: resource in the time domain having the duration of (1/Subcarrier Spacing), following cyclic prefix (excluded) in a PRACH occasion. Cyclic prefix and one or more of such consecutive PRACH Symbols constitute a PRACH preamble or a NPRACH symbol group defined in 3GPP TS 36.211 [42] and TS 38.211 [4]

**Primary Reference Time Clock (PRTC)**: as defined in Recommendation ITU-T G.8272 [25] and G.8272.1 [26].

NOTE: There are different types of PRTC defined in both Recommendation ITU-T G.8272 and G.8272.1. Unless the specific type is indicated, a reference to a PRTC in the present document could include any of these types.

**processing element:** see clause 7.5 of the M-Plane specification [7] for a definition of processing element

**Q<I.F>**: denotes a signed two's-complement I+F bit fixed point number with I signed integer bits, and F fractional bits

**quality Level:** referred to in Recommendation ITU G.781 [15] as "clock source quality level." The clock-source quality-level of a synchronous equipment clock or stand-alone synchronization clock is defined as the grade of clock to which it is ultimately traceable

**Resource Element (RE)**: one subcarrier of an OFDM symbol.

**rx-array:** as defined in clause 12.2

**Shared cell**: The operation for the same cell by several O-RUs.

NOTE: see clause 11.

**Shared O-RU:** see clause 14.1 for a definition of Shared O-RU.

**Shared O-RU Host:** see clause 3.1 of the M-Plane specification [7] for a definition of Shared O-RU Host.

**Shared Resource Operator:** see clause 3.1 of the M-Plane specification [7] for a definition of Shared Resource Operator.

**slot**: time duration defined in Table 7.5.2.13-3.

NOTE: This is applicable to both LTE and NR. Slot definition in the present document for LTE is different from the one defined in 3GPP TS 36.211 [42], clause 4.

**spatial stream**: data flow on the DL associated with precoded data (may be same as layers or different if there is expansion in the precoding), and on UL associated with the number of outputs from the digital beamforming (sometimes called "beams").

**Synchronization Plane (S-Plane)**: refers to traffic between the O-RU or O-DU and a synchronization controller which is generally an IEEE 1588 [3], [33] grandmaster.

NOTE: Grandmaster functionality may be embedded in the O-DU.

Time Error (**TE(*t*)**)-: The difference between the time indicated by a clock or timing signal, and that indicated by a reference clock or timing signal.

NOTE: See Recommendation ITU-T G.810 [16], clause 4.5.13.

**TRX**: refers to the specific processing chain in an O-RU associated with D/A or A/D converters.

NOTE: Due to digital beamforming the number of TRXs may exceed the number of spatial streams, and due to analog beamforming, the number of TRXs may be lower than the number of antenna elements.

**tx-array:** as defined in clause 12.2.

**user group:** A group of one or more layers for single UE (SU-MIMO) or single/multiple layers for different UEs (MU- MIMO), for which the scheduled layer (s) are using the same range of contiguous or non-contiguous PRBs and symbols in a slot. An individual UE's PRB and symbol allocation within a slot may span multiple user groups.

NOTE: In the context of DMRS-BF, if REs in DMRS symbols associated with the set of PUSCH symbols of a user group have differing PUSCH allocations based on differing cdmWithoutData values and/or differing DMRS allocations, those DMRS symbols are considered to be in said user group.

**UQ<I.F>**: denotes an unsigned I+F bit fixed point number with I unsigned integer bits and F fractional bits

**User Network Interface (UNI)**: as defined by eCPRI network requirement specification

**User Plane (U-Plane)**: refers to IQ sample data transferred between O-DU and O-RU

## Symbols

For the purposes of the present document, the symbols given in 3GPP TS 38.21 [4] and the following apply:

?*f* Subcarrier spacing

*u* Subcarrier spacing configuration

## Abbreviations

For the purposes of the present document, the abbreviations given in 3GPP TR 21.905 [i.1] and the following apply. An abbreviation defined in the present document takes precedence over the definition of the same abbreviation, if any, in 3GPP TR 21.905 [i.1].

ACK ACKnowledgement

ACK/NACK ACKnowledgement and Negative ACKnowledgement APTS Assisted Partial Timing Support

ASM Advanced Sleep Mode

BF BeamForming

BTCA Best TimeTransmitter Clock Algorithm C/U-Plane C-Plane and U-Plane

CA Carrier Aggregation

CDM Code Division Multiplexing

CID Company IDentification

CoMP Coordinated Multi-Point

CRS Cell specific Reference Signal

DAC Digital Analogue Converter

DIX Ethernet, named after DEC, Intel and Xerox

DL DownLink

DMRS DeModulation Reference Signal

DRS Discovery Reference Signal

DSS Dynamic Spectrum Sharing

eAxC\_ID eAxC IDentifier

EEC Ethernet Equipment Clock

eEEC enhanced Ethernet Equipment Clock

eNB evolved NodeB (applies to LTE)

ePRTC enhanced Primary Reference Time Clock

ESMC Ethernet Synchronization Messaging Channel FFO Fractional Frequency Offset

FHM FrontHaul Multiplexer

gNB next generation NodeB (applies to NR)

HARQ Hybrid Automatic Repeat request

IE Information element

iFFT inverse Fast Fourier Transformation

IQ In-phase and Quadrature-phase

ITU International Telecommunication Union

LBT Listen Before Talk

LLC Logical Link Control

MAC Media Access Control

MCOT Maximum Channel Occupancy Time MCS Modulation Coding Scheme

MMSE Minimum Mean Square Error

MTIE Maximum Time Interval Error

MTU Maximum Transmission Unit

NACK Negative Acknowledgement

OTA Over The Air

OTDOA Observed Time Delay Of Arrival OUI Organizationally Unique Identifier

PCP Priority Code Point

PDV Packet Delay Variation

PHY PHYsical layer

PLFS Physical Layer Frequency Support

PLL Phase Locked Loop

PPS Pulse Per Second

PRC Primary Reference Clock

PRG Precoding Resource block Group

PRTC Primary Reference Time Clock

PTP Precision Time Protocol

PT-RS Phase Tracking Reference Signal

QL Quality Level

RB Resource Block

RE Resource Element

RLC Radio Link Control

RLC-AM RLC Acknowledged Mode RLC-TM RLC Transparent Mode

RLC-UM RLC Unacknowledged Mode RoE Radio over Ethernet

RX Receiver

SE Section Extension

SF SubFrame

SLA Service Level Agreement

SMO Service Management and Orchestration

SRO Shared Resource Operator

SSB Synchronization Signal Block

SSM Synchronization Status Message

ST Section Type

SyncE Synchronous Ethernet

TAE Time Alignment Error

T-BC Telecom Boundary Clock

TDEV Time DEViation

T-GM Telecom GrandMaster

TLV Type Length Value

TM Transmission Mode

TOD Time Of Day

T-TC Telecom Transparent Clock

T-TSC Telecom Synchronous Clock

TX Transmitter

UE-TAE User Equipment Timing Advance Error UL UpLink

URLLC Ultra Reliable Low Latency Communications UTC Universal Time Coordinated

VLAN Virtual Local Area Network

vRAN virtualized Radio Access Network

## Document conventions

#### Terminologies

In the present document, all material is considered normative except where explicitly or implicitly labeled as informative. Labeling as informative includes content outside of tables and figures labeled as "NOTE", content described as "examples", and content carrying the explicit label of "informative" such as some Annexes.

For the purposes of the present document, the following terminologies apply.

**ignored**: Within the present document, it is sometimes stated that certain information elements are to be "ignored" by the receiver (generally for "reserved" fields but in some cases other fields too). In this case, the fields shall be ignored for the purposes of processing at the O-RAN application level, but in the case of certain packet error-checking such as Ethernet-layer CRC or parity calculations, the fields shall be included in the CRC or parity calculations. As well, in the event of packet encryption, the "ignored" fields shall be encrypted along with the other packet payload information.

#### Fields and bitmasks in messages

For the purposes of the present document, the following conventions apply for the format of messages and data structures within messages.

In accordance with IETF RFC 1166 [10], the left most bit of an octet is the most significant bit (msb) and the right most bit is the least significant bit (lsb). The msb is labelled as 0 and lsb is labelled as 7. This is illustrated by a blue ribbon in tables showing the message format. An example is depicted in Table 3.4.2-1. Note that this bit labelling convention (specifically the blue ribbon header in some tables) for octets is different from the labelling of bits within a field (bracketed bit numbers shown in tables).

To address specific bits within a field, the following notation is used: "X[k]" represents kth bit in a field X with the convention that bit X[0] is the least significant bit of field X and located in the rightmost bit position. Where applicable, a sequence of bits in a field X can be interpreted as an unsigned integer value Xval calculated with formula:

Xval = ?N-1 X[k] k

k=0

where N is number of bits in field X.

Notation "X[a:b]" represents a sequence of bits in field X starting from bit X[a] and ending at bit X[b] inclusive, where a > b.

Table 3.4.2-1 below illustrates the format of messages and data structures using this notation.

**Table 3.4.2-1: Example of table presenting format of a data structure**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **# of bytes** | **octet** |
| Y[3:0] | | | | X[11:8] | | | | 1 | N |
| X[7:0] | | | | | | | | 1 | N+1 |

The example data structure presented in Table 3.4.2-1 is interpreted as follows:

* Field Y has 4 bits. Bits Y[3] to Y[0] of field Y are in octet N; Y[3], the most significant bit of field Y is in the most significant bit of octet N.
* Field X has 12 bits. Bits X[11] to X[8] of field X are in octet N; X[8] is in the least significant bit of octet N. Bits X[7] to X[0] of field X are in octet N+1; X[7] is in the most significant bit of octet N+1 and X[0] is in the least significant bit of octet N+1.

This corresponds to a structure that maps every bit as presented in Table 3.4.2-2 below.

**Table 3.4.2-2: Interpretation of the example of table presenting format of a data structure**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **# of bytes** | **octet** |
| Y[3] | Y[2] | Y[1] | Y[0] | X[11] | X[10] | X[9] | X[8] | 1 | N |
| X[7] | X[6] | X[5] | X[4] | X[3] | X[2] | X[1] | X[0] | 1 | N+1 |

# Architecture & requirements

## Architectural aspects

#### Architectural entities

The architecture of eNB or gNB with O-DU and O-RUs is shown in Figure 4.1.1-1. LLS-C and LLS-U provide C-Plane and U-Plane over LLS interface, respectively.

In this architecture, O-DU and O-RU are defined as follows.

**O-RAN Distributed Unit (O-DU):** a logical node that includes the eNB/gNB functions as listed in clause 4.2 split option 7-2x, excepting those functions allocated exclusively to the O-RU. The O-DU controls the operation of O-RUs.

**O-RAN Radio Unit (O-RU):** a logical node that includes a subset of the eNB/gNB functions as listed in clause 4.2 split option 7-2x. The real-time aspects of control & user plane communication with the O-RU are controlled by the O-DU.

eNB/gNB

O-DU

LLS-C LLS-U

LLS-C LLS-U

...

O-RU

O-RU

**Figure 4.1.1-1: eNB/gNB architecture with O-DU and O-RUs**

## Functional split

#### Introduction

When considering the functional split defining a fronthaul interface there are two competing interests:

1. There is a benefit in keeping an O-RU as simple as possible because size, weight, and power draw are primary deciding considerations and the more complex an O-RU, the larger, heavier and more power-hungry the O-RU tends to be.
2. There is a benefit in having the interface at a higher level which tends to reduce the interface throughput relative to a lower-level interface -- but the higher-level the interface, the more complex the O-RU tends to be.

To resolve this, O-RAN has selected a single split point, known as "7-2x" but allows a variation, with the precoding function to be located either "above" the interface in the O-DU or "below" the interface in the O-RU. For the most part the interface is not affected by this decision, but there are some impacts, namely providing the necessary information to the O-RU to execute the precoding operation. O-RUs within which the precoding is not done (therefore of lower complexity) are called "Category A" O-RUs while O-RUs within which the precoding is done are called "Category B" O-RUs. See Figure 4.2.1-1 for a depiction of this dual O-RU concept.

Processing blocks with dotted blocks are not mandatory for all O-RU categories. Precoding operation for certain O-RU categories can be done within the O-RU and in this case precoding in O-DU can be bypassed.

|  |  |  |  |
| --- | --- | --- | --- |
| **O-DU** | **Scrambling** |  | |
| **Modulation** |
| **Layer Mapping** | |  |
| **Precoding**  (bypass mode possible) | |
| **RE Mapping**  **IQ Compression** | | | |

**O-RAN FH**

**O-RU**

|  |  |  |
| --- | --- | --- |
|  | O-RU Category A |  |
|  |  |
| Non-precoding O-RAN Radio Unit. Precoding in radio is not supported.  Digital and Analog beamforming optional | | |

|  |  |  |
| --- | --- | --- |
|  | O-RU Category B |  |
|  |  |
| Precoding O-RAN Radio Unit. Precoding in radio is supported.  Allows support for modulation compression.  Digital and Analog beamforming optional | | |

|  |  |  |  |
| --- | --- | --- | --- |
| **IQ Decompression** | | |  |
| **Precoding** |  | | |
| **Digital Beamforming** | | | |
| **iFFT and CP addition** | | | |
| **Digital to Analog** | |  | |
| **Analog Beamforming** | | | |

**Figure 4.2.1-1: Split Point and Category A and Category B O-RAN Radio Units**

The inclusion of these two O-RU categories has certain implications for the LTE and NR functional splits in both DL and UL, which are reflected in the following clauses. In particular, for a Category A O-RU, the precoding shall be executed in the O-DU and any beamforming in the O-RU, if present, would exclude the precoding calculation. For LTE precoding schemes other than Transmit Diversity and Spatial Multiplexing with Large Delay CDD and precoding schemes for NR, the precoding may be included in a digital beamforming processing block within the O-RU for a Category B O-RU (even for analog beamforming O-RUs). To implement Transmit Diversity and Spatial Multiplexing with Large Delay CDD precoding special C-Plane instructions need to be provided to the O-RU from the O-DU; this is described in clause 7.7.3.

#### Split 7-2x (DL)

###### Description

DL functional split for various physical layer channels is illustrated in Figure 4.2.2.1-1 (LTE Category A O-RUs), Figure 4.2.2.1-2 (LTE Category B O-RUs), Figure 4.2.2.1-3 (NR Category A O-RUs), and Figure 4.2.2.1-4 (NR Category B O-RUs).

When O-DU supports Category A O-RU, O-DU shall support a total number of precoded streams of up to 8. O-DU supporting Category A O-RU may support more than 8 precoded streams. For LTE (e.g. LTE TM9) and NR PDSCH with UE specific reference signals, the DL processing chain specified by 3GPP does not include a precoding operation. The detailed precoding operation referred to in Figure 4.2.2.1-1 and Figure 4.2.2.1-2 for PDSCH with UE specific reference signals is not further described within the present document.

![](../assets/images/9d818e4cd29d.png)

**Figure 4.2.2.1-1: Lower layer DL split description, LTE, Category A O-RUs**

![](../assets/images/e273a0bb9c46.png)

O-RAN FH

**Figure 4.2.2.1-2: Lower layer DL split description, LTE, Category B O-RUs**

Figure 4.2.2.1-2 presents DL functional split for Category B O-RU supporting precoding including precoding with Transmit Diversity and Spatial Multiplexing with Large Delay CDD schemes; for Category B O-RU not supporting Transmit Diversity and Spatial Multiplexing with Large Delay CDD schemes the channels precoded with Transmit Diversity or Spatial Multiplexing with Large Delay CDD shall be precoded by O-DU as presented on Figure 4.2.2.1-1 and the other channels shall be precoded on O-RU as presented on Figure 4.2.2.1-2.

Although not explicitly indicated in Figure 4.2.2.1-2, RE mapping operation is separated into two parts for precoding support at O-RU for transmit diversity and spatial multiplexing modes in Category B O-RU:

1. RE mapping to frequency resources is performed at O-DU.
2. RE mapping to antenna ports is performed at O-RU after precoding.

![](../assets/images/b36dfb7da49e.png)

O-RAN FH

NOTE: The above figure illustrates some of the high-level functionalities inside the O-RU and O-DU, and does not bind the internal design of each of the O-RU and O-DU.

**Figure 4.2.2.1-3: Lower layer DL split description, NR, Category A Radio**

![](../assets/images/7c93c8235e65.png)

O-RAN FH

NOTE: The above figure illustrates some of the high-level functionalities inside the O-RU and O-DU, and does not bind the internal design of each of the O-RU and O-DU.

**Figure 4.2.2.1-4: Lower layer DL split description, NR, Category B Radio**

In the DL, OFDM phase compensation (clause 5.4 of [4]), iFFT, CP addition, and digital beamforming functions reside in the O-RU for Category A and Category B O-RUs. In addition, precoding with schemes other than Transmit Diversity and Spatial Multiplexing with Large Delay CDD reside in the Category B O-RU. Optionally, precoding with Transmit Diversity and Spatial Multiplexing with Large Delay CDD precoding schemes reside in the Category B O-RU supporting these schemes. The PHY functions including resource element mapping, precoding, layer mapping, modulation, scrambling, rate matching and coding not handled by O-RU reside in the O-DU.

NOTE: The option of including some PHY functionality in a radio unit was not included in 3GPP TR 38.801 [i.4], clause 11.1.

###### Benefits and justification (informative)

* Interface simplicity: Transfer of user plane data is based on Resource Elements / Physical Resource Blocks, which simplifies the data mapping and limits the required associated control messages
* Transport Bandwidth Scalability: Lower split options (such as splits 7-1 and 8 as defined in 3GPP TR 38.801 [13], clause 11.1) scale based on number of antennas. In contrast, 7-2x interface scales based on "streams", which allows using high number of antennas without higher transport bandwidth. Further, sending only PRBs that contain user data is possible for purpose of reducing transport bandwidth
* Beamforming Support: The same interface design supports different beamforming techniques (digital, analog, hybrid) as well as different beamforming algorithms. Likewise, deployments using only analog beamforming are also possible with the same interface design.
* Interoperability: Less user specific parameters are used at split 7-2x (when compared to higher split options), which simplifies specification.
* Advanced receivers and inter-cell coordination: this option allows implementation of advanced receivers and coordination features, which are also easier to implement and less restricted when most functions are placed at the O-DU. For example, UL CoMP is not possible when the UL upper-PHY processing is in the O-RU.
* Lower O-RU complexity: Less functions at O-RU (when compared to higher split options) allow limiting the number of required real time calculations as well as required memory requirement, especially for Category A O-RUs.
* Future proof-ness: Placing most functions at O-DU will allow introduction of new features via software upgrades without inflicting HW changes at O-RU (e.g. specification changes due to URLLC or new modulation schemes).
* Interface and functions symmetry: If the same interface and split point is used for DL and UL, specification effort is reduced.

#### Split 7-2x (UL)

###### Description

UL functional split for various physical layer channels and transmission modes are illustrated in Figure 4.2.3.1-1. Likewise, digital beamforming in this context, is the function of antenna port selection or antenna port combining.

**PUxCH**

**SRS**

**PRACH**

**O-DU**

**Demodulation**

**Descrambling**

**(PHY part)**

**Detection**

**Channel**

**Estimation**

**Equalization, iDFT**

**Channel Estimation**

**RE demapping**

**RE demapping**

**RE demapping**

**IQ Decompression**

**IQ**

**Decompression**

**IQ**

**Decompression**

### O-RAN FH

**Filtering\***

**FFT and CP removal**

**Digital**

**Beamforming**

**Digital**

**Beamforming**

**Digital Beamforming**

**IQ Compression**

**IQ Compression**

**IQ**

**Compression**

**\*for PRACH, Filtering block includes CP removal, decimation filtering, and a smaller FFT or a larger FFT and PRACH subcarrier selection**

**O-RU**

**Analog to Digital**

**Dotted-line blocks are optional**

NOTE: The above figure illustrates some of the high level functionalities inside the O-RU and O-DU, and do not bind the internal design of each of the O-RU and O-DU.

**Analog Beamforming**

**Analog Beamforming**

**Analog Beamforming**

**Figure 4.2.3.1-1: Lower layer UL split description for LTE and NR**

In the UL, OFDM phase compensation (for all channels except PRACH when Section Type "3" message is used) according to clause 5.4 of [4], FFT, CP removal and digital beamforming functions reside in the O-RU. OFDM phase compensation for non-PRACH channels regardless of Section Type also reside in the O-RU, unless otherwise specified,

e.g. refer to clause 15.3.2, 15.3.3, and 15.4.2. The rest of the PHY functions including resource element de-mapping, equalization, de-modulation, de-scrambling, rate de-matching and de-coding reside in the O-DU.

NOTE: The option of including some PHY functionality in a radio unit was not included in 3GPP TR 38.801 [i.4], clause 11.1.

###### Benefits and justification (informative)

The benefits applicable for Option 7-2x for DL (see clause 4.2.2.2) are also applicable for Uplink.

## Data flows

An overall reference of required inputs for some major functional blocks, their granularity and input originating source is compiled in Table 4.3-1 and Table 4.3-2 for DL and UL, respectively.

**Table 4.3-1: Required information for each functional block (DL)**

|  |  |  |  |
| --- | --- | --- | --- |
| **Function** | **Required information** | **Example signalling granularity** | **Information source** |
| Digital beamforming | * Digital beamforming information * Number of TRXs or Beams | Per RE per beam per slot | Scheduler (O-DU) |
| iFFT and CP addition | * FFT size * SC spacing * CP length | Per TRX per slot | Scheduler (O-DU) |
| Analog beamforming | * Analog beamforming info | Per frequency band per slot | Scheduler (O-DU) |
| Listen Before Talk (LBT) | * LBT parameters | Per MCOT | Scheduler (O-DU) |

**Table 4.3-2: Required Information for each functional block (UL)**

|  |  |  |  |
| --- | --- | --- | --- |
| **Function** | **Required information** | **Example signalling granularity** | **Information source** |
| Digital beamforming | * Digital beamforming information * Number of TRXs or Beams | Per RE per TRX per slot | Scheduler (O-DU) |
| FFT and CP removal | * FFT size * SC spacing * CP length | Per TRX per slot | Scheduler (O-DU) |
| Analog beamforming | * Analog beamforming info | Per frequency band per slot | Scheduler (O-DU) |
| RRM measurements configuration | * Real-time trigger and commanding   of RRM measurements | Per layer per slot | DMRS-BF (O-DU) |
| RRM measurements | * RRM   measurements | Per layer/UE/PRB per slot | DMRS-BF (O-RU) (NOTE) |
| SINR reporting | * SINR data | Per layer per one or more RE(s) per slot | DMRS-BF-EQ (O-RU) |
| NOTE: Some RRM measurements have a different source of information in the O-RU than DMRS-BF. | | | |

In case of lower layer fronthaul based on split option 7-2x for DL and UL, the required external data flows (excluding M-Plane) to exchange information between O-DU and O-RU are categorized as follows. Further, the data flow direction is shown in figure 4.3-1, the data flow contents mapping is described in Table 4.3-3**.**

* User Plane
  + Data Flow 1a: Flows of IQ Data in FFT frequency domain on DL
  + Data Flow 1b: Flows of IQ Data in FFT frequency domain on UL
  + Data Flow 1c: Flow of PRACH IQ data in FFT frequency domain
* Control Plane
  + Data Flow 2a: Scheduling commands (DL & UL) & Beamforming commands
  + Data Flow 2b: LAA LBT configuration commands and requests
  + Data Flow 2c: LAA LBT status and response messages
  + Data Flow 2d: UE Channel Information
  + Data Flow 2e: ACK/NACK message
  + Data Flow 2f: Wake-up Ready Indication
  + Data Flow 2g: RRM measurements (see clause 12.6.1.6)
  + Data Flow 2h: SINR data (see clause 12.6.1.7)
* Synchronization Plane
  + Data Flow S: Timing and Synchronization data

**1a: DL IQ data in FFT frequency domain 1b: UL IQ data in FFT frequency domain**

O-RU

O-DU

**1c: PRACH IQ**

**2a: Scheduling Commands (DL&UL) & Beamforming Commands 2b: LAA LBT configuration parameters and requests**

**2c: LAA LBT status and responses 2d: UE Channel Information**

**2e: ACK/NACK message 2f: Wake-up Ready Indication**

**2g: RRM measurments 2h: SINR data**

**S: Timing & Synchronization**

NOTE: M-Plane flows are not presented here.

**Figur****e 4.3-1: Lower layer fronthaul data flows**

**Table 4.3-3: Data flow information mapping**

|  |  |  |  |  |
| --- | --- | --- | --- | --- |
| **Plane** | **ID** | **Data Flow** | **Contents** | **Typical Periodicity** |
| U-Plane | 1a | DL Frequency Domain IQ Data | DL user data (PDSCH), control channel data (PDCCH, etc.), ... | < slot |
| 1b | UL Frequency Domain IQ Data | UL user data (PUSCH), control channel data (PUCCH, etc.), ... | < slot |
| 1c | PRACH Frequency Domain IQ Data | UL PRACH data | < slot |
| C-Plane | 2a | Scheduling Commands (DL&UL) &  Beamforming Commands | Information conveyed in ST0, ST 1, ST 3, ST 4, ST 5, ST 11 including: Scheduling information, FFT size, CP length, Subcarrier spacing, UL PRACH scheduling.  DL and UL Beamforming commands (e.g. beam index, DMRS configuration) and scheduling;  Time-domain beamforming configuration using TIME\_DOMAIN\_BEAM\_CONFIG and  TDD pattern configuration using TDD\_PATTERN\_CONFIG;  Energy-saving configuration using TRX\_CONTROL and ASM;  Real-time commanding of RRM measurements. | ~ slot |
| 2b | LAA LBT configuration parameters and requests | LBT Configuration parameters conveyed in ST 7 such as lbtHandle, lbtDeferFactor, lbtBackoffCounter, lbtOffset, MCOT, lbtMode, sfnSf, lbtCWconfig\_H, lbtCWconfig\_T, lbtTrafficClass. | per MCOT/DRS (NOTE) |
| 2c | LAA LBT status and responses | LBT DL indication parameters conveyed in ST 7 such as lbtHandle, lbtResult, initialPartialSFs, bufferError, lbtCWR\_Result |  |
| 2d | UE channel information | Information conveyed in ST 6 including:  ciCompParam, ciIsample, ciQsample, regularizationFactor | >= slot |
| 2e | ACK/NACK message | Information conveyed in ST 8 including:  numberOfAcks, numberOfNacks, ackId, nackId | per ACK/NACK request (NOTE) |
| 2f | Wake-up Ready Indication | Information conveyed in ST 8 including:  numberOfAcks, ackId. | per wake-up (NOTE) |
|  | 2g | RRM measurements | RRM measurements conveyed in ST 10 | ~ slot |
| 2h | SINR data | SINR data conveyed in ST 9 | ~ slot |
| S-Plane | S | Timing and Synchronization | SyncE SSM & IEEE 1588 [3], [33]  PTP packets |  |
| NOTE: The listed periodicity is the only allowed value. | | | | |

## Latency requirements

#### Introduction

Intra-PHY lower layer fronthaul split has characteristic of a stringent bandwidth and tight latency requirement. This implies use of a special "Fronthaul Service Profile" to be supported by the transport network, and which may differ depending on the operating environment, topology and target use cases. The general concept and latency model is based on eCPRI reference points as specified in eCPRI Specification [2], clause 6.3.1, for delay management definitions (see Figure 4.4.1-1). However, the present document provides additional details for both DL and UL (see Table 4.4.1-1) latency. The delay parameters and how these are determined are explained below; in general it is expected a separate set of timing parameters applies to each O-RU attached to an O-DU. This clause defines multiple approaches which can be used to provide an inter-operable timing solution.

The reference points defined for eCPRI are reflected below in Figure 4.4.1-1**.**The reference points are:

* O-DU: R1 / R4 - Transmit / Receive interface at O-DU
* O-RU: R2 / R3 - Receive / Transmit interface at O-RU
* Ra: Antenna interface at O-RU

NOTE: When an external antenna is used with a cable imposing a negligible delay, then the O-RU connector to the external antenna can be assumed as Ra.

![](../assets/images/e45dc073c0f0.jpg)

O-RU

O-DU

**Figure 4.4.1-1: Definition of reference points for delay management (adapted from [2])**

Transmission delay between O-DU and O-RU are specified as T12 (downlink) and T34 (uplink). The transmission delay encompasses only the time from when a bit leaves the sender (R1 / R3) until it is received at the receiver (R2 / R4). In an ethernet transport network, these delays may not be constant due to switching delays (i.e. PDV). To account for this, transport delay shall be considered as a range with upper and lower bounds:

* Downlink transport delay: T12min / T12max
* Uplink transport delay: T34min / T34max

However, fixed timing at Ra is still required. Therefore, Ra is used as a reference point for delay management in the eCPRI model and transmission and reception at the reference points shall be measured relative to Ra, resulting in the following parameters in Table 4.4.1-1.

**Table 4.4.1-1: eCPRI O-DU/ O-RU delay model latency parameters (adapted from [2])**

|  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- |
|  |  | eCPRI | Latency | eCPRI | |
|  | |  |  | **Minimum** | **Maximum** |
|  | O-DU | T1a | Measured from output at O-DU (R1) to transmission over the air. | T1amin | T1amax |
| O-RU | T2a | Measured from reception at O-RU (R2) to transmission over the air | T2amin | T2amax |
|  | O-DU | Ta4 | Measured from reception at O-RU antenna to reception at O-DU port (R4). | Ta4min | Ta4max |
| O-RU | Ta3 | Measured from reception at O-RU antenna to output at O-RU port (R3) | Ta3min | Ta3max |

A common timescale is used on both ends of the link. The relative time error of the S-plane measurement signals between the O-DU and O-RU, for the purposes of latency requirements management, should be within a limit of 3 us (+-1.5 us).

* This requirement allows for the measurement of the transport delay (i.e. between O-DU and O-RU UNIs) with a measurement error that is sufficiently lower than the delay that is to be measured (e.g. 10 times lower).
* In case of LLS-C1 and LLS-C2, due to clause 11.3.2 requirements, the relative time error of the S-plane measurement signals between the O-DU and O-RU is within the limit of 3 us (+-1.5 us).
* In case of LLS-C3 and LLS-C4, the synchronization network should meet G.8271.1 or G.8271.2 network limits in order to meet similar requirements (relative time error of the S-plane measurement signals between the O-DU and O-RU within a limit of 3 us).
* The upper bound on the absolute time error requirement at the O-DU S-Plane is dictated by the O-RU's receive window, the delay and PDV in the transport network and the O-DU's internal delays.

#### Timing parameter relationships

###### General

To ensure proper reception of data at the receiver over the packet interface, there are several relationships between the parameters defined above which shall be met. First it is important to understand the nature of the transmission itself. In either direction (downlink/ uplink) it takes some amount of time for the sender to actually transmit the packets onto the transmission media. However, the amount of data for any interval (e.g. symbol) can vary thus resulting differing transmit times. This transmission time can be affected by several factors including (but not limited to) transport media rate, air interface bandwidth, and amount of data compression. The maximum amount of time allowed for the transmitter to send all data for an interval (Transmission Window) is defined by T1amax - T1amin. This is the allowed time, based on transport and O-RU characteristics, and its impacts on O-DU is explained in clause 4.4.2.2.

To account for transport variation and transmission time the receiver implements a reception window. This allows packets containing samples for a specific symbol to be received within the window and still be transmitted at Ra at the required time. The size of the Reception Window shall account for both the maximum transmission time at the sender and the transport variation through the fronthaul network. The result is the first of the delay relationships which shall be met to ensure a working delay solution, see Table 4.4.2.1-1.

Reception Window >= (Transmission Window + Transport Variation)

**Table 4.4.2.1-1: eCPRI Delay Windows**

|  |  |  |  |
| --- | --- | --- | --- |
|  | Reception Window | Transmission Window | Transport Variation |
| Downlink | T2amax - T2amin | T1amax - T1amin | T12max - T12min |
| Uplink | Ta4max - Ta4min | Ta3max - Ta3min | T34max - T34min |

The position (in time) of the reception/ transmission windows at the O-RU is fixed relative to the air interface. However, the position of the corresponding windows at the O-DU is a function of the O-RU and transport parameters. For guaranteed reception of packets sent from O-DU to O-RU within the O-RU reception window, the following relationships shown in Table 4.4.2.1-2 shall also be met (refer to Annex B for explanation of these inequalities):

**Table 4.4.2.1-2: O-DU transmission/ reception window position (in time)**

|  |  |  |
| --- | --- | --- |
| O-DU Timing | Parameter | O-DU Transmit Boundary Relationships |

|  |  |  |  |
| --- | --- | --- | --- |
| Downlink (Transmit) | No earlier than | T1amax | T1amax <= (T2amax + T12min) |
| No later than | T1amin | T1amin >= (T2amin + T12max) |
| Uplink (Receive) | No earlier than | Ta4min | Ta4min <= (Ta3min + T34min) |
| No later than | Ta4max | Ta4max >= (Ta3max + T34max) |

###### O-DU Transmission Window

The U-Plane O-DU transmission window (T1amax - T1amin) is defined by the relationships above based on the O-RU reception window and max transport variation. It does not define the exact timing of transmission from the O-DU. Rather, it defines the boundaries that the U-Plane O-DU transmission shall operate within. The window merely represents the mathematical boundaries imposed on the O-DU as a result of the O-RU and Transport constraints. It is possible to define the constraints for any one of O-DU, transport and O-RU based on knowledge of the other two.

However, typically the O-RU constraint is predefined based on the equipment, and transport is part of the overall network goals.

The window resulting from the relationships shall be greater than or equal to the actual maximum time required by the O-DU to transmit all data for a symbol (TXmaxO-DU). That is, the window shall be at least large enough that the O-DU can transmit in the worst case within the window. Where, within the window, the O-DU transmits (e.g. beginning, middle, end) and how much of the window is consumed by the O-DU transmission is a matter of O-DU design.

EXAMPLE: The following downlink example illustrates the concept:

* O-RU parameters: T2amin = 100 us, T2amax = 260 us.
* Transport Parameters (direct fibre of known length): T12min = 50 us, T12max = 51 us. The result indicates an O-DU transmission window as follows:
* T1amax <= (260 + 50) = 310 us.
* T1amin >= (100 + 51) = 151 us.

This provides a very large transmit window available to the O-DU. If, for example, the TXmaxO-DU is only 30 us, then the O-DU can determine where within the window to start its transmission, so long as the transmission completes prior to T1amin.

If, however, this same O-DU were paired with an O-RU with smaller reception window (e.g. T2amin = 100 us, T2amax = 150 us) using a transport network with the same T12min, but with 15 us of PDV (T12max = 65 us), the result is:

* T1amax <= (150 + 50) = 200 us.
* T1amin >= (100 + 65) = 165 us.

The delay solution still works (200 - 165 >= 30), but with far less margin, and far less flexibility as to where within the window the O-DU may begin transmission.

The C-Plane O-DU transmission window follows the same concept as the U-Plane O-DU transmit window. However, the C-Plane O-DU transmission window can be larger in size and hence, can start much earlier in time compared to the U-Plane O-DU transmission window.

In certain scenarios such as sending the beamforming weights in real-time for mMIMO application using Section Extension 11, the C-Plane messages need to be spread over time to avoid peak throughput. This use case is shown in Figure 4.4.2.2-1.

![](../assets/images/292628808d28.png)

**Figure 4.4.2.2-1: Example of the benefit of using a longer C-Plane tx/rx window compared to the U-Plane windows**

#### U-Plane/ C-Plane timing

The basic delay parameters above describe the general delay model and characteristics of the fronthaul interface. However, the fronthaul interface is divided into C-Plane and U-Plane parts. The C-Plane shall be available in order to process the corresponding U-Plane packets. To support coordination of C-Plane and U-Plane timing, the fronthaul interface specifies that C-Plane messages shall arrive at the O-RU some amount of time in advance (Tcp\_adv\_dl) of the latest possible time the first corresponding U-Plane messages may arrive. As a result, the present document has defined the downlink timing relationships and parameters shown in Figure 4.4.3-1.

NOTE: It is possible for Tcp\_adv\_dl to be set to 0.

**t=-T1a\_max\_cp\_dl**

start of Tx window C-Plane DL

**t=-T1a\_min\_cp\_dl**

end of Tx window C-Plane DL

tDL=0

![](../assets/images/2533f4d2b097.png)

F

**t=-T1a\_max\_up start of Tx window**

Transmission

Window

C-Plane DL

**t=-T1a\_min\_up end of Tx window**

**Transmission**

**Window**

C-Plane data **u-plane dl**

for symbol #n

IQ data for

Symbol #n

**DL FH Delay**

**t=-T2a\_min\_cp\_dl (end of RX window C-Plane DL)**

**t=-T2a\_min\_up**

**end of Rx window u-plane dl**

**DL FH Delay T12\_max**

**min DL**

**FH Delay T12\_min**

**T12\_max**

**T2a\_min\_up**

**Reception window u-plane dl**

**t=-T2a\_max\_up**

**Start of Rx window u-plane**

**T2a\_min\_cp\_dl**

**min DL**

**FH Delay T12\_min**

Reception window C-Plane DL

...

**t=-T2a\_max\_cp\_dl**

Symbol #n+1

Symbol #n

Symbol #n-1

Symbol #n-2

Symbol #n Processing

Symbol #n+1 Processing

c

u

c

u

![](../assets/images/f674bf4b14e7.png)![](../assets/images/b2a4636ded6b.png)

Ant Port

|  |  |
| --- | --- |
| O- DU | |
| H |  |
| O- RU | |

...

start of Rx window C-Plane DL

...

**DL frame timing at antenna ports (air interface)**

**Figure 4.4.3-1: Timing relations per symbol IQ in DL direction (U-Plane and C-Plane)**

The present document does not assume that the transmission windows for C-Plane and U-Plane are of the same size. Tcp\_adv\_dl allows for different alignment of the respective transmission/ reception windows as illustrated in the Figure 4.4.3-1. The reference (denoted as "tDL=0") is the transmission of the earliest IQ sample in time domain within a symbol (including cyclic prefix) which is generated from the IQ data received in a U-Plane messages specific to a symbol identified by symbolId (optionally adjusted by timeOffset).

For downlink, a C-Plane message with instructions for transmission of a downlink radio signal e.g. a C-Plane message of data flow 2a with dataDirection = 1 (see clause 4.3) is sent from O-DU to O-RU and may refer to one or more symbols; transmission and reception windows for a downlink C-Plane message referencing multiple symbols are relative to the start of the earliest symbol referenced by the message (identified by startSymbolId; optionally adjusted by timeOffset).

For uplink, the C-Plane messages with instructions for reception of an uplink radio signal i.e. C-Plane messages of data flow 2a with dataDirection = 0 (see clause 4.3) are sent from O-DU to O-RU, while the U-Plane messages are sent from O-RU to O-DU. Since these C-Plane data flows describing uplink U-Plane data are from O-DU to O-RU, they use the reference points R1 and R2 (see Figure 4.4.1-1), and corresponding timing parameters. However, the uplink C-Plane timing is not characterized relative to the downlink C-Plane or U-Plane timing, but relative to Ra (see Figure 4.4.1-1). The resulting fronthaul delay model for non-PRACH channels is shown in Figure 4.4.3-2.

![](../assets/images/077a7b8bf132.png)

**c**

#n

**c**

Symbol #n+1 Processing

Symbol #n Processing

O- RU

Reception Window C-Plane UL

c-plane data for symbol #n

O- DU

Transmission Window

C-Plane UL

tUL=0

|  |  |  |  |
| --- | --- | --- | --- |
| Symbol #n-2 | Symbol #n-1 | Symbol #n | Symbol #n+1 |

NOTE: The figure shows timing relations applicable for the natural order of transmission of uplink U-Plane messages i.e. the UL U-Plane messages for each symbol are sent in the order in which the uplink symbols are received at the air interface. For DMRS-BF, clause 12.6.1.5 defines mechanisms for rearranging the data included within the tx-windows of the uplink U-Plane messages.

**Figure 4.4.3-2: Timing relations per symbol IQ in UL direction (U-Plane and C-Plane)**

A C-Plane message with instructions for reception of an uplink radio signal of channels other than PRACH (data flow 2a with with dataDirection = 0, see clause 4.3) can refer to one or more symbols. The reference point for the message (denoted as "tUL=0" in Figure 4.4.3-2) is the reception of the earliest IQ sample in time domain (start of cyclic prefix) that is specific to the earliest symbol referenced by the message (indicated by startSymbolId in the message header and by Symbol #n in Figure 4.4.3-2; if Section Type 3 message is used, timeOffset will also point to this reference point).

The reference point for uplink U-Plane messages related to non-PRACH channels (denoted as "tUL=0" in Figure 4.4.3-2) is the reception of the earliest IQ sample in time domain within a symbol (start of cyclic prefix) referenced by the message (pointed by symbolId; if Section Type 3 message is used, timeOffset will also point to this reference point).

For DMRS-BF the O-RU may support one or more methods for reordering of uplink U-Plane symbols which provides the O-DU mechanism to rearrange the data included within the tx-windows of the uplink U-Plane messages sent by the O-RU, see clause 12.6.1.5 for more details.

A C-Plane message carrying SINR data (data flow 2h, see clauses 4.3, 7.2.11 and 12.6.1.7) is sent from the O-RU to the O-DU and shall be transmitted by the O-RU within transmit window defined for uplink U-Plane message i.e. window defined by Ta3\_min and Ta3\_max relative to "tUL=0" (see Figure 4.4.3-2). The transmit window for SINR data is symbol specific and usage of symbolId in SINR reporting is defined in clause 7.2.11. If DMRS-BF is used and the order of uplink U-Plane symbol data sent by the O-RU is rearranged by the O-DU (see clause 12.6.1.5) then the order of C- Plane messages carrying SINR shall be rearranged in the same way and follow the order configured for the same section.

When M-Plane parameter **ul-fft-sampling-offset** for non-PRACH channels is configured to a non-zero value, the capture of the earliest IQ sample in the FFT sampling window shall be advanced by that value as shown in Figure 4.4.3-2a. However, the reference for the symbol timing (denoted as "tUL=0" in Figure 4.4.3-2) shall be unaffected by value of **ul-fft-sampling-offset**. The configured value of **ul-fft-sampling-offset** shall not be larger than the duration of the cyclic prefix; in case of variability of the cyclic prefix duration, the limit is the shortest duration of the cyclic prefix in use.

![](../assets/images/b5e4fffe5f9e.png)![](../assets/images/d27ef3c8430b.png)![](../assets/images/f66018574868.png)![](../assets/images/e9e7ae8f09b7.png)![](../assets/images/eb9687824a2d.png)![](../assets/images/2f661df25295.png)![](../assets/images/f66018574868.png)![](../assets/images/f4e6cc60ad18.png)![](../assets/images/43fd24434523.png)![](../assets/images/9b0979418029.png)![](../assets/images/297a29ff8383.png)![](../assets/images/636cf6f22a63.png)![](../assets/images/f79fdea98604.png)![](../assets/images/e3e704cc1e6c.png)![](../assets/images/39b3409602fb.png)![](../assets/images/e1de2aac2712.png)![](../assets/images/1edc3654021c.png)![](../assets/images/1e31a90c1168.png)![](../assets/images/d65e81b28be3.png)![](../assets/images/95fb974cc5e6.png)![](../assets/images/cc53897f62c4.png)![](../assets/images/d4f8d5f15e9b.png)

**ul-fft-sampling-offset**

**ul-fft-sampling-offset**

**ul-fft-sampling-offset**

**ul-fft-sampling-offset**

FFT sampling window

Normal CP

Normal CP

Normal CP

**ul-fft-sampling-offset**

**ul-fft-sampling-offset**

**ul-fft-sampling-offset**

FFT sampling window

Extended CP

Extended CP

time

Extended CP

Normal CP

NOTE: The blocks represent a duration of cyclic prefixes, symbol data and FFT sampling window. For presentation purposes the figure is not to scale. The formulas in the figure express duration of cyclic prefix and symbol data. The time axis is in Tc (s). The symbols used in formulas are defined in 3GPP TS 38.211 [4].

**Figure 4.4.3-2a: FFT sampling window**

Due to the characteristics regarding CP duration and symbol duration of PRACH Symbols, PRACH is handled in a separate way. Especially for the preamble PRACH formats 0...3 (see 3GPP TS 38.211 [4], clause 6.3.3) the duration of both the CP and the PRACH Symbol is much larger than corresponding parts for e.g. PUSCH symbols. For the other PRACH formats (A1...C2) the duration of the CP could be very long compared to the CP for the PUSCH symbols (up to roughly 14 times longer (C2)). The consequence of either long CP duration and/or long PRACH Symbol duration of specific PRACH formats is that the values of Ta3\_min and Ta3\_max are increased. Due to this, PRACH CP duration and other PRACH Symbols than the first PRACH Symbol are excluded from the values for ta3\_min/max parameters provided by the O-RU.

The O-DU is aware of the characteristics of the PRACH format being used (e.g. duration of CP, number of PRACH Symbols), and with this information the position and size of the reception window is calculated by the O-DU. The used values for Ta3\_min and Ta3\_max are the ones being retrieved from the O-RU for the SCS being used for PRACH.

A C-Plane message with instructions for reception of a PRACH signal (a data flow 2a with dataDirection = 0, see clause 4.3) can refer to one or more PRACH Symbols depending on the PRACH format. For PRACH formats with multiple PRACH symbols, only a single C-Plane message is used to refer to all PRACH Symbols for a particular PRACH occasion.

The reference point for PRACH C-Plane message is pointed by startSymbolId and:

* Is the reception of the earliest IQ sample in time domain (start of cyclic prefix) that is specific to the PRACH Symbol referenced by the message.
  + This is allowed only for NR/LTE preamble formats which have sequence length 839 and one PRACH Symbol, i.e. NR/LTE format 0 and LTE format 1 (see 3GPP TS 36.211 [42] clause 5.7.2 and 38.211 [4]

clause 6.3.3).

* + In this case, cpLength is set to a non-zero value in the PRACH C-Plane (Section Type 3) message, which should indicate the actual CP duration.
* Or is the start of the latest symbol timing that starts right at or before the reception of the earliest IQ sample in time domain (after PRACH cyclic prefix) that is specific to the earliest PRACH Symbol referenced by the message.
  + This is allowed for all PRACH formats.
  + In this case, cpLength is set to zero in the PRACH C-Plane (Section Type 3) message.
  + If the SCS value provided by "frameStructure" is equal to or greater than 15 kHz, then the symbol timing used to determine startSymbolId is based on the numerology of the SCS value provided by "frameStructure". Else, if the SCS value provided by "frameStructure" is less than 15 kHz (e.g. for long preamble PRACH formats), then the symbol timing used to determine startSymbolId is based on the numerology of 15 kHz SCS.
  + When **ul-fft-sampling-offset** for PRACH is configured (via M-Plane) to a non-zero value, the timing of the earliest IQ sample is advanced by that value. However, the reference symbol timing that is used to determine the startSymbolId value in the PRACH C-Plane message is unaffected by **ul-fft-sampling- offset**. Therefore, with a non-zero **ul-fft-sampling offset** for PRACH, it is possible that "the latest symbol timing that starts right at or before the reception of the earliest IQ sample in time domain (after PRACH cyclic prefix) that is specific to the earliest PRACH Symbol" may change to an earlier symbol timing compared to the case where **ul-fft-sampling-offset** for PRACH is zero. So, the O-DU needs to take **ul-fft-sampling-offset** for PRACH into account when determining the startSymbolId value.

However, it is noted that even if **ul-fft-sampling-offset** for PRACH is configured to a non-zero value, it is expected to be in the order of nanoseconds (i.e. less than 1 microsecond).

The reference point for PRACH U-Plane message is the reception of the earliest IQ sample in time domain within a PRACH Symbol (after PRACH cyclic prefix) referenced by the message.

* For the first PRACH Symbol.
  + If cpLength is set to a non-zero value in the PRACH C-Plane (Section Type 3) message referencing the PRACH Symbol, this reference point for PRACH U-Plane message is pointed by timeOffset (pointing to the start of PRACH cyclic prefix) + cpLength - **ul-fft-sampling-offset** (for PRACH).
  + Else, if cpLength is set to zero in the PRACH C-Plane (Section Type 3) message referencing the PRACH repetition, this reference point for PRACH U-Plane message is pointed by timeOffset (pointing to the start of the PRACH Symbol (after PRACH cyclic prefix)) - **ul-fft-sampling-offset** (for PRACH).
* For subsequent PRACH Symbols (for PRACH formats with multiple PRACH Symbols), this reference point for PRACH U-Plane message is shifted by the PRACH Symbol duration.

Timing relationships for PRACH taking some specific PRACH formats (Format 0, Format 1, Format B4 and Format C0) as examples are shown in Figure 4.4.3-3 through Figure 4.4.3-6.

**15 kHz SCS**

**13**

**12**

**11**

**10**

**9**

**8**

**7**

**6**

**5**

**4**

**3**

**2**

**1**

**0**

**Subframe X**

**symbol timing**

![](../assets/images/967ef26c0f59.png)

**PRACH Symbol (R0)**

**CP**

**T2a\_max\_cp\_ul**

**O-RU Rx window**

**T2a\_max\_cp\_ul**

**cpLength or timeOffset**

**O-DU Rx window**

**T34\_max**

**O-RU Rx window**

**Ta3\_min**

**Ta3\_max**

**When cpLength is set to indicate actual CP duration Ref. point for PRACH C-Plane msg. pointed by startSymbolId (set to 0)**

**T34\_min**

**for R0**

**When cpLength is set to 0**

**Ref. point for PRACH C-Plane msg. pointed by startSymbolId (set to 1)**

**Ref. point for PRACH U-Plane msg. pointed by:**

1. **cpLength (when cpLength is set to indicate actual CP duration; in which case timeOffset is set to 0)**

**Or**

1. **timeOffset (when cpLength is set to 0)**

**Figure 4.4.3-3: Timing relations for PRACH (Example 1: PRACH Format 0)**

**15 kHz SCS**

**symbol timing**

**Subframe X**

**0 1 2 3 4 5 6 7 8**

**9 10 11 12 13**

**Subframe X+1**

**0 1 2 3 4 5 6 7 8 9 10 11 12 13**

**CP PRACH Symbol (R0) PRACH Symbol (R1)**

**O-RU Rx window**

**timeOffset**

**Ta3\_min**

**Ta3\_max**

**T34\_min**

**O-DU Rx**

**window for R0**

**T34\_max Ta3\_min**

**T34\_min**

**O-DU Rx**

**window for R1**

**Ref. point for PRACH C-Plane msg.**

**pointed by startSymbolId (set to 9)**

**Ref. point for PRACH U-Plane msg.**

**for R0 is pointed by timeOffset**

**Ta3\_max**

**T34\_max**

**Ref. point for PRACH U-Plane msg. for**

**R1 (shift by PRACH Symbol duration)**

**Figure 4.4.3-4: Timing relations for PRACH (Example 2: PRACH Format 1)**

![](../assets/images/4ac1d9e104f3.png)

**Figure 4.4.3-5: Timing relations for PRACH (Example 3: PRACH Format B4)**

![](../assets/images/b9b96c74456a.png)

**Figure 4.4.3-6: Timing relations for PRACH (Example 4: PRACH Format C0)**

A C-Plane message carrying RRM measurements (data flow 2g, see clauses 4.3 and clause 12.6.1.6) is sent from the O- RU to the O-DU and uses the reference points R3 and R4 in Figure 4.4.1-1 with the corresponding timing parameters. The resulting fronthaul delay model for the data flow 2g is shown in Figure 4.4.3-7.

tUL=0

**Ta4\_max\_2g**

**Ta4\_min\_2g**

Reception window C-plane flow 2g

Min UL FH

delay T34\_min

C-plane flow 2g message

for symbol #n

Max UL FH

delay T34\_max

**Ta3\_min\_2g**

**Ta3\_max\_2g**

C-plane flow 2g message for symbol #n

Transmission window C-plane flow 2g

...

Symbol #n+1

Symbol #n

Symbol #n-1

Symbol #n-2

RRM

RRM

|  |  |  |
| --- | --- | --- |
| O-DU | | |
| H |  |  |
| O-RU | | |
|  |  | |

F

Ant port

UL frame timing at antenna ports (air interface)

**Figure 4.4.3-7: Timing relations for C-Plane data flow 2g (RRM Measurements)**

The reference point (denoted as "tUL=0" in Figure 4.4.3-7) for uplink C-Plane data flow 2g messages is the reception of the earliest IQ sample in time domain (start of cyclic prefix) that is specific to the earliest symbol referenced by the message (indicated by startSymbolId in the message header and by Symbol #n in Figure 4.4.3-7). The requirements for usage of startSymbolId in the flow 2g are specified in clause 9.2.1 and restrict startSymbolId to value 0 which results in one transmit window per slot. The order of the flow 2g messages is not affected when the order of uplink U-Plane symbol data is rearranged with methods described in clause 12.6.1.5.

The resulting O-RAN delay model parameters are summarized in Table 4.4.3-1. The respective sections within the table for O-RU and O-DU define the delay profile parameters for the equipment.

**Table** **4.4.3-1: Delay management model parameters**

|  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- |
|  | **Parameters** | **C-Plane** | | **U-Plane** | |
| **DL** | **UL** | **DL** | **UL** |
| Network | T12min | T12\_min | T12\_min | T12\_min | N/A |
| T12max | T12\_max | T12\_max | T12\_max | N/A |
| T34min | N/A | N/A | N/A | T34\_min |
| T34max | N/A | N/A | N/A | T34\_max |
| O-RU | T2amin | T2a\_min\_cp\_dl | T2a\_min\_cp\_ul | T2a\_min\_up | N/A |
| T2amax | T2a\_max\_cp\_dl | T2a\_max\_cp\_ul | T2a\_max\_up | N/A |
|  | Tcp\_adv\_dl | N/A | N/A | N/A |
| Ta3min | N/A | Ta3\_min\_2g | N/A | Ta3\_min |
| Ta3max | N/A | Ta3\_max\_2g | N/A | Ta3\_max |
| O-DU | T1amin | T1a\_min\_cp\_dl | T1a\_min\_cp\_ul | T1a\_min\_up | N/A |
| T1amax | T1a\_max\_cp\_dl | T1a\_max\_cp\_ul | T1a\_max\_up | N/A |
| Ta4min | N/A | Ta4\_min\_2g | N/A | Ta4\_min |
| Ta4max | N/A | Ta4\_max\_2g | N/A | Ta4\_max |

The relationships between the various delay model parameters are defined below in Table 4.4.3-2 and Table 4.4.3-3:

**Table** **4.4.3-2: Downlink delay relationships**

|  |  |  |
| --- | --- | --- |
|  | **Earliest transmission from O-DU** | **Latest Transmission from O-DU** |
| U-Plane | T1a\_max\_up <= (T2a\_max\_up + T12\_min) | T1a\_min\_up >= (T2a\_min\_up + T12\_max) |
| C-Plane | T1a\_max\_cp\_dl <= (T2a\_max\_cp\_dl + T12\_min) | T1a\_min\_cp\_dl >= (T2a\_min\_cp\_dl + T12\_max) |

**Table** **4.4.3-3: Uplink delay relationships**

|  |  |  |
| --- | --- | --- |
|  | **Earliest U-Plane Reception at O-DU** | **Latest U-Plane Reception at O-DU** |
| U-Plane (NOTE 1) | Ta4\_min <= (Ta3\_min + T34\_min) | Ta4\_max >= (Ta3\_max + T34\_max) |
|  | **Latest UL C-Plane transmission from O-DU** | **Earliest UL C-Plane Transmission from O-DU** |
| C-Plane (NOTE 2) | T1a\_min\_cp\_ul >= (T2a\_min\_cp\_ul + T12\_max) | T1a\_max\_cp\_ul <= (T2a\_max\_cp\_ul + T12\_min) |
|  | **Earliest C-Plane Reception at O-DU** | **Latest C-Plane Reception at O-DU** |
| C-Plane (NOTE 3) | Ta4\_min\_2g <= (Ta3\_min\_2g + T34\_min) | Ta4\_max\_2g >= (Ta3\_max\_2g + T34\_max) |
| NOTE 1: The U-Plane relationships are applicable also for C-Plane data flow 2h (SINR data, see clauses 4.3 and 12.6.1.7)  NOTE 2: Applicable for C-Plane data flow 2a (see clause 4.3)  NOTE 3: Applicable for C-Plane data flow 2g (RRM Measurements, see clauses 4.3 and 12.6.1.6) NOTE 4: C-Plane data flows 2c, 2d, 2e and 2f have separate timing parameters not included in this table | | |

For the fronthaul interface to operate properly, the transmit and receive windows at the O-DU shall be properly aligned. The O-RU window alignment is always based on Ra. For the O-DU to align transmit and receive windows, it needs the following:

* O-RU Delay Characteristics.
* Transport Network Delay Characteristics.

The accuracy of the reported O-RU delay characteristics shall be 200 ns. The 200 ns value was decided as a compromise between a very high accuracy (tens of nanoseconds) which makes buffering in the O-RU easier and a more modest accuracy (~0.5 us) which is relatively easy for a well-controlled Ethernet network to accomplish. This accuracy applies only to the reported start and end times of the reception and transmission windows relative to Ra. Ra is a fixed reference point as defined by the respective air interface standards and supported features. As an example, if the O-RU reports T2a\_min\_up of 20 us, the O-RU may begin processing the data from 19.8 us to 20.2 us prior to the symbol over the air transmission time (Ra in Figure 4.4.1-1). However, the O-RU shall still transmit over the air with the precision as defined by the air interface standards.

#### Computed latency methods

###### Introduction

Clause 4.4.4 addresses supported methods for providing the O-DU with the required information to properly align transmit and receive windows. Table 4.4.4.1-1 lists the supported methods.

**Table** **4.4.4.1-1: O-DU transmit/ receive window alignment methods**

|  |  |  |
| --- | --- | --- |
| **Delay Characteristics** | **Computed Methods** | |
| **Defined Transport** | **Measured Transport** |
| O-RU Delay | O-RU specific values available to O- DU | O-RU specific values available to O-DU |
| Transport Delay | Pre-defined Min/ Max | Min - Measured; PDVmax - SLA |

The goal of delay management for fronthaul interfaces is to ensure that the transmission and reception windows at the O-DU are properly aligned to support the O-RU and transport network characteristics. With the computed methods, the O-DU shall compute the required transmit and receive windows based on O-RU delay and transport network characteristics. The O-DU shall then determine if the O-DU can accommodate the required transmit and receive windows. If so, it shall set its transmit and receive windows (based on O-DU design) to the most appropriate settings. As an example, an O-DU can have a fixed set of transmit and receive windows. The O-DU may then select the fixed settings that best fit the transport latency (T12, T34) and O-RU delay characteristics for the connected O-RUs.

The O-DU should raise notification if it is not capable of accommodating the required transmit and receive windows.

Based on the downlink delay relationships defined in Table 4.4.3-2, following conditions apply for the placement of the transmit window at the O-DU to support the reception window at the O-RU:

* The O-DU shall transmit DL U-Plane messages:
  + Early enough (i.e. before T1a\_min\_up) to ensure it is received at O-RU before T2a\_min\_up
  + Late enough (i.e. after T1a\_max\_up) to ensure it is received at O-RU after T2a\_max\_up
* Similarly, the O-DU shall transmit C-Plane messages within their respective windows (T1a\_min\_cp\_dl and T1a max\_cp\_dl for downlink C-Plane messages, and T1a\_min\_cp\_ul and T1a\_max\_cp\_ul for uplink C-Plane messages)

Based on the uplink delay relationships defined in Table 4.4.3-3, the following conditions apply for alignment of the receive window at the O-DU to support the transmission window at the O-RU:

* The O-DU shall set its receive window for UL U-Plane messages:
  + Early enough (i.e. Ta4\_min or before) to ensure UL U-Plane messages transmitted by O-RU after Ta3\_min is received
  + Late enough (i.e. Ta4\_max or after) to ensure UL U-Plane messages transmitted by O-RU before Ta3\_max is received

The O-DU constraints for delay management to operate properly are given in Table 4.4.4.1-2:

**T****able 4.4.4.1-2: O-DU constraints**

|  |  |  |  |
| --- | --- | --- | --- |
| **O-DU** | **Constraint** | | |
| **Parameter** | **Description** | **Relationship** |
| Transmit Window (U-Plane) | TXmaxO-DU | maximum transmit window needed by an O-DU | (T1a\_max\_up - T1a\_min\_up) >= TXmaxO-DU |
| T1a\_max\_upO-DU | Maximum T1a\_max\_up supported by an O-DU | T1a\_max\_upO-DU >= T1a\_max\_up |
| Receive Window | RXmaxO-DU | Maximum receive window supported by an O-DU | RXmaxO-DU >= (Ta4\_max ? Ta4\_min) |
| Ta4\_maxO-DU | Maximum uplink latency  relative to Ra supported by an O-DU | Ta4\_maxO-DU >= Ta4\_max |
| Transmit  Window (C-Plane) | TXmaxO-DU-C-Plane | maximum transmit window needed by an O-DU | (T1a\_max\_cp\_dl - T1a\_min\_cp\_dl) >= TXmaxO-DU-C-Plane |

###### Fronthaul timing domain

With the computed delay approach, O-DU delay parameters apply to a timing domain. A timing domain is defined as the set of O-DU and O-RU Physical Fronthaul Network Interface ports to which the computed O-DU delay parameters apply. The O-DU timing domain can encompass a single O-DU port, or can encompass multiple O-DU ports, where the same O-DU timing parameters apply to all O-DU ports in the domain.

Similarly, each O-DU port in the domain can support C-Plane and U-Plane traffic to 1 or more O-RU ports. Therefore, a fronthaul timing domain can encompass one or more O-DU Physical Fronthaul Interface Ports and one or more O-RU Physical Fronthaul Interface Ports.

The O-DU shall compute transmit and receive windows with the single set of delay parameters to encompass the worst case of Transport and O-RU delay characteristics within the domain. The following definitions are used:

* Transport Network Parameters for a timing domain:
  + T12\_minij: T12\_min between O-DU Physical Fronthaul Interface Port (i) and O-RU Physical Fronthaul Interface Port (j)
  + T34\_minij: T34\_min between O-DU Physical Fronthaul Interface Port (i) and O-RU Physical Fronthaul Interface Port (j)

Table 4.4.4.2-1 lists delay parameters for O-RU Port (j) within a timing domain.

NOTE: It is assumed that if a timing domain has multiple T12\_min and T34\_min values, then the transport delay characteristics are measured. For measured transport delay it is not possible to measure the maximum delay. T12\_max and T34\_max in this case is computed by adding a pre-defined (e.g. via SLA) worst case variation (PDVmax) to the corresponding transport minimum delay values.

**Table 4.4.4.2-1: Radio delay parameters for O-RU Port "j" within a timing domain**

|  |  |  |  |  |
| --- | --- | --- | --- | --- |
|  | **Downlink U-Plane** | **Uplink U-Plane** | **Downlink C-Plane** | **Uplink C-Plane** |
| Minimum | T2a\_min\_upj (Note 2) | Ta3\_minj | T2a\_min\_cp\_dlj | T2a\_min\_cp\_ulj  Ta3\_min\_2gj (Note 3) |
| Maximum | T2a\_max\_upj (Note 2) | Ta3\_maxj | T2a\_max\_cp\_dlj | T2a\_max\_cp\_ulj  Ta3\_max\_2gj (Note 3) |
| NOTE 1: Tcp\_adv\_dl may be different across RUs within a domain, therefore T2a\_min\_cp\_dl and T2a\_max\_cp\_dl shall be used to determine downlink C-Plane window.  NOTE 2: Uplink U-Plane parameters Ta3\_minj and Ta3\_maxj are applicable also for C-Plane data flow 2h (SINR data, see clauses 4.3 and 12.6.1.7)  NOTE 3: Uplink C-Plane parameters T2a\_min\_cp\_ulj and T2a\_max\_cp\_ulj are applicable for C-Plane data flow 2a (see clause 4.3); parameters Ta3\_min\_2gj and Ta3\_max\_2gj are applicable for C-Plane data flow 2g (RRM Measurements, see clauses 4.3 and 12.6.1.6).  NOTE 4: C-Plane data flows 2c, 2d, 2e and 2f have separate timing parameters not included in this table. | | | | |

The resulting parameters to be used for determining the O-DU window for the timing domain are shown in Table 4.4.4.2-2 and Table 4.4.4.2-3.

**Table** **4.4.4.2-2: Transport network parameters for a timing domain**

|  |  |  |
| --- | --- | --- |
|  | **Downlink** | **Uplink** |
| Minimum | T12\_min = MIN{i,j} (T12\_minij) | T34\_min = MIN{i,j} (T34\_minij) |
| Maximum | T12\_max = MAX{i,j} (T12\_minij) + PDVmax | T34\_max = MAX{i,j} (T34\_minij) + PDVmax |

**Table 4.4.4.2-3: O-RU delay parameters for a timing domain**

|  |  |  |  |
| --- | --- | --- | --- |
|  |  | **U-Plane** | **C-Plane** |
| Downlink | Minimum | T2a\_min\_up = MAX{j} (T2a\_min\_upj) | T2a\_min\_cp\_dl = MAX{j} (T2a\_min\_cp\_dlj) |
| Maximum | T2a\_max\_up = MIN{j} (T2a\_max\_upj) | T2a\_max\_cp\_dl = MIN{j} (T2a\_max\_cp\_dlj) |
| Uplink | Minimum | Ta3\_min = MIN{j} (Ta3\_minj) | T2a\_min\_cp\_ul = MAX{j} (T2a\_min\_cp\_ulj)  Ta3\_min\_2g = MAX{j} (Ta3\_min\_2gj) (NOTE 1) |
| Maximum | Ta3\_max = MAX{j} (Ta3\_maxj) | T2a\_max\_cp\_ul = MIN{j} (T2a\_max\_cp\_ulj)  Ta3\_max\_2g = MIN{j} (Ta3\_max\_2gj) (NOTE 1) |
| NOTE 1: Uplink C-Plane parameters T2a\_min\_cp\_ul and T2a\_max\_cp\_ul are applicable for C-Plane data flow 2a and 2d (see clause 4.3); parameters Ta3\_min\_2g and Ta3\_max\_2g are applicable for C-Plane data flow 2g (RRM Measurements, see clauses 4.3 and 12.6.1.6).  NOTE 2: C-Plane data flows 2c, 2d, 2e and 2f have separate timing parameters not included in this table. | | | |

The tables defined above are used to derive the corresponding delay parameters to be used in the timing relationships defined in Table 4.4.3-2 and Table 4.4.3-3 to support the computed methods defined below.

With computed delay approach, there are two situations that are considered:

* **Defined Transport Method**: the network delay is pre-defined (usually by the network operator) and the delays are computed based on that definition. The definition generally considers the maximum network latency, with an assumption that a smaller delay can more easily be accommodated.
* **Measured Transport method**: the network delay is estimated based on actual measurements of packet latency on the downlink and uplink (sometimes a symmetric delay is assumed but this is not necessary).

Regardless of whether the Defined Transport Method or Measured Transport Method is used, the calculations are mainly the same. The next two clauses describe in more detail these two methods.

###### Defined Transport method

With the Defined Transport method, the O-DU transmit and receive windows are determined based on pre-defined transport network characteristics, and the delay characteristics of the O-RUs within the timing domain. For this approach to work, the O-DU shall obtain the O-RU delay characteristics as defined in Table 4.4.4.2-3 for each O-RU in the timing domain. The O-DU can adapt its transmit and receive windows to accommodate the O-RU delay characteristics if O-DU has that capability. The adaptation of the O-DU transmission and reception windows can be limited based on the O-DU design. Table 4.4.4.3-1 details the O-DU and O-RU delay profile parameters.

**Table 4.4.4.3-1: DL and UL delay profiles**

|  |  |  |
| --- | --- | --- |
|  | **O-RU delay profile** | **O-DU delay profile** |
| Downlink | T2a\_min\_up, T2a\_max\_up, T2a\_min\_cp\_dl, T2a\_max\_cp\_dl, Tcp\_adv\_dl | T1a\_max\_upO-DU, TXmaxO-DU |
| Uplink | Ta3\_min, Ta3\_max, T2a\_min\_cp\_ul, T2a\_max\_cp\_ul, Ta3\_min\_2g,  Ta3\_max\_2g | Ta4\_maxO-DU, RXmaxO-DU |
| NOTE: The parameters Ta3\_min\_2g and Ta3\_max\_2g are applicable for uplink C-Plane data flow 2g (RRM Measurements, see clauses 4.3 and 12.6.1.6). The data flow 2g is optional for O-  RU, and the related parameters shall be part of a delay profile if and only if the O-RU supports the data flow 2g with the delay profile. | | |

Details on how O-RU parameters are obtained by the O-DU are specified in the fronthaul M-Plane specification [7]. Optionally, an O-RU can adapt its delay profile information, especially for uplink, based on O-DU delay profile and transport delay (T12\_min, T34\_min). If this option is supported by the O-RU, then the O-DU shall provide its delay profile as well as the T12\_min to the O-RU. The exchange of this information is specified in the fronthaul M-Plane specification [7]. With this option, the O-RU receives the O-DU delay profile before sending its delay profile to the O- DU. The O-DU is unaware that the O-RU delay profile information has been modified. It simply uses the delay profile provided by the O-RU as it would without this option.

Delay characteristics for an O-RU can vary based on air interface properties. Air interface properties which may be used as the basis for supporting different delay characteristics are limited to:

* Channel Bandwidth
* SCS

A set of delay characteristics which applies to a combination of the above properties is referred to as a delay profile. For each supported combination of the above properties, the O-RU shall identify a delay profile. Multiple combinations of the above properties can utilize the same O-RU delay profile. These delay profiles are O-RU specific and are not within the scope of the present document.

If the O-RU supports the feature BF-DELAY-PROFILE, each O-RU endpoint can support multiple delay profiles based on beamforming methods.

When the O-RU supports multiple beamforming methods which have different delay parameters, there may exist additional sets of delay profile. Among the multiple sets of delay profile, the O-DU may configure one of the reported delay profile with beamforming method(s) applicable for each endpoint (refer to M-Plane Specification [7] for details).

When calculating the O-DU transmit and receive window for a timing domain, the O-DU shall use the delay profile applicable for each O-RU based on the air interface properties including beamforming method (if

BF-DELAY-PROFILE is supported), used by the O-RU in the specific network configuration. If any of the O-DU constraints in Table 4.4.4.1-2 is violated, it cannot be assured for the O-DU to adjust transmit and reception windows to meet the required transmit or receive windows.

The O-RU and O-DU can have multiple delay profiles depending on the design as shown in Table 4.4.4.2-3. Using the delay parameters specified for the corresponding profile for each O-RU in the timing domain, the uplink and downlink O-RU parameters to use for the timing domain can be determined as specified in clause 4.4.4.2. The transport delay parameters are constant for this method and specified as part of the network. The delay relationships defined in Table 4.4.3-2 and Table 4.4.3-3 can then be applied to determine the O-DU transmit and receive delay parameters. Finally, the O-DU uplink and downlink constraints as defined in Table 4.4.4.1-2 will need to be ensured, by appropriate fronthaul transport network delay dimensioning and selection of O-RU and O-DU equipment, for the calculated windows to be supported.

###### Measured Transport method

With the Measured Transport method, the O-DU transmit and receive windows are determined based on the delay characteristics of the O-RUs as defined in clause 4.4.4.3, and measured transport delays between all O-DU ports and O- RU ports in the timing domain. The O-DU shall measure the transport delay(s) for all O-RU/O-DU Physical Fronthaul Network Interface port pairs in the timing domain and adapt its transmit and receive windows to accommodate the measured transport delay characteristics.

If the measured transport method is to be used, the O-DU shall use the One-Way Delay Measurement messages as defined in the eCPRI specification [2], clause 3.2.4.6. The message format is shown in Table 4.4.4.4-1. Some of the benefits of using the eCPRI approach are:

* Measurement consistency between the C-Plane and U-Plane is achieved by using a single processing element (see clause 3.1 for the definition of a processing element) and associated C/U-Plane endpoint address for the measurement.
* eCPRI One-Way Delay Measurement allows for varying packet sizes to better simulate real traffic.
* eCPRI approach allows for separate T12 and T34 measurements.

NOTE 1: For this delay measurement, the use of eCPRI One-Way Delay protocol is specified because no other specified transport mechanism supports one-way delay measurements - this is true even if RoE is used as the C-Plane and U-Plane transport mechanism.

**Table 4.4.4.4-1: eCPRI One-Way Delay Measurement message**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **One-Way Delay Measurement (Type 5)** | | | | | | | | | |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **# of bytes** |  |
| ecpriVersion | | | | ecpriReserved | | | ecpriConcat enation | 1 | Octet 1 |
| ecpriMessage = 5 | | | | | | | | 1 | Octet 2 |
| ecpriPayload | | | | | | | | 2 | Octet 3 |
| Measurement ID | | | | | | | | 1 | Octet 5 |
| Action Type | | | | | | | | 1 | Octet 6 |
| TimeStamp (seconds) | | | | | | | | 6 | Octet 7 |
| TimeStamp (nanoseconds) | | | | | | | | 4 | Octet 13 |
| Compensation value (nanoseconds) | | | | | | | | 8 | Octet 17 |
| Dummy bytes | | | | | | | | L | Octet 25 |

The O-DU is the initiator for measuring T12 and optionally T34 according to Figure 4.4.4.4-1 (T12) and Figure 4.4.4.4-2 (T34).

eCPRI Specification [2] defines two methods for measuring the One-Way-Delay, a 1-Step and a 2-Step method. With the 1-Step method the sender of the Request message includes the values of t1 and tCV1 in the request. With the 2-Step

method these values are included in a Follow-Up message. Detailed information of this procedure is specified in [2], clause 3.2.4.6.

Usage of either 1-Step or 2-Step method for the T34 measurement is controlled by M-Plane O-RU capability parameters **one-step-t34-supported** and **two-step-t34-supported**. When the O-RU supports Measured Transport Method (eCPRI message 5) the O-RU shall support at least one of the methods for measurement of T34. When the two parameters are reported by the O-RU in the capability report, the O-RU shall support both 1-Step and 2-Step method of the T12 measurement. If the O-DU will initiate a T34 measurement, the O-DU shall support both 1-Step and 2-Step method of the T34 measurement. When the two parameters are not reported by the O-RU in the capability report, but measured transport method is supported by the O-RU, the O-DU may probe the O-RU capabilities by using either 1-Step or 2- Step method when performing a T12 or T34 measurement.

O-DU

(Initiator)

Measurement of **T12**

with and without Follow-UP

O-RU

###### t1

![](../assets/images/dd7654d080a7.png)![](../assets/images/09815b8be935.png)![](../assets/images/038bace8ad23.png)![](../assets/images/c400dc1f4f69.png)![](../assets/images/720f1228a622.png)

tCV1

tCV2

1-Step method

t2

tD = (t2 - tCV2) - (t1 + tCV1)

tD = (t2 - tCV2) - (t1 + tCV1)

t1

tCV1

tCV2

2-Step method

t2

tD = (t2 - tCV2) - (t1 + tCV1)

tD = (t2 - tCV2) - (t1 + tCV1)

**Figure 4.4.4.4-1: eCPRI One-Way Delay T12 Measurement procedure**

O-DU

(Initiator)

Measurement of **T34**

with and without Follow-UP

O-RU

###### t1

![](../assets/images/b014535d065c.png)![](../assets/images/05013cfc23c6.png)![](../assets/images/3affc6a2aa27.png)![](../assets/images/082c3b526084.png)![](../assets/images/42593186cb0f.png)![](../assets/images/b673c707ebf5.png)![](../assets/images/029ba6486098.png)![](../assets/images/f3d39c379865.png)

1-Step method

tCV1

tCV2

t2

tD = (t2 - tCV2) - (t1 + tCV1)

tD = (t2 - tCV2) - (t1 + tCV1)

t1

2-Step method

tCV1

tCV2 t2

###### tD = (t2 - tCV2) - (t1 + tCV1)

tD = (t2 - tCV2) - (t1 + tCV1)

**Figure 4.4.4.4-2: eCPRI One-Way Delay T34 Measurement procedure**

When measuring the one-way delay, the goal is to determine the minimum transport delay. Since any individual packet can experience different delays through the network due to PDV, it is necessary to perform multiple measurements.

Since the desired value is the minimum (T12\_min or T34\_min), the O-DU should use the minimum delay measurement among the various measurements to estimate the minimum transport delay. The O-DU may use the estimated T12\_min value as the T34\_min value.

NOTE 2: There is no theoretical upper bound for transport delay. The maximum values are determined based on the measured minimum values plus a maximum allowed transport variation (PDVmax) defined as part of the SLA for the transport network.

The O-DU shall measure the delay corresponding to each O-DU and O-RU port pair within the timing domain. The O- DU shall then use the per port pair minimum delay as per Table 4.4.4.2-1 to provide the transport parameters to be used in the delay relationships specified in Table 4.4.3-2 and Table 4.4.3-3. The resulting delay configuration will meet the

O-DU constraints defined in Table 4.4.4.1-2 provided that appropriate fronthaul transport network delay dimensioning and selection of O-RU and O-DU equipment are made.

Since the transport delay is necessary to establish correct timing, when using the measured transport method, the O-DU shall perform this measurement initially before sending of C/U-Plane traffic. The measurement should be performed with packets using the same L2 CoS Priority or L3 DSCP Code as the U-Plane data uses, to ensure the measurement accurately reflects the U-Plane transport latency. The O-DU may also do this periodically to verify delay if desired.

Also, if an error is detected by traffic counts used for error detection defined in clause 4.4, it can be necessary to re- measure the delay and update the O-DU or O-RU timing based on the new measurements.

#### Latency categories for O-DU with dynamic timing advance

As an aide to selection of equipment for use in specific transport network use cases, O-DU and O-RU are categorized based on delay capabilities. Equipment is categorized with a Category [AAAA-ZZ] and Sub-category [.00-.1000]. The category can be used to determine the maximum T12max and T34max which the equipment can support. Categories are determined as follows:

* **T1a\_maxO-DU** >= (T12max + T2a\_min\_up)
* **Ta4\_maxO-DU** >= (T34max + Ta3\_max\_up)

By definition **T1a\_max\_upO-DU** is the earliest that the O-DU can begin transmission. This results in that the earliest that the O-DU can be guaranteed to complete transmission is **T1a\_max\_upO-DU** ? **TXmaxO-DU.** The result is that:

* (**T1a\_max\_upO-DU** ? **TXmaxO-DU** ? T2a\_min\_up) >= T12max

Similarly, for uplink **Ta4\_max\_upO-DU** is the latest that the O-DU may receive any packet from the O-RU. Therefore:

* (**Ta4\_max\_upO-DU** ? Ta3\_max\_up) >= T34max Both of these are illustrated in the **Figure 4.4.5-1**below:

![](../assets/images/421c152d19e9.png)

O-DU

O-DU

O-DU

O-DU

**Figure 4.4.5-1: Uplink and downlink timing parameter relationship**

Using these inequalities, O-DU and O-RU can be assigned categories based on the constraints shown in Table 4.4.5-1:

**Table 4.4.5-1: Maximum transport latency constraints**

|  |  |  |  |  |
| --- | --- | --- | --- | --- |
| **Parameters** | **Constraint** | | | |
| **Description** | **O-DU** | **O-RU Processing** | **Transport** |
| Downlink | Max Transport | T1a\_max\_upO-DU- TXmaxO-DU | T2a\_min\_up | **T12\_max** = T1a\_max\_upO-DU  ?TXmaxO-DU ?T2a\_min\_up |
| Uplink | Max Transport | Ta4\_max\_upO-DU | Ta3\_max\_up | **T34\_max** = Ta4\_max\_upO-DU - Ta3\_max\_up |

The maximum range that can be supported is based on the minimum value of T12\_max and T34\_max from above. This requires separate categorization for UL and DL for each O-DU and O-RU. Therefore, an uplink category pair (AX) and downlink category pair (BY) should be evaluated for each pairing of O-DU and O-RU. The minimum distance (T12\_max, T34\_max) represented by the corresponding pairs (AX, BY) then identifies the maximum transport latency which can be supported by the pair.

Each endpoint has a specific value for the characteristics defined in Table 4.4.5-1. In order to categorize endpoints, the endpoints are grouped based on the range in which the maximum transport characteristic falls. The category identification then means that the maximum transport characteristic for the endpoint falls somewhere between the maximum and minimum values for the category.

Since the category identifies that the maximum latency supported for the endpoint falls somewhere within the category range, the resulting category pair (AX) defines a range of T12\_max and T34\_max for the combination. The combination can be used to identify a maximum T12\_max and T34\_max, and minimum T12\_max and T34\_max that the combination can support. The category pair identifies a best and worst case for the maximum range the combination can support. The actual maximum range supported by a specific O-DU and O-RU pair with a given category combination will fall somewhere within the range. That is, for a given O-DU with category A and O-RU with category X, the T12\_max and T34\_max supported by the pair is defined as:

* Latency\_minAX <= (T12\_max = T34\_max) <= Latency\_maxAX

Additionally, the paired combination can be mapped to supported use cases. Annex B.2 contains the category definitions, Latency\_min, Latency\_max, and use case tables.

The categories are only useful for identifying the maximum possible range (T12\_max, T34\_max) values. To be able to usefully identify equipment for a given use-case, it is also necessary to be able to identify T12\_min and T34\_min values. This can be defined in terms of variation, where variation indicates how much lower T12\_min and T34\_min can be relative to T12\_max and T34\_max respectively. That is:

* DL Variation = T12\_max - T12\_min
* UL Variation = T34\_max - T34\_min

An additional level of categorization is required to address the transport delay variation (e.g. T12max - T12min) that a given equipment type pair can support. This is addressed using sub-categories. The total variation that can be supported is a combination of the receive window at the receiver, and the transmit variation. However, the receive window will likely be much larger than the transmit variation. Each endpoint is assigned to both an uplink and downlink category.

The O-DU DL sub-category is based on transmit variation, while the O-DU UL sub-category is based on receive window. For UL, the roles are reversed, and the O-RU DL sub-category is based on receive window, and the UL sub- category is based on transmit variation.

As a result, sub-categories are defined based on the role for the endpoint in the given transmission direction (UL, DL). Downlink variation (Tvariation\_DL) is defined in Figure 4.4.5-2 as follows:

Tvariation\_DL <= (T2a\_max\_up - T2a\_min\_up - TXmaxO-DU)

![](../assets/images/b9636c298cbc.png)

O-DU

O-DU

O-DU

**Figure 4.4.5-2: Downlink transport variation**

Uplink variation (Tvariation\_UL) is defined in Figure 4.4.5-3 as follows:

Tvariation\_UL <= (RXmaxO-DU - (Ta3\_max - Ta3\_min))

![](../assets/images/7cc54e534176.png)

O-DU

**Figure 4.4.5-3: Uplink transport variation**

Using the respective constraints, the variability can be defined based on O-DU and O-RU delay characteristics as shown in Table 4.4.5-2:

**Table 4.4.5-2: Maximum transport latency variation constraints**

|  |  |  |  |  |
| --- | --- | --- | --- | --- |
| **Parameters** | **Constraint** | | | |
| **Description** | **O-DU** | **O-RU Processing** | **Transport** |
| Downlink | Max Variation | TxmaxO-DU | T2a\_max\_up - T2a\_min\_up | **T12\_max** - **T12\_min** = (T2a\_max\_up - T2a\_min\_up) -  TxmaxO-DU |
| Uplink | Max Variation | RXmaxO-DU | Ta3\_max | **T34\_max - T34\_min** = RxmaxO-DU - (Ta3\_max\_up - Ta3\_min\_up) |

Sub-categories for each direction are defined using the endpoint characteristics. Similar to categories, sub-categories indicate that the endpoint has a variation characteristic that falls somewhere in the specified sub-category range. Since transmit variability and receive windows are expected to have different ranges, separate tables are created. However, since sub-categories are numeric [.####], to simplify these values are assigned in a similar way. The #### value represents the time in 10's of us for the given endpoint property.

For example, if an O-RU with a category X has a T2a\_min - T2a\_max = 163 us, the sub-category for the O-RU is [.16]. Making the full category for the O-RU X.16 (the "." is not a decimal point but a delimiter only). By using this approach, the receiver sub-category and transmitter sub-category can be directly used to determine the dynamic range in either direction:

* TX sub-category: .06
* RX sub-category: .16

Resulting Tvariability = 16 ? 10 - 6 ? 10 = 100 us. This provides a lower bound on the maximum dynamic range supported in one direction. The minimum of the UL and DL Tvariability can be used to determine the maximum dynamic range for the combination (e.g. maximum difference between T12\_max and T12\_min that can be supported).

Annex B.3 contains the sub-category definitions and resulting combination dynamic range use case tables.

With dynamic timing advance, since the O-DU can set its earliest transmission time based on the measured T12\_max, the full range of variability is available regardless of the T12\_max. For example, if an O-DU/ O-RU combination has 100 usec worth of variability, and a maximum range T12\_max of 250 usec, the combination can support the measured T12\_max (<= 250 usec) and T12\_min of T12\_max - 100 usec. So, if the measured T12\_max is 200 usec, the combination can support T12\_max of 200 usec and T12\_min of 100 usec.

#### Latency categories for O-DU with fixed timing advance

The same category concepts apply for O-DU which support fixed transmit and receive windows. The earliest transmit window and latest receive window timing defines the maximum range that the O-DU can support. T1a\_max\_upO-DU for the O-DU is equal to the T1a\_max\_up of the earliest fixed transmit window. Similarly, Ta4\_maxO-DU is equal to the Ta4\_max of the latest receive window. The O-DU category is then assigned based on this value.

Fixed transmit and receive windows do however impact variability. The fixed transmit time results in sending packets earlier than absolutely needed to achieve the actual T12\_max (i.e. the T12\_max value that is either measured or configured by the service provider). Figure 4.4.6-1 illustrates this concept:

![](../assets/images/562d8e6135f1.png)

O-DU

O-DU

O-DU

**Figure 4.4.6-1: Fixed transmit time illustration**

Since the TXDL\_Start is earlier than required for T12\_max by T1a\_offset, the latest packets arrive at least T1a\_offset before T2a\_min\_up. This results in T1a\_offset worth of O-RU receive buffer being always used, implying that the O- RU needs additional buffer to compensate T1a\_offset. Since the TXDL\_Start is fixed, the T12min is also fixed at:

T12min = TXDL\_Start - (T2a\_max\_up - TXmaxO-DU)

Since T12min is unaffected, the resulting Tvariation is reduced by T1a\_offset. To support T12min, O-RU need to provide T1a\_offset + T12max - T12min + TXmax\_O\_DU

When T12\_max + T2a\_min\_up = T1a\_max\_upO-DU (e.g. at maximum range), then T1a\_offset = 0. But as the actual T12\_max decreases, the amount of receive buffer consumed by T1a\_offset increases by the corresponding amount.

The same applies for UL. The result is that the T34\_min is defined relative to the T34\_max for the combination, not relative to the measured T34\_max.

#### Non Delay-managed U-Plane traffic

While most U-Plane data shall meet the delay constraints described above, there can be certain types of U-Plane traffic for which the reception windows may not be applicable. Not applying the transmission and reception window constraints to such data allows the transmission of the data over the fronthaul interface to be spread to reduce the peak bandwidth required by the interface.

Figure 4.4.7-1 uses SRS to illustrate an example non delay-managed U-Plane traffic.

![](../assets/images/7fb568c6df84.png)

1 SRS symbol from 64 TRX is transmitted to O-DU over 4 symbol duration as non delay-managed data. 16TRX each symbol duration.

1 SRS symbol from 64 TRX as received on air interface

**Figure 4.4.7-1: SRS as non delay-managed U-Plane traffic**

In the example, a large amount of SRS data is received during a special slot on the air interface. By allowing the SRS data to be transmitted from the O-RU to the O-DU outside of the normal transmit window, and instead allowing it to use otherwise un-used fronthaul interface bandwidth, the required peak fronthaul bandwidth requirement can be reduced.

Non delay-managed U-Plane traffic flows shall be uniquely identified from delay managed U-Plane traffic flows. The identification of U-Plane traffic flows using eAxC identifiers is described in clause 5.4, and the eAxC shall be used to

indicate delay-managed versus non delay-managed traffic (e.g. some eAxC or Pcid-identified packets may be used to carry delay-managed U-Plane traffic while other eAxC or Pcid-identified packets may be used to carry non delay- managed U-Plane traffic). Non delay-managed U-Plane traffic flows shall not use the same eAxC identifiers as delay managed U-Plane traffic flows. Different RU\_Port\_IDs shall be allocated within the eAxC\_ID for non delay-managed U-Plane flows from those used for delay managed U-Plane traffic flows in the same direction (UL, DL). RU\_Port\_IDs used in UL for non delay-managed traffic need not be the same as those used in the DL.

The sender may send non delay-managed traffic without regard to the transmission window for the corresponding air interface symbol. Similarly, the receiver need not discard received non delay-managed traffic received outside the normal reception window for the corresponding air interface symbol. However, the air interface symbol time shall still be contained within the U-Plane packets header for reference.

NOTE: The status of traffic flows being delay-managed versus non delay-managed (which is managed within the application) is independent of any transport prioritization that may be configured.

## Reception window monitoring

The reception window can be used for the purpose of error detection. The reception windows at O-RU and O-DU absorb delay variation in the fronthaul. Although its maximum size may vary depending on implementation, the position of windows at O-DU may be adjustable via parametrization as described in clause 4.3.

Data flow error detection during fronthaul operation may be monitored and reported via counters based on receipt of packets relative to the reception window. The receiving node monitors the actual reception timing and generates counters regarding the status and whether packets were successfully received in proper timing.

The following reception window performance counters shall be supported:

* Data was received on time (within reception window) - no action needed
* Data was received too early - link latency re-measurement may be needed
* Data was received too late - link latency re-measurement may be needed

The above counters and other performance monitoring counters may be implemented as defined in clause 9.1. Based on those counts the system may adjust its operation. The specific reaction will be implementation-specific and depend on such considerations as the number of instances needed before justifying sending an alarm, the ability of the system to measure link latencies, or other design-dependent judgments. Additional details regarding the counts, alarms, and fault handling are outside of the scope of the present document.

Dynamic adaptation of windows at Tx side to handle larger delay values may be employed. For instance, fronthaul distance may be extended by handling a portion (or most) of the fixed delay component at Tx buffer side by adapting the transmission timing based on information provided by RX side. In other words, rather than accommodating a latency range of zero to "max", it is possible to instead accommodate a longer latency of "offset" to "max+offset" (longer latency but same range). This is described in detail in clause 4.4.

## Transmission windows

#### Normal transmission

O-RU and O-DU send C-Plane and U-Plane messages at unspecified time within appropriate transmission window (see clause 4.4.2 for general description of transmission windows). This default O-RU transmission behaviour in uplink may be altered by configuration over M-Plane or with Section Extension 18 in C-Plane message as described in clauses 4.6.2, 4.6.3 and 4.6.4.

#### Uniformly distributed transmission

If O-RU supports uniformly distributed transmission feature, then O-RU may be configured (over M-Plane or with Section Extension 18 in C-Plane message) to uniformly distributed transmission of UL U-Plane messages over the transmission window (**uniformly-distributed-transmission-supported** in M-Plane).

The definition of "uniformly distributed" shall be that the total number of packets should as evenly as possible be spread out in time over the transmission window when they are sent on the interface.

The transmission window shall be divided into N sub-windows where N is the total number of packets to be transmitted during the transmission window. The N packets shall be sent one packet per sub-window. The transmission shall start at a random time within the sub-window.

The above description of when packets are sent can be disturbed by other traffic being transmitted by the O-RU. If that is the case the main object with 'uniform distribution' is that the traffic load shall be evenly distributed in time as much as possible.

In many cases transmission windows will be overlapping between different user data flows (different eAxCs or different section IDs etc.) When this is the case the same "rule" as described above is still valid, that is within the specific sub-window, the data packet should be sent at a random time. If several packets (due to different flows) are to be sent within the same sub-window, each packet shall be sent at a random time. If the transmission time for the different packets collide then the packets are buffered in any order and sent when link capacity is available.

#### Ordered transmission

If O-RU supports ordered transmission, the O-RU may be configured (over M-Plane) to ordered transmission of UL U- Plane messages within transmission window (**ordered-transmission-supported** in M-Plane). If O-RU is configured to order transmission of a set of eAxC then O-RU reports how eAxC are grouped into ordering groups (G) and relative order of eAxCs within each group (R) (**transmission-order and transmission-order-group** in M-Plane).

Assuming

A and B be eAxCs configured to order transmission,

GA and GB be ordering groups of eAxC A and B respectively,

RA and RB be relative ordering values of eAxC A and B respectively.

MA and MB be messages of eAxC A and B respectively that carry data related to the same symbol (the symbol is identified by the same frame number and the same symbol number within the frame and the same duration as derived from SCS) and transmitted in transmission windows WA and WB respectively.

If A and B belong to the same ordering group (GA = GB), and relative order of A is less than relative order of B (RA < RB), and start of transmission window WA is same as start of transmission window WB, and end of transmission window WA is same as end of transmission window WB, then O-RU transmits message MA before message MB. Otherwise, O- RU transmits message MA and MB in unspecified order. Therefore, order of U-Plane messages of eAxCs of different ordering groups and eAxCs of the same relative order (within a group) is unspecified. Messages transmitted in different transmission windows are ordered only as required to transmit them within transmission windows.

#### Scheduled transmission

If O-RU supports scheduled transmission, the O-RU may be configured (over M-Plane or with Section Extension 18 in C-Plane message) to shift (delay) and/or resize UL U-Plane messages transmission window.

O-RU may be commanded to shift the transmission window by given offset (delay) expressed as number of symbols. Depending on the O-RU capability the eAxC specific window offset (O) and window size (S) may be provided over:

1. M-Plane (**transmission-window-offset** and **transmission-window-size** in M-Plane) or
2. C-Plane (in Section Extension 18).

The window offset (O) and size (S) are specific to each eAxC and depending on O-RU the offset and size may be:

1. specific to all REs in a symbol within eAxC

This is applicable to O and S values provided over M-Plane and C-Plane.

1. specific to REs selected by section descriptions in a symbol within an eAxC.

This is applicable only to O and S provided in C-Plane. In this case, the same values of O and S shall be used for every Section Extension 18 description referring to REs in the same PRB using different values of reMask.

A C-Plane message can address multiple eAxCs if Section Extension 7 is used or mapping between of an eAxC\_ID to multiple eAxCs is configured with M-Plane.

The time at which the O-RU UL U-Plane message is transmitted depends on whether the eAxC is configured for delay managed or non delay-managed traffic:

* + If eAxC is configured for delay managed traffic and is also configured (via C-Plane or M-Plane) to apply transmission window offset (O) and window size (S), then the O-RU shall transmit the UL U-Plane message with data specific to REs in symbol N (N is the number of the symbol within a frame), in a window that starts at the same time as UL U-Plane normal transmission window corresponding to symbol N+O and has a duration as configured by window size setting. O-RU reports per endpoint max number of symbols and max number of PRBs that can be buffered (**max-buffered-prbs** and **max-buffered-symbols** in M-Plane). The O- DU shall not request from the O-RU UL a reception and transmission window configuration that exceeds O- RU buffering capacity. For calculation of buffering load, O-DU shall assume that the O-RU allocates its buffer at the time reference for Ta3\_min (typically start of symbol) and the buffer is released at the end of transmission window.
  + If eAxC is configured for non delay-managed traffic and is also configured (via C-Plane or M-Plane) to apply transmission window offset (O) and window size (S), then the O-RU shall transmit the UL U-Plane message with data specific REs in to symbol N (N is the number of the symbol within a frame) in a window that starts after of UL U-Plane normal transmission window corresponding to symbol N+O. In this case only the start of transmission window is defined - the end of the transmission window is unspecified. O-RU may report per endpoint max number of symbols and max number of PRBs that can be buffered (**max-buffered-prbs** and **max-buffered-symbols** in M-Plane). O-DU can request from O-RU UL reception and transmission window configuration that exceeds O-RU buffering capacity and O-RU shall handle it on best effort basis. For calculation of buffering load, O-DU shall assume that O-RU allocates buffer at the time reference for Ta3\_min (typically start of symbol) and the buffer is not released before the start of transmission window. U-Plane message transmission of eAxC configured for non delay-managed traffic shall be handled by O-RU on best effort basis and transmission is not guaranteed.

If O-RU does not report, over M-Plane, support for independent U-Plane transmission window control (feature INDEPENDENT-TRANSMISSION-WINDOW-CONTROL in M-Plane), then all endpoints with transmission window control enabled, handling the same carrier type and SCS, shall be configured (via M-Plane or C-Plane) with parameter values resulting in transmission windows that coincide between the endpoints. That is, for every symbol N, the effective transmission window for symbol N shall start at the same time and end at the same time for all the endpoints handling same carrier type and SCS. This restriction applies only to endpoints that have transmission control enabled over M- Plane.

## O-RU external antenna delay handling

#### Introduction

The latency model of clause 4.4 assumes that the antenna delay is negligible compared to the O-RU's internal delay or is known by the O-RU. Figure 4.4.1-1 defines the T2a and Ta3 values as the total processing time between Fronthaul interface input/output ports (R2 and R3) and the antenna interface point (Ra).

Figure 4.7-1 defines the reference points for delay management where the O-RU external antenna delay parameters are defined. T2a and Ta3 will have a new definition when external antenna delays are introduced. T2a is the O-RU internal delay between R2 and Rd and Ta3 is the O-RU internal delay between Ru and R3.

Ra

![](../assets/images/cb2e3783453a.png)![](../assets/images/2fd712980017.png)![](../assets/images/2fd712980017.png)![](../assets/images/c8fa3c9f678d.png)![](../assets/images/c8fa3c9f678d.png)![](../assets/images/5b4f03a59971.png)![](../assets/images/09e9f204549d.png)![](../assets/images/b4e37d830497.png)![](../assets/images/632384ff97c9.png)![](../assets/images/5c436b94ae82.png)![](../assets/images/2d2e1179f4e8.png)

*T1a (=T12 + T2a + Tda)*

*Tda*

R1

*T12*

R2

Rd

**O-DU**

R4

R3

*T2a*

**O-RU**

*Ta3*

Ru

*Tau*

*T34*

*Ta4 (=Tau + Ta3 + T34)*

**Figure 4.7-1: Definition of reference points including external antenna delay Table 4.7.1-1: eCPRI O-RU additional delay latency parameters**

|  |  |  |  |  |
| --- | --- | --- | --- | --- |
|  | Parameter | Latency | Minimum | Maximum |
| **Downlink** | Tda | Timing difference between the output of DL signal at the antenna connector (Rd) of O-RU and the transmission over the air (Ra). | - | - |
| **Uplink** | Tau | Timing difference between the reception over the air (Ra) and the input of UL signal at the antenna connector (Ru) of O-RU. | - | - |

NOTE: The latency model of clause 4.4 does not allow to adjust timing to compensate transmission delays between antenna ports of the O-RU and the external antenna. To handle external delays between O-RU and antenna reference point, a method is specified in clause 4.7.2 which has minimal impact on the O-DU implementation

#### Minimal O-DU impact method (defined transport method)

###### Description

When using Defined Transport Method as described in clause 4.4.4.3 and non-negligible external delays between the O- RU and antenna are present, this method will have a minimal impact on the O-DU implementation. O-DU shall configure the O-RU with Tda and Tau via the M-Plane [7]. Instead of taking Tda and Tau under consideration when calculating the transmission and reception windows on the O-DU, the external delay is taken from the fronthaul delay (T12, T34) timing budget.

When using this method, the values configured to O-RU for **t12-max** and **t34-max** shall maintain the same value as if there is no external delay, i.e. Tau = Tda = 0 (zero). It will be the responsibility of the operator to ensure that the actual fronthaul latency between R1 and R2, respectively R3 and R4, shall not exceed (**t12-max** - Tda) and (**t34-max** - Tau).

This method will keep the transmission and reception windows on the O-DU at the same positions in time with or without the external delays. The O-RU shall transmit the downlink signal at reference point Rd at (tDL=0 - Tda). The O- RU shall start the processing of the uplink signal received at the reference point Ru at (tUL=0 + Tau).

For downlink C-Plane and U-Plane, the O-RU shall shift its reception windows Tda earlier in time. For uplink C-Plane the reception window shall not be shifted. The transmission window for uplink U-Plane data will be shifted by Tau on the O-RU but since the external delay is taken from the fronthaul latency budget the uplink U-Plane messages arrive within the reception window on the O-DU. The sizes for reception and transmission windows remain unchanged on the O-DU and on the O-RU.

NOTE: In comparison with latency model of clause 4.4, this method can lead to changes in the O-DU's implementation of its O-RU M-Plane configuration flows.

###### Minimal O-DU impact method - Example

This clause shows an example of the timing relations for downlink and uplink when using the method described in clause 4.7.2.1.

Table 4.7.2.2-1 contains values for all relevant parameters used in this example.

**Table 4.7.2.2-1: Parameters for example**

|  |  |  |
| --- | --- | --- |
| Parameter | Latency (Tda = Tau = 0) [us] | Latency (Tda = Tau = 25) [us] |
| **Physical T12\_max, T34\_max**  **(NOTE)** | 100 | 75 |
| **T12\_max, T34\_max** | 100 | |
| **T12\_min, T34\_min** | 0 | |
| **T2a\_min\_up\_dl** | 100 | |
| **T2a\_max\_up\_dl** | 300 | |
| **T1a\_min\_up\_dl** | = T2a\_min\_up\_dl + T12\_max = 100 + 100 = 200 | |
| **T1a\_max\_up\_dl** | = T2a\_max\_up\_dl = 300 | |
| **T2a\_min\_cp\_dl** | 250 | |
| **T2a\_max\_cp\_dl** | 600 | |
| **T1a\_min\_cp\_dl** | = T2a\_min\_cp\_dl + T12\_max = 250 + 100 = 350 | |
| **T1a\_max\_cp\_dl** | = T2a\_max\_cp\_dl = 600 | |
| **T2a\_min\_cp\_ul** | 100 | |
| **T2a\_max\_cp\_ul** | 500 | |
| **T1a\_min\_cp\_ul** | = T2a\_min\_cp\_ul + T12\_max = 100 + 100 = 200 | |
| **T1a\_max\_cp\_ul** | = T2a\_max\_cp\_ul = 500 | |
| **Ta3\_min\_up** | 50 | |
| **Ta3\_max\_up** | 150 | |
| **Ta4\_min\_up** | = Ta3\_min\_up = 50 | |
| **Ta4\_max\_up** | = Ta3\_max\_up + T34\_max = 150 + 100 = 250 | |
| **NOTE: The configured T12\_max and T34\_max values are 100 us. Due to the external delay of 25 us the**  **actual physical T12\_max and T34\_max are decreased by 25 us according to the method description. The physical max fronthaul latency is thus 75 us.** | | |

Below are figures similar to Figure 4.4.3-1 and Figure 4.4.3-2, showing the timing relations both with and without the usage of the "Minimal O-DU Impact"-method. Figure 4.7.2.2-1 and Figure 4.7.2.2-3 assumes zero external delay both for downlink and uplink, the purpose of these two figures are to show that the relationships stated in Table 4.4.3-2 and Table 4.4.3-3:are still valid when applying the method in clause 4.7.2.1, i.e. the transmission and reception windows are unchanged on the O-DU.

The blue lines and arrows of the figures apply to U-Plane messages, and the green lines and arrows apply to C-Plane messages.

**DOWNLINK**

**Without** Minimal O-DU

Impact -Method

tDL=0

T1a\_max\_up\_dl, 300

T1a\_min\_up\_dl, 200

Tx-win UP DL, 100

T12\_max, 100

T2a\_min\_up\_dl, 100

T2a\_max\_up\_dl, 300

Rx-win UP DL, 200

T1a\_max\_cp\_dl, 600

Tx-win CP DL, 250

T1a\_min\_cp\_dl, 350

T12\_max, 100

T2a\_min\_cp\_dl, 250

T2a\_max\_cp\_dl, 600

Rx-win CP DL, 350

#n-2

#n-1

#n

**Figure 4.7.2.2-1: Downlink without using minimal O-DU impact method**

Figure 4.7.2.2-1 shows the timing relations for downlink without any external delays. T12\_max in this example is 100 us, both as configured value and as the actual physical maximum fronthaul latency.

**DOWNLINK**

**With** Minimal O-DU Impact -Method

tDL=0

T1a\_max\_up\_dl, 300

T1a\_min\_up\_dl, 200

Tx-win UP DL, 100

Restricted

T2a\_min\_up\_dl, 100

T12\_max, 75

T2a\_max\_up\_dl, 300

T1a\_max\_cp\_dl, 600

Rx-win UP DL, 200

Actual physical Rx-window

T1a\_min\_cp\_dl, 350

Tx-win CP DL, 250

Restricted

T12\_max, 75 T2a\_min\_cp\_dl, 250

T2a\_max\_cp\_dl, 600

Rx-win CP DL, 350

Tda, 25

Actual physical Rx-window

#n-2

#n-1

#n

**Figure 4.7.2.2-2: Downlink with usage of minimal O-DU impact method**

Figure 4.7.2.2-2 shows the timing relations for downlink when an external delay of 25 us is present and the method described in clause 4.7.2.1 is used. As shown, the transmission windows on the O-DU are the same as the ones in Figure 4.7.2.2-1. The shifting of the reception windows on the O-RU is shown, i.e. these windows start Tda us earlier compared to when not using the method in clause 4.7.2.1, the sizes of the reception windows is the same. The red arrows and text show the actual reception windows on the O-RU when restricting the actual physical fronthaul latency from 100 us to 75 us but still configuring 100 us to the system. As can be seen, there now is a part at the start of the reception windows that should be "un-used". While it is not expected by the O-RU to receive C-Plane or U-Plane messages during these periods the O-RU will process these messages.

**UPLINK**

tUL=0

Rx-win UP UL, 200

**Without** Minimal O-DU Impact -Method

Ta4\_max\_up, 250

Ta4\_min\_up, 50

T34\_max, 100

T1a\_max\_cp\_ul, 500

T1a\_min\_cp\_ul, 200

Tx-win UP UL, 100

Tx-win CP UL, 300

T2a\_min\_cp\_ul, 100

T12\_max, 100

T2a\_max\_cp\_ul, 500

Ta3\_max\_up, 150

Ta3\_min\_up, 50

Rx-win CP UL, 400

#n-2

#n-1

#n

**Figure 4.7.2.2-3: Uplink without using 4.7.2**

Figure 4.7.2.2-3 shows the timing relations for uplink without any external delays. T12\_max and T34\_max in this example are 100 us, both as configured value and as the actual physical maximum fronthaul latency.

![](../assets/images/ab38e3aca452.png)

**UPLINK**

tUL=0

**With** Minimal O-DU Impact -Method

Actual physical

Rx-window

Rx-win UP UL, 200

Ta4\_max\_up, 250

Ta4\_min\_up, 50

T1a\_max\_cp\_ul, 500

Tx-win CP UL, 300

Restricted

T34\_max, 75

T1a\_min\_cp\_ul, 200

Tx-win UP UL, 100

T2a\_min\_cp\_ul, 100

T2a\_max\_cp\_ul, 500

Restricted

T12\_max, 75

Ta3\_max\_up, 150

Ta3\_min\_up, 50

Rx-win CP UL, 400

Actual physical Rx-window

Tau, 25

#n-2

#n-1

#n

**Figure 4.7.2.2-4: Uplink with usage of 4.7.2**

Figure 4.7.2.2-4 shows the timing relations for uplink when an external delay of 25 us is present and the method described in clause 4.7.2.1 is used. As shown, the transmission window on the O-DU are the same as the ones in Figure 4.7.2.2-3. The reception window on the O-RU for C-Plane messages is not shifted for uplink traffic. The size of the reception window is the same. The red arrows and text show the actual reception windows on the O-RU and on the O- DU when restricting the actual physical fronthaul latency from 100 us to 75 us but still configuring 100 us to the system. As can be seen there is a part at the end of the reception window on the O-RU that will be "un-used". While it is not expected by the O-RU to receive C-Plane messages during this period the O-RU will process these messages. On

the O-DU there will be a part at the start of the reception window that will be "un-used". While it is not expected by the O-DU to receive U-Plane messages during this period the O-DU will process these messages. The transmission window on the O-RU for the U-Plane messages are shifted Tau later in time due to the external latency between reference points Ra and Ru.

## UL frame timing to DL frame

#### Overview

UL radio frame has a timing advance offset to DL radio frame with the same frame number at UE antenna port. NTA offset is a default timing offset parameter applied to UE, unless another value is configured in the cell, which is specified in 3GPP TS 36.211 [42] clause 8.1 and 38.211 [4] clause 4.3.1. **n-ta-offset** is a M-Plane parameter used to control the timing offset of UL radio frame with respect to the DL radio frame with the same frame number at O-RU antenna.

Timing relation between UL radio frame and DL radio frame which is configured by **n-ta-offset** is described in Figure 4.8.1-1.

*t****UL=0*** *t****DL=0***

***n-ta-offset \* Tc seconds***

**Downlink radio frame *i* at reference point Ra**

**Uplink radio frame *i* at reference point Ra**

***time***

**Figure 4.8.1-1 : Uplink-Downlink Timing Relation**

Optionally, **t-da-offset** and **t-au-offset** M-Plane parameters control radio timing on each direction at O-RU's antenna connector for external-antenna-delay-handling O-RU and contribute to the timing offset of UL frame to DL frame. Refer to clause 4.7.1 for those parameters. Timing relation configured by **t-da-offset** and **t-au-offset** on top of **n-ta- offset** is described in Figure 4.8.1-2.

*t****UL=0*** *t****DL=0***

***t-da-offset \* Tc seconds***

***n-ta-offset \* Tc seconds***

***t-au-offset \* Tc seconds***

**Uplink radio frame *i* at reference point Ru**

**Downlink radio frame *i* at reference point Rd**

***time***

**Figure 4.8.1-2 : Uplink-Downlink Timing Relation for O-RU handling external antenna delay**

#### Carrier types and default values of n-ta-offset

Default **n-ta-offset** values are described in Table 4.8.2-1 according to carrier type. This value is configurable up to 65535(~33.3 us) in Tc unit where Tc is 1/1.96608 GHz as specified in 3GPP TS 38.211 [4] clause 4.1. The time offset between UL frame and DL frame with the same frame number is calculated as **n-ta-offset**xTc.

**Table 4.8.2-1: Default values of n-ta-offset**

|  |  |  |
| --- | --- | --- |
| **Carrier type and frequency range** | **NTA offset**  **(Unit: Tc) (NOTE 4)** | **Default n-ta-offset**  **(Unit: Tc) (NOTE 5)** |
| LTE FDD (NOTE 1) NB-IoT FDD (NOTE 2)  NR FR1 FDD with LTE-NR and/or NB-IoT-NR coexistence case (NOTE 3) | 0 | 0 |
| LTE TDD (NOTE 1) NB-IoT TDD (NOTE 2)  NR FR1 TDD with LTE-NR and/or NB-IoT-NR coexistence case (NOTE 3) | 39936 | 39936 |
| NR FR1 FDD or TDD band with neither LTE-NR nor NB-IoT-NR coexistence case (NOTE 3) | 25600 | 25600 |
| NR FR2 (NOTE 3) | 13792 | 13792 |
| NOTE 1: See 3GPP TS 36.211 [42] clause 8.1.  NOTE 2: See 3GPP TS 36.211 [42] clause 10.0.1.  NOTE 3: See 3GPP TS 38.133 [37] Release 16 Table 7.1.2-2.  NOTE 4: Timing value specified in 3GPP specification according to radio technology and its use case.  NOTE 5: Default value of M-Plane parameter n-ta-offset to be set by O-DU. | | |

# Transport & Protocol Architecture

## Transport encapsulation types

#### Ethernet encapsulation

Ethernet can be used as transport mechanism for both U-Plane and C-Plane. In this case, messages are transmitted over standard Ethernet frames (see Figure 5.1.1-1). The supported frame format is Ethernet II/DIX frame with type interpretation of the type length field. The Length-interpretation and multiplexing data with LLC (IEEE 802.2 [44] LLC standard) is not supported. A globally administered unicast MAC address is assigned per Ethernet interface. The Ethernet termination feature supports MAC Client Data field sizes of up to 1500 bytes for basic frames, and up to 9000 bytes for jumbo frames.

To ensure QoS is supported, 3-bit Priority Code Point (PCP) field as defined in IEEE 802.1Q [36] shall be supported meaning the capability for VLAN tagging for the traffic shall be supported and M-Plane configurable (but using VLAN tags may be omitted for certain network configurations e.g. LLS-C1). Priority tagged frames (i.e. frames tagged with VLAN ID=0) are always received, as required by standard. Transmitting priority tagged frames is optional.

The MAC address resolution for U-Plane and C-Plane shall be performed via an M-Plane procedure specified in [7] regardless of whether the destined node supports IP or not.

The O-DU and O-RU shall support Intermediate L2 switch MAC address learning to avoid flooding U-Plane and/or C- Plane (not necessary for topology LLS-C1); this is done as a result of test Ethernet frame exchanges during the M-Plane procedure "Ethernet connectivity checking" as specified in [7].

Further, both the transport header and payload are contained within the Ethernet data field. For this encapsulation, either the eCPRI Ethertype or the IEEE 1914.3 [45] Ethertype shall be used.

|  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- |
| Preamble (8 Bytes) | Destination MAC Address  (6 Bytes) | Source MAC Address (6 Bytes) | VLAN Tag  (4 Bytes) | Type/Length (Ethertype) (2 Bytes) | Payload (46...1500 Bytes) | FCS  (4 Bytes) | IFG  (12 Bytes) |

**Figure 5.1.1-1: Native Ethernet frame with VLAN**

#### IP/UDP encapsulation

IP/UDP can be used as transport mechanism for both U-Plane and C-Plane. In this case, IP version 4 shall be supported according to RFC791 (Internet Protocol), and/or IPv6 as per IETF RFC 2460 [46] (both IPv4 and IPv6 are optional, see Table 10.2-1). The encapsulation mechanism is identified by "IPv4" or "IPv6" Ethertype (see Figure 5.1.2-1 and Figure 5.1.2-2). O-RAN equipment shall not send IPv4 packets with any IPv4 header option field or IPv6 packets with

"Next Header" value that is an extension header or "Next Header = 59". If the IPv4 header option field or IPv6 packets with "Next Header" value that is an extension header or "Next Header = 59" is detected in the received packet, the packet shall be silently discarded at the receiving equipment (though the existence of the discarded packet may be logged). For IPv6, if the value in "Next Header" is not an extension header and value is not equal to "59", it indicates that the next item in the header is upper-layer header and the packets shall be processed by the receiver (refer to

IETF RFC 2460 [46]).

IP based applications can be bound to virtual or physical interface addresses. Each configured physical and logical (i.e. VLAN-) interface shall be configured with a separate subnet. As an option, Alias IP addresses (i.e. more than one IP address on the same interface) can be supported as well. If supported, they can be assigned to logical and physical interfaces as well as to virtual interfaces (loopback interfaces).

The C/U-Plane packets shall not use IPv4 or IPv6 fragmentation due to stringent bandwidth and tight latency requirements (such received packets shall be silently discarded). The minimum MTU that is configurable shall be as per the relevant standard, i.e. IETF RFC 791 [47] for IPv4 and IETF RFC 2460 [46] for IPv6.

The resolution of MAC addresses and the flooding traffic reduction through L2 switch mac address learning shall be done via ARP according to IETF RFC 826 [48] only when IPv4 is supported by the transmitting and receiving nodes.

When using IP/UDP encapsulation, the UDP destination port field shall identify the encapsulated protocol. The UDP destination port field shall be set during initialization via M-Plane configuration. When the eCPRI Specification or IEEE 1914.3 [45] define their respective UDP destination ports these will become the default for M-Plane configuration.

On egress, the sending node shall set the checksum for transmitted UDP datagrams as per the relevant standards:

* For IPv4 UDP datagrams the field can be filled with a proper value to mark that the checksum is valid or to 0 to mark that the checksum is not calculated (see IETF RFC 768 [49]).
* For IPv6 UDP datagrams the field shall be filled with a proper value (see IETF RFC 2460 [46]). On ingress, the receiving node may validate UDP checksums if the checksum field contains a proper value.

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Preamble  (8 Bytes) | Destination MAC  Address (6 Bytes) | Source MAC Address (6 Bytes) | VLAN Tag  (4 Bytes) | Type/Length (Ethertype) (2 Bytes) | IPv4  (20 Bytes) | UDP  (8 Bytes) | Payload  (1...1472 Bytes) | FCS  (4 Bytes) | IFG  (12 Bytes) |

**Figure 5.1.2-1: Native IPv4 packet with VLAN**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Preamble  (8 Bytes) | Destination MAC  Address (6 Bytes) | Source MAC Address (6 Bytes) | VLAN Tag  (4 Bytes) | Type/Length (Ethertype) (2 Bytes) | IPv6  (40 Bytes) | UDP  (8 Bytes) | Payload  (1...1452 Bytes) | FCS  (4 Bytes) | IFG  (12 Bytes) |

**Figure 5.1.2-2: Native IPv6 packet with VLAN**

While the numbers in Figure 5.1.1-1, Figure 5.1.2-1 and Figure 5.1.2-2 imply standard Ethernet packets, use of Jumbo frames (up to 9000 bytes in length) is not precluded in the present document.

#### Transport headers

###### Introduction

O-RAN allows for multiple different transport headers within the Ethernet payload to further describe how the application data is to be handled in the C-Plane and U-Plane. In each case the transport header is 8 bytes in length and provides basic data routing capabilities, including description of the data flow type, sending and reception port identifiers, ability to support concatenation of multiple application messages in a single Ethernet packet, and sequence numbering. The following clauses describe the possible transport headers.

###### eCPRI transport header

* + - * 1. Overview

The definition of the eCPRI transport header is shown in Table 5.1.3.2.1-1 below.

**Table 5.1.3.2.1-1: eCPRI transport header field definitions**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **Section Type: any** | | | | | | | | | |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **# of bytes** |  |
| ecpriVersion | | | | ecpriReserved | | | ecpriConcat enation | 1 | Octet 1 |
| ecpriMessage | | | | | | | | 1 | Octet 2 |
| ecpriPayload | | | | | | | | 2 | Octet 3 |
| ecpriRtcid / ecpriPcid | | | | | | | | 2 | Octet 5 |
| ecpriSeqid | | | | | | | | 2 | Octet 7 |

Each field within the eCPRI Transport Header is further described in the following clauses.

* + - * 1. ecpriVersion (eCPRI protocol revision)

**Description:** This parameter indicates the eCPRI protocol version. This parameter is part of the eCPRI common header.

**Value range:** {0001b=eCPRI version 1.0, 1.1, 1.2 and 2.0, where the interpretation of the eCPRI message shall follow the eCPRI specification versions up to 2.0; 0000b and 0010b-1111b=Reserved for future eCPRI protocol revisions}.

**Type:** unsigned integer.

**Field length:** 4 bits.

**Default Value:** 0001b (eCPRI version 1.0, 1.1, 1.2 and 2.0).

* + - * 1. ecpriReserved (eCPRI reserved)

**Description:** This parameter is reserved for eCPRI future use. This parameter is part of the eCPRI common header.

**Value range:** {001b-111b=Reserved}.

**Type:** unsigned integer.

**Field length:** 3 bits.

**Default Value:** 000b (reserved fields should always be set to all zeros).

* + - * 1. ecpriConcatenation (eCPRI concatenation indicator)

**Description:** This parameter indicates when eCPRI concatenation is in use (allowing multiple eCPRI messages in a single Ethernet payload). This parameter is part of the eCPRI common header.

**Value range:** {0b=No concatenation, 1b=Concatenation}.

**Type:** binary bit.

**Field length:** 1 bit.

**Default Value:** 0b (no concatenation).

* + - * 1. ecpriMessage (eCPRI message type)

**Description:** This parameter indicates the type of service conveyed by the message type. This parameter is part of the eCPRI common header. In the present document, only values "0000 0000b" and "0000 0010b" and "0000 0101b" are used.

**Value range:**

0000 0000b = IQ data message

0000 0010b = Real-time control data message

0000 0101b = transport network delay measurement message (see clause 4.4.4.4 for full message format) other values not recognized within the present document.

**Type:** unsigned integer.

**Field length:** 8 bits.

**Valid Values:** 0x0 (U-Plane data) or 0x2 (C-Plane data) or 0x5 (network delay measurement messages).

* + - * 1. ecpriPayload (eCPRI payload size)

**Description:** This parameter is the size in bytes of the payload part of the corresponding eCPRI message. It does not include any padding bytes following the eCPRI message. The maximum supported payload size is 216-1, but the actual size may be further limited by the maximum payload size of the underlying transport network. This parameter is part of the eCPRI common header. See Figure 5.1.3.2.6-1 for a pictorial representation.

**Value range:** {0000 0000 0000 0000b-1111 1111 1111 1111b}.

**Type:** unsigned integer.

**Field length:** 16 bits.

![ecpri payload noconatenation](../assets/images/a4f34d1f4eb5.jpg)

**Figure 5.1.3.2.6-1: eCPRI payload - no concatenation (Ref. [2])**

* + - * 1. ecpriRtcid / ecpriPcid (real time control data / IQ data transfer message series identifier)

**Description:** This parameter is an eAxC identifier (eAxC\_ID) and identifies the specific data flow associated with each C-Plane (ecpriRtcid) or U-Plane (ecpriPcid) message. It is the analog of CPRI's "AxC" (antenna-carrier) value so is designated here as "eAxC" ("e" for "extended" to accommodate multiple bands and multiple component carriers).

Multiple O-DU processors may contribute to a single eAxC.

An endpoint may support mixed numerologies by indicating the capability via an M-Plane parameter; and a Section Type 3 message can be used to select one of the numerologies (frameStructure) from the capability list of possible numerologies for that endpoint. In this case, a single eAxC\_ID may be used for channels with different characteristics (frameStructure, cpLength, timeOffset, freqOffset), e.g. channels with different numerology and PRACH can share

same eAxC\_ID. Alternatively, an endpoint may be simpler, supporting a single numerology by declaring non-support of mixed numerology capability via the M-Plane parameter. In this case, a Section Type 3 message can be used to convey different values for parameters except for the frameStructure parameter. In this case a unique eAxC\_ID would be used for each mixed numerology channel (frameStructure), i.e. channels with different numerologies will use different eAxC\_IDs. An endpoint may declare non-support for Section Type 3, in which case it is suitable for channels like PDSCH/PUSCH.

The eAxC\_ID value assigned to an O-RU's endpoint is used to identify the endpoint within O-RU and shall be unique among all endpoints of O-RU of the same direction (Tx or Rx). An O-RU's endpoint could in principle be associated with multiple physical and virtual fronthaul interfaces (Ethernet ports and VLANs), but an eAxC\_ID value shall be unique and cannot be used to address different endpoints. The association of an O-RU's endpoint with multiple fronthaul interfaces is subject to O-RU design restrictions reported by O-RU via the M-Plane - interfaces not associated with a given endpoint shall not be configured via M-Plane for transferring C-Plane and U-Plane message to the endpoint. Also, fronthaul interfaces not configured via M-Plane shall not be used for transferring C-Plane and U-Plane messages to the endpoint. In other words, the O-DU shall obey the O-RU restrictions as conveyed on the M-Plane.

The O-DU may decide to use same eAxC\_ID value to address endpoints on different O-RUs, but eAxC\_ID values assigned to one O-RU shall be unique within the O-RU's endpoints of same direction. eAxC\_ID values assigned to one FHM shall be unique in the same direction. There can be O-RUs which do not support, within a same eAxC\_ID, independent sequence checkers for C-Plane messages describing U-Plane DL and C-Plane messages describing U-Plane UL, which is specified in clause 5.1.3.2.7. This O-RU capability limitation can be signaled by O-RUs and be interpreted by O-DUs from M-Plane specification v03.00. If either or both of the O-RU and O-DU only supports previous versions of the M-Plane specification, then the network operators and vendors intending to work with such O-RUs will need to ensure that the O-DU can interpret the O-RU capability limitation in other non-standardized ways, i.e. through off-line discussions. To interoperate with such O-RUs, O-DUs should avoid requiring at the O-RU, within a same eAxC\_ID, independent sequence checkers for C-Plane messages describing U-Plane DL and C-Plane messages describing U-Plane UL, either by:

* using different eAxC\_IDs for them; or
* if the O-DU chooses to use the same eAxC\_ID, using a shared sequence generator for C-Plane messages describing U-Plane DL and C-Plane messages describing U-Plane UL as shown in Figure 5.1.3.2.8-2 and described in clause 5.1.3.2.8.

However, support of such behaviour in order to interoperate with such O-RUs is optional for the O-DUs, and incompatible operation is likely to result in data outages and spurious error reports.

There can be O-DUs which do not support sequence number generation or sequence number checking. The O-RU may expose M-Plane feature **SEQ-ID-CHECKING-CONFIGURABLE,** if it has the capability to disable the sequence number checking, this includes checking of both Sequence Id and Subsequence Id as described in 5.1.3.2.8. If the O-RU supports this M-Plane feature, the O-DU may request the O-RU to disable the sequence number checking by setting

**seq-id-checking-disabled** to value true. The support for feature **SEQ-ID-CHECKING-CONFIGURABLE** on the O- RU is optional. When the sequence number checking is disabled the performance counters RX\_SEQID\_ERR and RX\_SEQID\_ERR\_C (see Table 9.1-1) shall not be updated on either the O-RU or the O-DU. When sequence number checking is disabled on O-RU then radio transport layer fragmentation (see Clause 5.5.3) cannot be used.

If the O-RU does not support feature SEQ-ID-CHECKING-CONFIGURABLE, then the network operators intending to work with such O-RUs and O-DU that does not support sequence number generation or sequence number checking, will need to ensure that the O-DU can interoperate with the O-RU in other non-standardized ways, i.e. through off-line discussions.

The generation and checking of the sequence number on the O-DU and on the O-RU for different cases is summarized in Table 5.1.3.2.7-1.

**Table 5.1.3.2.7****-1: Sequence number generation and checking**

|  |  |  |
| --- | --- | --- |
| **Messages sent from O-DU to O-RU** | | |
| **seq-id-checking- disabled** | **O-DU** | **O-RU** |
| Parameter not present (NOTE) | O-DU shall generate sequence numbers | O-RU may check sequence numbers |
| False | O-DU shall generate sequence numbers | O-RU may check sequence numbers |
| True | O-DU may generate sequence numbers | O-RU shall not check sequence numbers |
| **Messages sent from O-RU to O-DU** | | |
| **seq-id-checking- disabled** | **O-RU** | **O-DU** |
| Parameter not present (NOTE) | O-RU shall generate sequence numbers | O-DU may check sequence numbers |
| False | O-RU shall generate sequence numbers | O-DU may check sequence numbers |
| True | O-RU may generate sequence numbers | O-DU shall not check sequence numbers |
| NOTE: Parameter not present means that the feature SEQ-ID-CHECKING-CONFIGURABLE is not supported by the O-RU | | |

The present document does not define behaviour regarding transferring C-Plane and U-Plane messages to or from an endpoint over multiple fronthaul interfaces at the same time. For example, in UL, if an endpoint were to be assigned to multiple fronthaul ports, there is no way to instruct the endpoint which fronthaul port to use for any given message. In addition, in DL there is no accommodation for multiple delay windows per eAxC\_ID when multiple links are used.

Therefore, an endpoint shall be assigned exactly one fronthaul interface via the M-Plane, but different endpoints may use different fronthaul interfaces (ports) so the O-RU as a whole may use multiple fronthaul ports.

eAxC\_ID is specific to eCPRI Message Type = 2 (C-Plane) and eCPRI Message Type = 0 (U-Plane) messages. In the present document, one eAxC contains only one spatial stream (i.e. one beam per subcarrier) at a time. When precoding in the O-RU, then each eAxC contains one layer at a time, except for TxD (LTE TM2) when a single eAxC (single ecpriRtcid and ecpriPcid) represents all TxD layers.

**eAxC\_ID subfields:** One eAxC identifier (eAxC\_ID) comprises a band and sector identifier (BandSector\_ID), a component-carrier identifier (CC\_ID) a spatial stream identifier (RU\_Port\_ID) and a Distributed Unit identifier (DU\_Port\_ID).

Bit allocation is subdivided as follows:

* DU\_Port\_ID: Used to differentiate processing units at O-DU (e.g. different baseband cards). It can be expected the O-DU will assign these bits, and the O-RU will attach the same value to the UL U-Plane messages carrying the same sectionId data.
* BandSector\_ID: Aggregated cell identifier (distinguishes bands and sectors supported by the O-RU).
* CC\_ID: distinguishes Component Carrier supported by the O-RU.
* RU\_Port\_ID: designates logical flows such as data layers or spatial streams, and logical flows such as separate numerologies (e.g. PRACH) or signalling channels requiring special antenna assignments such as SRS.

The assignment of the DU\_port\_ID, BandSector\_ID, CC\_ID, and RU\_Port\_ID as part of the eAxC\_ID is done solely by the O-DU via the M-Plane. Furthermore, the O-RU doesn't need an explicit definition of any bit-level allocation within any of the four fields of the eAxC\_ID.

The bitwidth of each of the above fields is variable and set via M-Plane messaging. This is to allow flexibility given it can be expected that not all fields will simultaneously need their maximum range for any given O-RU. It can be expected the M-Plane message will configure the O-RU and O-DU with the appropriate bitwidth of each of the four fields, and the SMO that does the actual assignment will assure all 16 bits are allocated (with or without padding).

**Value range:** {0000 0000 0000 0000b-1111 1111 1111 1111b = eAxC\_ID}.

**Bit allocations:** variable, See Table 5.1.3.2.7-2.

**Table 5.1.3.2.7-2: Bit allocations**

|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0**  **(msb)** | **1** | **2** | **3** | | **4** | **5** | **6** | **7** | | **8** | **9** | **10** | **11** | | **12** | **13** | **14** | **15**  **(lsb)** | **Number of Octets** |
| DU\_Port\_ID | | | | BandSector\_ID | | | | | CC\_ID | | | | | RU\_Port\_ID | | | | | 2 |

**Type:** unsigned integer (concatenated bit fields).

**Field length:** 16 bits.

* + - * 1. ecpriSeqid (message identifier)

**Description**: This parameter provides unique message identification and ordering on two different levels. The first octet of this parameter is the Sequence ID, which is used to identify ordering of messages within an eAxC message stream.

The Sequence ID field increments and wraps independently for each U-Plane eAxC DL, U-Plane eAxC UL, C-Plane eAxC DL, and C-Plane eAxC UL, even if they share the same eAxC\_ID. The Sequence ID is used to verify that all messages are received and to reorder messages that are received out of order. The second octet of this parameter is the Subsequence ID. The Subsequence ID is used to verify ordering and implement reordering when radio-transport-level (eCPRI or IEEE-1914.3) fragmentation occurs. Radio-transport (eCPRI or IEEE-1914.3) fragmentation is a method of splitting U-Plane messages containing one or more sections whose length exceeds the maximum packet or message length of the underlying protocol. The Subsequence ID field consists of a 7 bit Subsequence counter and a single bit field, called E-bit. The Subsequence number increments starting from zero for each fragment of a U-Plane message. The E bit is used to indicate the last message of the radio-transport level fragments. It shall be set to zero except for the last message of the U-Plane fragment. In the case of C-Plane messages radio-transport fragmentation is not allowed, therefore the Subsequence ID shall be set to zero, and the E bit set to one. See clause 5.5 for a description of the fragmentation process.

As an alternative to radio-transport-level fragmentation, application fragmentation can be implemented. In this case the application can take the responsibility to ensure all transport messages are not too long (fit within the necessary transport payload size). When this "application layer fragmentation" is used, the subsequence identifier shall always be set to "0", and the E-bit set to "1" (see clause 5.5).

Figure 5.1.3.2.8-1 shows how the sequence numbers are intended to be generated and checked by C-Plane and U-Plane messaging.

|  |  |  |
| --- | --- | --- |
| LAA LBT |  | rx-endpoint |
| seq count  checker |
| seq count  generator |
| seq count  generator |
|  |
|  |

O-DU shall generate separate sequence counters for dataDirection bit = 0 and = 1

O-DU must generate separate

sequence counters for dataDirection bit = 0 and = 1

C-Plane message

Rtcid = ?

dataDirection bit=0

seq count

generator

C-Plane message

Rtcid = ?

dataDirection bit=0

seq count

checker

eAxC=?? UL

U-Plane message

Pcid = ?

dataDirection bit=1

seq count

generator

seq count

checker

seq count

checker

tx-endpoint

tx-array

C-Plane message

Rtcid = ?

dataDirection bit=1

seq count

generator

eAxC=?? DL

U-Plane message

Pcid = ?

dataDirection bit=0

seq count

checker

rx-array

O-RU generates and and checks sequence counters per endpoint but separate for

C-Plane and U-Plane

**Figure 5.1.3.2.8-1: Sequence count generation and checking for C-Plane and U-Plane in O-DU and O- RU**

Implications of Figure 5.1.3.2.8-1 are as follows:

1. Sequence ID is unique per eAxC (ecpriRtcid or ecpriPcid): different eAxC values have their own Sequence ID generation
2. Sequence ID is generated by the fronthaul interface transmitter in either the O-DU or O-RU
3. The sequence generator and checker for a C-Plane message describing U-Plane DL is independent of the sequence generator and checker for a C-Plane message describing U-Plane UL.

Table 5.1.3.2.8-1 summarizes this situation consistent with Figure 5.1.3.2.8-1:

**Table 5.1.3.2.8-1: Description of shared or independent sequence generators**

|  |  |  |  |  |
| --- | --- | --- | --- | --- |
| **direction of message flow** | **type of flow** | **U-Plane data direction** | **Same/different eAxC between DL & UL** | **shared/independent sequence generator** |
| O-DU ? O-RU | C-Plane | DL (dataDirection bit =1) | same or different | independent |
| O-DU ? O-RU | C-Plane | UL (dataDirection bit =0) | same or different | independent |
| O-RU ? O-DU | C-Plane | UL (dataDirection bit =0) | same or different | independent |
| O-DU ? O-RU | U-Plane | DL (dataDirection bit =1) | same or different | independent |
| O-RU ? O-DU | U-Plane | UL (dataDirection bit =0) | same or different | independent |

As described in clause 5.1.3.2.7, there are O-RUs which do not support, within a same eAxC\_ID, independent sequence checkers for C-Plane messages describing U-Plane DL and C-Plane messages describing U-Plane UL. As also described in clause 5.1.3.2.7, to interoperate with such O-RUs, O-DUs may choose, among other options, to use the same eAxC\_ID but with a shared sequence generator for C-Plane messages describing U-Plane DL and C-Plane messages describing U-Plane UL as described in Figure 5.1.3.2.8-2 and Table 5.1.3.2.8-2 below.

O-RAN layer

oRAN Layer

eCPRI Layer

Rtcid = ? seq count Message type = 2 generator

seq count Rtcid = ?

checker Message type = 2

Rtcid = ?

Message type = 2

seq count

checker

seq count Pcid = ?

checker Message type = 0

Pcid = ?

Message type = 0

seq count

generator

LAA LBT

seq count

generator

Rtcid = ?

Message type = 2

rx-endpoint

U-Plane message

dataDirection bit=1

C-Plane message dataDirection bit=0

tx-endpoint

C-Plane message dataDirection bit=0

C-Plane message dataDirection bit=1

eCPRI layer eCPRI layer

O-RAN layer

oRAN Layer

eCPRI Layer

|  |  |  |
| --- | --- | --- |
|  |  | Pcid = ?  Message type = 0 |
| seq count  generator |
|  |
|  |

#### O-DU O-RU

U-Plane message dataDirection bit=0

Pcid = ?

seq count

Message type = 0 checker

**Figure 5.1.3.2.8-2: Optional case of shared sequence generation and checking for C-Plane and U-Plane in O-DU and O-RU**

**Table 5.1.3.2.8-2: Optional case of description of shared sequence per eAxC\_ID generators**

|  |  |  |  |  |
| --- | --- | --- | --- | --- |
| **direction of message flow** | **type of flow** | **U-Plane data direction** | **Same/different eAxC between DL & UL** | **shared/independent sequence generator** |
| O-DU ? O-RU | C-Plane | DL (dataDirection bit =1) | same | Shared |
| O-DU ? O-RU | C-Plane | UL (dataDirection bit =0) | same | Shared |
| O-RU ? O-DU | C-Plane | UL (dataDirection bit =0) | same or different | Independent |
| O-DU ? O-RU | U-Plane | DL (dataDirection bit =1) | same or different | Independent |
| O-RU ? O-DU | U-Plane | UL (dataDirection bit =0) | same or different | Independent |

**Value range:** {0000 0000 0000 0000b-1111 1111 1111 1111b}

**Bit allocations:** See Table 5.1.3.2.8-3

**Table 5.1.3.2.8-3: Bit allocations**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **Number of Octets** |  |
| Sequence ID | | | | | | | | 1 | Octet 1 |
| E bit | Subsequence ID | | | | | | | 1 | Octet 2 |

**Type:** unsigned integer (concatenated bit fields)

**Field length:** Sequence ID: 8 bits; subsequence ID: 7 bits; E-bit: 1 bit

###### IEEE 1914.3 transport header

* + - * 1. Overview

As an alternative to eCPRI as a transport header, IEEE 1914.3 [45] may be used. The definition of the IEEE 1914.3 transport header is shown in Table 5.1.3.3.1-1 below.

**Table 5.1.3.3.1-1: IEEE 1914.3 transport header field definitions**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **Section Type: any** | | | | | | | | | |
| 0 (msb) | 1 | 2 | 3 | 4 | 5 | 6 | 7 (lsb) | # of bytes |  |
| RoEsubType | | | | | | | | 1 | Octet 1 |
| RoEflowId | | | | | | | | 1 | Octet 2 |
| RoElength | | | | | | | | 2 | Octet 3 |
| RoEorderInfo | | | | | | | | 4 | Octet 5 |

Each field within the IEEE 1914.3 Transport Header is further described in the following clauses.

* + - * 1. RoEsubType (sub type / message type)

**Description:** This field indicates the payload type within the IEEE 1914.3 Standard for Radio over Ethernet Encapsulations and Mappings (RoE) subType range. RoE allows RoE subTypes in the range 128 to 191 to be mapped to external organizations and companies using a subtype mapping table (below). This table has two fields.

The OUI/CID field uses a unique Company ID (CID) value. For the present document, the OUI/CID assigned by IEEE to xRAN (0xFAEB6E) shall be used. The payload structure mapping field assigns the RoE subtype to O-RAN message types. When the payload structure mapping field is set to 0xFFFF, this indicates that that RoE subtype is not mapped to an O-RAN message type.

A given O-RAN implementation may choose to have fixed (default) mappings, or alternatively, it may choose to configure the subType mapping table using control packets as described in IEEE 1914.3 [45].

Table 5.1.3.3.2-1 indicates the use by O-RAN of the IEEE-defined xRAN subtype mapping; future discussions with IEEE are needed to convert these to O-RAN subtype mapping.

**Table 5.1.3.3.2-1: RoE subtype mapping**

|  |  |  |
| --- | --- | --- |
| **RoE subType** | **OUI/CID subType mapping table (mapSubtype)** | |
| **OUI/CID Mapping (3 bytes) bit39 <-----------------------------------** | **Payload structure mapping (2 bytes)**  **- > bit 0** |
| 128 | xRAN=0xFAEB6E | 0x0001, IQ (No concatenation) |
| 129 | xRAN=0xFAEB6E | 0x0002, IQ (With concatenation) |
| 130 | xRAN=0xFAEB6E | 0x0003, Ctrl (No concatenation) |
| 131 | xRAN=0xFAEB6E | 0x0004, Ctrl (With concatenation) |
| 132 to 191 | xRAN=0xXXXXXX (do not care) | 0xFFFF (IEEE1914.3 [45] default),  unused/unmapped by xRAN in the present document. |

**Value range:** 128 to 191. Default values are shown below.

**Type:** unsigned integer.

**Field length:** 8 bits.

**Valid Values**: 128 (U-Plane, no concat), 129 (U-Plane, with concat), 130 (C-Plane, no concat), 131 (C-Plane, with concat).

* + - * 1. RoEflowID (flow identifier)

**Description:** The RoEflowID is a mechanism which can identify specific flows between end-points. RoEflowID, 0xFF is reserved for RoE control packets. O-RAN has no current use for this field.

**Value range:** 0 - 0xFE. **Type:** unsigned integer. **Field length:** 8 bits.

**Description:** This field is currently unused.

* + - * 1. RoElength (length)

**Description:** This field is the size in bytes of the payload part of the message. The payload length field value shall be the total number of octets following the O-RAN common header. It does not include the Ethernet FCS or following bytes.

**Value range:** 0 - 0xFFFF. **Type:** unsigned integer. **Field length:** 16 bits.

* + - * 1. RoEorderInfo (order information)

**Description:** This field is split into seven sub-fields as shown in Table 5.1.3.3.5-1.

**Table 5.1.3.3.5-1: Layout of RoEorderInfo field**

|  |  |  |
| --- | --- | --- |
| Field | Length | Note |
| **DU\_Port\_ID** | 16 bits | Used to differentiate processing units at O-DU (e.g. different baseband cards). It can be expected the O-DU will assign these bits, and the O-RU will attach the same value to the UL U-Plane messages carrying the same sectionId data. See sub-clause  5.1.3.2.7 for further information. |
| **BandSector\_ID** | Aggregated cell identifier (distinguishes bands and sectors supported by the O-RU). See sub-clause 5.1.3.2.7 for further information. |
| **CC\_ID** | Distinguishes Component Carrier supported by the O-RU. See sub- clause 5.1.3.2.7 for further information. |
| **RU\_Port\_ID** | Used to differentiate spatial streams or beams on the O-RU. See sub-clause 5.1.3.2.7 for further information. |
| **Sequence\_ID** | 8 bits | Unique message ordering sequence. See sub-clause 5.1.3.2.8 for further information. |
| **E\_Bit** | 1 bit | Marks the last message pertaining to the section. See sub-clause  5.1.3.2.8 for further information. |
| **Subsequence\_ID** | 7 bits | Unique message ordering sub-sequence. See sub-clause 5.1.3.2.8 for further information. |

**Value range:** 0 to 0xFFFF FFFF.

**Type:** unsigned integer (concatenated bit fields).

**Field length:** 32 bits.

## Protocol architecture

#### C-Plane

Figure 5.2.1-1 depicts the protocol stack for C-Plane. Data can be optionally transmitted over IP Layer 3 if supported by the transmitting and receiving nodes.

|  |
| --- |
| eCPRI / RoE |
| UDP (optional) |
| IP (optional) |
| Eth L2 + VLAN |
| Eth L1 |

**Figure 5.2.1-1: C-Plane protocol structure**

#### U-Plane

Figure 5.2.2-1 depicts the protocol stack for U-Plane. Data can be optionally transmitted over IP Layer 3 if supported by the transmitting and receiving nodes.

|  |
| --- |
| eCPRI / RoE |
| UDP (optional) |
| IP (optional) |
| Eth L2 + VLAN |
| Eth L1 |

**Figure 5.2.2-1: U-Plane protocol structure**

#### S-Plane

Frequency and time synchronization of O-DUs and O-RUs via Ethernet use synchronous Ethernet and IEEE 1588 [3],

[33] Precision Time Protocol (PTP). Transport of PTP directly over L2 Ethernet (Recommendation ITU-T G.8275.1 [31] full timing on-path support) is assumed in the present document, whilst transport of PTP over UDP/IP (Recommendation ITU-T G.8275.2 [32] partial timing support from the network) is also possible albeit with unassured synchronization performance. The protocol stack for PTP and SyncE (synchronous Ethernet) over L2 Ethernet is depicted in Figure 5.2.3-1.

|  |  |
| --- | --- |
| PTP | SyncE |
| Eth L2 | |
| Eth L1 | |

**Figure 5.2.3-1: S-Plane protocol structure**

## Quality of service

The LLS interface needs to support the ability to distinguish between data flows with different QoS requirements. Configurable priority levels (via the M-Plane) for traffic prioritization of flows shall be supported on each node on the

network path. Default values for the respective O-RAN planes are indicated as shown in Table 5.3-1. Priority marking per packet shall be used in each protocol layer except for protocols that do not allow such tagging e.g.

Recommendation ITU-T G.8264 [21] for SyncE and Recommendation ITU-T G.8275.1 [31] for full timing support PTP. For operation at Layer 2, prioritization is performed by specifying a configurable value for the PCP tag in the IEEE 802.1Q VLAN header on the outgoing traffic (see IEEE Standard 802.1Q [36], clauses 6.9.3 and 9).

**Table 5.3-1: Quality of service classes**

|  |  |  |  |
| --- | --- | --- | --- |
| **Plane** | **L2 CoS Priority (range 0-7)** | **L3 DSCP Code** | **Preemption(NOTE 1)** |
| S-Plane | G.8264 [21]: N/A  G.8275.1 [31]: N/A  G.8275.2 [32]: Default 7 | G.8264: N/A  G.8275.1: N/A  G.8275.2: EF (Expedited Forwarding) | non-preemptable |
| U-Plane (NOTES 2,3) | Default: 7 | EF (Expedited Forwarding) | non-preemptable |
| C-Plane (NOTES 2,3) | Default: 7 | EF (Expedited Forwarding) | non-preemptable |
| M-Plane (NOTE 3) | Default: 2 | AF2x (Assured Forwarding) | preemptable |
| Other traffic | Default: 1 | BE (Best Effort) | preemptable |
| NOTE 1: Not all networks will support pre-emption, so this only applies to networks supporting preemption NOTE 2: Applies also to LBP [7]  NOTE 3: Applies also to ARP, if used, where IPv4 is used | | | |

For U-Plane separate priorities can be supported based on ecpriRtcid / ecpriPcid (or the equivalent fields in RoE packet headers). This allows for different prioritization of some channels (e.g. PRACH/SRS), or services (URLLC). This requires the ability to configure priority assignments to ecpriRtcid / ecpriPcid via M-Plane messages. The default U- Plane priority can be applied to flows not specifically configured with a different value via the M-Plane. If a node does not support configurable ecpriRtcid / ecpriPcid priorities, then all U-Plane traffic will use the default value.

QoS failure (dropped packets) can be detected using the sequence numbers that make up part of the transport header. Loss of a packet in the U-Plane will impact only a specific symbol. Loss of a C-Plane packet is more serious, with the possibility of impacting an entire slot's worth of data. A broader impact is also possible with C-Plane packet loss: if downloaded beamforming weights, beamforming attributes, or channel information is lost then a beamId may be incorrectly associated with an "old" set of beamforming weights thereby possibly impacting multiple slots. However, packet loss can be detected via the sequence number so a recovery action may be taken to re-send messages that can have a persistent impact. The C-Plane packet loss can also be more precisely detected via the ACK/NACK procedure (as described in clause 7.2.8).

## Data flow identification

Differentiation between a combined C/U-Plane data flow for a single eAxC\_ID and Management Plane data flow traffic can be achieved using the following options:

* Data flow separation based on TCP/UDP (applicable when layer 3 transport is used for the C/U-Plane).
* Data flow separation based on VLAN (applicable when layer 2 or layer 3 is used for the C/U-Plane transport):

- VLAN ID for the combined U-Plane and C-Plane data flow for a given eAxC\_ID is configured via the M-Plane.

* Data flow separation based on usage of different MAC addresses (applicable when Layer 2 is used for the combined C/U Plane transport):

EXAMPLE: One MAC address used for the combined C/U-Plane data flow and a second MAC address used for the M-Plane data flow or additional MAC addresses used for the U-Plane for baseband load sharing purposes.

* Data flow separation based on different EtherTypes (applicable when Layer 2 is used for C/U Plane transport).

The U-Plane application also needs to uniquely associate different data flows (e.g. spatial streams) each with a unique C/U Plane endpoint address. This can be achieved in an O-RU using the eAxC identifier, and in the O-DU using the eAxC identifier in combination with transport-based endpoint identifiers to differentiate O-RUs. In addition, O-RU data flows can be switched/routed to different O-DUs (or different O-DU ports or O-DU processors) according to the transport-based identifiers associated with an eAxC\_ID (referred to as processing-elements in the WG4 M-Plane Specification) to allow frames/packets to be switched/routed by network equipment with no visibility of the eAxC values carried in the eCPRI/IEEE 1914.3 transport header (see clause 5.1.3).

Different transport identifiers (e.g. UDP/IP, VLAN, MAC) can be used based on whether layer 2 or layer 3 transport is used for the C/U-Plane:

* Separation of the combined C/U-Plane data flow using UDP-port identifiers (applicable when layer 3 transport is used for the C/U-Plane).
* Separation of the combined C/U-Plane data flow using VLAN identities (applicable when layer 2 or layer 3 is used for the C/U-Plane transport).
* Separation of the combined C/U-Plane data flow using different MAC addresses (applicable when Layer 2 is used for C/U Plane transport).

## Fragmentation

#### Introduction

Fragmentation shall be applied in case data (U-Plane or C-Plane data) with Ethernet transport overheads to be transferred exceed maximum transmission unit (MTU) of the network. The present document allows two methods for fragmentation, application layer fragmentation and transport layer fragmentation:

#### Application layer fragmentation

* Application creates C-Plane or U-Plane messages, which when including overheads can fit to MTU requirements set by network
* Sequence ID: Sequence ID increases for every message, E=1, Subsequence ID=0

An example of application fragmentation is provided in Figure 5.5.2-1, wherein a long data section is split between multiple U-Plane messages. In the example it is a single data section (0xABC) so described as such in the C-Plane, and in the U-Plane the sectionId is cited multiple times in the multiple U-Plane messages but with differing and consecutive groups of PRBs as indicated by the startPrbu and numPrbu fields. The value 0x00 in the C-Plane numPrbc field indicates that the number of PRBs is larger than 255 and all the PRBs in the specified SCS and carrier bandwidth are described by this section description (refer to clause 7.5.3.6 for more details). This example assumes that the total number of PRB is 273. The I and Q word width in the example is 14 bits, which for such a large data section requires multiple U-Plane messages. The ecpriRtcid / ecpriPcid (0xDEF3) is shown with a random example value, as is the sequence ID in the C-Plane (0x99) and independently in the U-Plane (0x40-0x48).

![A row of colorful papers with text  Description automatically generated with medium confidence](../assets/images/8cb7cfbcf61d.jpg)

**Figure 5.5.2-1: Example of application-level fragmentation of U-Plane messages**

#### Radio transport layer (eCPRI or IEEE-1914.3) fragmentation

* Application creates U-Plane messages, which when including overhead may exceed MTU requirements set by network
* Radio transport layer splits message which may contain more than one section into pieces such that the fragments with overheads fit to MTU requirements set by network.
* Sequence ID: Sequence ID remains same for all the fragments. Subsequence ID starts from 0 for the first fragment and counts up for each fragment. Last fragment flagged with E=1, others E=0. This is shown in Table 5.5.3-1.

**Table 5.5.3-1: Example of sequence numbers usage**

|  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **Application Layer Fragmentation** | | | |  | **eCPRI Layer Fragmentation** | | | |
| **eAxC** | **SeqId** | **E** | **Sub-SeqId** | **eAxC** | **SeqId** | **E** | **Sub-SeqId** |
| ? | 0 | 1 | 0 | ? | 0 | 0 | 0 |
| ? | 1 | 1 | 0 | ? | 0 | 1 | 1 |
| ? | 2 | 1 | 0 | ? | 1 | 0 | 0 |
| ? | 3 | 1 | 0 | ? | 1 | 0 | 1 |
| ? | 4 | 1 | 0 | ? | 1 | 0 | 2 |
| ? | 5 | 1 | 0 | ? | 1 | 1 | 3 |
| ? | 6 | 1 | 0 | ? | 2 | 0 | 0 |
| ? | 7 | 1 | 0 | ? | 2 | 0 | 1 |
| ? | 8 | 1 | 0 | ? | 2 | 1 | 2 |
| ? | 9 | 1 | 0 | ? | 3 | 1 | 0 |

#### Fragmentation considerations

Application layer fragmentation should be applied so that maximum size standard IEEE 802.3 [53] Ethernet frames can be used. (Jumbo frames, if used, increase the maximum MTU size).

* In case of L2 only solution, application layer maximum transmission unit size is standard IEEE 802.3 Ethernet frame payload size (1500 bytes) - transport overhead (8 bytes) = 1492 bytes (or larger for Jumbo frames)

When a U-Plane section payload is fragmented due to large number of PRBs, it will be divided into multiple groups of PRBs such that each group (including the application headers) can fit to the MTU requirements. Each group of PRBs shall have its respective control fields including the same section ID from the C-Plane and startPrbu and numPrbu to identify its contents (see Figure 5.5.2-1). When an application layer message exceeds the MTU size set via the M-Plane configuration, radio-transport layer fragmentation can be applied at the transport layer and has the advantage of allowing application layer messages to fit whatever is the MTU size without the application having to know about transport-level details.

# Security

## General

Security requirements are depicted in Table 6.1-1. The CUS-Plane has sensitivity to latency. Security controls should be selected with consideration of latency requirements.

**Table 6.1-1: Security requirements for User Plane, Control Plane, and Synchronization Plane**

|  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- |
| **Plane** | **Authentication and Authorization (at interface level)** | **Integrity (protection from packet modifications**  **and injection)** | **Confidentiality (encryption protection)** | **Availability (including performance degradation)** | **Remarks** |
| C-Plane | IEEE 802.1X  supplicant functionality for NAC [51] (NOTE 2) | Not currently specified | Not currently specified | IEEE 802.1X  supplicant functionality for NAC [51]  (NOTE 2) |  |
| U-Plane | IEEE 802.1X  supplicant functionality for NAC [51] (NOTE 2) | No additional protection mechanisms are specified | No additional protection mechanisms are specified | IEEE 802.1X  supplicant functionality for NAC [51]  (NOTE 2) | 3GPP Control Plane and User Plane messages that are transported via the Open Fronthaul U- Plane (LLS-UP) are integrity protected and may be confidentiality protected by the Packet Data Convergence  Protocol (PDCP) [52]. (NOTE 3) |
|  |  |  |  | Optional |  |
|  |  |  |  | Grandmaster |
|  |  |  |  | Clock |
| S-Plane | IEEE 802.1X  supplicant functionality for NAC [51] (NOTE 2) | Not currently specified | Not currently specified | Redundancy (NOTE 1).  IEEE 802.1X  supplicant |
|  |  |  |  | functionality for |
|  |  |  |  | NAC [51] |
|  |  |  |  | (NOTE 2) |
| NOTE 1: Principles for Grandmaster Clock Redundancy are provided in Annex P.2.3.1 of IEEE 1588 [33] and in the applicable PTP profile (e.g. ITU-T G.8275.1 [31]). Guidelines are provided in Annex G of O-RAN Synchronization Architecture and Solution Specification [54]  NOTE 2: Refer to Table 10.2-1 for support of IEEE 802.1X supplicant functionality by the O-DU and the O-RU. NOTE 3: The details of PDCP are outside the scope of the present document. | | | | | |

# C-Plane Protocol

## General

#### C-Plane transport

Either eCPRI or IEEE 1914.3 shall be used as an encapsulation mechanism for the Control Plane messages. It is assumed that a different data flow is used other than the U-Plane channel. Further, C-Plane messages are not concatenated with U-Plane messages within same Ethernet frame.

## Elementary procedures

#### Scheduling and beamforming commands transfer procedure

C-Plane messages shall be exchanged between O-DU and O-RU. The main purpose of these messages is to transmit data-associated control information required for processing of user data (e.g. scheduling and beamforming commands) if such information is not provided via M-Plane (see clause 8.2.2 for more details). Messages shall be sent separately for DL related commands and UL related commands (see Figure 7.2.1-1). See also Figure 7.2.5.2-1 for the special case of LTE LAA wherein there are UL as well as DL C-Plane message flows. For purpose of increased flexibility, C-Plane messages may be sent either jointly or separately depending on the channel for which information is conveyed. For example, PUCCH and PUSCH may be bundled or not bundled into a single C-Plane message depending on implementation.

**DL C-Plane and DL U-Plane**

![](../assets/images/66dd1a0c41cf.png)

messages arrive at RU before the deadline by a margin > inaccuracies of timing params.

**O-RU**

**(@ FH interface)**

**O-DU**

**(@ FH interface)**

![](../assets/images/313a40260305.png)![](../assets/images/76a34efb2e0a.png)![](../assets/images/6e25fcf435bc.png)![](../assets/images/022f2aaac331.png)

**UL C-Plane and UL U-Plane**

**network delay**

the start of UL U-plane transmit window for symbol #N

**time flow**

**...**

the start of UL U-plane transmit window for symbol #M+1

the start of UL U-plane transmit window for symbol #M

the earliest air interface UL signal sample for symbol #M arrives at O-RU antenna

the end of UL C-plane receive window for symbol #M

messages arrive at RU before the deadline by a margin > inaccuracies of timing params.

**O-DU**

**(@ FH interface)**

**O-RU**

**(@ FH interface)**

**network delay**

**Tcp\_adv\_dl** min. time the O-RU has to

**t2a\_min\_cp\_ul** min. time the O-RU has to prepare to

**network** process UL signals

the end of DL C-plane receive window for symbol #M

messages arrive at RU before the deadline by a margin > inaccuracies of timing params.

the end of DL U-plane receive window for symbol #M

prepare to process DL data from the O-DU

**delay**

at the antenna

**ta3\_min**

the end of DL U-plane receive window for symbol #M+1

**...**

the end of DL U-plane receive window for symbol #N

**time flow**

NOTE 1: A DL C-Plane message describing multiple symbols shall arrive at O-RU at least **Tcp\_adv\_dl** before the end of DL U-Plane receive window for symbol **startSymbolId** (the earliest symbol described by the message).

NOTE 2: A UL C-Plane message describing multiple symbols shall arrive at O-RU at least **t2a\_min\_cp\_ul** before the earliest air interface UL signal sample of symbol **startSymbolId** (the earliest symbol described by the message) arrives at O-RU antenna.

**Figure 7.2.1-1: Scheduling and beamforming commands transfer procedure**

#### Symbol numbering and duration

For the NR case, data symbol numbering in a slot shall be from zero to thirteen (for extended CP, eleven). For LTE the symbol numbering shall be mapped to the NR numbering as follows:

LTE with normal prefix maps to NR with same u and normal prefix:

* LTE symbol lLTE of slot 2i is mapped to NR slot i, symbol l? = lLTE
* LTE symbol lLTE of slot 2i + 1 is mapped to NR slot i, symbol l? = 7 + lLTE

LTE with extended prefix the following applies:

* LTE symbol lLTE of slot 2i is mapped to NR slot i, symbol l? = lLTE
* LTE symbol lLTE of slot 2i + 1 is mapped to NR slot i, symbol l? = 6 + lLTE

The symbol duration can be determined from the SCS provided by "frameStructure" and knowledge of whether LTE or NR is supported; 3GPP TS 36.211 [42] clause 5.2.1 (UL) and clause 6.2.1 (DL), and 3GPP TS 38.211 [4] clause 4.3 provide the necessary formulas.

When the SCS value provided by "frameStructure" is less than 15 kHz (e.g. for long preamble PRACH formats), numerology for symbolId shall be based on 15 kHz SCS.

#### Mixed numerology and PRACH handling

###### Overview

5G NR defines the Physical Resource Block (PRB) such that the number of subcarriers per PRB is the same (i.e. 12) for all numerologies. However, subcarrier spacing may differ, resulting in mixed numerology used in time and frequency domains. Likewise, mixed numerologies may be applied to both DL and UL respectively. An example is shown in Figure 7.2.3.1-1.

![](../assets/images/7e369003f943.png)

**Figure 7.2.3.1-1: Mixed numerology in time and frequency domain**

###### Frequency indexing across multiple numerologies

RB indexing (i.e. the physical resource block) is always dependent on the used numerology. For PRACH and SSB the relation is with the physical channel. In case of PRACH, indexing of RBs inside of each PRACH frequency block follows 3GPP specifications and PRACH subcarrier extraction shall be performed in the O-DU. In particular, the first RE of the first RB addressed inside section description shall correspond with the first guard tone used at the lower edge of the PRACH frequency block based on the PRACH SCS. The O-RU, using the filter index and SCS of corresponding PUSCH, knows the PRACH subcarrier position and guard tones and can then adjust its filtering parameters (e.g. filter centre, passband). For the SSB case, its own separate frequency offset is assigned.

Figure 7.2.3.2-1 shows a PRACH example illustrating startPrbc, numPrbc, and freqOffset. Specifically,

* freqOffset indicate the location of lowest RE's centre in the lowest RB defined by frameStructure, with respect to center-of-channel-bandwidth.
* startPrbc and numPrbc in the Section Type 3 indicate the PRB in the RB grid defined by corresponding freqOffset and frameStructure.
  + If freqOffset refers to the lowest RE's centre in the lowest RB of the PRACH block (as shown in Figure 7.2.3.2-1), then startPrbc shall be set to 0.
  + If freqOffset refers to lower than the start of the PRACH block, then startPrbc shall take a non-zero value, where indexing starts from the PRB referred to by freqOffset.
* Note that numPrbc may exclude PRBs with all-guard-tones at the upper end of the PRACH frequency block. (Hence, in the example in Figure 7.2.3.2-1, numPrbc could be set to 71 or 72).

![Diagram  Description automatically generated with low confidence](../assets/images/e4960f24f1ac.png)

**Figure 7.2.3.2-1: startPrbc, numPrbc, and freqOffset Illustration - PRACH example**

For each numerology (and PRACH/SSB), the freqOffset IE shall determine the frequency offset between centre of channel bandwidth (configured via M-Plane) and centre of subcarrier corresponding to RE#0 of RB#0 with resolution of half the SCS of the respective numerology. This concept is depicted in Figure 7.2.3.2-2, Figure 7.2.3.2-3 and Figure 7.2.3.2-4.

* The centre of channel bandwidth (component carrier centre frequency in Hz) is the common reference to all numerologies and PRACH/SSB channels. The centre of channel bandwidth shall be configured at carrier setup over M-Plane.
* Frequency offset resolution of half the SCS value allows centre of channel bandwidth to be aligned with an RE centre, or an RE edge.

PRACH frequency block #1 with SCS = 1.25 kHz

RB 0 RB 71

PRACH frequency block #3 with SCS = 1.25 kHz

RB 0 RB 71

RE 863

RE 862

...

RE 851

...

RE 11

...

RE 1

RE 0

RE 863

RE 862

...

RE 851

...

RE 11

...

RE 1

RE 0

freqOffset = -2592 center of channel

freqOffset = +864

frequency

-1620 kHz = -2592\*0.625 kHz

bandwidth

+540 kHz = +864\*0.625 kHz

NOTE 1: Each frequency block is either requested with separate section descriptions in one ST 3 C-Plane message, as separate section descriptions in multiple ST 3 C-Plane messages or as a single section description covering multiple frequency blocks in one ST 3 C-Plane message.

NOTE 2: In this example, 5G NR 100 MHz carrier PUSCH SCS is 30 kHz, PRACH SCS is 1.25 kHz. NOTE 3: In 5G NR, PRACH frequency blocks are continuous.

NOTE 4: In the example, guard tones are included.

**Figure 7.2.3.2-2: RB mapping- PRACH example**

50 MHz FR1 carrier with SCS 15 kHz (270 RB), SCS 30 kHz (133 RB) and SCS 60 kHz (65 RB)

RB 0 RB 135

15 kHz

RE 1631

...

RE 1620

RE 11

...

RE 1

RE 0

RE 3239

...

...

RB 66

RB 0

30 kHz

RE 803

...

RE 798

...

RE 792

...

RE 1

RE 0

RE 1595

...

RB 32

RB 0

60 kHz

RE 779

...

RE 395

...

RE 390

...

RE 384

...

RE 0

frequency

freqOffset = -780 (-23.4 MHz = -780\*30 kHz)

freqOffset = -1596 (-23.94 MHz = -1596\*15 kHz) freqOffset = -3240 (-24.3 MHz = -3240\*7.5 kHz)

center of channel bandwidth

**Figure 7.2.3.2-3: RB mapping and support of mixed numerologies - example with mixed numerologies**

30 kHz

RE 1595

...

RE 803

...

RE 798

...

RE 792

...

RE 1

RE 0

PDSCH

RE 239

...

RE 131

...

RE 125

...

RE 120

...

RE 1

RE 0

RB 0

50 MHz FR1 carrier with SCS 30 kHz (133 RB) for PDSCH and SCS 30 kHz (20 RB) for SSB

RB 66

30 kHz SSB

RB 0

RB 10

freqOffset = -240 (-3.6 MHz = -240\*15 kHz)

freqOffset = -1596 (-23.94 MHz = -1596\*15 kHz)

center of channel bandwidth

frequency

**Figure 7.2.3.2-4: RB mapping and support of mixed numerologies - example SSB**

###### Slot indexing with mixed numerologies

For a given frequency range FR1 or FR2, the highest possible numerology supported by the O-RU shall be used as the common reference (separately for FR1 and FR2) for the start of the slot identified by slotId. UL and DL shall use the same reference numerology for slotId. If the highest numerology supported by the O-RU allows both normal and extended CP then normal CP shall be used as reference. Note that the O-RU shall advance slots with extended CP against the reference. The symbol duration and position in time is calculated from the u value (SCS from frameStructure in message field or configured via M-Plane) and the slotId field in the C/U-Plane message. The value of the sectionId field in C/U-Plane messages addressed per eAxC shall be unique per slot identified by slotId value.

For example, in FR1 case, the maximum slot numbers per subframe is four, when the maximum supported SCS by the O-RU is 60 kHz

* u= 0 ? slot #0; u=1 ? slot #0 & #2; u=2 ? slot #0, #1, #2, #3 (see Table 7.2.3.3-1)

13

**Table 7.2.3.3-1: slotId indexing (example 1)**

|  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- |
| FR 1 | | | | | | |
| u=2  60 kHz  (Highest supported FR 1 SCS) | | u=1  30 kHz | | | u=0  15 kHz | |
| slotId | symbolId | slotId | symbolId | | slotId | symbolId |
| 0 | 0 | 0 | 0 | | 0 | 0 |
| 1 |
| 2 | 1 | |
| ... |
| 11 | 2 | | 1 |
| 12 |
| 13 | ... | |
| 1 | 0 |
| 1 | 11 | | 2 |
| 2 |
| ... | 12 | |
| 11 |
| 12 | 13 | | ... |
| 13 |
| 2 | 0 | 2 | 0 | |
| 1 |
| 2 | 1 | | 11 |
| ... |
| 11 | 2 | |
| 12 |
| 13 | ... | | 12 |
| 3 | 0 |
| 1 | 11 | |
| 2 |
| ... | 12 | | 13 |
| 11 |
| 12 | 13 | |
| 13 |
| 0 | 0 | 0 | 0 | | 0 | 0 |
| 1 |
| 2 | 1 |  |
| ... | 1 |
| 11 | 2 | |
| 12 |
| ... ... | |  |

FR 2

u=4

240 kHz

(Highest supported

FR 2 SCS)

u=3 120 kHz (FR2)

u=2 60 kHz (FR2)

slotId symbolId slotId symbolId slotId symbolId

0

1

2

3

4

5

6

7

8

9

0

...

13

0

...

13

0

... 13

0

... 13

0

... 13

0

...

13

0

... 13

0

... 13

0

... 13

0

... 13

0

0

1

...

12

13

0

1

...

12

13

0

1

... 12

13

0

1

... 12

13

0

1

...

12

13

0

2

4

4

6

8

8

...

14

15

0

1

2

0

... 13

.. 12

13

0

... 13

0

... 13

0

...

13

14

0

1

...

12

13

0

1

... 12

13

0

1

...

12

12

0

0

1

2

.. 11

12

13

0

1

2

.. 11

12

13

0

1

2

.. 11

12

13

0

1

2

.. 11

12

13

0

1

2

..

11

12

...

**Table 7.2.3.3-2: slotId indexing (FR1 + FR2 example 2)**

FR 2

FR 1

u=4

240 kHz

(Highest supported

FR 2 SCS)

u=3

120 kHz

u=2

60 kHz

u=2 60 kHz

((Highest supported

FR 1 SCS))

u=1

30 kHz

u=0

15 kHz

slotId symbolId slotId symbolId slotId symbolId slotId symbolId slotId

symbolId slotId

symbolId

0

1

2

3

4

5

6

7

8

9

0

... 13

0

...

13

0

... 13

0

... 13

0

... 13

0

... 13

0

... 13

0

... 13

0

...

13

0

...

13

0

4

0

1

...

12

13

0

1

...

12

13

0

1

...

12

13

0

1

...

12

13

0

1

...

12

13

0

4

0

1

2

... 11

12

13

0

1

2

... 11

12

13

0

1

2

... 11

12

13

0

1

2

...

11

12

13

0

1

2

...

0

1

0

1

2

... 11

12

13

0

1

2

...

11

12

13

0

1

2

... 11

12

13

0

1

2

... 11

12

13

0

1

2

...

0

0

0

0

1

2

2

1

...

11

2

6

12

13

...

8

8

2

2

0

1

11

2

...

...

12

3

12

11

14

15

0

1

0

... 13

..

12

13

0

... 13

0

... **13**

14

0

1

...

12

13

12

1

...

12

103

12

13

13

0

0

0

0

0

0

...

1

Numerology for slotId shall be based on the highest possible numerology supported by the O-RU. For example:

0

* If the O-RU supports only FR1 SCSs i.e. 15 kHz, 30 kHz and 60 kHz, it shall be as per the left hand side table of Table 7.2.3.3-1;
* If the O-RU supports only FR2 SCSs i.e. 60 kHz, 120 kHz and 240 kHz, it shall be as per the right hand side table of Table 7.2.3.3-1;
* If the O-RU supports both FR1 SCSs i.e. 15 kHz, 30 kHz, 60 kHz and FR2 SCSs i.e. 60 kHz, 120 kHz and 240 kHz, it shall be as per Table 7.2.3.3-2;

###### PRACH formats with multiple PRACH Symbols

Certain PRACH formats have PRACH preambles constructed from multiple repetitions of a PRACH Symbol, with the Cyclic Prefix (CP) used only with the first PRACH Symbol. Therefore, the O-RU shall be informed how to correctly execute CP extraction and FFT. This shall be achieved by sending a single control message spanning over multiple symbols which reduces the number of C-Plane messages and data sections required.

EXAMPLE: In Figure 7.2.3.4-1, numSymbol = 4, cpLength = 0, startSymbolId = 9 and

timeOffset = 10168 x Ts duration to adjust by an equivalent time value for setting cpLength = 0.

Optionally O-RU can advertise the list of the supported formats for the specific endpoint. If the O-RU chooses not to, it means O-RU supports all PRACH formats and the O-DU may select whatever format that is 3GPP compliant with the selected SCS. If the O-RU implements earlier releases of the M-Plane specification which does not support such reporting, then the negotiation of PRACH formats to use shall happen offline, i.e. operators and/or vendors shall ensure that the intended PRACH formats are supported by both O-RU and O-DU.

The example in Figure 7.2.3.4-1 depicts the scenario with format A2, 30 kHz SCS, PRACH Configuration Index: 105 for FR1 and unpaired spectrum [4] in which CP extraction occurs only once, yet there are four associated FFT operations.

![A diagram of a graph  Description automatically generated](../assets/images/f1a1ec317fdf.png)

**Figure 7.2.3.4-1: Example of PRACH format A2**

#### DL precoding configuration parameters and indications

This clause addresses the method of specifying the precoding operation in the Category B O-RU. For Category A O- RU, if there is precoding in the DL processing chain, the precoding shall be implemented in the O-DU so the descriptions in this clause are not relevant. Annex I contains more information and examples regarding this precoding. Support for Transmit Diversity and Spatial Multiplexing with Large Delay CDD precoding schemes is optional for Category B O-RU. If O-RU does not support those precoding schemes, O-DU shall handle precoding of channels using those schemes on O-DU side as defined for Category A O-RU case.

**O-DU:** 12 REs are generally sent on the interface from the O-DU to the O-RU but for certain IQ formats (selective RE sending as described in Annex A.6), fewer REs may be sent. In this case the missing REs would be considered by the O-RU to be equal to zero in both I and Q.

For Single TX:

For layer mapping at O-RU, complex-valued modulation symbols mapped in a sequence starting with

*d* (*q*) (0),..., *d* (*q*) (*M* (q) ?1) to frequency REs (k,l) and are packed into a PRB. A single eAxC is used for this

symb

purpose.

* For CRS mapping at O-RU, all CRS REs belong to a single Tx antenna and are mapped to frequency REs (k,l) for one layer and are packed into a PRB for transmission and are unpacked at O-RU (see Annex I for details).

For Transmit Diversity:

* For layer mapping at O-RU, complex-valued modulation symbols mapped in a sequence starting with

*d* (*q*) (0),..., *d* (*q*) (*M* (q) ?1) to frequency REs (k,l) and are packed into a PRB. A single eAxC is used for this

symb

purpose.

* For CRS mapping at O-RU, all CRS RE's are mapped to frequency REs (k,l) for all layers and are packed into a PRB for transmission and are unpacked at O-RU (see Annex I for details).

For Spatial Multiplexing with Large Delay CDD:

* At the O-DU, layer mapped symbols for each layer v, mapped in sequence starting with

*x*(*i*) ? ?*x*(0) (*i*) ... *x*(*?*?1) (*i*)?*T* to frequency REs (k,l) are packed into each PRB (see Annex I).

* For precoding at the O-RU, different eAxCs are used for each layer (See Annex I).
* For CRS mapping at the O-RU, all CRS RE's for each layer are packed into a PRB for transmission and are unpacked at the O-RU (see Annex I for details).
* All C-Plane message parameters are kept the same for precoding purposes. For other LTE precoding schemes and NR
* Precoding in the O-RU may be implemented in various ways that are vendor-defined and vendor-specific, especially for LTE TM7-TM10 and NR as there is no 3GPP-mandated precoding operation for these cases.

**O-RU:** From the C-Plane precoding Section Extension, the O-RU determine the transmission scheme using txScheme field.

For Single TX:

* At the O-RU, input modulated symbols *d* (*q*) (0),..., *d* (*q*) (*M* (q) ?1) shall be unpacked and used to perform layer mapping, precoding and antenna port mapping for single tx.

symb

* For transmission on a single antenna port, a single layer shall be used, *?* ? 1 , and the mapping is defined as

*x*(0) (*i*) ? *d* (0) (*i*) with Mlayer = M(0) .

symb symb

* For single tx transmission on a single antenna port, precoding is defined by *y*( *p*) (*i*) ? *x*(0) (*i*) where

*p* ??0, 4, 5, 7,8,11,13,107,108,109,110? is the number of the single antenna port used for transmission of the

?1 , *M*

? *M* .

physical channel and *i* ? 0,1,..., *M* ap

symb

ap symb

layer symb

* For antenna port mapping p={0}, each y(i)=[y(p) (i) ]T RE shall go to antenna port y\_p(i) after antenna port mapping.
* Since the PRB contains CRS sequences for one antenna port, the RE should extract the CRS RE's using crsSymbolNumber, crsReMask and crsShift (see Annex I for details) and are mapped to the appropriate RE position.

For Transmit Diversity:

* At the O-RU, input modulated symbols *d* (*q*) (0),..., *d* (*q*) (*M* (q) ?1) shall be unpacked and used to perform layer

symb

mapping, precoding and antenna port mapping.

* The appropriate precoder shall be selected based on number of layers and antenna ports.
* For antenna port mapping p={0..N}, each y(i)=[y(p) (i) ]T RE shall go to each antenna port y\_p(i) after antenna port mapping.
* Since the PRB contains CRS sequences for N antenna ports, the RE should extract the CRS RE's using crsSymbolNumber, crsReMask and crsShift (see Annex I for details) which are mapped to the appropriate RE position and rest of the REs are populated with zero data.

For Spatial Multiplexing with Large Delay CDD:

* Input layer mapped symbols *x*(*i*) ? ?*x*(0) (*i*)

based on numLayers, layerID.

...

*x*(*?*?1) (*i*)?*T* shall be used to perform precoding at the O-RU

* The O-RU shall change the precoder per RE automatically based on the number of antenna ports and number of layers.
* After precoding, for antenna port mapping p={0..N}, each y(i)=[y (p) (i) ]T RE shall go to each antenna port y\_p(i) after antenna port mapping.
* Since all PRBs contain CRS sequences for N antenna ports, then based on the layerID (layer 0) the O-RU shall extract CRS sequence using crsSymbolNumber, crsReMask and crsShift (see Annex I) for CRS mapping to each of the antenna ports using the reMask bit field; the CRS REs from other layers can be ignored.

For other LTE precoding schemes and NR

* One way to implement precoding in the O-RU is via the beamId values, wherein a beamId points to a beamforming vector that also implements the precoding operation.

#### LAA commands transfer procedure

###### Introduction

This procedure shall be used to exchange C-Plane messages between O-DU and O-RU. The main purpose of these messages is to support LAA feature in the O-RU/O-DU. See Annex G for more details on the LAA message flow.

###### LBT procedure overview

The LBT procedure shall be used to configure the O-RU with the parameters needed to do LBT prior to PDSCH or DRS transmission OTA. The O-RU shall report the LBT process outcome (either success or failure) in the indication message.

In contrast to licensed spectrum, where the O-RU may continuously send data or reference signals OTA, in unlicensed spectrum, the O-RU can only send discontinuous bursts of data (of length MCOT) or periodic DRS signals. If the O-RU cannot manage a congestion window by itself, the O-DU shall send a LBT\_DL\_CONFIG request message prior to each OTA transmission on the LAA SCell. This includes both DRS and PDSCH (i.e. MCOT burst) transmissions. For every LBT\_DL\_CONFIG request message, the O-RU shall reply with the LBT\_DL indication messages which include the LBT outcome and the status of the subframe (transmitted/dropped) (see Figure 7.2.5.2-1).

If the O-RU can manage a congestion window by itself, the O-DU does not need to send LBT\_DL\_CONFIG request message to start the LBT procedure at the O-RU. Because the O-RU can determine the start timing of LBT procedure, the requirements of the O-DU for the LBT procedure at the O-RU is a delivery of needed information to adjust a congestion window managed by the O-RU. To transmit this information, the O-DU shall send LBT\_CWCONFIG\_REQ message, and the O-RU shall notify the O-DU by LBT\_CWCONFIG\_RSP message to indicate that the LBT\_CWCONFIG\_REQ message is successfully received or not. Also, the O-RU can adjust its congestion window based on the information on the LBT\_CWCONFIG\_REQ message. For every LBT\_CWCONFIG\_REQ request message, the O-RU shall reply with the LBT\_DL indication message(s) which include the LBT outcome and the status of the subframe (transmitted/dropped).

For the DRS signal, initially, the O-DU shall configure the O-RU with the DRS parameters (DMTC period and DMTC offset) via the M-Plane.

Before every DRS period, the O-DU shall send the LBT\_DL\_CONFIG request message and the DRS signal. The O-RU shall do the LBT procedure and transmit the DRS signal OTA in case of LBT success. The O-RU then shall send the LBT\_DL indication.

The DRS signal can be transmitted over the fronthaul interface similar to other reference signals such as the PSS/SSS/CRS.

![](../assets/images/9db057ed4f56.png)

O-RU

O-DU

**Figure 7.2.5.2-1: LBT message flow**

###### Definitions

* DOW: Maximum one-way fronthaul latency.
* PDU : Maximum O-DU processing time (reading an upstream O-RU C-Plane message, MAC processing, sending the downstream U-Plane data).
* PRU : Maximum O-RU processing time (sending an upstream C-Plane message, receiving downstream U-Plane data, transmitting U-Plane data OTA).
* BRU : O-RU Buffer depth (for LAA) ceiled to an integer number of OFDM symbols in microseconds (up to 140 symbols, for example (i.e. MCOT)). This is equivalent to the minimum amount of data that shall be buffered at the O-RU. This parameter could be less than or equal to the actual O-RU buffer size communicated via the M- Plane.
* Expired symbol: Symbol where the current time at the O-RU exceeds its target transmission time (i.e. SFN/SF) OTA.
* Normal (partially-filled) SF assumption: Tstart is the start of the transmission time, which occurs at the first SF (slot) boundary the O-RU encounters after starting the LBT CAT 4 process and after finishing the minimum sensing duration. Initially known to the O-DU (since it sends the LBT start time and the LBT parameters to the O-RU). It can be updated in real-time based on the LBT outcome and the communication between the O-DU and O-RU. Here, a "slot" follows the LTE definition of containing seven symbols.
* LBT\_DL indication Threshold (LBTth ): The latest time the O-DU is expected to receive the LBT\_DL indication message from the O-RU.

LBTth = Tstart + (PRU + DOW + PDU )

* CU Transmission time threshold (CUTth): The time at which the O-DU is required to send the data to the O- RU to be transmitted OTA at time Tstart .

CUTth = Tstart - (PRU + DOW + PDU )

* x*:* Minimum time between any two potential start transmission times.

x = { 1 ms, Normal SF

0.5 ms, Partially - filled SF

###### General guidelines for the LAA-procedure

* + - * 1. PDSCH Transmission
* O-DU should avoid buffer overflow or underflow at the O-RU:
  + O-DU should only send BRU worth of data to the O-RU for every single transmission
  + O-DU should plan for the data to be received at the O-RU only PRU before the actual OTA transmission time at the O-RU
* O-RU should avoid buffer overflow or underflow at the O-RU:
  + O-RU should flush its buffer (by dropping any expired symbols) as soon as any symbol becomes expired (i.e. current time is larger than the symbol's scheduled time)
  + O-RU should immediately send a success LBT indication to the O-DU once the channel is acquired.
  + The O-RU should send an error message to the O-DU if data received is larger than its local buffer
  + The O-RU should send a subframe drop or transmission message to the O-DU when buffered subframe is dropped because scheduled time is passed, or is transmitted after LBT success.
* The O-RU should have a buffer that satisfies the following equation: BRU >= 2 x DOW + PDU + PRU
* LBT CAT 4 considerations:
  + The O-DU can configure the O-RU (via the M-Plane) with the threshold on the LBT CAT 4 duration (e.g. 8 ms). Once this threshold has exceeded, the O-RU sends a failure LBT indication to the O-DU, which in return sends back a new LBT config request. The O-RU can then restart the LBT CAT 4 process.
* The data signal may be received at the O-RU before or after the LBT\_PDSCH\_REQ
* The O-RU should generate the reservation signal locally whenever needed
  + - * 1. DRS Transmission
* Recall:
  1. PSS/SSS being part of a DRS may occur outside subframe 0 and 5
  2. CRS/CSI-RS/PSS/SSS do not vary with subframe number but are kept unchanged across subframes 0-4 (call it DRS\_v1) and 5-9 (DRS\_v2).
* Assumption: DRS OTA transmission starts at the SF boundaries.
* The DRS signal may be received before or after the LBT\_DRS\_REQ.
* LBT\_DRS\_REQ is sent once per DRS window (e.g. DMTC offset = 6 ms is conveyed to the O-RU via the M- Plane).
* DRS signal is sent every SF in the 6 SFs of the DRS window until LBT succeeds.
* DRSth,1 = SF0 - (PRU + DOW + PDU ).
* DRSth,2 = SF5 - (PRU + DOW + PDU ).
* SF0: The start of SF0, SF1, SF2, SF3, or SF4.
* SF5: The start of SF5, SF6, SF7, SF8, or SF9.
* At DRSth,1, O-DU sends DRS\_v1 (i.e. to be transmitted within SFs 0-4).
* At DRSth,2, O-DU sends DRS\_v2 (i.e. to be transmitted within SFs 5-9). NOTE: LBT indication with failure outcome is sent for every sensing period.
  + - * 1. Congestion window information transmission
* O-DU should send information regarding a congestion window adjustment to O-RU:
  + HARQ feedback information for the reference subframe and number of TB are included.
* O-RU should adjust its managed congestion window value and notify to O-DU the packet reception status:
  + O-RU should adjust its congestion window value based on received information.
  + O-RU should immediately send a success LBT\_CWCONFIG\_RSP to the O-DU when the message is successfully received. If not, O-RU should send a fail LBT\_CWCONFIG\_RSP.

#### Dynamic Spectrum Sharing (DSS)

###### Overview

Dynamic Spectrum sharing allows different technologies - 4G LTE and 5G NR in the present document, to share same frequency carrier dynamically, i.e. the O-DU may allocate one or more set(s) of frequency-time resources (or PRBs) to LTE or NR dynamically. The O-RU shall support this feature for the O-DU to take advantage of such an allocation. The present document supports DSS via using dedicated eAxC\_ID (i.e. endpoints) for LTE and NR or via using Section Extension 9 for DSS.

###### Dynamic Spectrum Sharing (DSS) via dedicated endpoints

When using dedicated endpoints for DSS, dedicated endpoints shall be configured in the O-RU for LTE and NR (hence dedicated eAxC\_ID) to implement DSS. For example, when an O-DU allocates a set of PRBs for LTE, the O-DU shall use an eAxC\_ID dedicated for LTE (assigned to a carrier identified as an LTE carrier) to address the LTE endpoint; at a

different time when the O-DU allocates the same set of PRBs for NR, the O-DU shall use an eAxC\_ID dedicated for NR (assigned to a carrier identified as an NR carrier) to address the NR endpoint in the O-RU.

When using this approach, a carrier will be assigned to LTE or NR, so when both LTE and NR are to be supported at the same time ("DSS"), two carriers with overlapping frequency ranges are to be identified, one being LTE and the other being NR. It will be up to the O-RU to overlap the two carriers such that the same frequency range can support both NR and LTE, and it will be up to the O-DU to assure that no RE is assigned to both LTE and NR at the same time.

###### Dynamic Spectrum Sharing (DSS) via Section Extension 9 for DSS

Using Section Extension 9 for DSS, the O-DU shall use a single eAxC\_ID (and hence a single endpoint) for conveying LTE and NR PRB allocations if the O-RU is capable of handling both LTE and NR processing using one endpoint (i.e. the O-RU indicates support for Section Extension 9). A single carrier shall be allocated to either LTE, NR or both, and supporting DSS in this manner means the carrier (to which the endpoint is assigned) shall be designated as supporting both. The O-DU shall indicate whether the PRB allocation information is applicable to LTE or to NR via Section Extension 9.

#### Channel information based beamforming

In the channel information based beamforming method, the O-DU shall provide channel information per UE periodically (generally less often than every slot) using Section Type 6 C-Plane message(s) and then on a slot-by-slot basis the O-DU shall provide scheduling information using Section Type 5 C-Plane message which the O-RU shall use along with the channel information to calculate the proper beamforming weights for the specific slot with its co- scheduled UEs. To reduce peak bandwidth, the transmission/ reception window constraints shall not apply to a Section Type 6 message. The O-RU is expected to use the latest possible available channel information for a ueId for channel information based beamforming operation i.e. the O-RU uses channel information for a ueId available to the O-RU at the end of receive window of a Section Type 5 message. The O-RU should store updated channel information for a ueId when it is received, to be used when that ueId is scheduled in future.

#### ACK/NACK Procedure for C-Plane Messages

If an O-RU reports its capability of supporting both Section Extension 22 and Section Type 8, then the O-DU may append a Section Extension 22 with an ackNackReqId to the section description to request for ACK/NACK feedback from the O-RU. SE 22 can be used with all Section Types and Section Extensions sent from O-DU to O-RU, except with Section Type 7. The O-DU shall not request O-RU to send from an endpoint more ACK/NACK feedbacks in a symbol than endpoint's capability reported by O-RU in M-Plane parameter **max-ack-nack-per-symbol**; that is, number of SE 22 instances in all C-Plane messages for one endpoint that address the same symbol with frameId, subframeId, slotId and startSymbolId shall not exceed the value of **max-ack-nack-per-symbol**. The O-RU may also report the capability of **nack-supported**; if it is reported as 'false', the O-DU shall assume that NACK feedback can not be reported by the O- RU and that only ACK feedback can be reported. The O-RU may also report the capability of max number of Section Extension 22 (ACK/NACK request) supported in a C-Plane message by **max-num-se22-per-cplane-message**. The O- DU shall not include more Section Extension 22 in a C-Plane message than the reported value.

If the O-RU receives one or more section description(s) with Section Extension 22, it shall send an ACK/NACK message (Section Type 8) to the O-DU, which contains the ACK feedback including ackId(s) for the section description(s) correctly received and correctly processed and not dropped. If the O-RU supports sending NACK feedback (nack-supported = true) and Section Extension 22 is present within the section description containing an O- RAN protocol error, then the O-RU shall drop the section description and send nackId(s) for the section description to the O-DU using Section Type 8. O-RU may send one or more ackIds and/or nackIds in one ST 8 message. The O-RU shall send ACK/NACK messages with frameId, subframeId slotId and symbolId set to values of frameId, subframeId, slotId and startSymbolId respectively received in the C-Plane message with the Section Extension 22.

The O-RU shall send ACK/NACK messages within the ACK transmit window, and the O-DU is expected to receive ACK/NACK messages within the ACK receive window. The ACK transmit/receive window is similar with UL U-Plane transmit/receive window as defined in clause 4.4.3, specifically as Figure 4.4.3-2, with the difference that the

parameters Ta3\_min\_ack and Ta3\_max\_ack can be negative values*,* i.e. Ta3\_min\_ack takes the place of Ta3\_min and Ta3\_max\_ack takes the place of Ta3\_max.

The O-DU populates a unique identifier for a section description in ackNackReqId in Section Extension 22 for the O- RU to use to report the ACK/NACK feedback. The O-RU shall indicate the ackNackReqId of correctly decoded section description in ackId field. The O-RU shall indicate the ackNackReqId of the incorrectly decoded section description in the nackId field of the ACK/NACK message, if the O-RU supports sending NACK feedback.

NOTE: Section descriptions after an erroneous and dropped section description might be impacted e.g. dropping of a symInc flag, and it is expected an O-DU, knowing a section description was dropped via receiving a NACK feedback, will understand the impact on subsequent section descriptions.

By the end of ACK receive window for a symbol M (where M is the value of startSymbolId in the C-Plane message which carries SE 22), if the O-DU receives the ACK/NACK message which contains the NACK (NACK means one of the nackId(s) equals to the ackNackReqId in Section Extension 22) for a section description, then the O-DU may interpret that there is an error in the section description sent for symbol M, and may retransmit the section description by reconstructing the information. If neither NACK feedback nor ACK feedback (ACK feedback means one of the ackId(s) equals to the ackNackReqId in Section Extension 22) for a section description is received by the O-DU by the end of the ACK receive window for symbol M, then the O-DU may interpret that either the C-Plane message containing section description with SE 22, for symbol M was lost or section descriptions within the C-Plane message sent for symbol M was dropped before Section Extension 22 is decoded, and the O-DU may choose to resend the lost section description and if so, shall appropriately update any required fields to ensure correct reception at the O-RU

In addition, if the O-DU receives the NACK feedback for C-Plane message(s) from O-RU before sending the corresponding U-Plane message(s), it may skip sending the U-Plane message(s) to reduce the fronthaul traffic. Figure 7.2.8-1 shows an example of this ACK/NACK procedure.

Dropped after SE 22 is decoded

![](../assets/images/a492411582e2.png)![](../assets/images/bfd933f1702e.png)![](../assets/images/5af1d45c7ebd.png)![](../assets/images/6cf394078810.png)![](../assets/images/7bfac9b20a98.png)![](../assets/images/3bf0ddfc1d91.png)![](../assets/images/d88884a98a17.png)![](../assets/images/d4ef6ea77e90.png)![](../assets/images/caafd0e6babb.png)![](../assets/images/2f22f6bc083c.png)

**O-RU**

**O-DU**

Lost, or dropped before SE 22 is decoded

Network Delay

End of C-plane receive window

Ta3\_min\_ack

Start of ACK transmit window

Over-the-ai r time for symbol M

T34\_min

Ta3\_max\_ack

Start of ACK receive window

T34\_max

End of ACK transmit window

O-DU recognizes SI2 is dropped

before decoding SE 22 and SI3 is dropped after SE 22 is decoded. O-DU may decide to re-transmit the dropped section descriptions

**Figure 7.2.8-1: Example of ACK/NACK procedure**

#### Section Type 4: Slot Configuration Control

###### Overview

Section Type 4 C-Plane message is used to send slot level configuration from the O-DU to the O-RU which may apply to all endpoints belonging to a carrier, all endpoints associated with a tx-array or rx-array or all the endpoints in the O- RU. Each Section Type 4 C-Plane message comprises of Section Type 4 common header followed by one or more Section Type 4 command type headers. Both Section Type 4 header and each command type shall be 4-byte aligned. 4- byte alignment shall also be applicable when multiple commands are present in a Section Type 4 C-Plane message.

Each command type shall comprise of a common header specifying st4CmdType, st4CmdLen, numSlots for which the configuration specified by the command applies, and ackNackReqId field. The common part of the command header is followed by command configuration-specific fields.

NOTE: Loss of ST 4 message especially with numSlots other than 1 (see clause 7.5.3.40) can have a lasting negative impact on the O-RU operation.

Every ST 4 command has a "command scope", indicated by the "cmdScope" field, which can be either CARRIER (applies to a single array-carrier), ARRAY (applies to a single tx-array or rx-array) or O-RU (applies to the whole O- RU). For each ST 4 command, the O-RU shall declare which command it supports as part of its O-RU capability report and shall further declare which of the valid scopes are supported for each ST 4 command. The valid command scopes are listed for each ST 4 command in the sub-clauses to clause 7.2.9.2.

###### Section Type 4 commands

* + - * 1. TIME\_DOMAIN\_BEAM\_CONFIG (Time-domain beamforming command)

This command is defined to send time-domain beamforming information from the O-DU to the O-RU. This command may be used by the O-DU for sending time-domain beamforming information to the O-RU and may also be used in the case of hybrid beamforming to send time-domain beamforming information separate from frequency-domain beamforming information. Refer to clause 12.4.3.4.4 to understand how redundancy is avoided when this command is used with Section Type 4.

This command provides the flexibility for sending time-domain beamforming weights. Here are some of the variants of this command configuration:

* Specify time-domain beam group with associated time-domain beam number and beamforming weights per time-domain beam number. Refer to Table 7.4.6-3.
* Specify time-domain beam group with time-domain beam number vector. Refer to Table 7.4.6-4.
* Specify time-domain beam group only. Refer to Table 7.4.6-5.

Because the values of beamforming weights never expire, the value of numSlots should be set to zero for this command type and the O-RU shall apply the beamforming configuration until the configuration is changed by a subsequent message.

Time-domain beam weights are applied to a specific tx-array or rx-array. Hence, only cmdScope "ARRAY- COMMAND" is valid for this ST 4 command. When using cmdScope of ARRAY-COMMAND, the largest overlapping array (belonging to the endpoint assigned the eAxC\_ID in the command header), not a sub-array of a larger overlapping array, shall be specified as the subject of the command, which will apply to the whole array including any sub-arrays.

The C-Plane message with Section Type 4 TIME\_DOMAIN\_BEAM\_CONFIG command shall apply to the direction specified by dataDirection bit in the Section Header.

* + - * 1. TDD\_CONFIG\_PATTERN (TDD configuration command)

This command may be used to send TDD UL, DL, and guard symbol configuration as an alternative to using the dataDirection bit in the C-Plane message. It enables support of semi-static and dynamic TDD use cases. Using this command enables the O-RU to know TDD configuration for an entire slot and also a set of consecutive slots (if 'numSlots > 0' refer to clause 7.5.3.40). If 'numSlots' in the Section Type 4 header is set to the value of zero, TDD\_CONFIG\_PATTERN sent in the respective 'slotID' shall last till the next Section Type 4 message with modified TDD\_CONFIG\_PATTERN is sent to the O-RU. If 'numSlots' is set to a non-zero value, the TDD configuration shall only last for the value specified by numSlots.

If Section Type 4 C-Plane message with TDD\_CONFIG\_PATTERN command is followed by C-Plane message using Section Type 0, 1, 3, 5, 6 which specifies symbol direction using 'dataDirection' bit, O-DU shall set 'dataDirection' bit direction to align with TDD configuration specified in TDD\_CONFIG\_PATTERN. Refer to clause 12.4.3.4.4 for details.

The C-Plane message with Section Type 4 TDD\_CONFIG\_PATTERN command shall apply to both UL and DL (as specified in Table 7.5.2.17-1) regardless of the direction specified by the dataDirection bit in the section header.

TDD configuration shall not conflict between carriers using the same antenna panel. Hence, cmdScope CARRIER- COMMAND is not valid for this ST 4 command and shall not be used. When using cmdScope of ARRAY- COMMAND, the largest overlapping array (belonging to the endpoint assigned the eAxC\_ID in the command header), not a sub-array of a larger overlapping array, shall be specified as the subject of the command, which will apply to the whole array including any sub-arrays. This is to avoid having different TDD patterns applied to portions of the same array.

* + - * 1. TRX\_CONTROL (transmission/reception control for energy saving)

This command is defined to allow energy saving by disabling ("putting to sleep") some or all array elements in a tx- array or rx-array (or both). In the command an antenna mask is provided to indicate which array elements are to be put to sleep or woken up. As well, different sleep modes may be supported. Details regarding how this may be done are provided in clause 16.

TRX\_CONTROL applies to antenna arrays. Hence, the only valid cmdScope is ARRAY-COMMAND. When using the TRX\_CONTROL command, the largest overlapping array (belonging to the endpoint assigned the eAxC\_ID in the command header), not a sub-array of a larger overlapping array, shall be specified as the subject of the command, which will apply to the whole array including any sub-arrays. This is to avoid having a pattern of asleep and awake array elements that violates valid antenna masks.

* + - * 1. ASM (Advanced Sleep Mode)

This command is defined to allow energy saving by disabling ("putting to sleep") array carriers, tx-arrays or rx-arrays or the whole O-RU. When the command is issued it pertains to all array elements in the affected tx-array or rx-array. As well, different sleep modes may be supported. Details regarding how this may be done are provided in clause 16.

Valid cmdScope values for the ASM command are CARRIER-COMMAND, ARRAY-COMMAND, and O-RU- COMMAND. When using the ASM command with CARRIER-COMMAND cmdScope, only the specified carrier (the carrier assigned to the endpoint assigned to the eAxC\_ID in the command header) shall be impacted by the ASM command. When using the ASM command with ARRAY-COMMAND cmdScope, the largest overlapping array (tx- array-carrier, rx-array-carrier, tx-array or rx-array belonging to the endpoint assigned the eAxC\_ID in the command header), not a sub-array of a larger overlapping array, shall be specified as the subject of the command, which will apply to the whole array including any sub-arrays. This is to avoid having a pattern of asleep and awake array elements that violates valid antenna masks.

###### ACK/NACK feedback support

If the O-DU requests the O-RU to provide ACK/NACK feedback for a given command and if the O-RU supports Section Type 8 C-Plane message, O-DU shall set 'ackNackReqId' to a non-zero value. Supporting ACK/NACK feedback for Section Type 4 is similar to using SE 22 in conjunction with Section Type 8 with two differences:

1. Instead of using SE 22 to request Section Type 8 C-Plane message from O-RU, the Section Type 4 message command common header has the field 'ackNackReqId' to request for Section Type 8 message from the O-RU.
2. The granularity of requesting ACK/NACK feedback from O-RU is per Section Type 4 command instead of per section header when SE 22 is used with ST 0, 1, 3, 5, 6.

###### O-RU handling

If the O-RU supports Section Type 4, support for this Section Type and associated command type shall be indicated by the O-RU on a per endpoint basis using M-Plane parameters for Section Type 4. Each Section Type 4 'cmdScope' value shall be associated with a bitmask 'st4-reception-mask' defined in M-Plane. The C-Plane reception window for Section Type 4 C-Plane messages shall be determined from the bits set to '1' in the 'st4-reception-mask'. The value of 'startSymbolId' shall be equal to the symbol number set to '1' in the M-Plane bitmask 'st4-reception-mask'. If the O-RU receives a Section Type 4 message which is not aligned with 'st4-reception-mask', the O-RU shall drop the Section Type 4 message. If a Section Type 4 command is invoked more than once within a slot for the same 'cmdScope', the value of 'startSymbolId' for each invocation shall be equal to the corresponding symbol set to '1' in per command scope 'st4-reception-mask'.

###### Latency requirements

To ensure adequate time for processing a Section Type 4 message with a given 'cmdScope' value, the O-DU shall send the message to the Section Type 4 supporting endpoint with the earliest reception window (largest value 'T2a\_min\_cp\_ul/dl') of all those endpoints impacted by the message. In the case of multiple O-DUs sharing RF circuits within a single O-RU, a specific O-DU may need to send the Section Type 4 message to assure the rx-window is sufficiently early to allow all endpoints to correctly process the message.

#### DMRS based beamforming

In the DMRS based beamforming method, the O-DU provides DMRS configuration information to the O-RU on a slot- by-slot basis for each user group (see clause 3.1 for the definition of "user group"). The O-RU uses that information to extract DMRS data from uplink received data, then computes weights for beamforming or weights for beamforming with equalization based on extracted DMRS data which are applied to the associated uplink PUSCH data. This allows an improvement in the PUSCH performance, as compared to beamforming using SRS-based weights, because the weights are based on the exact same interference environment, reflected in the DMRS data, as is experienced by the PUSCH data and optionally DMRS data. As well, a reduction in uplink fronthaul throughput may be expected because user data layers, as opposed to spatial streams, may be conveyed on the uplink fronthaul, and there are generally fewer data layers than there are spatial streams. In addition, the omission of conveyance of uplink beamforming weights from O-DU to O-RU may result in a downlink fronthaul throughput reduction. Refer to clause 12.6 for a more detailed description of DMRS based beamforming.

#### SINR reporting

The post-equalization SINR (signal-to-interference-plus-noise-ratio, see clause 12.6.3.4) is useful for the O-DU when DMRS-BF-EQ (DMRS-based beamforming with equalization) is used and sending of DMRS symbols to the O-DU is not enabled. If the O-RU's RX endpoint is configured for DMRS-BF-EQ and sending of DMRS symbols is not enabled

,or if the O-RU supports concurrent sending of DMRS symbols and SINR data, then O-DU may enable SINR reporting. If SINR reporting is enabled, the O-DU shall configure the SINR reporting resolution in both frequency and time by setting a pair of M-Plane parameters: sinr-per-prb (number of SINR values per PRB) and sinr-slot-mask (a bitmask represented as an integer with bits indicating symbol pattern of SINR reports per slot) following the O-RU's capability

reported via M-Plane per RX endpoint type in a list supported-sinr-resolutions. If the O-RU supports O-RU controlled time resolution for SINR reporting (see M-Plane YANG feature **ORU-CONTROL-SINR-TIME-RESOLUTION**) and the O-DU configures to use it (O-DU shall enable both SINR reporting and O-RU controlled time resolution for SINR reporting by setting **sinr-reporting-enabled** to true and setting **oru-control-sinr-time-resolution-enabled** to true, respectively), the O-DU shall configure a list of sinr-slot-mask values (via M-Plane parameter **sinr-slot-masks**) that the O-RU can dynamically use. The O-RU will determine and use one of the sinr-slot-mask values in the configured list for each SINR report. The used sinr-slot-mask value is indicated in the common header of each ST 9 message, which is applied to the SINR reports in all sections of a ST 9 message. The SINR reports using different sinr- slot-mask values shall be sent in different ST 9 messages. The configured list of sinr-slot-mask values if used shall follow the O-RU's capability reported via M-Plane per RX endpoint type in a list **supported-sinr-resolutions**. Any sinr-slot-mask value in the configured list shall be one of the values listed in the list **supported-sinr-resolutions**. If the

O-DU controlled frequency resolution for SINR reporting is supported by the O-RU, and the O-DU configures to use it, the O-DU may configure the SINR reporting resolution in frequency to O-RU by SE 28, and the O-RU shall use the value of numSinrPerPrb received in SE 28 for frequency resolution of SINR reporting. The used numSinrPerPrb value is indicated in the common header of each ST 9 message, which is applied to the SINR reports in all sections of a ST 9 message. The SINR reports using different numSinrPerPrb values shall be sent in different ST 9 messages.

An entry in the M-Plane list supported-sinr-resolutions conveys combinations of sinr-per-prb and sinr-slot-mask values supported by the O-RU when number of data layers scheduled in any user group does not exceed a maximum value reported in sinr-max-data-layers. The entry in the list supported-sinr-resolutions includes: a list of sinr-per-prb values, a list of sinr-slot-mask values that are supported by the O-RU (an empty list of sinr-slot-mask values indicates support for every mask), and sinr-max-data-layers (the maximum number of data layers for which the entry in supported-sinr- resolutions is applicable). The value of sinr-per-prb shall be an integer divisor of 12 (i.e. 1, 2, 3, 4, 6 or 12). The value sinr-slot-mask shall be a bitmask represented as an integer with bits bm for m = 0, 1, 2, ..., 13 (where b0 is least significant bit representing the earliest-arriving symbol of the slot on the air interface) indicating SINR report in symbol m if bm = 1, and no SINR report in symbol m otherwise. An endpoint supporting DMRS-BF-EQ shall support at least SINR resolution of "one SINR value per PRB once per slot" (sinr-per-prb = 1, sinr-slot-mask = 1) for any supported number of data layers.

When SINR reporting is configured, then the O-RU shall report SINR to the O-DU for every layer, PRB, and slot where DMRS-BF-EQ reception was requested (more details on time and frequency resolution of SINR reporting are provided further in this clause). The O-RU shall send layer specific SINR data to the O-DU in C-Plane messages of Section Type 9 (see clause 7.4.11) using the eAxC specific to the layer. Further in this clause the descriptions consider one eAxC (one layer) and shall apply separately to every eAxC with DMRS-BF-EQ reception requested.

SINR data conveyed in ST 9 are used together with equalized IQ data in demodulation and decoding (see clause 12.6.3.1). SINR data in ST 9 shares many properties with IQ data in U-Plane: SINR data reporting follows time constraints defined for uplink U-Plane in clause 4.4.3 (to avoid impact on demodulation latency), SINR data format follows format of U-Plane (to allow application-level fragmentation and low-latency processing of data sections), C- Plane and U-Plane coupling methods are applicable to SINR data as if ST 9 was carrying uplink U-Plane data. While ST 9 section header includes parameters startPrbu and numPrbu to enable application of C-Plane and U-Plane coupling methods to ST 9, the values of the parameters need not to be the same as the values in U-Plane message e.g. when application layer fragmentation (see clause 5.5.2) is used for U-Plane or ST 9.

The per-window symbol reordering and per-section tx-window reassignment defined in clause 12.6.1.5 are methods for altering the order of symbol data within uplink U-Plane messages and apply to messages with SINR data in the same way as for U-Plane messages (see clauses 4.4.3 and 7.7.25 for further details). The C-Plane messages carrying SINR data shall be transmitted by the O-RU within transmit windows defined in clause 4.4.3 with the following restrictions only on use of per-window symbol reordering (see clause 12.6.1.5) with SINR data reporting:

* Enabling of per-window symbol reordering and SINR data reporting at the same time is permitted when the O-RU endpoint supports DMRS-BF-EQ, per-window symbol reordering and concurrent sending of DMRS

symbols and SINR data, the endpoint is configured for DMRS-BF-EQ and DMRS symbols sending is enabled.

* Enabling of per-window symbol reordering and SINR data reporting at the same time is permitted when the

O-RU endpoint supports DMRS-BF-EQ and per-window symbol reordering without sending DMRS symbols, the endpoint is configured for DMRS-BF-EQ and DMRS symbols sending is not enabled.

NOTE: The restrictions defined above for per-window symbol reordering do not apply to per-section tx-window reassignment.

Unless specified otherwise the following descriptions and examples assume per-window symbol reordering and per-section tx-window reassignment are not in use.

The relationship between SINR data conveyed in a data section in ST 9 message and the C-Plane messages commanding DMRS-BF-EQ reception is called coupling. SINR data shares many properties with IQ data conveyed in U-Plane therefore SINR reporting uses one of the C-Plane and U-Plane coupling methods described in clause 7.8.1, and for application of a coupling method the ST 9 C-Plane messages shall be treated as U-Plane messages. Therefore, the C- Plane messages requesting UL reception with DMRS-BF-EQ and ST 9 C-Plane messages conveying SINR data for requested UL PRBs are coupled. The parameters sectionId, rb, symInc, startPrbu, numPrbu in the data section header in ST 9 message are handled as the corresponding parameters in U-Plane message data section header. If the C-Plane messages requested DMRS-BF reception of a non-contiguous PRB ranges, SINR data for each contiguous PRB range shall be conveyed in a separate ST 9 section. This does not restrict optimization defined in clause 8.4.1, the optimization applies to ST 9 when the appropriate coupling method is used in which case rules defined in clause 8.4.1 for U-Plane messages apply to ST 9 messages.

Depending on the SINR time resolution configured in the M-Plane parameter sinr-slot-mask, or the SINR time resolution determined by the O-RU and indicated in each ST 9 message if O-RU controlled time resolution for SINR reporting is supported by the O-RU and enabled by the O-DU, SINR data is reported one or more times per slot. When O-RU controlled time resolution for SINR reporting is supported by the O-RU and enabled by the O-DU, the O-RU shall use the same time resolution for all PRBs and symbols of the layers of the same UE in a slot, regardless of whether the UE is scheduled in one user group or multiple user groups. The O-RU shall report SINR data in a ST 9 message for symbol S + m when bm = 1. Here m = 0, ..., M - S, where S and M are the first and last symbols respectively, allocated to UE for which DMRS-BF-EQ reception was requested.

The SINR data reported for a symbol S + m is applicable to:

* Symbol S + m when m = M - S (the last allocated symbol) or bm+1 = 1 (SINR data report is configured for the following symbol).
* Contiguous range of symbols S + m, S + m + 1, S + m + 2, ..., when SINR data report is not configured for symbols S + m + 1, S + m + 2, ... (bm+1, bm+2, ..., are all 0).

The O-RU shall report SINR for symbol S + m if the corresponding bit bm in sinr-slot-mask value is 1 and any of the symbols where the SINR reported for the symbol S + m is applicable contains PUSCH data. The O-RU shall not report SINR for symbol S + m if the corresponding bit bm in sinr-slot-mask value is 0 or all the symbols where the SINR reported for the symbol S + m is applicable do not contain PUSCH data.

Regardless of the SINR reporting granularity, the calculation of SINR is an implementation choice of the O-RU. For example, when the reporting granularity of SINR is every two REs and every two symbols, the calculation of SINR may use the REs and symbols inside and/or outside the reported RE range and symbol range.

Example 1: With sinr-slot-mask = 0x0001 (00 0000 0000 0001b) and DMRS-BF-EQ reception requested for the whole slot, the reported SINR values reported for PRBs apply to the whole slot (all symbols in a slot) and are sent in messages with symbolId = 0.

Example 2: With sinr-slot-mask = 0x0081 (00 0000 1000 0001b) and DMRS-BF-EQ reception requested for the whole slot, the reported SINR values reported for PRBs apply to the respective half slots (symbols in the first half of a slot and symbols in the second half of a slot) and are sent in messages with symbolId = 0 and symbolId = 7. Figure 7.2.11-1 illustrates this example.

Configured value of sinr-slot-mask = 0x81 (00 0000 1000 0001b)

|  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 | 12 | 13 |

Set bits are indicated by dark shaded bits

SINR reported in symbols (lighter shade indicates other symbols where SINR is applicable)

13

12

11

10

9

8

7

6

5

4

3

2

1

0

S Allocated symbols M

**Figure 7.2.11-1: Example 2 of SINR reporting in Section Type 9 with sinr-slot-mask = 0x81 and allocation spanning symbols 0 to 13**

Example 3: With sinr-slot-mask = 0x3FFF (11 1111 1111 1111b) and DMRS-BF-EQ reception requested for the whole slot, the reported SINR values reported for PRBs apply to the respective symbols and are sent in messages with symbolId = 0 to 13 if PUSCH is multiplexed with DMRS. If PUSCH is not multiplexed with DMRS then SINR is not reported for symbols with DMRS.

Example 4: With sinr-slot-mask = 0x3FFF (11 1111 1111 1111b) and DMRS-BF-EQ reception requested for symbols 7 to 13, the reported SINR values reported for PRBs apply to the respective symbols and are sent in messages with symbolId = 7 to 13 if PUSCH is multiplexed with DMRS. If PUSCH is not multiplexed with DMRS then SINR is not reported for symbols with DMRS.

Example 5: With sinr-slot-mask = 0x0081 (00 0000 1000 0001b) and DMRS-BF-EQ reception requested for symbols 7 to 13, the reported SINR values reported for PRBs apply to the respective symbols and are sent in messages with symbolId = 7. Figure 7.2.11-2 illustrates this example.

Configured value of sinr-slot-mask = 0x81 (00 0000 1000 0001b)

|  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 | 12 | 13 |

Set bits are indicated by dark shaded bits

SINR reported in symbols (lighter shade indicates other symbols where SINR is applicable)

|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 | 12 | 13 | |
|  | | | | | | | | | | | | | |  |

S Allocated symbols M

**Figure 7.2.11-2: Example 5 of SINR reporting in Section Type 9 with sinr-slot-mask = 0x81 and allocation spanning symbols 7 to 13**

Example 6: With sinr-slot-mask = 0x0081 (00 0000 1000 0001b) and DMRS-BF-EQ reception requested for symbols 2 to 13, the reported SINR values reported for PRBs apply to the respective symbols and are sent in messages with symbolId = 2 and symbolId = 9. Figure 7.2.11-3 illustrates this example.

Configured value of sinr-slot-mask = 0x81 (00 0000 1000 0001b)

|  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 | 12 | 13 |

Set bits are indicated by dark shaded bits

SINR reported in symbols (lighter shade indicates other symbols where SINR is applicable)

|  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 | 12 | 13 |

S Allocated symbols M

**Figure 7.2.11-3: Example 6 of SINR reporting in Section Type 9 with sinr-slot-mask = 0x81 and allocation spanning symbols 2 to 13**

Example 7: With sinr-slot-mask = 0x0891 (00 1000 1001 0001b) and DMRS-BF-EQ reception requested for symbols 3 to 13, the reported SINR values reported for PRBs apply to the respective symbols and are sent in messages with symbolId = 3, symbolId = 7 and symbolId = 10. Figure 7.2.11-4 illustrates this example.

Configured value of sinr-slot-mask = 0x891 (00 1000 1001 0001b)

|  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 | 12 | 13 |

Set bits are indicated by dark shaded bits

SINR reported in symbols (lighter shade indicates other symbols where SINR is applicable)

|  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 | 12 | 13 |

S Allocated symbols M

**Figure 7.2.11-4: Example 7 of SINR reporting in Section Type 9 with sinr-slot-mask = 0x891 and allocation spanning symbols 3 to 13**

Depending on the configured SINR frequency resolution, sinr-per-prb SINR values are reported per PRB. Each reported SINR value applies to a range of subcarriers in a PRB obtained by dividing a PRB (12 subcarriers) into sinr-per-prb subcarrier blocks and each subcarrier block contains the same number of consecutive subcarriers, i.e. 12/sinr-per-prb subcarriers in each subcarrier block. The SINR values apply to blocks of subcarriers in order of occurrence of SINR values in a PRB such that the first SINR value in a PRB applies to the block of subcarriers at lowest frequency. The

O-RU shall report SINR with the configured frequency resolution regardless of DMRS configuration and whether a block of subcarriers contains PUSCH.

Example 8: With sinr-per-prb = 1 there is 1 SINR value reported per PRB. The SINR value reported for a PRB applies to the whole PRB (12 subcarriers).

Example 9: With sinr-per-prb = 2 there are 2 SINR values reported per PRB. The SINR values reported for a PRB apply to the respective halves of a PRB (blocks of 6 subcarriers) i.e. the first SINR value in a PRB applies to subcarriers 0-5 and the second SINR value a PRB applies to subcarriers 6-11.

Example 10: With sinr-per-prb = 12 there are 12 SINR values reported per PRB. The SINR values reported for a PRB apply to the respective subcarriers in a PRB i.e. the first SINR value in a PRB applies to subcarrier 0, the second SINR value in a PRB applies to subcarrier 1, the third SINR value in a PRB applies to subcarrier 2, etc.

The format of SINR data is static (i.e. it is configured via M-Plane as part of carrier creation) and the configuration for format of SINR data is independent of configuration for uplink U-Plane IQ data. The O-RU shall report supported SINR data formats by listing supported combinations of compression method (block floating point or uncompressed), bitwidth and optionally block size in M-Plane parameters: sinr-compression-method, sinr-bitwidth and sinr-block-size. Omission of block size indicates SINR data format without zero-padding to align number of values per PRB to block size. The O- RU shall support block floating point without block size (i.e. SINR reporting with sinr-per-prb SINR values per PRB without zero-padding to align number of values per PRB to the block size larger than sinr-per-prb). The O-RU may support uncompressed and block floating point formats with block size.

The O-DU configures format of SINR data via M-Plane with configuration selecting a supported combination of compression method, bitwidth, and optionally block size in M-Plane parameters: sinr-compression-method, sinr- bitwidth and sinr-block-size. If block size is configured by the O-DU then the O-DU shall ensure that configured block size is sufficient to convey the configured number of SINR values i.e. ensure that sinr-block-size >= sinr-per-prb.

The O-RU shall report supported range of SINR reference level with M-Plane parameters sinr-reference-level-min and sinr-reference-level-max. The O-DU shall configure the SINR reference level via M-Plane parameter sinr-reference- level-config (in dB). The O-RU shall report SINR reference level used (the best approximation of the sinr-reference- level-config) in the read-only M-Plane parameter sinr-reference-level-used.

For each SINR report in a slot, and every PRB where DMRS-BF-EQ reception was requested, the post-equalization SINR values are packed into PRB fields of a ST 9 message as per the following procedure.

For purpose of applying Block Floating Point compression procedure defined in Annex A.1 the SINR values (real numbers) are mapped to a vector of complex values fPRB expected by the compression procedure.

For k = 0 to 11:

if 2k < N then Re(fPRB(k+1)) = SINRFH else Re(fPRB(k+1)) = 0

2k

if 2k+1 < N then Im(fPRB(k+1)) = SINRFH else Im(fPRB(k+1)) = 0

2k+1

where:

N is number of SINR values per PRB configured via M-Plane parameter sinr-per-prb,

fPRB(k) for k = 1, ..., 12 is complex number (input of the compression algorithm in Annex A.1), Re(x) and Im(x) are respectively real and imaginary parts of complex number x,

SINRFH for n = 0, ..., N-1 are scaled post-equalization SINR values (real numbers) calculated for a layer, such that the SINR value corresponding to the value reported in the M-Plane parameter sinr-reference-level-used is mapped to the interface resolution of the data format selected via M-Plane

n

sinr-reference-level-used

n

SINRFH = 10- 10 x SINRn,

SINRn for n = 0, ..., N-1 are post-equalization SINR values before scaling (see clause 12.6.3.4).

The IQ compression defined for U-Plane in Annex A.1 is applied on fPRB, with format parameters configured via M- Plane for SINR data. The output of the compression procedure cPRB (vector of 12 complex numbers) is mapped to parameters in the ST 9.

For k = 0 to floor((Z-1)/2):

if 2k < Z then sinrValue2k = Re(cPRB(k+1))

if 2k+1 < Z then sinrValue2k+1 = Im(cPRB(k+1)) where:

Z is number of SINR values per PRB configured via M-Plane parameter sinr-per-prb if sinr-block-size is not configured or size of SINR block configured via M-Plane parameter sinr-block-size if sinr-block-size is configured,

floor(x) is the greatest integer less than or equal to x, sinrValuez for z = 0, ..., Z-1 is SINR value in ST 9,

cPRB(k) for k = 1, ..., 12 is compressed complex number (output of the compression algorithm in Annex A.1), Re(x) and Im(x) are respectively real and imaginary parts of complex number x.

The sinrCompParam and N SINR values are present in the parameter(s) sinrValuez for z=0, ..., N-1 for each PRB. When sinr-block-size is configured, if Z > N then Z-N zero values (zero-padding) are added in sinrValuez for z=N, ..., Z-1. A bit-padding is inserted per PRB after the last sinrValuez if necessary to align the next PRB with the octet boundary.

Example 11: If sinr-per-prb = 3 and sinr-block-size is not configured, then a PRB in Section Type 9 section will contain sinrCompParam, sinrValue0 for the 1st SINR value, sinrValue1 for the 2nd SINR value and sinrValue2 for the 3rd SINR value. Each SINR value applies to a block of 4 subcarriers. DMRS configuration has no effect on how SINR data is reported per PRB (when the O-RU sends SINR for a PRB then the O-RU always sends number of SINR values per PRB configured via M-Plane; this does not preclude the O-RU from not sending SINR that is not applicable to any PUSCH data). Figure 7.2.11-5 shows example of mapping of SINR values to sinrValuen values and application of SINR values to subcarriers for sinr-per-prb = 3.

A PRB in Section Type 9

iSample 1 qS

SINR 0 S

ample 1 iSampl

INR 1 SINR

e 2 qSample 2

2 SINR 3

|  |  |  |  |  |
| --- | --- | --- | --- | --- |
| sinrCompParam | sinrValue0 | sinrValue1 | | sinrValue2 |
|  | | |  | |

|  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 |

Subcarriers in the PRB where SINR is applicable

**Figure 7.2.11-5: Example 11 of SINR reporting in Section Type 9 with sinr-per-prb = 3**

Example 12: If sinr-per-prb = 4 and sinr-block-size is not configured, then a PRB in Section Type 9 section will contain sinrCompParam, sinrValue0 for the 1st SINR value, sinrValue1 for the 2nd SINR value, sinrValue2 for the 3rd SINR value and sinrValue3 for the 4th SINR value. Each SINR value applies to a block of 3 subcarriers. DMRS configuration has no effect on how SINR data is reported.

Figure 7.2.11-6 shows example of mapping of SINR values to sinrValuen values and application of SINR values to subcarriers for sinr-per-prb = 4.

A PRB in Section Type 9

0

1

2

3

4

5

6

7

8

9

10

11

|  |  |  |  |  |
| --- | --- | --- | --- | --- |
| sinrCompParam | sinrValue0 | sinrValue1 | sinrValue2 | sinrValue3 |

Subcarriers in the PRB where SINR is applicable

**Figure 7.2.11-6: Example 12 of SINR reporting in Section Type 9 with sinr-per-prb = 4**

For purpose of applying uncompressed format SINR values (real numbers) are mapped to parameters in ST 9. For z = 0 to Z-1:

if z < N then sinrValuez = SINRFH else sinrValuez = 0

z

where:

N is number of SINR values per PRB configured via M-Plane parameter sinr-per-prb,

Z is number of SINR values per PRB configured via M-Plane parameter sinr-per-prb if sinr-block-size is not configured or size of SINR block configured via M-Plane parameter sinr-block-size if sinr-block-size is configured,

sinrValuez for z = 0, ..., Z-1 is SINR value in ST 9,

SINRFH for n = 0, ..., N-1 are scaled post-equalization SINR values (real numbers) calculated for a layer, such that the SINR value corresponding to the value reported in the M-Plane parameter sinr-reference-level-used is mapped to the interface resolution of the data format selected via M-Plane

n

sinr-reference-level-used

n

SINRFH = 10- 10 x SINRn,

SINRn for n = 0, ..., N-1 are post-equalization SINR values before scaling (see clause 12.6.3.4).

The N SINR values are present in the parameter(s) sinrValuez for z=0, ..., N-1 for each PRB. When sinr-block-size is configured, if Z > N then Z-N zero values (zero-padding) are added in sinrValuez for z=N, ..., Z-1. A bit-padding is inserted per PRB after the last sinrValuez if necessary to align the next PRB with the octet boundary.

## Elements for the C-Plane protocol

#### Section Types

C-Plane messages shall be encapsulated using a two-layered header approach. The first layer consists of an eCPRI common header or IEEE 1914.3 common header, including corresponding fields used to indicate the message type, while the second layer is an application layer including necessary fields for control and synchronization. Within the application layer, a "section" defines the characteristics of U-Plane data to be transferred or received from a beam with one pattern id. In general, the transmission header, application header, and sections shall be aligned on 4-byte boundaries (but see the exception for Section Type 6 and Section Type 9 below) and are transmitted in "network byte order" meaning the most significant byte of a multi-byte parameter is transmitted first.

When the optional "little endian byte order" is chosen via M-Plane, the beamforming weights (Section Type 1,3 or 4, and Section Extension 1, 11 or 19) and ciIsample/ciQsample (Section Type 6) fields shall use little endian byte order to transmit the complex numbers. Annex D.2 shows little endian byte order format for various IQ data bitwidths.

Table 7.3.1-1 describes the Section Types that are supported within the C-Plane.

**Table 7.3.1-1: Section Types**

|  |  |  |
| --- | --- | --- |
| **Section Type** | **Target Scenario** | **Remarks** |
| 0 | Unused Resource Blocks or symbols in Downlink or Uplink | Indicates to the O-RU that certain Resource Blocks or symbols will not be used (idle periods, guard periods). Likewise, there are no associated U-Plane messages containing IQ data for this Section Type. The purpose is to inform the O-RU that transmissions may be halted during the specified idle interval for e.g. power-savings or to provide an interval  for calibration. |
| 1 | Most DL/UL radio channels (NOTE) | Here "most" refers to channels not requiring time or frequency offsets such as are needed for mixed-numerology channels |
| 2 | Reserved for future use |  |
| 3 | PRACH and mixed-numerology channels (NOTE) | Channels requiring time or frequency offsets or different-than-nominal SCS values |
| 4 | Slot Configuration Control | Slot configuration for multiple eAxC\_IDs with one or multiple Section Type 4 configuration commands |
| 5 | UE scheduling information (ueId assignment to section) | Provides scheduling information for ueIds |
| 6 | Channel information | Sends UE-specific channel information from the O-DU to the O-RU |
| 7 | LAA | Messages communicated between O-DU and the O-RU in both directions to configure LBT for PDSCH/DRS transmission and to report  the LBT outcome. |
| 8 | ACK/NACK Feedback | Sent from the O-RU to the O-DU, providing ACK/NACK feedback for section descriptions in C-Plane messages |
| 9 | SINR reporting | Reporting of post-equalization SINR values to the O-DU; applicable for DMRS-BF-EQ |
| 10 | RRM measurement reports | RRM measurement report sent from O-RU to O-DU. Multiple reports of different types can be sent in the same section. |
| 11 | Request RRM measurements | Sent by O-DU to request O-RU to perform one or more RRM measurements. |
| 12-255 | Reserved for future use |  |
| NOTE: When PRACH having same numerology as other UL channel, Section Type 1 can alternatively be used by O-DU for PRACH signalling. In this case, the O-RU is not expected to perform any PRACH specific processing. | | |

By default, Section Type 6 is 1-byte aligned instead of 4-byte aligned. In the present document, the O-RU may optionally support a Boolean flag "st6-4byte-alignment-required" to indicate support for 4-byte aligned Section Type 6 as part of the O-RU's M-Plane capability exchange. If the O-RU sets "st6-4byte-alignment-required=true", the O-DU shall provide Section Type 6 messages according to Table 7.4.8-1 with the octets shown as "<padding with zeros to the next 4-byte boundary>" included.

However, if the O-RU sets Boolean flag "st6-4byte-alignment-required=false" or the O-DU does not receive this Boolean flag, then the O-DU shall provide Section Type 6 messages according to Table 7.4.8-1 with the octets shown as "<padding with zeros to the next 4-byte boundary>" not included.

The parameter value true or false for "st6-4byte-alignment-required" applies to all Section Type 6 messages that the O-DU may send to the O-RU.

The network operator should ensure that the O-DU in the network is prepared to conform to the possible presence of the O-RU's M-Plane capability flag "st6-4byte-alignment-required", or the network operator should ensure that the O-RUs connected to the O-DU that is not prepared to conform to the O-RU's 4-byte aligned Section Type 6 capability indicated by "st6-4byte-alignment-required" flag will properly process 1-byte-aligned Section Type 6 messages.

Section Type 9 is 1-byte aligned instead of 4-byte aligned. For more details on Section Type 9 format refer to clauses

7.4.11 and 7.2.11.

#### Section Extensions

Within a data section description, the section header may include an "extension flag" which indicates parameters that apply to the section beyond those within the section header (the extension flag is often adjacent to the beamId or ueId fields). The presence of this extension flag indicates that following the header, a Section Extension is present. Within the Section Extension is another extension flag, adjacent to the "extType" field, which indicates that a second (or third, etc.) extension is present. In this way any number of Section Extensions may be included within a data section. This provides an extensibility for section parameters without the need to continually redefine the section header or create new Section Types to accommodate future fronthaul specification needs.

The Section Extension takes the form reminiscent of "TLV": there is a type field specifically "extType" which is a 7-bit field describing the specific extension type, then a one-byte (sometimes 2 bytes) length field specifically "extLen" detailing how many 4-byte words are contained in the extension (minimum of 1 including the "extType" and "extLen" fields), and then some number of parameters that depend on the "extType" value for their definition. In all cases the Section Extension shall be an integer number of (4-byte) words in length.

Specific valid values of "extType", their meanings and their associated parameters are detailed in clause 7.7.

## Section Type elements

#### Overview

A common frame format shall be used for C-Plane messages, consisting of a transport layer (see clause 5.1.3) and an application layer. The application layer is within the transport layer payload and shall consist of a common header for time reference, followed by information and parameters dependent and specific to the Section Type in use. Multiple sets of section data of the same Section Type value can be lined up one after another within the payload. To minimize packet rate over the interface, transmitter should fill messages with as many subsequent sections (with or without sequential section IDs) as possible. However, sets of section data of different Section Type values shall be sent via separate messages (i.e. different values of Section Type shall not be mixed within a single C-Plane message payload). When using Section Types, the formats shown in following clauses shall be used.

#### Section Type 0 elements

Section Type 0 is used for indicating idle or guard periods from O-DU to O-RU; see Table 7.4.2-1

* Common Header Fields:
  + **dataDirection** (data direction (gNB Tx/Rx)) field: 1 bit**.**
  + **payloadVersion** (payload version) field: 3 bits:
    - value = 1 shall be set (1st protocol version for payload and time reference format).
  + **filterIndex** (filter index) field: 4 bits.
  + **frameId** (frame identifier) field: 8 bits.
  + **subframeId** (subframe identifier) field: 4 bits.
  + **slotID** (slot identifier) field: 6 bits.
  + **startSymbolId** (start symbol id) field: 6 bits.
  + **numberOfsections** (number of sections) field: 8 bits.
  + **sectionType** (Section Type) field: 8 bits:
    - value = 0 shall be set.
  + **timeOffset** (time offset) field: 16 bits.
  + **frameStructure** (frame structure) field: 8 bits.
  + **cpLength** (cyclic prefix length) field: 16 bits.
  + **reserved** (reserved for future use) field: 8 bits.
* Section Fields:
  + **sectionId** (section identifier) field: 12 bits.
  + **rb** (resource block indicator) field: 1 bit.
  + **symInc** (symbol number increment command) field: 1 bit.
  + **startPrbc** (starting PRB of data section description) field: 10 bits.
  + **numPrbc** (number of contiguous PRBs per data section description) field: 8 bits.
  + **reMask** (resource element mask) field: 12 bits.
  + **numSymbol** (number of symbols) field: 4 bits.
  + **ef** (extension flag) field: 1 bit.
  + **reserved** (reserved for future use) field: 15 bits.

**Table 7.4.2-1: Scheduling and beamforming commands frame format (Section Type 0)**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **Section Type 0: idle / guard periods** | | | | | | | | | |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **# of bytes** |  |
| transport header, see clause 5.1.3 | | | | | | | | 8 | Octet 1 |
| dataDirection | payloadVersion | | | filterIndex | | | | 1 | Octet 9 |
| frameId | | | | | | | | 1 | Octet 10 |
| subframeId | | | | slotId | | | | 1 | Octet 11 |
| slotId | | startSymbolId | | | | | | 1 | Octet 12 |
| numberOfsections | | | | | | | | 1 | Octet 13 |
| sectionType = 0 | | | | | | | | 1 | Octet 14 |
| timeOffset | | | | | | | | 2 | Octet 15 |
| frameStructure | | | | | | | | 1 | Octet 17 |
| cpLength | | | | | | | | 2 | Octet 18 |
| Reserved | | | | | | | | 1 | Octet 20 |
| sectionId | | | | | | | | 1 | Octet 21 |
| sectionId | | | | rb | symInc | startPrbc | | 1 | Octet 22 |
| startPrbc | | | | | | | | 1 | Octet 23 |
| numPrbc | | | | | | | | 1 | Octet 24 |
| reMask[11:4] | | | | | | | | 1 | Octet 25 |
| reMask[3:0] | | | | numSymbol | | | | 1 | Octet 26 |
| ef | reserved (7 bits) | | | | | | | 1 | Octet 27 |
| reserved (8 bits) | | | | | | | | 1 | Octet 28 |
| Section Extensions as indicated by "ef" if any | | | | | | | | var | Octet 29 |
| ... | | | | | | | |  |  |
| sectionId | | | | | | | | 1 | Octet N |
| sectionId | | | | rb | symInc | startPrbc | | 1 | N+1 |
| startPrbc | | | | | | | | 1 | N+2 |
| numPrbc | | | | | | | | 1 | N+3 |
| reMask[11:4] | | | | | | | | 1 | N+4 |
| reMask[3:0] | | | | numSymbol | | | | 1 | N+5 |
| ef | reserved (7 bits) | | | | | | | 1 | N+6 |
| reserved (8 bits) | | | | | | | | 1 | N+7 |
| Section Extensions as indicated by "ef" if any | | | | | | | | var | N+8 |
| NOTE: Shading: yellow is transport header, pink is radio application header, others are repeated sections. | | | | | | | | | |

#### Section Type 1 elements

Section Type 1 is used for most of the Downlink and Uplink radio channels - some channels especially PRACH and mixed-numerology channels may need more information elements contained in other Section Types. However, if Section Type 1 is used for PRACH channel, it should be processed in the same manner as a non-PRACH channel is processed in O-RU; see Table 7.4.3-1

* Common Header Fields:
  + **dataDirection** (data direction (gNB Tx/Rx)) field: 1 bit**.**
  + **payloadVersion** (payload version) field: 3 bits:
    - value = 1 shall be set (1st protocol version for payload and time reference format).
  + **filterIndex** (filter index) field: 4 bits.
  + **frameId** (frame identifier) field: 8 bits.
  + **subframeId** (subframe identifier) field: 4 bits.
  + **slotID** (slot identifier) field: 6 bits.
  + **startSymbolId** (start symbol id) field: 6 bits.
  + **numberOfsections** (number of sections) field: 8 bits.
  + **sectionType** (Section Type) field: 8 bits:
    - value = 1 shall be set.
  + **udCompHdr** (user data compression header) field: 8 bits.
  + **reserved** (reserved for future use) field: 8 bits**.**
* Section Fields:
  + **sectionId** (section identifier) field: 12 bits.
  + **rb** (resource block identifier) field: 1 bit.
  + **symInc** (symbol number increment command) field: 1 bit.
  + **startPrbc** (starting PRB of data section description) field: 10 bits.
  + **numPrbc** (number of contiguous PRBs per data section description) field: 8 bits.
  + **reMask** (resource element mask) field: 12 bits.
  + **numSymbol** (number of symbols) field: 4 bits.
  + **ef** (extension flag) field: 1 bit.
  + **beamId** (beam identifier) field: 15 bits.

**Table 7.4.3-1: Scheduling and beamforming commands frame format (Section Type 1)**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **Section Type 1: DL/UL control msgs** | | | | | | | | | |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **# of bytes** |  |
| transport header, see clause 5.1.3 | | | | | | | | 8 | Octet 1 |
| dataDirection | payloadVersion | | | filterIndex | | | | 1 | Octet 9 |
| frameId | | | | | | | | 1 | Octet 10 |
| subframeId | | | | slotId | | | | 1 | Octet 11 |
| slotId | | startSymbolId | | | | | | 1 | Octet 12 |
| numberOfsections | | | | | | | | 1 | Octet 13 |
| sectionType = 1 | | | | | | | | 1 | Octet 14 |
| udCompHdr | | | | | | | | 1 | Octet 15 |
| reserved | | | | | | | | 1 | Octet 16 |
| sectionId | | | | | | | | 1 | Octet 17 |
| sectionId | | | | rb | symInc | startPrbc | | 1 | Octet 18 |
| startPrbc | | | | | | | | 1 | Octet 19 |
| numPrbc | | | | | | | | 1 | Octet 20 |
| reMask[11:4] | | | | | | | | 1 | Octet 21 |
| reMask[3:0] | | | | numSymbol | | | | 1 | Octet 22 |
| ef = 1 | beamId[14:8] | | | | | | | 1 | Octet 23 |
| beamId[7:0] | | | | | | | | 1 | Octet 24 |
| Section Extensions as indicated by "ef" | | | | | | | | var | Octet 25 |
| ... | | | | | | | |  |  |
| sectionId | | | | | | | | 1 | Octet N |
| sectionId | | | | rb | symInc | startPrbc | | 1 | N+1 |
| startPrbc | | | | | | | | 1 | N+2 |
| numPrbc | | | | | | | | 1 | N+3 |
| reMask[11:4] | | | | | | | | 1 | N+4 |
| reMask[3:0] | | | | numSymbol | | | | 1 | N+5 |
| ef = 0 | beamId[14:8] | | | | | | | 1 | N+6 |
| beamId[7:0] | | | | | | | | 1 | N+7 |
| Section Extensions as indicated by "ef" | | | | | | | | var | N+8 |
| NOTE: Shading: yellow is transport header, pink is radio application header, others are repeated sections | | | | | | | | | |

#### reserved (reserved for future use)

#### Section Type 3 elements

Section Type 3 is used for PRACH and mixed-numerology channels; see Table 7.4.5-1:

* Common Header Fields:
  + **dataDirection** (data direction (gNB Tx/Rx)) field: 1 bit**.**
  + **payloadVersion** (payload version) field: 3 bits:
    - value = 1 shall be set (1st protocol version for payload and time reference format).
  + **filterIndex** (filter index) field: 4 bits.
  + **frameId** (frame identifier) field: 8 bits.
  + **subframeId** (subframe identifier) field: 4 bits.
  + **slotID** (slot identifier) field: 6 bits.
  + **startSymbolId** (start symbol identifier) field: 6 bits.
  + **numberOfsections** (number of sections) field: 8 bits.
  + **sectionType** (Section Type) field: 8 bits.
    - value = 3 shall be set.
  + **timeOffset** (time offset) field: 16 bits.
  + **frameStructure** (frame structure) field: 8 bits.
  + **cpLength** (cyclic prefix length) field: 16 bits.
  + **udCompHdr** (user data compression header) field: 8 bits.
* Section Fields:
  + **sectionId** (section identifier) field: 12 bits.
  + **rb** (resource block identifier) field: 1 bit.
  + **symInc** (symbol number increment command) field: 1 bit.
  + **startPrbc** (starting PRB of data section description) field: 10 bits.
  + **numPrbc** (number of contiguous PRBs per data section description) field: 8 bits.
  + **reMask** (resource element mask) field: 12 bits.
  + **numSymbol** (number of symbols) field: 4 bits.
  + **ef** (extension flag) field: 1 bit.
  + **beamId** (beam identifier) field: 15 bits.
  + **freqOffset** (frequency offset) field: 24 bits.
  + **reserved** (reserved for future use) field: 8 bits.

**Table 7.4.5-1: Scheduling and beamforming commands frame format (Section Type 3)**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **Section Type 3: PRACH & mixed-numerology** | | | | | | | | | |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **# of bytes** |  |
| transport header, see clause 5.1.3 | | | | | | | | 8 | Octet 1 |
| dataDirection | payloadVersion | | | filterIndex | | | | 1 | Octet 9 |
| frameId | | | | | | | | 1 | Octet 10 |
| subframeId | | | | slotId | | | | 1 | Octet 11 |
| slotId | | startSymbolId | | | | | | 1 | Octet 12 |
| numberOfsections | | | | | | | | 1 | Octet 13 |
| sectionType = 3 | | | | | | | | 1 | Octet 14 |
| timeOffset | | | | | | | | 2 | Octet 15 |
| frameStructure | | | | | | | | 1 | Octet 17 |
| cpLength | | | | | | | | 2 | Octet 18 |
| udCompHdr | | | | | | | | 1 | Octet 20 |
| sectionId | | | | | | | | 1 | Octet 21 |
| sectionId | | | | rb | symInc | startPrbc | | 1 | Octet 22 |
| startPrbc | | | | | | | | 1 | Octet 23 |
| numPrbc | | | | | | | | 1 | Octet 24 |
| reMask[11:4] | | | | | | | | 1 | Octet 25 |
| reMask[3:0] | | | | numSymbol | | | | 1 | Octet 26 |
| ef | beamId[14:8] | | | | | | | 1 | Octet 27 |
| beamId[7:0] | | | | | | | | 1 | Octet 28 |
| freqOffset | | | | | | | | 3 | Octet 29 |
| reserved (8 bits) | | | | | | | | 1 | Octet 32 |
| Section Extensions as indicated by "ef" | | | | | | | | var | Octet 33 |
| ... | | | | | | | |  |  |
| sectionId | | | | | | | | 1 | Octet N |
| sectionId | | | | rb | symInc | startPrbc | | 1 | N+1 |
| startPrbc | | | | | | | | 1 | N+2 |
| numPrbc | | | | | | | | 1 | N+3 |
| reMask[11:4] | | | | | | | | 1 | N+4 |
| reMask[3:0] | | | | numSymbol | | | | 1 | N+5 |
| ef | beamId[14:8] | | | | | | | 1 | N+6 |
| beamId[7:0] | | | | | | | | 1 | N+7 |
| freqOffset | | | | | | | | 3 | N+8 |
| reserved (8 bits) | | | | | | | | 1 | N+11 |
| Section Extensions as indicated by "ef" | | | | | | | | var | N+12 |
| NOTE: shading: yellow is transport header, pink is radio application header, others are repeated sections | | | | | | | | | |

#### Section Type 4 elements

Section Type 4 (Slot level configuration); see Table 7.4.6-1, Table 7.4.6-2:

* Common Header Fields:
  + **dataDirection** (data direction (gNB Tx/Rx)) field: 1 bit**.**
  + **payloadVersion** (payload version) field: 3 bits:
    - value = 1 shall be set (1st protocol version for payload and time reference format).
  + **scs** (filter index) field: 4 bits.
  + **frameId** (frame identifier) field: 8 bits.
  + **subframeId** (subframe identifier) field: 4 bits.
  + **slotID** (slot identifier) field: 6 bits.
  + **startSymbolId** (start symbol identifier) field: 6 bits.
  + **reserved** (reserved for future use) field: 4 bits.
  + **cmdScope** (scope of Section Type 4 command) field: 4 bits.
  + **sectionType** (Section Type) field: 8 bits:
    - value = 4 shall be set.
  + **numberOfST4Cmds** (number of sections) field: 8 bits.
  + **reserved** (for future use)**:** 8 bits.
* **st4CmdType** = 1 shall be set for **st4CmdType** : TIME\_DOMAIN\_BEAM\_CONFIG; see Table 7.4.6-3, Table 7.4.6-4, Table 7.4.6-5:
  + **st4CmdType** (TIME\_DOMAIN\_BEAM\_CONFIG command type): 8 bits.
  + **st4CmdLen** (length of section type 4 command):16 bits.
  + **numSlots** (number of slots for which the command configuration shall be valid): 8 bits.
  + **ackNackReqId** (ACK/NACK request id for a Section Type 8 command which shall be used for ackId and nackId in Section Type 8): 16 bits.
  + **reserved** (reserved for future use) field, required for 4-byte alignment: 2 bytes.
  + **symbolMask** (symbol to which time-domain beamforming config shall apply. Symbol bits before 'startSymbolId' in Section Type 4 common header should be set to 0 by O-DU and shall be ignored by O- RU)**:** 14 bits.
  + **disableTDBFNs** ('1' = only 'tdBeamGrp' is included; '0' = 'tdBeamNum' with associated time-domain beamforming groups are included): 1 bit
  + **tdBeamGrp** (time-domain beam group, uniquely identifying a vector of length **K',** of time-domain beam numbers): 15 bits.
  + **bfwCompHdr** (beamforming weight compression header. Present only if disableTDBFWs=0, else the field is a reserved field): 8 bits.
  + **reserved** (reserved for future use) field, required for 4-byte alignment: 3 bytes.
  + **disableTDBFWs** ('1' = only tdBeamNum are included; '0' = tdBeamNum with associated time-domain beamforming weights are included): 1 bit.
  + **tdBeamNum** (time-domain beam number associated with tdBeamGrp value): 15 bits.
  + **bfwCompParam** (Beamforming weight compression parameter, present only if disableTDBFWs=0): variable .
  + **bfWI** (time-domain beamforming weight in-phase value): variable.
  + **bfWQ** (time-domain beamforming weight quadrature-phase value): variable.
  + Padding rules: 4-byte boundary for each set of weights when weights are present (disableTDBFWs = 0), mandatory padding to a 4-byte boundary only after the last beamId when weights are absent (disableTDBFWs = 1).
* **st4CmdType** = 2 shall be set for **st4CmdType**: TDD\_CONFIG\_PATTERN; see Table 7.4.6-6:
  + **st4CmdType** (TDD\_CONFIG\_PATTERN command type): 8 bits.
  + **st4CmdLen** (length of section type 4 command):16 bits.
  + **numSlots** (number of slots for which the command configuration shall be valid): 8 bits.
  + **ackNackReqId** (ACK/NACK request id for a Section Type 8 command which shall be used for ackId and nackId in Section Type 8): 16 bits.
  + **reserved** (reserved for future use) field, required for 4-byte alignment: 2 bytes.
  + **dirPattern** (Tx/Rx direction symbol mask, 1 = DL symbol, 0 = UL symbol): 14 bits.
  + **guardPattern** (guard bits for Tx->Rx switch, 1=guard symbol, 0 = non-guard symbol, either UL or DL per dirPattern): 14 bits.
* **st4CmdType = 3** shall be set for **st4CmdType:** TRX\_CONTROL; see Table 7.4.6-7:
  + **st4CmdType** (TRX\_CONTROL command type): 8 bits.
  + **st4CmdLen** (length of section type 4 command):16 bits.
  + **numSlots** (number of slots for which the command configuration shall be valid): 8 bits.
  + **ackNackReqId** (ACK/NACK request id for a Section Type 8 command which shall be used for ackId and nackId in Section Type 8): 16 bits.
  + **reserved** (reserved for future use) field, used in several places: variable number of bits.
  + **log2MaskBits** (log2 of the number of antenna mask bits): 4 bits.
  + **sleepMode** (sleep mode): 2 bits.
  + **numSlotsExt (**number of slots extension): 20 bits
  + **symbolMask** (symbol mask): 14 bits
  + **antMask** (antenna mask): variable number of bytes
* **st4CmdType** = 4 shall be set for **st4CmdType**: Advanced Sleep Mode (ASM); see Table 7.4.6-8:
  + **st4CmdType** (ASM command type): 8 bits.
  + **st4CmdLen** (length of section type 4 command):16 bits.
  + **numSlots** (number of slots for which the command configuration shall be valid): 8 bits.
  + **ackNackReqId** (ACK/NACK request id for a Section Type 8 command which shall be used for ackId and nackId in Section Type 8): 16 bits.
  + **reserved** (reserved for future use) field, used in several places: variable number of bits.
  + **sleepMode** (sleep mode): 2 bits.
  + **numSlotsExt (**number of slots extension): 20 bits
  + **symbolMask** (symbol mask): 14 bits

**Table 7.4.6-1: Slot message frame format (Section Type 4)**

|  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **Section Type 4: Slot-level Config** | | | | | | | | | | |
| 0 (msb) | 1 | | 2 | 3 | 4 | 5 | 6 | 7 (lsb) | # of bytes |  |
| transport header, see clause 5.1.3 | | | | | | | | | 8 | Octet 1 |
| dataDirection | | payloadVersion | | | scs | | | | 1 | Octet 9 |
| frameId | | | | | | | | | 1 | Octet 10 |
| subframeId | | | | | slotId | | | | 1 | Octet 11 |
| slotId | | | startSymbolId | | | | | | 1 | Octet 12 |
| reserved | | | | | cmdScope | | | | 1 | Octet 13 |
| sectionType = 4 | | | | | | | | | 1 | Octet 14 |
| numberOfST4Cmds | | | | | | | | | 1 | Octet 15 |
| reserved (8 bits) | | | | | | | | | 1 | Octet 16 |

**Table 7.4.6-2: Section Type 4 Command common header format**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **Section Type 4: Command common header format** | | | | | | | | | |
| 0 (msb) | 1 | 2 | 3 | 4 | 5 | 6 | 7 (lsb) | # of bytes |  |
| st4CmdType | | | | | | | | 1 | Octet 17 |
| st4CmdLen | | | | | | | | 2 | Octet 18 |
| numSlots | | | | | | | | 1 | Octet 20 |
| ackNackReqId | | | | | | | | 2 | Octet 21 |
| reserved | | | | | | | | 2 | Octet 23 |

**Table 7.4.6-3: Slot level command type TIME\_DOMAIN\_BEAM\_CONFIG (st4CmdType = 1) with disableTDBFNs = 0 and disableTDBFWs = 0**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **st4CmdType 'TIME\_DOMAIN\_BEAM\_CONFIG'** | | | | | | | | | |
| 0 (msb) | 1 | 2 | 3 | 4 | 5 | 6 | 7 (lsb) | # of bytes |  |
| transport header, see clause 5.1.3 | | | | | | | | 8 | Octet 1 |
| Section Type 4 section header | | | | | | | | 8 | Octet 9 |
| Section Type 4 common part of the command header | | | | | | | | 8 | Octet 17 |
| reserved | | symbolMask[13:8] | | | | | | 1 | Octet 25 |
| symbolMask[7:0] | | | | | | | | 1 | Octet 26 |
| disableTDBFNs | tdBeamGrp[14:8] (for tdBeamGrp 1) | | | | | | | 1 | Octet 27 |
| tdBeamGrp[7:0] (for tdBeamGrp 1) | | | | | | | | 1 | Octet 28 |
| bfwCompHdr | | | | | | | | 1 | Octet 29 |
| reserved | | | | | | | | 3 | Octet 30 |
| disableTDBFWs | tdBeamNum[14:8] (for tdBeamNum 1) | | | | | | | 1 | Octet 33 |
| tdBeamNum[7:0] (for tdBeamNum 1) | | | | | | | | 1 | Octet 34 |
| bfwCompParam (for tdBeamNum 1) | | | | | | | | var |  |
| bfwI (for tdBeamNum 1, for TRX 0) | | | | | | | | var |  |
| bfwQ (for tdBeamNum 1, for TRX 0) | | | | | | | | var |  |
| remaining time-domain beamforming weights bfwI and bfwQ  K  (for tdBeamNum 1, for ( ) - 1 TRXs)  K? | | | | | | | | var |  |
| zero pad to a 4-byte boundary | | | | | | | | var |  |
| ... | | | | | | | |  |  |
| disableTDBFWs | tdBeamNum[14:8] ((for tdBeamNum K') | | | | | | | 1 |  |
| tdBeamNum[7:0] (for tdBeamNum K') | | | | | | | | 1 |  |
| bfwCompParam | | | | | | | | var |  |
| bfwI (TRX 0) | | | | | | | | var |  |
| bfwQ (TRX 0) | | | | | | | | var |  |
| remaining time-domain beamforming weights bfwI and bfwQ  K  (for tdBeamNum K'th , for ( ) - 1 TRXs)  K? | | | | | | | | var |  |
| zero pad to a 4-byte boundary | | | | | | | | var |  |

**Table 7.4.6-4: Slot level command type TIME\_DOMAIN\_BEAM\_CONFIG (st4CmdType = 1) with disableTDBFNs = 0 and disableTDBFWs = 1**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **st4CmdType 'TIME\_DOMAIN\_BEAM\_CONFIG'** | | | | | | | | | |
| 0 (msb) | 1 | 2 | 3 | 4 | 5 | 6 | 7 (lsb) | # of bytes |  |
| transport header, see clause 5.1.3 | | | | | | | | 8 | Octet 1 |
| Section Type 4 section header | | | | | | | | 8 | Octet 9 |
| Section Type 4 common part of the command header | | | | | | | | 8 | Octet 17 |
| reserved | | symbolMask[13:8] | | | | | | 1 | Octet 25 |
| symbolMask[7:0] | | | | | | | | 1 | Octet 26 |
| disableTDBFNs | tdBeamGrp[14:8] (for tdBeamGrp 1) | | | | | | | 1 | Octet 27 |
| tdBeamGrp[7:0] (for tdBeamGrp 1) | | | | | | | | 1 | Octet 28 |
| bfwCompHdr | | | | | | | | 1 | Octet 29 |
| reserved | | | | | | | | 3 | Octet 30 |
| disableTDBFWs | tdBeamNum[14:8] (for tdBeamNum 1) | | | | | | | 1 | Octet 33 |
| tdBeamNum[7:0] (for tdBeamNum 1) | | | | | | | | 1 | Octet 34 |
| ... | | | | | | | |  |  |
| disableTDBFWs | tdBeamNum[14:8] (for tdBeamNum K') | | | | | | | 1 |  |
| tdBeamNum[7:0] (for tdBeamNum K') | | | | | | | | 1 |  |
| zero pad to a 4-byte boundary | | | | | | | | var |  |

**Table 7.4.6-5: Slot level command type TIME\_DOMAIN\_BEAM\_CONFIG (st4CmdType =1) with disableTDBFNs = 1**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **st4CmdType 'TIME\_DOMAIN\_BEAM\_CONFIG'** | | | | | | | | | |
| 0 (msb) | 1 | 2 | 3 | 4 | 5 | 6 | 7 (lsb) | # of bytes |  |
| transport header, see clause 5.1.3 | | | | | | | | 8 | Octet 1 |
| Section Type 4 section header | | | | | | | | 8 | Octet 9 |
| Section Type 4 common part of the command header | | | | | | | | 8 | Octet 17 |
| reserved | | symbolMask[13:8] | | | | | | 1 | Octet 25 |
| symbolMask[7:0] | | | | | | | | 1 | Octet 26 |
| disableTDBFNs | tdBeamGrp[14:8] (for tdBeamGrp 1) | | | | | | | 1 | Octet 27 |
| tdBeamGrp[7:0] (for tdBeamGrp 1) | | | | | | | | 1 | Octet 28 |
| bfwCompHdr | | | | | | | | 1 | Octet 29 |
| reserved | | | | | | | | 3 | Octet 30 |

**Table 7.4.6-6: Slot level command type TDD\_CONFIG\_PATTERN (st4CmdType =2)**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **st4CmdType 'TDD\_CONFIG\_PATTERN'** | | | | | | | | | |
| 0 (msb) | 1 | 2 | 3 | 4 | 5 | 6 | 7 (lsb) | # of bytes |  |
| transport header, see clause 5.1.3 | | | | | | | | 8 | Octet 1 |
| Section Type 4 section header | | | | | | | | 8 | Octet 9 |
| Section Type 4 common part of the command header | | | | | | | | 8 | Octet 17 |
| reserved | | dirPattern[13:8] | | | | | | 1 | Octet 25 |
| dirPattern[7:0] | | | | | | | | 1 | Octet 26 |
| reserved | | guardPattern[13:8] | | | | | | 1 | Octet 27 |
| guardPattern[7:0] | | | | | | | | 1 | Octet 28 |

**Table 7.4.6****-7: Slot level command type TRX\_CONTROL (st4CmdType = 3)**

|  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **st4CmdType 'TRX\_CONTROL'** | | | | | | | | | | |
| 0 (msb) | 1 | 2 | 3 | 4 | | 5 | 6 | 7 (lsb) | # of bytes |  |
| transport header, see clause 5.1.3 | | | | | | | | | 8 | Octet 1 |
| Section Type 4 section header | | | | | | | | | 8 | Octet 9 |
| Section Type 4 common part of the command header | | | | | | | | | 8 | Octet 17 |
| reserved | | log2MaskBits[3:0] | | | | | sleepMode[1:0] | | 1 | Octet 25 |
| reserved | | | | | numSlotsExt[19:16] | | | | 1 | Octet 26 |
| numSlotsExt[15:8] | | | | | | | | | 1 | Octet 27 |
| numSlotsExt[7:0] | | | | | | | | | 1 | Octet 28 |
| reserved | | symbolMask[13:8] | | | | | | | 1 | Octet 29 |
| symbolMask[7:0] | | | | | | | | | 1 | Octet 30 |
| antMask[x:0] | | | | | | | | | var | Octet 31 |
| zero-pad to a 4 byte boundary, not always present | | | | | | | | |  |  |
| NOTE: startSymbolId in the section header shall be set to zero for this command | | | | | | | | | | |

**Table 7.4.6****-8: Slot level command type ASM (st4CmdType =4)**

|  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **st4CmdType 'ASM'** | | | | | | | | | | |
| 0 (msb) | 1 | 2 | 3 | 4 | | 5 | 6 | 7 (lsb) | # of bytes |  |
| transport header, see clause 5.1.3 | | | | | | | | | 8 | Octet 1 |
| Section Type 4 section header | | | | | | | | | 8 | Octet 9 |
| Section Type 4 common part of the command header | | | | | | | | | 8 | Octet 17 |
| reserved | | reserved | | | | | sleepMode[1:0] | | 1 | Octet 25 |
| reserved | | | | | numSlotsExt[19:16] | | | | 1 | Octet 26 |
| numSlotsExt[15:8] | | | | | | | | | 1 | Octet 27 |
| numSlotsExt[7:0] | | | | | | | | | 1 | Octet 28 |
| reserved | | symbolMask[13:8] | | | | | | | 1 | Octet 29 |
| symbolMask[7:0] | | | | | | | | | 1 | Octet 30 |
| reserved | | | | | | | | | 2 | Octet 31 |
| NOTE: startSymbolId in the section header shall be set to zero for this command | | | | | | | | | | |

#### Section Type 5 elements

Section Type 5 is used for UE scheduling information; see Table 7.4.7-1:

* Common Header Fields:
  + **dataDirection** (data direction (gNB Tx/Rx)) field: 1 bit**.**
  + **payloadVersion** (payload version) field: 3 bits:
    - value = 1 shall be set (1st protocol version for payload and time reference format).
  + **filterIndex** (filter index) field: 4 bits.
  + **frameId** (frame identifier) field: 8 bits.
  + **subframeId** (subframe identifier) field: 4 bits.
  + **slotID** (slot identifier) field: 6 bits.
  + **startSymbolId** (start symbol identifier) field: 6 bits.
  + **numberOfsections** (number of sections) field: 8 bits.
  + **sectionType** (Section Type) field: 8 bits:
    - value = 5 shall be set.
  + **udCompHdr** (user data compression header) field: 8 bits**.**
  + **reserved** (reserved for future use) field: 8 bits.
* Section Fields:
  + **sectionId** (section identifier) field: 12 bits.
  + **rb** (resource block identifier) field: 1 bit.
  + **symInc** (symbol number increment command) field: 1 bit.
  + **startPrbc** (starting PRB of data section description) field: 10 bits.
  + **numPrbc** (number of contiguous PRBs per data section description) field: 8 bits.
  + **reMask** (resource element mask) field: 12 bits.
  + **numSymbol** (number of symbols) field: 4 bits.
  + **ef** (extension flag) field: 1 bit.
  + **ueId** field: 15 bits.

**Table 7.4.7-1: UE scheduling information frame format (Section Type 5)**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **Section Type 5: UE scheduling information conveyance** | | | | | | | | | |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **# of bytes** |  |
| transport header, see clause 5.1.3 | | | | | | | | 8 | Octet 1 |
| dataDirection | payloadVersion | | | filterIndex | | | | 1 | Octet 9 |
| frameId | | | | | | | | 1 | Octet 10 |
| subframeId | | | | slotId | | | | 1 | Octet 11 |
| slotId | | startSymbolId | | | | | | 1 | Octet 12 |
| numberOfsections | | | | | | | | 1 | Octet 13 |
| sectionType = 5 | | | | | | | | 1 | Octet 14 |
| udCompHdr | | | | | | | | 1 | Octet 15 |
| reserved | | | | | | | | 1 | Octet 16 |
| sectionId | | | | | | | | 1 | Octet 17 |
| sectionId | | | | rb | symInc | startPrbc | | 1 | Octet 18 |
| startPrbc | | | | | | | | 1 | Octet 19 |
| numPrbc | | | | | | | | 1 | Octet 20 |
| reMask[11:4] | | | | | | | | 1 | Octet 21 |
| reMask[3:0] | | | | numSymbol | | | | 1 | Octet 22 |
| ef | ueId[14:8] | | | | | | | 1 | Octet 23 |
| ueId[7:0] | | | | | | | | 1 | Octet 24 |
| Section Extensions as indicated by "ef" | | | | | | | | var | Octet 25 |
| ... | | | | | | | |  |  |
| sectionId | | | | | | | | 1 | Octet N |
| sectionId | | | | rb | symInc | startPrbc | | 1 | N+1 |
| startPrbc | | | | | | | | 1 | N+2 |
| numPrbc | | | | | | | | 1 | N+3 |
| reMask[11:4] | | | | | | | | 1 | N+4 |
| reMask[3:0] | | | | numSymbol | | | | 1 | N+5 |
| ef | ueId[14:8] | | | | | | | 1 | N+6 |
| ueId[7:0] | | | | | | | | 1 | N+7 |
| Section Extensions as indicated by "ef" | | | | | | | | var | N+8 |
| NOTE: Shading: yellow is transport header, pink is radio application header, others are repeated sections | | | | | | | | | |

#### Section Type 6 elements

Section Type 6 is used for sending channel information for a specific ueId; see Table 7.4.8-1:

* Common Header Fields:
  + **dataDirection** (data direction (gNB Tx/Rx)) field: 1 bit**.**
  + **payloadVersion** (payload version) field: 3 bits:
    - value = 1 shall be set (1st protocol version for payload and time reference format).
  + **filterIndex** (filter index) field: 4 bits.
  + **frameId** (frame identifier) field: 8 bits.
  + **subframeId** (subframe identifier) field: 4 bits.
  + **slotID** (slot identifier) field: 6 bits.
  + **startSymbolId** (start symbol identifier) field: 6 bits.
  + **numberOfsections** (number of sections) field: 8 bits.
  + **sectionType** (Section Type) field: 8 bits:
    - value = 6 shall be set.
  + **numberOfUEs** (number of UE-specific channel information data sets) field: 8 bits.
  + **ciCompHdr** (channel information compression header) field: 8 bits.
* Section Fields:
  + **ef** (extension flag) field: 1 bit.
  + **ueId** field: 15 bits.
  + **regularizationFactor** (regularization factor used for MMSE reception) field: 16 bits.
  + **reserved** (reserved for future use) field: 4 bits.
  + **rb** (resource block identifier) field: 1 bit.
    - Value = 0 shall be set.
  + **symInc** (symbol number increment command) field: 1 bit.
  + **startPrbc** (starting PRB of data section description) field: 10 bits.
  + **numPrbc** (number of contiguous PRBs per data section description) field: 8 bits.
  + **ciCompParam** (channel information compression parameter): 0 or 8 bits.
  + **ciIsample** (channel information value, in-phase sample) field: 1-16 bits.
  + **ciQsample** (channel information value, quadrature sample) field: 1-16 bits.

**Table 7.4.8-1: UE channel information frame format (Section Type 6)**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **Section Type 6: channel information conveyance** | | | | | | | | | |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **# of bytes** |  |
| transport header, see clause 5.1.3 | | | | | | | | 8 | Octet 1 |
| dataDirection | payloadVersion | | | filterIndex | | | | 1 | Octet 9 |
| frameId | | | | | | | | 1 | Octet 10 |
| subframeId | | | | slotId | | | | 1 | Octet 11 |
| slotId | | startSymbolId | | | | | | 1 | Octet 12 |
| numberOfsections | | | | | | | | 1 | Octet 13 |
| sectionType = 6 | | | | | | | | 1 | Octet 14 |
| numberOfUEs | | | | | | | | 1 | Octet 15 |
| ciCompHdr | | | | | | | | 1 | Octet 16 |
| ef | ueId[14:8] | | | | | | | 1 | Octet 17 |
| ueId[7:0] | | | | | | | | 1 | Octet 18 |
| regularizationFactor | | | | | | | | 2 | Octet 19 |
| reserved | | | | rb | symInc | startPrbc | | 1 | Octet 21 |
| startPrbc | | | | | | | | 1 | Octet 22 |
| numPrbc | | | | | | | | 1 | Octet 23 |
| ciCompParam (for the first PRB or all PRBs of the first UE, not always present) | | | | | | | | var | Octet 24 |
| ciIsample (first PRB, first antenna) | | | | | | | | var |  |
| ciQsample (first PRB, first antenna) | | | | | | | | var |  |
| ciIsample (first PRB, second antenna) | | | | | | | | var |  |
| ciQsample (first PRB, second antenna) | | | | | | | | var |  |
| ... | | | | | | | |  |  |
| ciIsample (first PRB, last antenna) | | | | | | | | var |  |
| ciQsample (first PRB, last antenna) | | | | | | | | var |  |
| ... | | | | | | | |  |  |
| ciCompParam (for the last PRB, not always present) | | | | | | | | var |  |
| ciIsample (last PRB, last antenna) | | | | | | | | var |  |
| ciQsample (last PRB, last antenna) | | | | | | | | var |  |
| <padding with zeros to the next 4-byte boundary> may not be present (NOTE 2) | | | | | | | | var |  |
| Section Extensions as indicated by "ef" | | | | | | | | var |  |
| ... | | | | | | | |  |  |
| ef | ueId[14:8] | | | | | | | 1 | Octet N |
| ueId[7:0] | | | | | | | | 1 | N+1 |
| regularizationFactor | | | | | | | | 2 | N+2 |
| Reserved | | | | rb | symInc | startPrbc | | 1 | N+4 |
| startPrbc | | | | | | | | 1 | N+5 |
| numPrbc | | | | | | | | 1 | N+6 |
| ciCompParam (for the first PRB or all PRBs of the last UE, not always present) | | | | | | | | var | N+7 |
| ciIsample (first PRB, first antenna) | | | | | | | | var |  |
| ciQsample (first PRB, first antenna) | | | | | | | | var |  |
| ciIsample (first PRB, second antenna) | | | | | | | | var |  |
| ciQsample (first PRB, second antenna) | | | | | | | | var |  |
| ... | | | | | | | |  |  |
| ciIsample (first PRB, last antenna) | | | | | | | | var |  |
| ciQsample (first PRB, last antenna) | | | | | | | | var |  |
| ... | | | | | | | |  |  |
| ciCompParam (for the last PRB, not always present) | | | | | | | |  |  |
| ciIsample (last PRB, last antenna) | | | | | | | | var |  |
| ciQsample (last PRB, last antenna) | | | | | | | | var |  |
| <padding with zeros to the next 4-byte boundary> may not be present (NOTE 2) | | | | | | | | var |  |
| Section Extensions as indicated by "ef" | | | | | | | | var |  |

NOTE 1: shading: yellow is transport header, pink is radio application header, others are repeated sections. NOTE 2: "may not be present" depends on O-RU Boolean flag "st6-4byte-alignment-required".

NOTE 3: The remainder of N divided by 4 is 1 if 4-byte alignment is to be used.

#### Section Type 7 elements

Section Type 7 is used to support LAA; see Table 7.4.9-1:

* Common Header Fields:
  + dataDirection (data direction (gNB Tx/Rx)) field: 1 bit.
    - value = 0 shall be set
  + **payloadVersion** (payload version) field: 3 bits:
    - value = 1 shall be set (1st protocol version for payload and time reference format).
  + **reserved** (reserved for future use) field: 4 bits.
  + **frameId** (frame identifier) field: 8 bits.
  + **subframeId** (subframe identifier) field: 4 bits.
  + **slotID** (slot identifier) field: 6 bits.
  + **reserved** (reserved for future use) field: 14 bits.
  + **sectionType** (Section Type) field: 8 bits:
    - value = 7 shall be set.
  + **reserved** (reserved for future use) field: 16 bits.
* Section Fields:
  + laaMsgType (LAA message type) field: 4 bits.
  + laaMsgLen field: 4 bits.
* laaMsgType = 0 shall be set for LBT\_DL\_CONFIG.request: LBT\_PDSCH\_REQ; see Table 7.4.9-2:
  + **lbtHandle** (An opaque handling returned in LBT\_PDSCH\_RSP) field: 16 bits.
  + **lbtOffset** (LBT start time in microseconds from the beginning of the subframe scheduled by this message) field: 10 bits.
  + **lbtMode** (LBT process type) field: 2 bits.
  + **reserved** (reserved for future use) field: 1 bit.
  + **lbtDeferFactor** (Defer factor in sensing slots as described in 3GPP TS 36.213 [14], clause 15.1.1) field: 3 bits.
  + **lbtBackoffCounter** (LBT backoff counter in sensing slots as described in 3GPP TS 36.213 [14], clause 15.1.1) field: 10 bits.
  + **MCOT** (LTE TXOP duration in subframes) field: 4 bits.
  + reserved (reserved for future use) field: 10 bits.
* laaMsgType = 1 shall be set for LBT\_DL\_CONFIG.request: LBT\_DRS\_REQ; see Table 7.4.9-3:
  + **lbtHandle** (An opaque handling returned in LBT\_DRS\_RSP) field: 16 bits.
  + **lbtOffset** (LBT start time in microseconds from the beginning of the subframe scheduled by this message) field: 10 bits.
  + **lbtMode** (LBT process type) field: 2 bits.
  + **reserved** (reserved for future use) field: 28 bits.
* laaMsgType = 2 shall be set for LBT\_DL.indication: LBT\_PDSCH\_RSP; see Table 7.4.9-4:
  + **lbtHandle** (An opaque handling returned in LBT\_PDSCH\_RSP) field: 16 bits.
  + **lbtPdschRes** (LBT result of SFN/SF) field: 2 bits.
  + **inParSF** (Indicates whether the initial SF in the LBT process is full or partial) field: 1 bit.
  + **sfStatus** (subframe status) field: 1 bit.
  + **sfnSf** (SFN/SF of subframe which is dropped or successfully transmitted at O-RU) field: 12 bits.
  + **reserved** (reserved for future use) field: 24 bits.
* laaMsgType = 3 shall be set for LBT\_DL.indication: LBT\_DRS\_RSP; see Table 7.4.9-5:
  + **lbtHandle** (An opaque handling returned in LBT\_DRS\_RSP) field: 16 bits.
  + **lbtDrsRes** (LBT result of SFN/SF) field: 1 bit.
  + **reserved** (reserved for future use) field: 7 bits.
* laaMsgType = 4 shall be set for LBT\_buffer error: LBT\_Buffer\_Error; see Table 7.4.9-6:
  + **lbtHandle** (An opaque handling returned in LBT\_DRS\_RSP) field: 16 bits.
  + **lbtBufErr** (LBT buffer error type) field: 1 bit.
  + **reserved** (reserved for future use) field: 7 bits.
* laaMsgType = 5 shall be set for LBT\_DL\_CONFIG.request: LBT\_CWCONFIG\_REQ; see Table 7.4.9-7:
  + **lbtHandle** (An opaque handle returned in LBT\_CWCONFIG\_RSP) field: 16 bits.
  + **lbtCWConfig\_H** (HARQ feedback information regarding number of NACK about reference subframe as described in 3GPP TS 36.213 [14], clause 15.1.3) field: 8 bits.
  + **lbtCWConfig\_T** (number of TB to manage congestion window as described in 3GPP TS 36.213 [14], clause 15.1.3) field: 8 bits.
  + **lbtMode** (LBT process type) field: 2 bits.
  + **lbtTrafficClass** (LBT traffic class) field: 3 bits.
  + **reserved** (reserved for future use) field: 19 bits.
* laaMsgType = 6 shall be set for LBT\_DL.indication: LBT\_CWCONFIG\_RSP; see Table 7.4.9-8:
  + **lbtHandle** (An opaque handling returned in LBT\_CWCONFIG\_RSP) field: 16 bits.
  + **lbtCWR\_Rst** (Notification LBT\_CWCONFIG\_REQ message successful or not) field: 1 bit.
  + **reserved** (reserved for future use) field: 7 bits.

**Table 7.4.9-1: LAA Message, O-DU to O-RU -OR- O-RU to O-DU (Section Type 7)**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **Section Type 7: LAA Message, O-DU to O-RU or O-RU to O-DU** | | | | | | | | | |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **# of bytes** |  |
| transport header, see clause 5.1.3 | | | | | | | | 8 | Octet 1 |
| dataDirection | payloadVersion | | | reserved | | | | 1 | Octet 9 |
| frameId | | | | | | | | 1 | Octet 10 |
| subframeId | | | | slotId | | | | 1 | Octet 11 |
| slotId | | reserved | | | | | | 1 | Octet 12 |
| reserved | | | | | | | | 1 | Octet 13 |
| sectionType = 7 | | | | | | | | 1 | Octet 14 |
| reserved | | | | | | | | 1 | Octet 15 |
| reserved | | | | | | | | 1 | Octet 16 |
| laaMsgType | | | | laaMsgLen | | | | 1 | Octet 17 |
| Payload (see below) plus padding to 32-bit boundary | | | | | | | | 3 or 7 | Octet 18+ |
| NOTE: frameId, subframeId and slotId serve to provide a time stamp on the LAA LBT C-Plane message and do not describe any U-Plane data associated with the Section Type 7 C-Plane message. | | | | | | | | | |

**Table 7.4.9-2: LAA Request Message, O-DU to O-RU LBT\_PDSCH\_REQ**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **Section Type 7:** LAA Request Message, O-DU to O-RU **LBT\_PDSCH\_REQ** | | | | | | | | | |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **# of bytes** |  |
| laaMsgType = 0000b (LBT\_PDSCH\_REQ) | | | | laaMsgLen = 2 (2 words) | | | | 1 | Octet 17 |
| lbtHandle | | | | | | | | 2 | Octet 18 |
| lbtOffset[9:2] | | | | | | | | 1 | Octet 20 |
| lbtOffset[1:0] | | lbtMode | | reserved | lbtDeferFactor | | | 1 | Octet 21 |
| lbtBckoffCounter[9:2] | | | | | | | | 1 | Octet 22 |
| lbtBckoffCounter[1:0] | | MCOT | | | | reserved | | 1 | Octet 23 |
| reserved | | | | | | | | 1 | Octet 24 |

**Table 7.4.9-3: LAA Request Message, O-DU to O-RU LBT\_DRS\_REQ**

**Section Type 7:** LAA Request Message, O-DU to O-RU **LBT\_DRS\_REQ**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **# of bytes** |  |
| laaMsgType = 0001b (LBT\_DRS\_REQ) | | | | laaMsgLen = 2 (2 words) | | | | 1 | Octet 17 |
| lbtHandle | | | | | | | | 2 | Octet 18 |
| lbtOffset[9:2] | | | | | | | | 1 | Octet 20 |
| lbtOffset[1:0] | | lbtMode | | reserved | | | | 1 | Octet 21 |
| reserved | | | | | | | | 1 | Octet 22 |
| reserved | | | | | | | | 1 | Octet 23 |
| reserved | | | | | | | | 1 | Octet 24 |

**Table 7.4.9-4: LAA Response Message, O-RU to O-DU LBT\_PDSCH\_RSP**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **Section Type 7:** LAA Response Message, O-RU to O-DU **LBT\_PDSCH\_RSP** | | | | | | | | | |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **# of bytes** |  |
| laaMsgType = 0010b (LBT\_PDSCH\_RSP) | | | | laaMsgLen = 2 (2 words) | | | | 1 | Octet 17 |
| lbtHandle | | | | | | | | 2 | Octet 18 |
| lbtPdschRes | | inParSF | sfStatus | sfnSf[11:8] | | | | 1 | Octet 20 |
| sfnSf[7:0] | | | | | | | | 1 | Octet 21 |
| reserved | | | | | | | | 1 | Octet 22 |
| reserved | | | | | | | | 1 | Octet 23 |
| reserved | | | | | | | | 1 | Octet 24 |

**Table 7.4.9-5: LAA Response Message, O-RU to O-DU LBT\_DRS\_RSP**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **Section Type 7:** LAA Response Message, O-RU to O-DU **LBT\_DRS\_RSP** | | | | | | | | | |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **# of bytes** |  |
| laaMsgType = 0011b (LBT\_DRS\_RSP) | | | | laaMsgLen = 1 (1 word) | | | | 1 | Octet N |
| lbtHandle | | | | | | | | 2 | N+1 |
| lbtDrsRes | reserved | | | | | | | 1 | N+3 |

**Table 7.4.9-6: LAA Response Message, O-RU to O-DU LBT\_Buffer\_Error**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **Section Type 7: LAA Response Message, O-RU to O-DU LBT\_Buffer\_Error** | | | | | | | | | |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **# of bytes** |  |
| laaMsgType = 0100b (LBT\_Buffer\_Error) | | | | laaMsgLen = 1 (1 word) | | | | 1 | Octet N |
| lbtHandle | | | | | | | | 2 | N+1 |
| lbtBufErr | reserved | | | | | | | 1 | N+3 |

**Table 7.4.9-7: LAA Request Message, O-DU to O-RU LBT\_CWCONFIG\_REQ**

**Section Type 7:** LAA Request Message, O-DU to O-RU **LBT\_CWCONFIG\_REQ**

|  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | | **6** | **7 (lsb)** | **# of bytes** |  |
| laaMsgType = 0101b (LBT\_CWCONFIG\_REQ) | | | | laaMsgLen = 2 (2 words) | | | | | 1 | Octet N |
| lbtHandle | | | | | | | | | 2 | N+1 |
| lbtCWConfig\_H | | | | | | | | | 1 | N+3 |
| lbtCWConfig\_T | | | | | | | | | 1 | N+4 |
| lbtMode | | lbtTrafficClass | | | | reserved | | | 1 | N+5 |
| reserved | | | | | | | | | 2 | N+6 |

**Table 7.4.9-8: LAA Request Message, O-RU to O-DU LBT\_CWCONFIG\_RSP**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **Section Type 7:** LAA Request Message, O-RU to O-DU L**BT\_CWCONFIG\_RSP** | | | | | | | | | |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **# of bytes** |  |
| laaMsgType = 0110b (LBT\_CWCONFIG\_RSP) | | | | laaMsgLen = 1 (1 word) | | | | 1 | Octet N |
| lbtHandle | | | | | | | | 2 | N+1 |
| lbtCWR\_Rst | reserved | | | | | | | 1 | N+2 |

#### Section Type 8 elements

Section Type 8 is used for sending ACK/NACK feedbacks from the O-RU to the O-DU; see Table 7.4.10-1:

* Common Header Fields
  + **dataDirection** (data direction (gNB Tx/Rx)) field: 1 bit.
  + **payloadVersion** (payload version) field: 3 bits
    - value = 1 shall be set (1st protocol version for payload and time reference format)
  + **scs** (sub-carrier spacing) field: 4 bits
  + **frameId** (frame identifier) field: 8 bits
  + **subframeId** (subframe identifier) field: 4 bits
  + **slotId** (slot identifier) field: 6 bits
  + **symbolId** (symbolId identifier) field: 6 bits
  + **ready** (wake-up ready indicator) field: 1 bit
  + **reserved** (reserved for future use) field: 7 bits
  + **sectionType** (Section Type) field: 8 bits
    - value = 8 shall be set
  + **numberOfAcks** (number of ACKs) field: 8 bits
  + **numberOfNacks** (number of NACKs) field: 8 bits
* Section Fields
  + **ackId** (ACK Id) field: 16 bits
  + **nackId** (NACK Id) field: 16 bits

**Table 7.4.10-1: ACK/NACK Message, O-RU to O-DU (Section Type 8)**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **Section Type 8 : ACK/NACK Message, O-RU to O-DU** | | | | | | | | | |
| 0 (msb) | 1 | 2 | 3 | 4 | 5 | 6 | 7 (lsb) | # of bytes |  |
| transport header, see clause 5.1.3 | | | | | | | | 8 | Octet 1 |
| dataDirection | payloadVersion | | | scs | | | | 1 | Octet 9 |
| frameId | | | | | | | | 1 | Octet 10 |
| subframeId | | | | slotId | | | | 1 | Octet 11 |
| slotId | | symbolId | | | | | | 1 | Octet 12 |
| reserved | | | | | | | ready | 1 | Octet 13 |
| sectionType = 8 | | | | | | | | 1 | Octet 14 |
| numberOfAcks | | | | | | | | 1 | Octet 15 |
| numberOfNacks | | | | | | | | 1 | Octet 16 |
| 1st ackId | | | | | | | | 2 | Octet 17 |
| 2nd ackId | | | | | | | | 2 | Octet 19 |
| ... | | | | | | | |  |  |
| nth ackId (NOTE) | | | | | | | | 2 | Octet 15+2\*n |
| 1st nackId | | | | | | | | 2 | Octet 17+2\*n |
| 2nd nackId | | | | | | | | 2 | Octet 19+2\*n |
| ... | | | | | | | |  |  |
| mth nackId (NOTE) | | | | | | | | 2 | Octet 15+2\*(m+n) |
| Padding to align with 32-bit boundary | | | | | | | |  |  |
| NOTE: n is the value in the field of numberOfAcks and m is the value in the field of numberOfNacks. | | | | | | | | | |

#### Section Type 9 elements

Section Type 9 is used for sending post-equalization SINR (signal-to-interference-plus-noise-ratio) data from the O-RU to the O-DU and is applicable for DMRS-BF-EQ. See clause 7.2.11 for further description of SINR reporting. Section Type 9 shares section header structure and parameters with U-Plane message with defined restrictions on selected parameters. The example of Section Type 9 format is presented in Table 7.4.11-1. Section Type 9 has the following fields:

* Common Header Fields
  + **dataDirection** (data direction (gNB Tx/Rx)) field: 1 bit.
    - value = 0 (uplink) shall be used
  + **payloadVersion** (payload version) field: 3 bits
    - value = 1 shall be set (1st protocol version for payload and time reference format)
  + **filterIndex** (filter index) field: 4 bits
    - The value from the corresponding C-Plane message requesting DMRS-BF-EQ reception shall be used.
  + **frameId** (frame identifier) field: 8 bits
  + **subframeId** (subframe identifier) field: 4 bits
  + **slotId** (slot identifier) field: 6 bits
  + **symbolId** (symbolId identifier, see clause 8.3.3.7) field: 6 bits
  + **numberOfsections** (number of sections) field: 8 bits.
  + **sectionType** (Section Type) field: 8 bits
    - value = 9 shall be used
  + **numSinrPerPrb** (indicates number of SINR values per PRB, see clause 7.5.2.19) field: 3 bits
  + **oruControlSinrSlotMaskId** (identifier of the used sinr-slot-mask value in the list **sinr-slot-masks** configured via M-Plane for O-RU controlled time resolution for SINR reporting, see clause 7.5.2.20) field: 5 bits
* Section header fields:
  + **sectionId** (section identifier) field: 12 bits.
  + **rb** (resource block indicator) field: 1 bit.
  + **symInc** (symbol number increment command) field: 1 bit.
    - value = 0 shall be used
  + **startPrbu** (starting PRB of user plane section, see clause 8.3.3.11) field: 10 bits.
  + **numPrbu** (number of contiguous PRBs per data section, see clause 8.3.3.12) field: 8 bits.
  + PRB fields:
    - **sinrCompParam** (user data compression parameter, only present when block floating point compression is used, see clause 7.5.3.67) field: 8 bits.
    - **sinrValue** (SINR value, see clause 7.5.3.68) field: 1-16 bits.

**Table 7.4.11-1: SINR reporting (Section Type 9)**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **Section Type 9: SINR reporting** | | | | | | | | | |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **# of bytes**  (NOTE 2) | **Octet** |
| transport header, see clause 5.1.3 | | | | | | | | 8 | 0 |
| dataDirection | payloadVersion | | | filterIndex | | | | 1 | 8 |
| frameId | | | | | | | | 1 | 9 |
| subframeId | | | | slotId | | | | 1 | 10 |
| slotId | | symbolId | | | | | | 1 | 11 |
| numberOfsections | | | | | | | | 1 | 12 |
| sectionType = 9 | | | | | | | | 1 | 13 |
| numSinrPerPrb[2:0] | | | oruControlSinrSlotMaskId | | | | | 1 | 14 |
| reserved | | | | | | | | 1 | 15 |
| sectionId | | | | | | | | 1 | 16 |
| sectionId | | | | rb | symInc | startPrbu | | 1 | 17 |
| startPrbu | | | | | | | | 1 | 18 |
| numPrbu (NOTE 3) | | | | | | | | 1 | 19 |
| sinrCompParam | | | | | | | | 0/1 | var |
| sinrValue = 1st SINR in the first PRB | | | | | | | | 1 | var |
| sinrValue = 2nd SINR in the first PRB (not always present) | | | | | | | | 0/1 | var |
| ... | | | | | | | |  | var |
| sinrValue = 11th SINR in the first PRB (not always present) | | | | | | | | 0/1 | var |
| sinrValue = 12th SINR in the first PRB (not always present) | | | | | | | | 0/1 | var |
| sinrCompParam | | | | | | | | 0/1 | var |
| sinrValue = 1st SINR in the second PRB | | | | | | | | 1 | var |
| sinrValue = 2nd SINR in the second PRB (not always present) | | | | | | | | 0/1 | var |
| ... | | | | | | | |  | var |
| sinrValue = 11th SINR in the second PRB (not always present) | | | | | | | | 0/1 | var |
| sinrValue = 12th SINR in the second PRB (not always present) | | | | | | | | 0/1 | var |
| ... | | | | | | | |  |  |
| sectionId | | | | | | | | 1 | N+1 |
| sectionId | | | | rb | symInc | startPrbu | | 1 | N+2 |
| startPrbu | | | | | | | | 1 | N+3 |
| numPrbu (NOTE 3) | | | | | | | | 1 | N+4 |
| sinrCompParam | | | | | | | | 0/1 | var |
| sinrValue = 1st SINR in the first PRB | | | | | | | | 1 | var |
| sinrValue = 2nd SINR in the first PRB (not always present) | | | | | | | | 0/1 | var |
| ... | | | | | | | |  | var |
| sinrValue = 11th SINR in the first PRB (not always present) | | | | | | | | 0/1 | var |
| sinrValue = 12th SINR in the first PRB (not always present) | | | | | | | | 0/1 | var |
| sinrCompParam | | | | | | | | 0/1 | var |
| sinrValue = 1st SINR in the second PRB | | | | | | | | 1 | var |
| sinrValue = 2nd SINR in the second PRB (not always present) | | | | | | | | 0/1 | var |
| ... | | | | | | | |  | var |
| sinrValue = 11th SINR in the second PRB (not always present) | | | | | | | | 0/1 | var |
| sinrValue = 12th SINR in the second PRB (not always present) | | | | | | | | 0/1 | var |
| NOTE 1: Shading: yellow is transport header, pink is radio application header, others are repeated sections. NOTE 2: Number of bytes given in column "# of bytes" assumes iqWidth = 8 but other iqWidth values are possible. NOTE 3: The example assumes numPrbu = 2, other values are permitted.  NOTE 4: Section Type 9 follows 1-byte alignment per PRB. Refer to clause 7.2.11 for details. | | | | | | | | | |

#### Section Type 10 elements

Section Type 10 is used for sending RRM measurement reports from O-RU to O-DU; see Table 7.4.12-1:

* Common Header Fields:
  + **dataDirection** (data direction (gNB Tx/Rx)) field: 1 bit**.**
    - value = 0 (uplink) shall be used
  + **payloadVersion** (payload version) field: 3 bits:
    - value = 1 shall be set (1st protocol version for payload and time reference format).
  + **reserved** (reserved for future use) field: 4 bits**.**
  + **frameId** (frame identifier) field: 8 bits.
  + **subframeId** (subframe identifier) field: 4 bits.
  + **slotID** (slot identifier) field: 6 bits.
  + **startSymbolId** (start symbol id) field: 6 bits.
  + **numberOfsections** (number of sections) field: 8 bits.
  + **sectionType** (Section Type) field: 8 bits:
    - value = 10 shall be set.
  + **reserved** (reserved for future use) field: 16 bits**.**
* Section Fields:
  + **sectionId** (section identifier) field: 12 bits.
  + **rb** (resource block identifier) field: 1 bit.
  + **reserved** (reserved for future use) field: 1 bit.
  + **startPrbc** (starting PRB of data section description) field: 10 bits.
  + **numPrbc** (number of contiguous PRBs per data section description) field: 8 bits.
  + **reMask** (resource element mask) field: 12 bits.
  + **numSymbol** (number of symbols) field: 4 bits.
  + **ef** (extension flag) field: 1 bit.
  + **ueId** (UE identifier) field: 15 bits.
* Section extensions (optional, supported Section Extensions described in clause 9.2.1)
* Measurement report structure (at least one report, additional reports indicated by 'mf' flag)
  + **mf** (measurement flag) field: 1 bit.
  + **measTypeId** (measurement type identifier) field: 7 bits.
    - Different RRM measurements are indicated by different measTypeId values. More details are described in the following subclauses.
  + **measDataSize** (measurement data size) field: 16 bits.
  + Measurement data report field: variable size.
    - The structure and format depend on the measTypeId value which indicates what RRM measurement is reported in the measDataReport. More details are described in the following subclauses.
* **measTypeId** = 1 shall be set for **measTypeId**: MEAS\_UE\_TAE; see Table 7.4.12-2
  + **measTypeId** (MEAS\_UE\_TAE measurement type): 8 bits
  + reserved: 8 bits
  + **measDataSize** (length of measurement report): 16 bits
  + **ueTae** (UE-TAE measurement value): 16 bits
  + reserved: 16 bits
* **measTypeId** = 2 shall be set for **measTypeId**: MEAS\_UE\_LAYER\_POWER; see Table 7.4.12-3
  + **measTypeId** (MEAS\_UE\_LAYER\_POWER measurement type): 8 bits
  + reserved: 8 bits
  + **measDataSize** (length of measurement report): 16 bits
  + **ueLayerPower** (UE layer power): 16 bits per value
  + zero padding to ensure 4-byte boundary alignment: 0/2 bytes
* **measTypeId** = 3 shall be set for **measTypeId**: MEAS\_UE\_FREQ\_OFFSET; see Table 7.4.12-4
  + **measTypeId** (MEAS\_UE\_FREQ\_OFFSET measurement type): 8 bits
  + reserved: 8 bits
  + **measDataSize** (length of measurement report): 16 bits
  + **ueFreqOffset** (UE frequency offset): 16 bits
  + reserved: 16 bits
* **measTypeId** = 4 shall be set for **measTypeId**: MEAS\_IPN\_ALLOC; see Table 7.4.12-5
  + **measTypeId** (MEAS\_IPN measurement type): 8 bits
  + reserved: 8 bits
  + **measDataSize** (length of measurement report): 16 bits
  + **ipnPower** (IpN power per PRB): 16 bits per value
  + zero padding to ensure 4-byte boundary alignment: 0/2 bytes
* **measTypeId** = 5 shall be set for **measTypeId**: MEAS\_IPN\_UNALLOC; see Table 7.4.12-6
  + **measTypeId** (MEAS\_IPN measurement type): 8 bits
  + reserved: 8 bits
  + **measDataSize** (length of measurement report): 16 bits
  + **ipnPower** (IpN power per PRB): 16 bits per value
  + zero padding to ensure 4-byte boundary alignment: 0/2 bytes
* **measTypeId** = 6 shall be set for **measTypeId**: MEAS\_ANT\_DMRS\_SNR; see Table 7.4.12-7
  + **measTypeId** (MEAS\_ANT\_DMRS\_SNR measurement type): 8 bits
  + **numElements** (number of antennas, or dimension reduced antennas, for which measurement is reported): 8 bits
  + **measDataSize** (length of measurement report): 16 bits
  + **antDmrsSnrVal** (SNR per antenna): 16 bits per value
  + zero padding to ensure 4-byte boundary alignment: 0/2 bytes

**Table 7.4.12-1: RRM measurement reports (Section Type 10)**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **Section Type 10: RRM Measurement reports** | | | | | | | | | |
| **0(msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7(lsb)** | **# of bytes** | **Octet**  **(NOTE 2)** |
| Transport Header, see clause 5.1.3 | | | | | | | | 8 | 1 |
| dataDir (NOTE 1) | payloadVersion=1 | | | reserved | | | | 1 | 9 |
| frameId | | | | | | | | 1 | 10 |
| subframeId | | | | slotId[5:2] | | | | 1 | 11 |
| slotId[1:0] | | startSymbolId | | | | | | 1 | 12 |
| numberOfsections | | | | | | | | 1 | 13 |
| sectionType=10 | | | | | | | | 1 | 14 |
| reserved | | | | | | | | 2 | 15 |
| sectionId[11:4] | | | | | | | | 1 | 17 |
| sectionId[3:0] | | | | rb | reserved | startPrbc[9:8] | | 1 | 18 |
| startPrbc[7:0] | | | | | | | | 1 | 19 |
| numPrbc | | | | | | | | 1 | 20 |
| reMask [11:4] | | | | | | | | 1 | 21 |
| reMask [3:0] | | | | numSymbol | | | | 1 | 22 |
| ef | ueId[14:8] | | | | | | | 1 | 23 |
| ueId[7:0] | | | | | | | | 1 | 24 |
| Section Extensions as indicated by "ef" | | | | | | | | var | 25 |
| mf | 1st measurement report (always present) | | | | | | | var | 4N+1 |
| Additional measurement reports as indicated by "mf" in previous report. | | | | | | | | var | 4P+1 |
| ... | | | | | | | |  |  |
| sectionId[11:4] | | | | | | | | 1 | 4Q+1 |
| sectionId[3:0] | | | | rb | reserved | startPrbc[9:8] | | 1 | 4Q+2 |
| startPrbc[7:0] | | | | | | | | 1 | 4Q+3 |
| numPrbc | | | | | | | | 1 | 4Q+4 |
| reMask [11:4] | | | | | | | | 1 | 4Q+5 |
| reMask [3:0] | | | | numSymbol | | | | 1 | 4Q+6 |
| ef | ueId[14:8] | | | | | | | 1 | 4Q+7 |
| ueId[7:0] | | | | | | | | 1 | 4Q+8 |
| Section Extensions as indicated by "ef" | | | | | | | | var | 4Q+9 |
| mf | 1st measurement report (always present) | | | | | | | var |  |
| Additional measurement reports as indicated by "mf" in previous report. | | | | | | | | var |  |
| NOTE 1: dataDir is dataDirection NOTE 2: N, P, and Q are integers | | | | | | | | | |

**Table 7.4.12-2: UE Timing Advance Error measurement report (measTypeId = 1)**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0(msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7(lsb)** | **# of bytes** | **Octet** |
| mf | measTypeId=1 | | | | | | | 1 | 1 |
| reserved | | | | | | | | 1 | 2 |
| measDataSize[15:0] = 2 | | | | | | | | 2 | 3 |
| ueTae | | | | | | | | 2 | 5 |
| reserved[15:0] | | | | | | | | 2 | 7 |

**Table 7.4.12-3: UE layer signal power measurement report (measTypeId = 2)**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0(msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7(lsb)** | **# of bytes** | **Octet** |
| mf | measTypeId=2 | | | | | | | 1 | 1 |
| reserved | | | | | | | | 1 | 2 |
| measDataSize[15:0] | | | | | | | | 2 | 3 |
| 1st layer ueLayerPower[15:0] | | | | | | | | 2 | 5 |
| ... | | | | | | | | var | var |
| last layer ueLayerPower[15:0] | | | | | | | | 2 | var |
| padding to ensure 4-byte boundary | | | | | | | | var | var |

**Table 7.4.12-4: UE frequency offset measurement report (measTypeId = 3)**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0(msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7(lsb)** | **# of bytes** | **Octet** |
| mf | measTypeId=3 | | | | | | | 1 | 1 |
| reserved | | | | | | | | 1 | 2 |
| measDataSize[15:0] = 2 | | | | | | | | 2 | 3 |
| ueFreqOffset[15:0] | | | | | | | | 2 | 5 |
| reserved[15:0] | | | | | | | | 2 | 7 |

**Table 7.4.12-5: IpN for allocated PRBs measurement (measTypeId = 4)**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0(msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7(lsb)** | **# of bytes** | **Octet** |
| mf | measTypeId=4 | | | | | | | 1 | 1 |
| reserved | | | | | | | | 1 | 2 |
| measDataSize[15:0] | | | | | | | | 2 | 3 |
| reserved | | symbolMask[13:8] | | | | | | 1 | 5 |
| symbolMask[7:0] | | | | | | | | 1 | 6 |
| 1st PRB ipnPower | | | | | | | | 2 | 7 |
| ... | | | | | | | | var | 9 |
| last PRB ipnPower | | | | | | | | 2 | var |
| padding to ensure 4-byte boundary | | | | | | | | var | var |

**Table 7.4.12-6: IpN for unallocated PRBs measurement (measTypeId = 5)**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0(msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7(lsb)** | **# of bytes** | **Octet** |
| mf | measTypeId=5 | | | | | | | 1 | 1 |
| reserved | | | | | | | | 1 | 2 |
| measDataSize[15:0] | | | | | | | | 2 | 3 |
| reserved | | symbolMask[13:8] | | | | | | 1 | 5 |
| symbolMask[7:0] | | | | | | | | 1 | 6 |
| 1st PRB ipnPower | | | | | | | | 2 | 7 |
| ... | | | | | | | | var | 9 |
| last PRB ipnPower | | | | | | | | 2 | var |
| padding to ensure 4-byte boundary | | | | | | | | var | var |

**Table 7.4.12-7: DMRS-SNR measurement (measTypeId = 6)**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0(msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7(lsb)** | **# of bytes** | **Octet** |
| mf | measTypeId=6 | | | | | | | 1 | 1 |
| numElements[7:0] | | | | | | | | 1 | 2 |
| measDataSize[15:0] | | | | | | | | 2 | 3 |
| 1st antDmrsSnrVal | | | | | | | | 2 | 5 |
| ... | | | | | | | | var | var |
| last antDmrsSnrVal | | | | | | | | 2 | var |
| padding to ensure 4-byte boundary | | | | | | | | var | var |

#### Section Type 11 elements

Section Type 11 is sent from O-DU to O-RU to request RRM measurements. It supports a command to request IpN for unallocated PRBs, see table 7.4.13-1.

* Common Header Fields:
  + **dataDirection** (data direction (gNB Tx/Rx)) field: 1 bit**.**
    - value = 0 (uplink) shall be used
  + **payloadVersion** (payload version) field: 3 bits:
    - value = 1 shall be set (1st protocol version for payload and time reference format).
  + **reserved** (reserved for future use) field: 4 bits.
  + **frameId** (frame identifier) field: 8 bits.
  + **subframeId** (subframe identifier) field: 4 bits.
  + **slotID** (slot identifier) field: 6 bits.
  + **startSymbolId** (start symbol id) field: 6 bits.
  + **numberOfsections** (number of sections) field: 8 bits.
  + **sectionType** (Section Type) field: 8 bits:
    - value = 11 shall be set.
  + **reserved**: 16 bits.
* Section Fields:
  + **sectionId** (section identifier) field: 12 bits.
  + **rb** (resource block identifier) field: 1 bit.
  + **reserved** (reserved for future use) field: 1 bit.
  + **startPrbc** (starting PRB of data section description) field: 10 bits.
  + **numPrbc** (number of contiguous PRBs per data section description) field: 8 bits.
  + **reMask** (resource element mask) field: 12 bits.
  + **numSymbol** (number of symbols) field: 4 bits.
  + **ef** (extension flag) field: 1 bit.
  + **reserved** (not used) field: 15 bits
* Section Extensions (optional, SE 6, SE 12 can be used by O-DU for efficient PRB description)
* Measurement command (One or more measurement commands with common header and command specific data.)
  + Common header
    - **mf** (measurement flag) field: 1 bit
    - **measTypeId** (measurement type identifier) field: 7 bits
    - **measCmdSize** (meas command size) field: 16 bits
  + Measurement command data: various
  + zero padding to ensure 4-byte boundary alignment: 0-3 bytes
* measTypeId = 5 shall be set for measTypeId: MEAS\_IPN\_UNALLOC, see Table 7.4.13-2
  + **mf** (measurement flag) field: 1 bit
  + **measTypeId** (MEAS\_IPN\_UNALLOC measurement type) field: 7 bits
  + reserved: 8 bits
  + **measCmdSize** (meas command size) field: 16 bits
  + **symbolMask** (symbol mask): 14 bits

**Table 7.4.13-1: Request RRM measurement (Section Type 11)**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **Section Type 11: Request RRM measurement** | | | | | | | | | |
| **0(msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7(lsb)** | **# of bytes** | **Octet**  **(NOTE 2)** |
| Transport Header, see clause 5.1.3 | | | | | | | | 8 | 1 |
| dataDir (NOTE 1) | payloadVersion=1 | | | reserved | | | | 1 | 9 |
| frameId | | | | | | | | 1 | 10 |
| subframeId | | | | slotId[5:2] | | | | 1 | 11 |
| slotId[1:0] | | startSymbolId | | | | | | 1 | 12 |
| numberOfsections | | | | | | | | 1 | 13 |
| sectionType=11 | | | | | | | | 1 | 14 |
| reserved | | | | | | | | 2 | 15 |
| sectionId[11:4] | | | | | | | | 1 | 17 |
| sectionId[3:0] | | | | rb | reserved | startPrbc[9:8] | | 1 | 18 |
| startPrbc[7:0] | | | | | | | | 1 | 19 |
| numPrbc | | | | | | | | 1 | 20 |
| reMask[11:4] | | | | | | | | 1 | 21 |
| reMask[3:0] | | | | numSymbol | | | | 1 | 22 |
| ef | reserved | | | | | | | 1 | 23 |
| reserved | | | | | | | | 1 | 24 |
| Section Extensions as indicated by "ef" | | | | | | | | var | 25 |
| mf | 1st measurement command (always present) | | | | | | | var | 4N+1 |
| Additional measurement commands as indicated by "mf" in previous meas. command | | | | | | | | var | 4P+1 |
| ... | | | | | | | |  |  |
| sectionId[11:4] | | | | | | | | 1 | 4Q+1 |
| sectionId[3:0] | | | | rb | reserved | startPrbc[9:8] | | 1 | 4Q+2 |
| startPrbc[7:0] | | | | | | | | 1 | 4Q+3 |
| numPrbc | | | | | | | | 1 | 4Q+4 |
| reMask=4095[11:4] | | | | | | | | 1 | 4Q+5 |
| reMask[3:0] | | | | numSymbol | | | | 1 | 4Q+6 |
| ef | reserved | | | | | | | 1 | 4Q+7 |
| reserved | | | | | | | | 1 | 4Q+8 |
| Section Extensions as indicated by "ef" | | | | | | | | var | 4Q+9 |
| mf | 1st measurement command (always present) | | | | | | | var |  |
| Additional measurement commands as indicated by "mf" in previous meas. command | | | | | | | | var |  |
| NOTE 1: dataDir is dataDirection NOTE 2: N, P, and Q are integers | | | | | | | | | |

**Table 7.4.13-2: Measurement command for IpN for unallocated PRBs (measTypeId = 5)**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0(msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7(lsb)** | **# of bytes** | **Octet** |
| mf | measTypeId=5 | | | | | | | 1 | N |
| reserved | | | | | | | | 1 | N+1 |
| measCmdSize[15:0]=0x0002 | | | | | | | | 2 | N+2 |
| reserved | | symbolMask[13:8] | | | | | | 1 | N+4 |
| symbolMask[7:0] | | | | | | | | 1 | N+5 |
| reserved | | | | | | | | 2 | N+6 |

## Coding of Section Type IEs

#### Transport layer

See clause 5.1.3 for transport header information element details.

#### Application layer, common

###### dataDirection (data direction (gNB Tx/Rx))

**Description:** This parameter indicates the gNB data direction. This parameter is used in combination with eAxC\_ID to identify to or from which O-RU low level endpoint the C-Plane/U-Plane message is targeted or originated.

* data direction value 1b implies the C-Plane/U-Plane message is from or to an O-RU low level tx endpoint.
* data direction value 0b implies the C-Plane/U-Plane message is from or to an O-RU low level rx endpoint.

NOTE: Generation and checking of ecpriSeqid (5.1.3.2.8) depends on value of the dataDirection when independent sequence generator is used for each direction.

**Value range:** {0b=Rx (i.e. UL), 1b=Tx (i.e. DL)}.

**Type:** binary bit.

**Field length:** 1 bit.

###### payloadVersion (payload version)

**Description:** This parameter defines the payload protocol version valid for the following IEs in the application layer. In the present document payloadVersion=001b shall be used.

**Value range:** {000b-111b=Payload version}.

**Type:** unsigned integer.

**Field length:** 3 bits.

**Default Value:** 001b (version 1 assumed).

###### filterIndex (filter index)

**Description:** This parameter defines an index to the channel filter to be used between IQ data and air interface, both in DL and UL. For most physical channels filterIndex =0000b may be used which indexes the standard channel filter, e.g. 100 MHz channel filter for 100 MHz nominal carrier bandwidth. Another use case is PRACH in UL, where different filter indices can be used for different PRACH formats, assuming that before FFT processing of PRACH data there is a separate PRACH filter or PRACH filter in addition to the standard channel filter in UL. For PRACH, when Section Type 3 message is used, there is typically also a frequency offset (see freqOffset) applied before the PRACH filter. filterIndex coding shall conform to Table 7.5.2.3-1.

* Filter index shall be commanded from the O-DU to the O-RU. However, it is not mandatory to command special filters, and filter index = 0000b is also allowed for PRACH.
* When using filter indices corresponding to PRACH, the first RE of the first PRB addressed inside the section Id shall correspond with the first guard tone used at the lower edge of the PRACH frequency block as specified

in 3GPP TS 36.211 [42], clause 5.7 and TS 38.211 [4], clause 6.3.3.2. In case of fragmentation of one data section over multiple U-Plane messages, this is applicable to the first fragmented section.

* Since different PRACH formats may be assigned to the same filterIndex value, optionally O-RU can notify by M-Plane the specific supported formats (grouped into PRACH format-groups) in o-ran-uplane-conf.yang module on a per-endpoint basis.
* O-DU shall set filterIndex as 1000b for NPUSCH and 0100b for NPRACH as specified in Table 7.5.2.3-1 in ST 3 C-Plane message when SSSC or SSMC method is used for NB-IoT carriers for UL direction as specified in clauses 15.4.1 and 15.4.2.
* When O-RU reports a non-empty **supported-pass-band-for-filterindex0x9-per-scs** for the given SCS indicated via frameStructure, the O-DU should set filterIndex as 1001b (0x9) for mixed numerology NR channels like NR PUxCH, NR PDxCH, SSB except PRACH and NB-IoT as specified in Table 7.5.2.3-1, when ST 3 C-Plane message is used. Instead of multiple C-Plane messages, it is recommended to use one C-Plane message with multiple section descriptions when filterIndex 0x9 is used. The O-DU shall not send more messages than indicated by the capability parameter **supported-max-num-msg-for-filterindex0x9-per-scs.** This parameter indicates the capability of receiving messages specific for filterIndex 0x9 and other restrictions for ST 3 messages may exist. When filterIndex 0x9 is used, O-RU shall use minimum pass band filter among the reported passband filter sizes in **supported-pass-band-for-filterindex0x9-per-scs** that can accommodate the full PRB range described by the section descriptions and the Section Extensions in the C-Plane message.

**Value range:** {0000b-1111b}.

**Table 7.5.2.3****-1: Filter index**

|  |  |  |  |
| --- | --- | --- | --- |
| **Value of IE "filter Index"** | **Usage** | **PRACH preamble formats** | **Minimum filter pass band** |
| 0000b=0x0 | standard channel filter | N/A |  |
| 0001b=0x1 | UL filter for PRACH preamble formats | LTE-0, LTE-1, LTE-2, LTE-  3, NR-0, NR-1, NR-2 | 839 x 1.25 kHz = 1048.75 kHz |
| 0010b=0x2 | NR-3 | 839 x 5 kHz = 4195 kHz |
| 0011b=0x3 | NR-A1, NR-A2, NR-A3,  NR-B1, NR-B2, NR-B3, NR-B4, NR-C0, NR-C2 | 139 x ?fRA  (See SCS in Table 7.5.2.13-3) |
| 0110b=0x6 | 1151 x 15 kHz = 17265 kHz |
| 0111b=0x7 | 571 x 30 kHz = 17130 kHz |
| 0100b=0x4 | UL filter for NPRACH | LTE-NB0, LTE-NB1 LTE-NB0-a, LTE-NB1-a LTE-NB2 | 48 x 3.75 kHz = 180 kHz and  144 x 1.25 kHz = 180 kHz  for SSSC,  or numPrbc x 12 x SCS for SSMC (NOTE) |
| 0101b=0x5 | UL filter for PRACH preamble formats | LTE-4 | 139 x 7.5 kHz = 1042.5 kHz |
| 1000b=0x8 | UL filter for NPUSCH | N/A | 180 kHz for SSSC,  or numPrbc x 12 x SCS for SSMC (NOTE) |
| 1001b=0x9 | Mixed numerology and other channels except PRACH and NB-IoT | N/A | O-RU selects minimum pass band filter among the reported passband filter sizes in **supported-pass- band-for-filterindex0x9-per-scs** that can accommodate the full PRB range described by the section  descriptions and the Section Extensions in the C-Plane message |
| 1010b...1111b | Reserved |  |  |
| NOTE: Refer to clauses 15.4.1 and 15.4.2 for SSSC and SSMC operation. | | | |

**Type:** unsigned integer.

**Field length:** 4 bits.

**Default Value:** 0000b (no special filter).

###### frameId (frame identifier)

**Description:** This parameter is a counter for 10 ms frames (wrapping period 2.56 seconds), specifically frameId = frame number modulo 256. When the SCS is less than 15 kHz, e.g. in PRACH and NB-IoT, then the frameId shall take the value of the first symbol in a multi-symbol C-Plane section description.

**Value range:** {0000 0000b-1111 1111b}.

**Type:** unsigned integer.

**Field length:** 8 bits.

###### subframeId (subframe identifier)

**Description:** This parameter is a counter for 1 ms sub-frames within a 10 ms frame. When the SCS is less than 15 kHz in e.g. PRACH and NB-IoT, then the subframeId shall take the value of the first symbol in a multi-symbol C-Plane section description.

**Value range:** {0000b-1111b}.

**Type:** unsigned integer.

**Field length:** 4 bits.

###### slotId (slot identifier)

**Description:** This parameter is the slot number within a 1 ms sub-frame. All slots in one sub-frame shall be counted by this parameter, slotId running from 0 to Nslot-1. If a C-Plane message is addressing symbols of SCS less than 15 kHz, the slot duration exceeds duration of a sub-frame (Nslot = 1) and slotId shall be set to zero. In the present document the maximum Nslot=16, all other values of the 6 bits are reserved for future use.

**Value range:** {00 0000b-00 1111b=slotID, 01 0000b-11 1111b=Reserved}.

**Type:** unsigned integer.

**Field length:** 6 bits.

###### startSymbolId (start symbol identifier)

**Description:** This parameter identifies the symbol number (within a slot) of the earliest symbol, to which the information of this message is applicable. When the SCS value provided by "frameStructure" in the C-Plane message is less than 15 kHz, startSymbolId shall be based on the frame structure of SCS 15 kHz, specified in clause 7.2.2. When SSSC or SSMC method is used (see clauses 15.4.1 and 15.4.2), startSymbolId shall be set as per clause 15.6.

NOTE: If the C-Plane message containing this parameter includes a Section Extension (e.g. SE 6, SE 12) or command type (Section Type 4) containing a mask for symbols (e.g. symbolMask, dirPattern, guardPattern), all bits in the mask before startSymbolId are expected to be set to zero by the O-DU.

**Value range:** {00 0000b-11 1111b}.

**Type:** unsigned integer.

**Field length:** 6 bits.

###### numberOfsections (number of sections)

**Description:** This parameter indicates the number of data section descriptions (separate citations of section ID even for multiple citations of the same sectionId) included in this C-Plane message.

**Value range:** {0000 0000b-1111 1111b}.

**Type:** unsigned integer.

**Field length:** 8 bits.

###### sectionType (Section Type)

**Description:** This parameter determines the characteristics of U-Plane data to be transferred or received from a beam with one pattern id.

**Value range:** {0000 0000b-1111 1111b=Section Type, see Table 7.3.1-1 for Section Type meanings}.

**Type:** unsigned integer.

**Field length:** 8 bits.

###### udCompHdr (user data compression header)

See clause 8.3.3.13 for the description of this parameter.

The udCompHdr information is provided on the U-Plane, instructing the O-RU (on DL) and O-DU (on UL) how to interpret and decompress the received U-Plane data. For UL U-Plane data compression, the O-DU shall instruct the O- RU via udCompHdr in a C-Plane message. This means the udCompHdr in a C-Plane message only has meaning for UL U-Plane data (dataDirection = 0b) and should be set to 0x00 when dataDirection = 1b (DL data), and the receiving O- RU shall ignore the received udCompHdr value. When static data format and compression is used (see clause 8.1.2) then udCompHdr is not needed in any C-Plane message and should be set to 0x00, and the receiving O-RU shall ignore the received udCompHdr value.

The O-DU shall not send different values of udCompHdr for the same data section, even if it is sent over separate C- Plane messages discriminated by different reMask values. Only a single compression method per data section is supported (see clause 7.5.3.1).

###### numberOfUEs (number Of UEs)

**Description:** This parameter applies to Section Type 6 messages and indicates the number of UEs (for which channel information is provided) are included in the message.

NOTE: This allows the parser to determine when the last UE's data has been parsed.

**Value range:** {0000 0000b-1111 1111b}.

**Type:** unsigned integer.

**Field length:** 8 bits.

###### timeOffset (time offset)

**Description:** This parameter defines the time\_offset from the start of the slot to the start of the Cyclic Prefix (CP) in number of samples Ts (=1/30.72 MHz as specified in 3GPP TS 38.211 [4], clause 4.1):

time\_offset = timeOffset ? Ts

The time\_offset value shall be less than the slot length. The slot length is based on the SCS on which the startSymbolId numerology is based (see Table 7.2.3.3-1 and Table 7.2.3.3-2 in clause 7.2.3.3). For the mixed numerology case (non- PRACH), timeOffset points to the same timing pointed by startSymbolId. For PRACH, refer to clause 4.4.3.

**Value range:** {0000 0000 0000 0000b-1111 1111 1111 1111b}.

**Type:** unsigned integer.

**Field length:** 16 bits.

###### frameStructure (frame structure)

**Description:** This parameter defines the frame structure. The first 4 bits define the FFT/iFFT size being used for all IQ data processing related to this message. The second 4 bits define the sub carrier spacing as well as the number of slots per 1 ms sub-frame according to 3GPP TS 38.211 [4], taking for completeness also 3GPP TS 36.211 [42] into account. The parameter u = 0,...,4 from 3GPP TS 38.211 [4] is extended to apply for PRACH processing. Table 7.5.2.13-1 shall be used for the frameStructure bit allocation, while Table 7.5.2.13-2 shall be used for the FFT size field definitions and Table 7.5.2.13-3 shall be used for the sub-carrier spacing field definitions.

NOTE: The parameter "FFTSize" does not dictate the O-RU's method of time-to-frequency conversion.

**Value range:** {0000 0000b-1111 1111b}

**Bit allocations**

**Table 7.5.2.13-1: frameStructure bit allocation**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **Number of Octets** |  |
| FFT Size | | | | u (Subcarrier spacing) | | | | 1 | Octet 1 |

**Table 7.5.2.13-2: FFT size**

|  |  |
| --- | --- |
| **Value of IE "FFT\_size"** | **FFT/iFFT size** |
| 0000b | Reserved (no FFT/iFFT processing) |
| 0001b...0011b | Reserved |
| 0100b | 16 |
| 0101b | 32 |
| 0110b | 64 |
| 0111b | 128 |
| 1000b | 256 |
| 1001b | 512 |
| 1010b | 1024 |
| 1011b | 2048 |
| 1100b | 4096 |
| 1101b | 1536 |
| 1110b | 3072 |
| 1111b | Reserved |

**Table 7.5.2.13-3: Sub-Carrier spacing**

|  |  |  |  |  |
| --- | --- | --- | --- | --- |
| **Value of IE "SCS"** | **3GPP "u"** | **Subcarrier spacing ?f** | **Number of slots per 1 ms sub-**  **frame: Nslot** | **Slot length** |
| 0000b | 0 | 15 kHz | 1 | 1 ms |
| 0001b | 1 | 30 kHz | 2 | 500 us |
| 0010b | 2 | 60 kHz | 4 | 250 us |
| 0011b | 3 | 120 kHz | 8 | 125 us |
| 0100b | 4 | 240 kHz | 16 | 62.5 us |
| 0101b...1011b | N/A | Reserved | Reserved | Reserved |
| 1100b | N/A | 1.25 kHz | 1 | 1 ms |
| 1101b | N/A | 3.75 kHz (LTE-specific) | 1 | 1 ms |
| 1110b | N/A | 5 kHz | 1 | 1 ms |
| 1111b | N/A | 7.5 kHz (LTE-specific) | 1 | 1 ms |

**Type:** unsigned integer (concatenated bit fields).

**Field length:** 8 bits.

###### cpLength (cyclic prefix length)

**Description:** This parameter defines the length CP\_length of the Cyclic Prefix (CP) as follows, based on Ts

(= 1/30.72 MHz as specified in 3GPP TS 38.211 [4], clause 4.1): CP\_length = cpLength x Ts

The cpLength parameter is used with Section Types 0 and 3, and is applicable to all symbols addressed by the C-Plane message. In addition to the values defined in 3GPP (3GPP TS 36.211 [42] and 3GPP TS 38.211 [4]), the value 0 shall be supported when applicable to the conveyed channel such as PRACH (see clause 4.4.3 for such cases where normal cyclic prefix numerology shall be used for PRACH timing reference). The value 0 is not used when dataDirection bit is set to 1. The slot start time reference differentiation between normal CP and extended CP (i.e. 60 kHz SCS and extended 60 kHz SCS in NR) shall be based on cpLength and frameStructure. Extended CP for NR shall be indicated by the value 128 for cpLength and the SCS value 60 kHz provided by frameStructure. With Section Type 1, the CP properties shall be configured over M-Plane and the cyclic prefix shall have the following properties:

* **cp-type**: Normal or extended.
* **cp-length**: same unit as cpLength defined in this clause; used for symbol 0 for NR & LTE, and symbol 7x2u

for NR (u as defined in Table 7.5.2.13-3 with "N/A" for u shall be replaced by "0").

* **cp-length-other**: same unit as cpLength defined in this clause; used for other symbols than those using cp- length.

**Value range:** {0000 0000 0000 0000b-1111 1111 1111 1111b}.

**Type:** unsigned integer.

**Field length:** 16 bits.

###### ciCompHdr (channel information compression header)

**Description:** This parameter defines the compression method and IQ bit width for the channel information.

If the O-RU supports static channel information compression through M-Plane configuration, and static compression is configured, this field shall be set to a value corresponding to the compression method configured via M-Plane. If the O- RU supports dynamic channel information compression, then O-DU may configure dynamic compression via M-Plane with or without providing a list of compression methods that will be used dynamically (i.e. a subset of methods supported by O-RU). If dynamic compression is configured via M-Plane without providing a list of compression

methods, this field shall be set to a value corresponding to one of dynamic compression methods supported by O-RU. If dynamic compression is configured with a list of compression methods, then this field shall be set to a value corresponding to one of compression methods in the list. If the ciCompHdr parameter value in a C-Plane message and M-Plane configuration are not compatible, then the O-RU may discard the message or process the message as per M- Plane configuration or as per ciCompHdr value (this may result in O-RU incorrectly decoding channel information).

**Value range:** {0000 0000b-1111 0001b}.

**Bit allocations:** Table 7.5.2.15-1 shall be used for the ciCompHdr bit allocation, Table 7.5.2.15-2 shall be used to encode the ciIqWidth value, Table 7.5.2.15-3 shall be used for the ciCompMeth definition, and Table 7.5.2.15-4 shall be used for the ciCompOpt definition.

**Table 7.5.2.15-1: ciCompHdr bit allocation**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **Number of Octets** |  |
| ciIqWidth | | | | ciCompMeth | | | ciCompOpt | 1 | Octet 1 |

**Table 7.5.2.15-2: ciIqWidth definition**

|  |  |
| --- | --- |
| **ciIqWidth** | **Bit width of each I and each Q** |
| 0000-1111b | value of ciIqWidth except a value of zero means 16 bits  e.g. ciIqWidth = 0000b means I and Q are each 16 bits wide  e.g. ciIqWidth = 0001b means I and Q are each 1 bit wide  e.g. ciIqWidth = 1111b means I and Q are each 15 bits wide |

**Table 7.5.2.15-3: ciCompMeth definition**

|  |  |  |
| --- | --- | --- |
| **ciCompMeth** | **compression method** | **ciIqWidth meaning** |
| 000b | no compression | bitwidth of each uncompressed I and Q value |
| 001b | block floating point, | bitwidth of each I and Q mantissa value |
| 010b | block scaling | bitwidth of each I and Q scaled value |
| 011b | ?-law | bitwidth of each compressed I and Q value |
| 100b -111b | reserved for future methods | depends on the specific compression method |

**Table 7.5.2.15-4: ciCompOpt definition**

|  |  |
| --- | --- |
| **ciCompOpt** | **Compression Option** |
| 0b | compression per UE, one ciCompParam exists before the I/Q value of each UE |
| 1b | compression per PRB, one ciCompParam exists before the I/Q value of each PRB |
| NOTE 1: ciCompOpt parameter is applicable only when compression is used i.e. ciCompMeth set to value other than 000b.  NOTE 2: When channel information compression is supported, O-RU shall support both compression per UE (ciCompOpt=0) and compression per PRB (ciCompOpt=1). | |

**Type:** unsigned integer (concatenated bit fields).

**Field length:** 8 bits.

**Default Value:** 0000 0000b (no compression, 16-bit I and Q).

###### scs (sub-carrier spacing)

**Description:** When included in a Section Type 4 message, this parameter specifies the subcarrier spacing for the slot to which Section Type 4 slot level message shall apply. This parameter is used by the O-RU to derive reception window based on the scs for mixed numerology endpoints. Refer to Table 7.5.2.13-3: Sub-Carrier spacing.

This parameter is also included in a Section Type 8 message but the value is only used when the Section Type 8 message has ready = 1 (see clause 7.5.3.55). When ready = 0, the scs parameter shall be ignored by the O-DU and may be set to any value by the O-RU. In the Section Type 8 ready message, this parameter indicates the time-duration of the "extra" slot needed prior to the O-RU being available for transmission and reception.

**Value range:** Same as Table 7.5.2.13-3.

**Type:** unsigned integer.

**Field length:** 4 bits.

###### cmdScope (command scope)

**Description:** Section Type 4 C-Plane messages are structured to apply to a group of endpoints. The group of endpoints to which a given 'st4CmdType' shall apply is derived from eAxC\_ID value in the Section Type 4 C-Plane message transport header, the dataDirection bit in the Section Type 4 header, and the value of this parameter 'cmdScope' in Section Type 4 section header. An endpoint's support for Section Type 4 shall mean that the endpoint (eAxC\_ID in the C-Plane transport header) can directly receive and execute the Section Type 4 command and all endpoints in the command scope are impacted by the Section Type 4 command regardless of their support for Section Type 4.

EXAMPLE: If a group of eAxC\_IDs: 1 to 20 are assigned to tx-array-0 in the O-RU, a Section Type 4 command with transport header eAxC\_ID=1, 'dataDirection = 1', cmdScope = 'ARRAY-COMMAND (0000b)' shall apply to all eAxC\_IDs: 1 to 20 associated with tx-array-0.

The defined value of command scope is defined in Table 7.5.2.17-1.

**Table 7.5.2.17-1: command scope values and description**

|  |  |
| --- | --- |
| **cmdScope** | **Description** |
| ARRAY-COMMAND | The command applies to:   * all endpoints associated with the array associated with the endpoint receiving the ST 4 message, and * all endpoints associated with the arrays having shared or co-located array elements with the array associated with the endpoint receiving the ST 4 message.   If the command type applies to both UL and DL then the command applies to endpoints of both RX and TX directions regardless of the direction of endpoint receiving the ST 4 message. Otherwise, the command applies to endpoints of the same direction as the of endpoint receiving the ST 4 message. |
| CARRIER-COMMAND | The command applies to all endpoints associated with the array carrier associated with the endpoint receiving the ST 4 message. |
| O-RU-COMMAND | If the command type applies to both UL and DL then the command applies to endpoints of both RX and TX directions regardless of the direction of endpoint receiving the ST 4 message. Otherwise the command applies to endpoints of the same direction as the of endpoint receiving the ST 4 message. In the case of multiple O-DUs sharing RF circuits in a single O-RU, the O-DUs are expected to cooperate to ensure the impact of the Section Type 4 command is appropriate for all affected O-DUs. |

To handle shared/co-located array elements of [tr]x-arrays, if an endpoint assigned to a large array is addressed by ST 4 command, any sub-arrays of the large array shall be impacted without having to send the ST 4 command explicitly to

endpoints assigned to the sub-arrays. If an endpoint is assigned to a sub-array addressed by a ST 4 command, the results shall depend on the specific ST 4 command and is documented in the present document for each ST 4 command type.

**Value range:** {0000b - 1111b}.

* 0000b: ARRAY-COMMAND
* 0001b: CARRIER-COMMAND
* 0010b: O-RU-COMMAND
* 0011b - 1111b: reserved

**Type:** unsigned integer.

**Field length:** 4 bits.

###### numberOfST4Cmds (Number of Section Type 4 commands)

**Description:** Number of Section Type 4 commands which are included in the Section Type 4 C-Plane message; the minimum value is one because there shall always be at least one Section Type 4 command in a Section Type 4 message.

**Value range:** {0000 0001b - 1111 1111b}.

* 0000 0000b - reserved

**Type:** unsigned integer.

**Field length:** 8 bits.

###### numSinrPerPrb (number of SINR values per PRB)

**Description:** This parameter indicates the number of SINR values per PRB used for all sections in the Section Type 9 message.This parameter is also present in Section Extension 28. See clause 7.2.11 for further details on SINR reporting. If SE 28 is not used, the value of this parameter in ST 9 shall reflect the value of M-Plane configured parameter sinr- per-prb. If SE 28 is used, the value of this parameter in ST 9 shall reflect the value in SE 28. See clause 7.7.28 for further detail on SE 28. See Table 7.5.2.19-1 for mapping between the number of SINR values per PRB indicated by M- Plane parameter sinr-per-prb and value of numSinrPerPrb.

**Value range:** 0 - 7. Table 7.5.2.19-1 presents meaning of values.

**Table 7.5.2.19-1: Meaning of numSinrPerPrb values.**

|  |  |
| --- | --- |
| **numSinrPerPrb** | **Number of SINR values per PRB** |
| 0 | 1 |
| 1 | 2 |
| 2 | 3 |
| 3 | 4 |
| 4 | 6 |
| 5 | 12 |
| 6 | reserved |
| 7 | reserved |

**Type:** unsigned integer.

**Field length:** 3 bits.

###### oruControlSinrSlotMaskId

**Description:** If O-RU controlled time resolution for SINR reporting is not supported or enabled, this parameter shall be set to 0 and O-DU shall ignore it. If O-RU controlled time resolution for SINR reporting is supported by the O-RU and

enabled by the O-DU, this parameter indicates the SINR time resolution determined by the O-RU and used for the SINR report(s) in all sections of a ST 9 message. The value of this parameter specifies a **sinr-slot-mask-id** value that identifies a **sinr-slot-mask** value in the list **sinr-slot-masks** configured via M-Plane by the O-DU. The list **sinr-slot- masks** contains multiple **sinr-slot-mask** values, each of which is identified by a **sinr-slot-mask-id**. With a **sinr-slot- mask-id** value received in a ST 9, O-DU obtains the corresponding **sinr-slot-mask** value which conveys the information of how each SINR report maps to the symbols in a slot. See clause 7.2.11 for more details about **sinr-slot- mask** value and the list **sinr-slot-masks**.

**Value range:** {1-31}, 0 is a special value which means O-RU controlled time resolution for SINR reporting is not used.

**Type:** unsigned integer.

**Field length:** 5 bits.

#### Application layer, sections

###### sectionId (section identifier)

**Description:** If C-Plane and U-Plane coupling via sectionId (see clause 7.8.1.2) is used then this parameter identifies individual data sections that are described by data section descriptions within the C-Plane message. The purpose of the sectionId is to map U-Plane data sections to the corresponding C-Plane message (and Section Types) associated with the data. Two or more C-Plane data section descriptions with same sectionId may be cited corresponding to a single U- Plane data section containing a combined payload for both citations (e.g. for supporting mixed CSI RS and PDSCH). This case is applicable when usage of reMask is complimentary (or orthogonal) and different beam directions (i.e. beamIds) are given the resource elements. Data sections are specific to an eAxC so a different eAxC may have independently defined data sections (e.g. have different ranges of PRBs contained within), unless otherwise specified (e.g. as in SE 10).

sectionId attributes:

* sectionIds are specific to a slot, so sectionId values may be "reused" for each slot, and the sectionId value for one slot has no specified relation to the sectionId value for a different slot.
* All data in section descriptions with same sectionId value shall have same rb, startPrbc, numPrbc, udCompHdr, and numSymbol IE fields' content.
* An upper bound on the max number of section IDs that can be addressed per eAxC or per sets of eAxCs, per symbol and per slot, for DL and for UL respectively, shall be conveyed via M-Plane messaging as part of the O-RU capabilities description.
* The sectionId cited in a C-Plane message shall have the same value as the sectionId in the corresponding U- Plane message for the given data section as defined by the frameId, subFrameId, slotId, startSymbolId fields and range of relevant PRBs as indicated by the totality of the specified startPrbc/startPrbu and numPrbc/numPrbu fields.

If C-Plane and U-Plane coupling via sectionId (see clause 7.8.1.2) is not used, then the sectionId value is not used for identification of data sections in U-Plane messages and is not used for identification of data section descriptions in C- Plane messages. In this case above rules for uniqueness of sectionId value within slot and restriction on rb, startPrbc, numPrbc, udCompHdr, and numSymbol IE fields' content do not apply. Sender shall send sectionId = 4095. The only exception to this is "Coupling via Frequency and Time with Priorities (Optimized)" where a unique value of sectionId is still used for identification of the highest priority data section descriptions in C-Plane messages (clause 7.8.1.5, restriction 5). The corresponding U-Plane messages shall still use sectionId value as 4095 in this case.

**Value range:** {0000 0000 0000b-1111 1111 1111b}.

**Type:** unsigned integer.

**Field length:** 12 bits.

###### rb (resource block indicator)

**Description:** This parameter indicates if every RB is used or every other RB is used. The starting RB is defined by startPrbc and total number of used RBs is defined by numPrbc.

EXAMPLE: rb = 1, startPrbc = 1, numPrbc = 3, then the PRBs used are 1, 3, and 5.

If numPrbc=0 (i.e. all PRBs), then the sending node shall set the rb value to zero, and the receiving node shall ignore whatever rb value is received and assume it is zero.

If section description includes Section Extension 6 or 12 then the sender shall set the parameter rb to zero. Refer to clause 7.7.6.1, requirement #3 for an exception with respect to Section Extension 6.

When used within Section Type 6, the rb value should be set by the O-DU to "0" and the O-RU shall ignore it.

**Value range:** {0b=every RB used; 1b=every other RB used}.

**Type:** binary bit.

**Field length:** 1 bit.

**Default Value:** 0b (every RB used).

###### symInc (symbol number increment command)

**Description:** If the section description does not include Section Extension 6, 12 and 19, this parameter is used to indicate which symbol number is relevant to the given section description. If the section description includes Section Extension 6, 12 or 19 then set of symbols relevant for the section description shall be given in symbolMask (see clauses 7.7.6.4, 7.7.12.3 and 7.7.19.6). In this case, symInc and numSymbol do not affect the set of symbols relevant for the section description but can affect the following section descriptions if they do not include Section Extension 6, 12 and

19. Regardless of the presence of Section Extension 6, 12 and 19, for each C-Plane message a symbol number shall be maintained and starts with the value of startSymbolId. The same value shall be used for each section in the message as long as symInc is zero. When symInc is one, the maintained symbol number shall be incremented to the next symbol, and that new symbol number shall be used for that section and each subsequent section until the symInc bit is again detected to be one. In the case of a multiple-symbol data section (numSymbol > 1), the new symbol number shall be the one after the last symbol in the data section. In this manner, multiple symbols may be handled by a single C-Plane message.

Additional considerations regarding use of symInc in the C-Plane:

1. symInc may be used when different data section descriptions have a different number of symbols under certain conditions namely that the data section descriptions in the C-Plane message are carefully arranged. The arrangement shall be such that the following procedure as applied by the O-RU works correctly:
   * symbol[s] - symbol addressed by section description s=1...N (considers section descriptions in one C- Plane message, s=1 identifies the first section description) shall be calculated as follows:
   * Assuming symInc[s] and numSymbols[s] are values of corresponding fields of section description s For sake of simplicity, symbol[0] = startSymbolId, symInc[0]=0 and numSymbols[0]=1

for s=1...N (all section descriptions in a message):

* + - If symInc[s] = 0 then symbol[s] = symbol[s-1].
    - Else symbol[s] = symbol[s-1] + numSymbols[s-1].

1. symInc is specific to a data section description and, if any of Section Extension 6, 12 and 19 are not present, symInc is affecting range of symbols described by the section description. When C-Plane and U-Plane coupling via sectionId (see clause 7.8.1.2) is used and a data section is referenced by multiple data section

descriptions (e.g. with different reMask values) if the value of symInc is to be set to 1, then only the first invocation of the sectionId shall have symInc=1 and all other invocations of the sectionId shall have symInc=0 in the same C-Plane message. This assures that the above rule can be applied (in the same C-Plane message only) while assuring that all invocations of the data section descriptions will refer to the same symbols, which shall be the case whether the invocations are in the same C-Plane message or in separate C-Plane messages.

Use of symInc in the U-Plane is independent of the use of symInc in the C-Plane. U-Plane messages include data for a single symbol (to avoid degrading the latency performance of the U-Plane). For this reason, use of symInc=1 shall be prohibited in the U-Plane.

**Value range:** {0b=use the current symbol number; 1b=increment the current symbol number and use that}.

**Type:** binary bit.

**Field length:** 1 bit.

**Default Value:** 0b (do not increment the current symbol number).

###### startPrbc (starting PRB of data section description)

**Description:** In absence of Section Extensions 6, 12 and 13 in the section description, startPrbc parameter conveys the first (lowest frequency) PRB described by the section description. The interpretation of startPrbc is affected by presence of Section Extensions 6, 12 and 13; see clause 7.7.6, 7.7.12 and 7.7.13 for more details.

Section description shall address resource elements without ambiguity: a resource element addressed by a section description shall not be addressed by other section description, with exception for C-Plane and U-Plane coupling via frequency and time with priorities which resolves ambiguity by differences in priorities (see clause 7.8.1.4 and 7.8.1.5). If coupling of C-Plane and U-Plane via sectionId value is used a PRB addressed by a section description shall not be addressed by a section description with a different value of sectionId.

freqOffset affects the frequency span for specific range of PRB numbers. Therefore "shall address resource elements without ambiguity" shall consider the value of freqOffset.

Centre frequency FRE in Hz of a subcarrier corresponding to RE #k (k = 0 ... 11) in PRB identified by startPrbc is defined by:

FRE = center\_of\_channel\_bandwidth + frequency\_offset + startPrbc x 12 x ?f + k x ?f + dc\_skip where:

* center\_of\_channel\_bandwidth in Hz is configured in M-Plane,
* frequency\_offset is calculated from freqOffset field (see clause 7.5.3.11) if freqOffset is present in the C-Plane message or calculated from M-Plane parameter offset-to-absolute-frequency-center (in this case frequency\_offset = offset-to-absolute-frequency-center x ?f x 0.5 where ?f is frequency in Hz corresponding to subcarrier spacing configured via M-Plane) otherwise,
* ?f is frequency in Hz corresponding to the subcarrier spacing configured in frameStructure (see clause 7.5.2.13) if frameStructure is present in the message, or to the subcarrier spacing configured via M-Plane otherwise,
* dc\_skip depends on carrier type:

- if carrier is of LTE DL type and frequency\_offset + startPrbc x 12 x ?f + k x ?f >= 0 then dc\_skip = ?f else dc\_skip = 0.

The above formulation is intended to result in resource grid position in frequency compatible with 3GPP requirements, defined in 3GPP TS 36.211 [42], clause 5.2.1 and clause 6.2.1, and 3GPP TS 38.211 [4], clause 4.4.2.

**Value range:** {00 0000 0000b-11 1111 1111b}.

**Type:** unsigned integer.

**Field length:** 10 bits.

###### reMask (resource element mask)

**Description:** This parameter defines the Resource Element (RE) mask within a PRB. Each bit setting in the reMask indicates if the section control is applicable to the RE sent in U-Plane messages (0=not applicable; 1=applicable). MSB indicates the value for the RE of the lowest frequency in a PRB.

Different REs in a PRB may be referenced by different data section descriptions. This is restricted to data section descriptions having the same sectionId but different reMask if C-Plane and U-Plane coupling via sectionId is used (see clause 7.8.1.2). If C-Plane and U-Plane coupling method independent of sectionId (see clauses 7.8.1.3 or 7.8.1.4 or 7.8.1.5) is used, then data sections descriptions referencing different REs in a PRB shall have different reMask values but sectionId is not relevant. In addition, if C-Plane and U-Plane coupling via frequency and time with priorities (see clause 7.8.1.4) is used an RE in a PRB may be referenced by more than one data section description (in terms of reMask) but only configuration carried with data section description of highest priority is applicable (see clauses 7.8.1.4 and 7.7.6.4).

The maximum number of different reMask values that may be applied to a PRB is an O-RU characteristic that is conveyed from the O-RU to the O-DU via the M-Plane. If any RE in a PRB is never pointed to by an reMask (but other REs in that PRB are), the "missing" RE should be set to zero in the U-Plane, and no beamforming ID or other processing should be applied to the "missing" RE. An RE shall not be referenced more than once in a data section.

If no RE in a PRB is referenced in a section description (reMask all zeros), U-Plane data for that PRB shall not be sent by the O-DU. This is applicable when the O-DU updates the beamforming weights for a specific beamId, the updated beam may be used for scheduled traffic in the same manner as if the reMask had one or more bits set (refer to clause 12.4.3.1 and 12.4.3.2 for specific details on beamId update rules). Despite the reMask being set to all zeros the same scheduling and field value constraints shall apply to the C-Plane message as if the reMask had one or more bits set. This method of updating beams may be used together with any Section Extension that provides beamforming weights.

When Section Extension 24 is present in a section description then reMask is restricted to all ones. The Section Extension 24 provides parameters that with respective M-Plane configuration indicate RE mask for DMRS symbols. For more details refer to clauses 7.7.24.1 and 7.7.24.15.

**Value range:** {0000 0000 0000b-1111 1111 1111b}.

**Type:** unsigned integer (bit mask).

**Field length:** 12 bits.

**Default Value:** 1111 1111 1111b (all REs in the block applicable).

###### numPrbc (number of contiguous PRBs per data section description)

**Description:** In absence of Section Extensions 6, 12, 13, and 21 in the section description and the M-Plane configuration **ci-prb-group-size**, the numPrbc parameter conveys the number of PRBs described by the section description. The interpretation of numPrbc is affected by presence of Section Extensions 6, 12, 13 and 21, and the M- Plane configuration **ci-prb-group-size**; see clauses 7.7.6, 7.7.12, 7.7.13, 7.5.3.13, and 7.7.21 for more details. Presence of M-Plane configuration **ci-prb-group-size** only affects the interpretation of numPrbc parameter within Section Type 6.

Section description shall address resource elements without ambiguity: a resource element addressed by a section description shall not be addressed by other section description, with exception for C-Plane and U-Plane coupling via frequency and time with priorities which resolves ambiguity by differences in priorities (see clause 7.8.1.4 and 7.8.1.5). If coupling of C-Plane and U-Plane via sectionId value is used a PRB addressed by a section description shall not be addressed by a section description with a different value of sectionId.

**Value range:** {0000 0001b-1111 1111b, 0000 0000b = all PRBs in the specified SCS and carrier bandwidth}.

Value 0000 0000b is reserved for NR cases wherein the total number of PRBs may be more than 255. In this case, the sending node shall set the startPrbc value to zero and the receiving node shall ignore whatever startPrbc value is received and assume it is zero. For all other cases a non-zero value of numPrbc shall be used.

If the number of PRBs that needs to be sent is more than 255 but is not all of the PRBs in the specified SCS and carrier bandwidth, then multiple data sections describing smaller number of PRBs are needed.

**Type:** unsigned integer.

**Field length:** 8 bits.

###### numSymbol (number of symbols)

**Description:** In section description without Section Extension 6, 12 and 19, this parameter defines number of symbols, or number of PRACH Symbols in a PRACH occasion in the case of PRACH or number of PRACH Symbols in NPRACH symbol group in the case of NPRACH, to which the section control is applicable. At minimum, the section control shall be applicable to at least one symbol. However, possible optimizations could allow for several (up to 14) symbols, if e.g. all 14 symbols use the same beamId.

In section description with Section Extension 6, 12 or 19, the set of symbols referred by the description is conveyed with symbolBitmask field and numSymbol parameter does not reflect number of symbols referred by the description. In this case, the value of numSymbol can be zero or non-zero number of symbols as it affects the set of symbols referred by the following section descriptions that do not include Section Extension 6, 12 and 19 and have symInc flag set to 1.

Refer to clause 7.5.3.3 for more details.

**Value range:** {0001b-1110b=number of symbols, 0000b=reserved (can be used in section description with Section Extension 6 or 12), 1111b=reserved}.

**Type:** unsigned integer.

**Field length:** 4 bits.

###### ef (extension flag)

**Description:** This parameter is used to indicate if this section has any Section Extensions as described in clause 7.3.2 included in the message.

**Value range:** {0b=no Section Extensions; 1b=one or more Section Extensions are included in this section}.

**Type:** binary bit.

**Field length:** 1 bit.

**Default Value:** 0b (no Section Extensions).

###### beamId (beam identifier)

**Description:** This parameter defines the beam pattern to be applied to the U-Plane data. beamId = 0 means no beamforming operation will be performed. No beamforming operation implies that the O-RU shall not apply any phase or amplitude weights to the U-Plane data and that the resulting RF signal will be applied to all antenna elements in the group equally.

The beamId encodes the beamforming to be done on the O-RU. This beamforming may be digital, analog or both ("hybrid beamforming") and the beamId provides all the information necessary for the O-RU to select the correct beam (or weight table or beam attributes from which to create a beam). If the multiple beamId tables feature is not supported

by the O-RU or it is not configured by O-DU via the M-Plane, it is intended that the beamId be global for the O-RU meaning there are 32767 possible beams shared within the O-RU for all eAxC\_IDs and shared between UL and DL (beamId=0x0000 is reserved for no beamforming). The specific mapping of beamId to weight table, beam attributes, directionality, beam adjacency or any other beam designator is specific to the O-RU design and shall be conveyed via M-Plane from the O-RU to O-DU upon startup. If the multiple beamId tables feature is configured by O-DU via the M- Plane as specified in clause 15.4.6 of the M-Plane specification [7], then the beamId value (and the associated beam) is specific to the beamId table configured (via M-Plane parameter configured-[tr]x-beamId-table-index) for the array carrier associated with the eAxC receiving the beamId value. In such case the association between the beamId and the beam (defined via a vector of beamforming weights or beamforming attributes) shall be determined by the configured beamId table and the value of beamId.

An upper bound on the number of beamIds that can be addressed per eAxC or per sets of eAxCs, per symbol and per slot, for DL and for UL respectively, shall be conveyed via M-Plane messaging as part of the O-RU capabilities description. In addition to this, for O-RUs with C-Plane message processing limits, additional limits to restrict the number of highest priority sections per C-Plane message on top of eAxC limits shall be applied (clause 7.8.2).

**Value range:** {000 0000 0000 0001b-111 1111 1111 1111b; 000 0000 0000 0000b means no BF to be done}.

**Type:** unsigned integer.

**Field length:** 15 bits.

**Default Value:** 0000 0000 0000 0000b (no beamforming).

###### ueId

**Description:** This parameter supports CIBF by providing a logical identifier for the set of channel information associated with a spatial stream of a UE sent via Section Type 6. This shall be used to support channel information sent from the O-DU to the O-RU. This is just a label and the specific value has no meaning regarding types of UEs that may be supported within the system.

This parameter is also used within Section Type 5 to support CIBF and to support DMRS-BF, In the context of DMRS- BF, the format of the ueId field is specifically formatted to indicate a UE identifier and a layer number for the UE, see clause 12.6.1.3.1.2.

If the O-RU reports the capability of 'non-scheduled-ueId-supported' = TRUE for an endpoint, and the O-DU configures 'non-scheduled-ueId-enabled' = TRUE the following O-RU interpretation shall apply:

* If the O-DU sets the ueId in the section header in ST 5 to 0x7FFF, the O-RU shall interpret that the PRBs in the section description are not scheduled for the representative eAxC\_ID (i.e. the eAxC\_ID in the transport header).
* If the O-DU sets ueId to 0x7FFF in SE 10 with beamGroupType set to 10b when used with ST 5, the O-RU shall interpret that the PRBs in the section description are not scheduled for the specific eAxC\_ID (refer to clause 7.9.13 for more details).

In the context of use for CIBF, the value of ueId can be associated with at most one set of channel information (at a different time, the O-DU may associate the same ueId with another set of channel information). Mapping of ueId value to a set of channel information is global per O-RU.

NOTE 1: While ueId is expected to take values in the full range 0x0000 to 0x7FFF, there is a limit on the number of valid ueId values an O-RU can support, which is dictated by O-RU advertised M-Plane parameter 'max-number-ues-15bit', which applies to CIBF.

In the context of use for DMRS-BF, consult clause 12.6.1.3.1.2 regarding the persistence of the ueId value. In addition, the maximum number of UEs supported for the purposes of DMRS-BF is separately declared by the O-RU

(called max-num-ues-supported, a per O-RU limit), and the value of ueId shall range from zero to the maximum number of UEs minus one, excluding the ueId bits dedicated to UE layers - this defines the "ueId space". If the maximum number of supported UEs declared by O-RU is larger than the maximum value which can be represented by the ueId bits dedicated to UEs, then the actual maximum number of UEs will equal to the maximum value determined by the ueId bits dedicated to UEs.

NOTE 2: when the number of scheduled layers per UE is not a power of two, there will be unused ueId values within the total range.

In the context of use for DMRS-BF, the possible number of layers to be scheduled per UE is governed by the O-RU- reported parameter ueid-max-layer-bits. Upon receiving this parameter from the O-RU, the O-DU shall configure ueid- layer-bits-configured which shall be less than or equal to ueid-max-layer-bits. The "ueId space" mentioned above is the product of max-num-ues-supported and 2 to the power of ueid-layer-bits-configured. The per-layer allocated bits (least- significant bits of ueId) shall count from zero to the number of layers minus one being scheduled for the UE.

Example: If the maximum number of UEs for DMRS-BF were declared to be 10 (numbered from 0-9), and there are 3 bits configured for UE layers, then the permitted range of ueId (the "ueId" space) would be from 0 to 79 (from 0x00 to 0x4F).

In the context of use for DMRS-BF, the O-RU shall report another limit, max-num-ueids, which governs the maximum number of unique ueId values within the "ueId space" that may be used by the O-DU(s). It is the responsibility of the O-DU to allocate the use of ueId values to fit within the limit of max-num-ueids, as well as fitting within the limit of max-num-ues-supported and ueid-layer-bits-configured. It would generally be true that max-num-ueids would be greater than max-num-ues-supported (to allow for multi-layer UEs), but whatever the reported and configured values, ueId use shall be governed by the most restrictive limit in place.

**Value range:** {000 0000 0000 0000b-111 1111 1111 1111b}.

**Type:** unsigned integer.

**Field length:** 15 bits.

###### freqOffset (frequency offset)

**Description:** This parameter defines the frequency offset with respect to the carrier centre frequency before additional filtering (e.g. for PRACH) and FFT processing (in UL) in steps of one half the subcarrier spacings ?f. The frequency offset shall be consistent per data section (one cannot use reMask to allow different frequency offsets for different REs in the PRBs).

Frequency offset in Hz is calculated as: frequency\_offset = freqOffset x ?f x 0.5

where ?f is frequency in Hz corresponding to subcarrier spacing provided in frameStructure (see clause 7.5.2.13).

Frequency span resulting from frameStructure, freqOffset, startPrbc, numPrbc, and rb shall not exceed channel bandwidth configured for eAxC over M-Plane.

The O-DU is not required to perform phase compensation based on freqOffset value indicated by the O-DU to the O- RU unless otherwise specified, e.g. refer to clause 15.3.2, 15.3.3, and 15.4.2.

**Value range:** { 0x000000=no offset,

0x000001 - 0x7FFFFF = positive frequency offset, 0x800000 - 0xFFFFFF = negative frequency offset }.

**Type:** signed integer.

**Field length:** 24 bits.

###### regularizationFactor (regularization factor)

**Description:** This parameter provides a signed value to support MMSE operation within the O-RU when beamforming weights are supported in the O-RU, so related to Section Type 6.

**Value range:** {0000 0000 0000 0000b-1111 1111 1111 1111b}.

**Type:** unsigned integer.

**Field length:** 16 bits.

###### ciIsample, ciQsample (channel information I and Q values)

**Description:** These values are the channel information complex values relayed from the O-DU to the O-RU, related to Section Type 6. In absence of Section Extensions 21 and the M-Plane configuration **ci-prb-group-size**, the order of transmission shall be first Prbc for the first antenna to the last antenna, then second Prbc for the first to last antenna, and so on until reaching the last Prbc for the first to last antenna. In the presence of Section Extension 21 or the M-Plane configuration **ci-prb-group-size**, the order of transmission shall be first PRB group for the first antenna to the last antenna, then second PRB group for the first to last antenna, and so on until reaching the last PRB group for the first to last antenna. Each PRB group for one antenna shall include one pair of ciIsample/ciQsample. The bit-width per I and Q value shall be variable (determined by M-Plane configuration **channel-information-bitwidth** if channel information compression is not configured, and determined by ciCompHdr field when either static or dynamic channel information compression is configured) so after the very last Q value, some number of padding (set to zero) bits may be inserted to get to the next byte boundary. When the optional "little endian byte order" is chosen via M-Plane, the ciIsample/ciQsample shall use little endian byte order to transmit the complex numbers. Refer to Annex D.2 for details.

If an O-RU supports receiving and processing channel information with PRB group size greater than one PRB (indicated via M-Plane) and if O-RU is configured via M-Plane to receive and process channel information with PRB group size greater than one PRB, then O-RU shall apply every pair of ciIsample/ciQsample for one PRB group received in Section Type 6 to **ci-prb-group-size** number of continuous PRBs start from index startPrbc + *i* x **ci-prb-group-size**, where **ci-prb-group-size** is configured via M-Plane, and index *i* ranges from 0 to numPrbc-1. If M-Plane configuration **ci-prb-group-size** exists, the numPrbc in Section Type 6 indicates the number of PRB groups per antenna and is used to determine the length of the Section Type 6 message, and the actual number of PRBs to which Section Type 6 is applied is determined by the method described above. Also, numPrbc shall not be set to 0 when **ci-prb-group-size** is configured. If startPrbc + *i* x **ci-prb-group-size** is larger than the maximum available PRBs configured via M-Plane (**number-of-prb**), the channel information shall only be applied to those PRBs within the maximum available PRBs.

**Value range:** {0000 0000 0000 0000b-1111 1111 1111 1111b} for each I and Q value.

**Type:** signed integer.

**Field length:** variable bit-with per I and Q value.

###### laaMsgType (LAA message type)

**Description:** This parameter defines the LAA message type being conveyed within the Section Type 7 C-Plane message. For LAA, the C-Plane messages may flow from the O-DU to the O-RU (as usual) or from the O-RU to the O- DU. All of these messages relate to the Listen Before Talk (LBT) LAA operation and provide a "handshake" between the O-DU and the O-RU to manage the LBT operation. The laaMsgType definitions shall conform to Table 7.5.3.14-1.

**Value range:** {0001b-1111b}.

**Table 7.5.3.14-1: laaMsgType definition**

|  |  |  |
| --- | --- | --- |
| **laaMsgType** | **lssMsgType definition** | **lssMsgType meaning** |
| 0000b | LBT\_PDSCH\_REQ | O-DU to O-RU request to obtain a PDSCH channel |
| 0001b | LBT\_DRS\_REQ | O-DU to O-RU request to obtain the channel and send DRS |
| 0010b | LBT\_PDSCH\_RSP | O-RU to O-DU response, channel acq success or failure |
| 0011b | LBT\_DRS\_RSP | O-RU to O-DU response, DRS sending success or failure |
| 0100b | LBT\_Buffer\_Error | O-RU to O-DU response, reporting buffer overflow |
| 0101b | LBT\_CWCONFIG\_REQ | O-DU to O-RU request, congestion window configuration |
| 0110b | LBT\_CWCONFIG\_RSP | O-RU to O-DU response, congestion window config. response |
| 0100b - 1111b | reserved for future methods |  |

**Type:** unsigned integer.

**Field length:** 4 bits.

###### laaMsgLen (LAA message length)

**Description:** This parameter defines number of 32-bit words in the LAA section, including the word containing the lssMsgLen parameter. Zero is a reserved value.

**Value range:** {0001b-1111b=number of 32-bit words in the section from 1 to 16 words (4 to 64 bytes) 0000b is a reserved value}.

**Type:** unsigned integer.

**Field length:** 4 bits.

###### lbtHandle

**Description**: This parameter provides a label that is included in the configuration request message (e.g. LBT\_PDSCH\_REQ, LBT\_DRS\_REQ) transmitted from the O-DU to the O-RU and returned in the corresponding response message (e.g. LBT\_PDSCH\_RSP, LBT\_DRS\_RSP).

**Value range:** {0000 0000 0000 0000b - 1111 1111 1111 1111b}.

**Type:** unsigned integer.

**Field length:** 16 bits.

###### lbtDeferFactor (listen-before-talk defer factor)

**Description**: Defer factor in sensing slots as described in 3GPP TS 36.213 [14] clause 15.1.1. This parameter is used for LBT CAT 4 and can take one of three values: {1,3, 7} based on the priority class. Four priority classes are defined in 3GPP TS 36.213 [14] clause 15.1.1.

**Value range:** {001b, 011b, 111b} or {1, 3, 7} in decimal.

**Type:** unsigned integer.

**Field length:** 3 bits.

###### lbtBackoffCounter (listen-before-talk backoff counter)

**Description:** LBT backoff counter in sensing slots as described in 3GPP TS 36.213 [14] clause 15.1.1.

**Value range:** {00 0000 0000b - 11 1111 1111b} (0-1023 decimal).

**Type:** unsigned integer.

**Field length:** 10 bits.

###### lbtOffset (listen-before-talk offset)

**Description:** LBT start time in microseconds from the beginning of the subframe scheduled by this message.

**Value range:** {00 0000 0000b - 11 1110 0111b} or {0 - 999} in decimal.

**Type:** unsigned integer.

**Field length:** 10 bits.

###### MCOT (maximum channel occupancy time)

**Description**: LTE TXOP duration in subframes as described in 3GPP TS 36.213 [14] clause 15.1.1. The maximum values for this parameter are {2, 3, 8, 10} based on the priority class. Four priority classes are defined in 3GPP TS

36.213 [14] clause 15.1.1.

**Value range:** {1-10} in decimal.

**Type:** unsigned integer.

**Field length:** 4 bits.

###### lbtMode (LBT mode)

**Description:** Part of multi-carrier support. Indicates whether full or partial LBT process is carried out (multi carrier mode B according to 3GPP TS 36.213 [14] clause 15.1.5.2).

**Value range:** {00b - 11b}.

* 00b = full LBT (regular LBT, sending reservation signal until the beginning of the SF/slot).
* 01b = Partial LBT (looking back 25 ?sec prior to transmission as indicated in 3GPP TS 36.213 [14] clause 15.1.5.2).
* 10b = Partial LBT (looking back 34 ?sec prior to transmission as indicated in 3GPP TS 36.213 [14] clause 15.1.5.2).
* 11b = full LBT and stop (regular LBT, without sending reservation signal; O-RU senses the spectrum for the defer factor + a sensing slot right before OTA when the O-DU is ready to transmit data as indicated in 3GPP TS 36.213 [14] clause 15.1.1. i.e. right before the SF/slot boundary).

**Type:** unsigned integer.

**Field length:** 2 bits.

###### lbtPdschRes (LBT PDSCH result)

**Description:** LBT result of SFN/SF:

* 00b = not sensing - indicates that the O-RU is transmitting data.
* 01b = currently sensing - indicates the O-RU has not yet acquired the channel.
* 10b = success - indicates that the channel was successfully acquired.
* 11b = Failure - indicates expiration of the LBT timer. The LBT process should be reset.

**Value range:** {00b - 11b}.

**Type:** unsigned integer.

**Field length:** 2 bits.

###### sfStatus (subframe status)

**Description:** indicates whether the subframe was dropped or transmitted:

* 0 - subframe was dropped.
* 1 - subframe was transmitted.

**Value range:** {0,1}.

**Type:** binary bit.

**Field length:** 1 bit.

###### lbtDrsRes (LBT DRS result)

**Description:** LBT result of SFN/SF:

* 0 - SUCCESS - indicates that DRS is sent.
* 1 - FAILURE - indicates that DRS is not sent.

**Value range:** {0,1}.

**Type:** binary bit.

**Field length:** 1 bit.

###### initialPartialSF (Initial partial SF)

**Description:** Indicates whether the initial SF in the LBT process is full or partial:

* 0 - full SF (two slots, 14 symbols).
* 1 - partial SF (only second slot, last 7 symbols).

**Value range:** {0, 1}.

**Type:** binary bit.

**Field length:** 1 bit.

###### lbtBufErr (LBT buffer error)

**Description:** Indicates when an LBT buffer overflow has occurred:

* 0 - reserved.
* 1 - buffer overflow - data received at O-RU is larger than the available buffer size.

**Value range:** {0, 1}.

**Type:** binary bit.

###### sfnSf (SFN/SF end)

**Description:** SFN/SF which is dropped by O-RU because of time expired or successfully transmitted.

**Value range:** SFN: {0000 0000b - 1111 1111b} or {0 - 255} in decimal, SF: {0000b - 1001b} or {0 - 9} in decimal.

**Type:** unsigned integer.

**Field length:** 12 bits.

###### lbtCWConfig\_H (HARQ parameters for congestion window management)

**Description:** Total number of HARQ NACK feedback messages received for the lbtCWConfig\_T transport blocks transmitted over LAA cell(s)to be used for adjusting the congestion window.

**Value range:** {0000 0000b - 1111 1111b} or {0 - 255} in decimal.

**Type:** unsigned integer.

**Field length:** 8 bits.

###### lbtCWConfig\_T (TB parameters for congestion window management)

**Description:** Total number of Transport Blocks (TB) transmitted over the LAA cell to be used for adjusting the congestion window.

**Value range:** {0000 0000b - 1111 1111b} or {0 - 255} in decimal.

**Type:** unsigned integer.

**Field length:** 8 bits.

###### lbtTrafficClass (traffic class priority for congestion window management)

**Description:** Channel access priority class as defined in TS 36.213 [14].

**Value range:** {000 - 111} or {0 - 7} in decimal:

1 - 4: traffic class priority.

0, 5 - 7: reserved.

**Type:** unsigned integer.

**Field length:** 3 bits.

###### lbtCWR\_Rst (notification about packet reception successful or not)

**Description**: Notifies to O-DU whether the O-RU receives LBT\_CWCONFIG\_REQ message successfully or not:

* 0 - SUCCESS - indicates successful reception of LBT\_CWCONFIG\_REQ.
* 1 - FAILURE - indicates failure of receiving LBT\_CWCONFIG\_REQ.

**Value range:** {0, 1}.

**Type:** binary bit.

**Field length:** 1 bit.

###### ciCompParam (channel information compression parameter)

**Description:** This parameter applies to the compression method specified by the associated ciCompMeth value. If ciCompOpt (a subfield of ciCompHdr) is 0, this parameter applies to the following vector of ciIsample, ciQsample for all PRBs of a specific UE. If ciCompOpt (a subfield of ciCompHdr) is 1, this parameter applies to the following vector of ciIsample, ciQsample for all antennas of a specific PRB. ciCompParam shall be configured according to Table 7.5.3.32-1**.**

**Value range:** {0000 0000b-1111 1111b}.

**Bit allocations:**

**Table 7.5.3.32-1: ciCompParam bit allocations for various values of ciCompMeth**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **ciCompMeth** | **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **compParam size** |
| 000b = no compression | absent | | | | | | | | 0 octet |
| 001b = block floating point | reserved (set to all zeros) | | | | Exponent (unsigned) | | | | 1 octet |
| 010b = block scaling | blockScaler (unsigned, 1 integer bit, 7 fractional bits) | | | | | | | | 1 octet |
| 011b = ?-law | compBitWidth | | | | compShift | | | | 1 octet |
| 100b -111b | reserved (set to all zeros) | | | | | | | | ? octet |

**Type:** unsigned integer (concatenated bit fields).

**Field length:** zero for ciCompMeth value 000b, 8 bits for ciCompMeth values 001b, 010b and 011b; other ciCompMeth values may imply other lengths but will always be an integer number of bytes.

###### reserved (reserved for future use)

**Description:** This parameter is reserved for future use. Transmitter shall send value "0", while receiver shall ignore the value received.

**Value range:** {variable}.

**Type:** variable.

**Field length:** variable.

###### numberOfAcks (number of ACKs)

**Description:** This parameter is used to indicate the number of ACKs included in the ACK/NACK message for one eAxC\_ID.

**Value range:** {0000 0000b-1111 1111b}.

**Type:** unsigned integer.

**Field length:** 8 bits.

###### numberOfNacks (number of NACKs)

**Description:** This parameter is used to indicate the number of NACKs included in the ACK/NACK message for one eAxC\_ID.

**Value range:** {0000 0000b-1111 1111b}.

**Type:** unsigned integer.

**Field length:** 8 bits.

###### ackId (ACK Id)

**Description:** This parameter is used to indicate a correctly received section description which carries a Section Extension 22. The ackId in the Section Type 8 message shall be set to the ackNackReqId in the Section Extension 22.

**Value range:** {0000 0000 0000 0000b-1111 1111 1111 1111b}.

**Type:** unsigned integer.

**Field length:** 16 bits.

###### nackId (NACK Id)

**Description:** This parameter is used to indicate a section description with Section Extension 22 is received but dropped after Section Extension 22 is decoded. The nackId in the Section Type 8 message shall be set to the ackNackReqId in the Section Extension 22.

**Value range:** {0000 0000 0000 0000b-1111 1111 1111 1111b}.

**Type:** unsigned integer.

**Field length:** 16 bits.

###### st4CmdType (Section Type 4 command type)

**Description:** This parameter shall be used specifically with Section Type 4 to specify the command type. Value of this parameter specifies a unique command type value which specifies a slot level configuration to be applied to single/multiple eAxC\_IDs. Section Type 4 cannot be used without a Section Type 4 command.

**Value range:** {0000 0000b-1111 1111b}.

|  |  |  |
| --- | --- | --- |
| **ST4CmdType** | **ST4CmdType definition** | **ST4CmdType meaning** |
| 0000 0001b | TIME\_DOMAIN\_BEAM\_CONFIG | Command to send time-domain beam group uniquely  identifying time-domain beam number vector and/or associated time-domain beamforming weights |
| 0000 0010b | TDD\_CONFIG\_PATTERN | Command specifying symbol direction: UL/DL and the guard symbols (DL->UL switch), meant for dynamic  TDD configurations use cases. |
| 0000 0000b,  0000 0011b -  1111 1111b | reserved for future command types |  |

**Type:** unsigned integer.

**Field length:** 8 bits.

###### st4CmdLen (Section Type 4 command length)

**Description**: This parameter provides the length of the section type 4 command in units of 32-bit (or 4-byte) words. The value zero is reserved, as there is always at least one word in the Section Type 4 command. If multiple Section Type 4 commands are present in a C-Plane Section Type 4 message, this value shall be used to specify the length of each command independently

**Value range:** {all zeros - all ones} - from one word to 65535 words (16 bits). The value zero is reserved.

**Type:** unsigned integer.

**Field length:** 16 bits.

###### numSlots (number of slots)

**Description:** This parameter shall specify the number of contiguous slots for which a given Section Type 4 command is applicable. If the command configuration is expected to be applicable until changed, the value of this parameter shall be set to zero.

Command configuration specified using a given 'st4CmdType' shall apply to the group of endpoints associated with the 'st4CmdScope' in the section header for the duration specified by 'numSlots'. Any new Section Type 4 command having the same 'st4CmdType' and the same 'st4CmdScope' shall be applicable only after the expiration of duration equal to 'numSlots'.

**Value range:** {0000 0000b - 1111 1111b}.

0000 0000b - command configuration shall last until updated by the next command of the same 'st4CmdType'.

**Type:** unsigned integer.

**Field length:** 8 bits.

###### ackNackReqId (ACK/NACK Request ID)

**Description:** refer to clause 7.7.22.2 for more details. This parameter is a field in the common header part of each Section Type 4 command. This field enables the O-DU to request the O-RU for ACK/NACK feedback using a Section Type 8 C-Plane message for a specific Section Type 4 command. The value of this parameter shall be set to zero for two specific cases.

Case 1: If an O-RU reports its capability of NOT supporting Section Type 8.

Case 2: If an O-RU reports its capability of supporting Section Type 8, but the O-DU chooses not to request for Section Type 8 ACK/NACK feedback for the Section Type 4 command.

**Value range:** {0000 0000 0000 0000b - 1111 1111 1111 1111b}.

0000 0000 0000 0000b - No Section Type 8 ACK/NACK C-Plane message expected from O-RU for the 'st4CmdType'. The value of zero for 'ackNackReqId' shall be interpreted as no request for ACK/NACK ST 8 message from O-RU when used in Section Type 4 C-Plane message commands.

**Type:** unsigned integer.

**Field length:** 16 bits.

###### symbolMask (symbol mask)

**Description:** refer to clause 7.7.6.4 for the format of this parameter. This parameter applies to the following Section Type 4 command types:

TIME\_DOMAIN\_BEAM\_CONFIG: This parameter specifies the symbols to which time-domain beamforming config specified in the command shall apply. Bits in symbolMask corresponding to symbols earlier than symbol identified by startSymbolId shall be set to 0 by the O-DU.

TRX\_CONTROL: This parameter specifies the symbols (mask bit values of 1) during which certain antenna array elements may be put into an energy-saving mode.

ASM: This parameter specifies the symbols (mask bit values of 1) during which part or all of the O-RU may be transitioned into an energy-saving mode.

When used in a Section Type 4 TRX\_CONTROL or ASM command, an all-zero symbolMask indicates no symbols are to be put to sleep meaning all symbols will be set to an awake condition by the command.

The parameter also applies to ST 10 measurement reports and ST 11 measurement commands containing a symbolMask. Here, it represents symbols in natural order, as received on the air interface. At least one bit in the symbolMask shall be set to one and no bit shall be set to one in the symbolMask of an ST 10 report or ST 11 command if the corresponding symbol is not referred to by the respective ST 10 or ST 11 section description (including any Section Extension). If SE 20 is used to puncture one or more symbols for a subset of PRBs, the corresponding bits in the symbolMask in ST 10 report and ST 11 command shall, even if non-zero, be interpreted and handled as if set to zero for punctured symbols in the PRB range where puncturing applies. If puncturing results in all-zero symbolMask for a PRB range, no measurement values shall be reported for that range (applicable to the measurement commands and reports containing a symbolMask).

* ST 10 MEAS\_IPN\_ALLOC and MEAS\_IPN\_UNALLOC: bits set to value 1 for the symbolMask in the measurement report indicate over which OFDM symbols (only DMRS symbols for MEAS\_IPN\_ALLOC) the IpN measurement has been averaged to produce the result reported in the measurement report.
* ST 11 MEAS\_IPN\_UNALLOC: bits set to value 1 for the symbolMask in the measurement command indicate over which OFDM symbols the IpN measurement shall be averaged to produce the result to be reported in the measurement report.

###### disableTDBFNs (disable sending tdBeamNum)

**Description:** This parameter is used to enable/disable sending of beamforming numbers 'tdBeamNum' as part of Section Type 4 command type: TIME\_DOMAIN\_BEAM\_CONFIG. Disable sending time-domain beamforming numbers implies that once the tdBeamGrp and associated time-domain beam number vector mapping is established in the O-RU, the O-DU may choose to send only tdBeamGrp for associated 'tdBeamNum' vectors. This value shall be set to '1b' only when the mapping between the time-domain beamforming weights and [tdBeamGrp, tdBeamNum] has been established by sending tdBeamGrp, tdBeamNum and per tdBeamNum time-domain beamforming weight in an earlier ST 4 message. Refer to Table 7.4.6-5.

**Value range:** {0b = time-domain beam numbers included in TIME\_DOMAIN\_BEAM\_CONFIG command. 1b = time-domain beam numbers excluded in TIME\_DOMAIN\_BEAM\_CONFIG command}.

**Type:** binary bit.

**Field length:** 1 bit.

###### tdBeamGrp (time-domain beam group identity)

**Description**: This parameter is used for Section Type 4 command type: TIME\_DOMAIN\_BEAM\_CONFIG. This parameter uniquely identifies the time-domain beam number vector (refer to tdBeamGrp in Figure 12.4.3.4.4-3). Each tdBeamGrp is a unique identifier of a vector of size equal to K'' (see clause 12.5.3 for the definition of K') i.e. K'' ''tdBeamNum'' values (see clause 7.5.3.56). Only one tdBeamGrp shall be specified with one instance of 'TIME\_DOMAIN\_BEAM\_CONFIG' which shall apply to 'symbolMask' specified in this command header.

**Value range:** {000 0000 0000 0000b -111 1111 1111 1111b}.

**Type:** unsigned integer.

**Field length:** 15 bits.

###### bfwCompHdr (beamforming weight compression header)

**Description**: refer to clause 7.7.1.2.

This parameter defines the compression method and IQ bit width for the beamforming weights when specifying beamforming weights in Section Type 4 command type: TIME\_DOMAIN\_BEAM\_CONFIG. The time-domain beamforming weight compression method may not be the same as the frequency-domain beamforming weight compression method, the compression can be completely independent and can use any of the methods supported by O- RU.

###### disableTDBFWs (disable sending time-domain beamforming weights)

**Description:** This parameter is used to enable/disable sending of beamforming weights as part of Section Type 4 command type: TIME\_DOMAIN\_BEAM\_CONFIG. Disabling sending time-domain beamforming weights allows an operation such that only 'tdBeamNum' associated with 'tdBeamGrp' is sent in the command and not the actual time- domain beamforming weights. This value shall be set to '1b' only when the mapping between the tdBeamNum and time- domain beamforming weights is established by sending tdBeamNum and associated time-domain beamforming weights in an earlier ST 4 message. Refer to Table 7.4.6-4.

**Value range:** {0b = time-domain beamforming weights included in TIME\_DOMAIN\_BEAM\_CONFIG command. 1b = time-domain beamforming weights excluded in TIME\_DOMAIN\_BEAM\_CONFIG command}.

**Type:** binary bit.

**Field length:** 1 bit.

###### bfwCompParam (beamforming weight compression parameter)

**Description:** refer to clause 7.7.1.3.

Applies to Section Type 4 command type: TIME\_DOMAIN\_BEAM\_CONFIG.

###### bfWI, bfWQ (beamforming weights I and Q values)

**Description:** refer to clause 7.7.1.4 for bfWI and 7. 7.1.5 for bfWQ.

Applies to Section Type 4 command type: TIME\_DOMAIN\_BEAM\_CONFIG.

###### dirPattern (symbol data direction (gNB Tx/Rx) pattern)

**Description**: This parameter is a bitmask for symbols in a slot where each bit of bitmask specifies the symbol's data direction. Bits in dirPattern corresponding to the symbols that are guard symbols shall be ignored by the O-RU. Bits in dirPattern corresponding to symbols earlier than the symbol identified by startSymbolId shall be set to 0 by the O-DU and ignored by the O-RU.

Value of 1 = DL symbol, Value of 0 = UL symbol. Applies to Section Type 4 command type: TDD\_CONFIG\_PATTERN.

LSB of dirPattern indicates symbol zero (the first symbol in a slot).

**Value range:** {00 0000 0000 0000b-11 111 1111 1111b}.

**Type:** unsigned integer (bit mask).

**Field length:** 14 bits.

###### guardPattern (guard pattern bitmask)

**Description:** This parameter is a bitmask for symbols in a slot used in conjunction with the dirPattern bitmask. Each bit of the bitmask associated with a given symbol specifies a guard symbol for gNB DL to UL switch. Bits in guardPattern corresponding to symbols earlier than the symbol identified by startSymbolId shall be set to 0 by the O-DU and ignored by the O-RU.

Value of 1 = guard symbol, 0 = non-guard symbol.

LSB of guardPattern indicates symbol zero (the first symbol in a slot).

**Value range:** {00 0000 0000 0000b-11 1111 1111 1111b}.

**Type:** unsigned integer (bit mask).

**Field length:** 14 bits.

###### log2MaskBits

**Description:** This parameter indicates how many bits are in the antenna mask corresponding to various antenna panel sizes, according to Table 7.5.3.52-1. The actual number of array elements may be equal to or less than the maximum number of array elements in Table 7.5.3.52-1; when less than the unused mask bits shall be set to zero.

**Table 7.5.3.51****-1: log2MaskBits value encoding**

|  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- |
| **log2MaskBit s value** | **maximum number of array elements**  **NOTE 1** | **log2MaskBit s value** | **maximum number of array elements**  **NOTE 1** | **log2MaskBit s value** | **maximum number of array elements**  **NOTE 1** | **log2MaskBit s value** | **maximum number of array elements**  **NOTE 1** |
| 0 | reserved | 4 | 16 | 8 | 256 | 12 | 4096 |
| 1 | 2NOTE 2 | 5 | 32 | 9 | 512 | 13 | 8192 |
| 2 | 4NOTE 2 | 6 | 64 | 10 | 1024 | 14 | 16384 |
| 3 | 8NOTE 2 | 7 | 128 | 11 | 2048 | 15 | reserved |
| NOTE 1: antMask size is the same as maximum number of array elements shown in this table, except see NOTE 2 NOTE 2: minimum antMask size is 16 bits | | | | | | | |

**Value range:** {0x0 - 0xF, see Table 7.5.3.51-1, 0x0 and 0xF are reserved values}.

**Type:** unsigned integer.

**Field length:** 4 bits.

###### sleepMode

**Description:** This parameter indicates the sleep mode that is being commanded and applies to st4CmdType = 3 and 4 (TRX\_CONTROL and ASM). Each sleep mode has an associated wake-up duration (separate for TRX\_CONTROL and ASM), except that sleepMode = 0 means there is "symbol" wake-up duration for both TRX\_CONTROL and ASM meaning the wake-up duration is consistent with just a few symbols rather than close to or greater than a slot duration. This means no extra slots need to be reserved to activate ("wake-up") the relevant parts of the O-RU.

NOTE: "symbol" wake-up duration for sleepMode = 0 means that the slot number identified in the slotId field of the wake-up C-Plane command is the slot number that is available for transmission or reception - no additional slots are needed to wake up the O-RU.

There is a specific ordering of the sleep modes (see clause 16.1) and sleep mode 0 by definition has a "symbol" wake-up duration which is presumed shorter than any other sleep mode's wake-up duration. Which parts of an O-RU are put to sleep for any sleep mode is dependent on the O-RU's design. See clause 16.1 and Table 16.1-1 for more information on the use of sleepMode.

**Value range:** {0x0 - 0x3}.

**Type:** unsigned integer.

**Field length:** 2 bits.

###### numSlotsExt

**Description:** This parameter, when added to numSlots, indicates the total number of slots that a defined-duration TRX\_CONTROL or ASM command shall last. Slot length in time depends on the SCS for the command as indicated in the command header. The value 0x00000 has a special meaning when coupled with numSlots = 0x00, it means the command is an undefined-duration command.

**Value range:** {0x00000 - 0xFFFFF}.

**Type:** unsigned integer.

**Field length:** 20 bits.

###### antMask

**Description:** This parameter indicates which antenna array elements are commanded to enter or exit an energy-saving mode for a TRX\_CONTROL command. The range of supported number of array elements is 2-16384, so the mask size can be as large as 16384 bits (2048 bytes), although such large antenna arrays are unlikely to be practical.

The antMask parameter is integer bytes in size and is at least 2 bytes; when the number of array elements is less than 16 or is not a factor of 8 the array elements are least-significant-bit justified so that array element zero (numbered according to the antenna model order) is associated with the least significant mask bit (bit 0). The O-DU should set the "extra" mask bits (those not associated with any array element) to zero.

A zero mask bit indicates an array-element that should be disabled ("put to sleep") while a one mask bit indicates an array-element that should be enabled ("woken up"). An all-zero antenna mask is valid and would disable all array elements in the relevant tx-array and/or rx-array. This is not treated the same as an ASM command; all TRX\_CONTROL rules are still valid even with an all-zero antMask. However, an O-RU may take any extra energy- saving actions possible when all array elements are off, up to and including turning off C-Plane processing if there is no other reason for C-Plane processing to remain on (e.g. no other antenna arrays exist).

**Value range:** {all zeros to all ones, no reserved values}.

**Type:** bit mask.

**Field length:** variable, 2 bytes - 2048 bytes.

###### ready

**Description:** This parameter indicates a Section Type 8 message is being used to indicate O-RU readiness after waking up from a commanded sleep mode having a non-guaranteed wake-up duration. If this bit is 1, then the Section Type 8 is a "ready message" and may include some number of ackIds (numberOfNacks will be 0). The O-RU is available for transmission and/or reception in the slot *after* the slot identified by the slotId in the message header. The time-duration of a slot in this context is determined by the "scs" parameter in the Section Type 8 command. If this bit is 0, then the Section Type 8 is a conventional ACK message carrying valid values for numberOfAcks and numberOfNacks and including some number of ackId values. If an ACK/NACK message needs to be sent from O-RU to O-DU coincident with a ready message, they shall be two separate messages.

It is possible that two separate sleep commands could be active at once e.g. for two separate antenna arrays, and each one is subject to a ready message. In such a case the Section Type 4 sleep message may have an ackId associated with it, in which case the ready message would have numberOfAcks!=0 and contain the ackId(s) to identify which sleep command(s) is(are) being terminated.

This message shall be sent from O-RU to O-DU with value symbolId = 0 hence being at the beginning of a slot. If the slotId = X, then the O-RU is available for transmission and/or reception during slot X+1.

If the O-DU does not support reception and interpretation of the ready message, then the O-DU should not invoke any sleep mode with a "minimum" wake-up time.

**Value range:** {0 = message is an ACK message; 1 = message is a "ready" message}.

**Type:** binary bit.

**Field length:** 1 bit.

###### tdBeamNum (time-domain beam number)

**Description**: This parameter is used for Section Type 4 command type: TIME\_DOMAIN\_BEAM\_CONFIG. This parameter identifies a time-domain beam (refer to tdBeamNum in Figure 12.4.3.4.4-3) associated with the unique tdBeamGrp value (see clause 7.5.3.44). Each tdBeamNum is an identifier of a beamforming weight vector of size equal to **K**/**K'** i.e. **K**/**K'** weights (see clause 12.5.3 for the definition of **K** and **K'**).

**Value range:** {000 0000 0000 0000b -111 1111 1111 1111b}.

**Type:** unsigned integer.

**Field length:** 15 bits.

###### mf (measurement flag)

**Description:** This parameter is used to indicate if the ST 10 report contains any additional measurement report after the current one or if the current ST 11 measurement command is followed by any additional measurement commands.

**Value range:** {0b=no additional measurement report or command; 1b=at least one additional measurement report or command after the current one}

**Type:** binary bit **Field length:** 1 bit **Default Value:** N/A

###### measTypeId (measurement report type identifier)

**Description:** This parameter shall be used specifically with Section Type 10 or Section Type 11 to specify the type of measurement report (ST 10) or measurement command (ST 11). Support for a given measTypeId in ST 10 and ST 11 respectively is indicated in the table below. Section Type 10 shall contain at least one measurement report, and it is possible to append multiple reports of different type. Section Type 11 shall contain at least one measurement command and supports appending multiple commands.

**Value range:** {000 0000b - 111 1111b}

**Table 7.5.3.58-1: measTypeId definitions and applicable Section Types**

|  |  |  |  |  |
| --- | --- | --- | --- | --- |
| **measTypeId** | **measTypeId definition** | **ST 10** | **ST 11** | **measTypeId meaning** |
| 000 0000b | (reserved for future use) | | | |
| 000 0001b | MEAS\_UE\_TAE | **applicable** | not applicable | UE Timing Advance Error |
| 000 0010b | MEAS\_UE\_LAYER\_POWER | **applicable** | not applicable | UE layer power |
| 000 0011b | MEAS\_UE\_FREQ\_OFFSET | **applicable** | not applicable | UE frequency offset |
| 000 0100b | MEAS\_IPN\_ALLOC | **applicable** | not applicable | Interference plus Noise for allocated PRBs |
| 000 0101b | MEAS\_IPN\_UNALLOC | **applicable** | **applicable** | Interference plus Noise for unallocated PRBs |
| 000 0110b | MEAS\_ANT\_DMRS | **applicable** | not applicable | DMRS SNR per antenna |
| 000 0111b -  111 1111b | reserved for future measurement types |  |  |  |

**Type:** unsigned integer **Field length:** 7 bits **Default Value:** n/a

###### measDataSize (measurement data size)

**Description:** This parameter describes the total length of an RRM measurement report in ST 10, in units of 4-byte words, including the header with parameters mf and measTypeId, as well as any padding at the end.

**Value range:** {0x0001 - 0x3FFF}. The value 0x0000 and the range 0x4000 - 0xFFFF are reserved.

**Type:** unsigned integer **Field length:** 16 bits **Default Value:** N/A

###### ueTae (UE Timing Advance Error)

**Description:** This parameter provides value of UE Timing Advance Error (UE-TAE) measurement. See clause 9.2.2.1 for information about the measurement. The measurement unit is nanoseconds, with a resolution of 21-? x Tc , where

Tc = (480 kHz x 4096)-1 ? 0.509 ns and ? represents the subcarrier spacing configuration. This gives an effective

15 15

time resolution of (30 kHz / SCS) x T . The range of the reported value is [-2 +1,2 -1]symbol duration, i.e. an open

c

interval of +- 0.5 symbol duration (excluding cyclic prefix).

**Value range:** {0x0000 (0): no UE-TAE, 0 symbols

216

0x0001 (+1) - 0x7FFF (+32767): positive UE-TAE in the range 2-16 x [1, 215 - 1] symbols

0x8001 (-32767) - 0xFFFF (-1): negative UE-TAE in the range 2-16 x [-215 + 1, -1] symbols 0x8000 (-32768): invalid measurement result}

**Type:** signed integer **Field length:** 16 bits **Default Value: N/A**

###### ueLayerPower (UE layer power)

**Description:** This parameter indicates the average signal power per PRB for one uplink layer. It is represented in unit dBm/PRB with resolution 0.1 dB. See also clause 9.2.2.2.

**Value range:** {0x0000 (0) - 0x07FF (+2047): [0.0, 204.7] dBm/PRB

0xF800 (-2048) - 0xFFFF (-1): [-204.8, -0.1] dBm/PRB

0x8000 (-32768): invalid measurement result

Other values: reserved}

**Type:** signed integer **Field length:** 16 bits **Default Value:** N/A

###### ueFreqOffset (UE frequency offset)

**Description:** This parameter indicates the UE frequency offset in unit Hz, with resolution 2?-2 Hz where u represents the subcarrier spacing configuration. For example, 30 kHz SCS has u=1, which gives resolution 0.5 Hz. The supported range of frequency offsets is +- 0.5 subcarrier spacing. See also clause 9.2.2.3.

**Value range:** {0x0000 (0): no frequency offset

0x0001 (+1) - 0x7530 (+30000): positive frequency offset, ]0, +0.5] subcarrier

0x8AD0 (-30000) - 0xFFFF (-1): negative frequency offset, [-0.5, 0[ subcarrier 0x8000 (-32768): invalid measurement result

Other values: reserved}

**Type:** signed integer **Field length:** 16 bits **Default Value:** N/A

###### ipnPower (Interference plus Noise power)

**Description:** This parameter indicates interference plus noise power per PRB in unit dBm/PRB with resolution 0.1 dB. It is used both in measurement of IpN for allocated PRBs and measurement of IpN for unallocated PRBs. Depending on the symbolMask in ST 11 for IpN for unallocated PRBs and the aIpnPerSym parameter in SE 24 for IpN for allocated PRBs, the value could be an average over symbols, or one value per symbol. See also clauses 9.2.2.4 and 9.2.2.5.

**Value range:** {0x0000 (0) - 0x07FF (+2047): [0.0, 204.7] dBm/PRB,

0xF800 (-2048) - 0xFFFF (-1): [-204.8, -0.1] dBm/PRB

0x8000 (-32768): invalid measurement result

Other values: reserved}

**Type:** signed integer **Field length:** 16 bit **Default Value:** N/A

###### antDmrsSnrVal (antenna DMRS-SNR)

**Description:** This parameter indicates DMRS port SNR value per antenna in unit dB with resolution 0.1 dB. It is defined as DMRS signal power (per O-RU antenna, per DMRS port or UE layer) / (noise + inter-cell interference power) averaged over the DMRS REs used per DMRS port or UE layer per antenna (or dimension-reduced antenna) per slot. See also clause 9.2.2.6.

**Value range:** {0x0000 (0): 0 dB SNR

0x0001 (+1) - 0x07FF (+2047): positive SNR, [0.1, 204.7] dB

0xF800 (-2048) - 0xFFFF (-1): negative SNR, [-204.8, -0.1] dB

0x8000 (-32768): invalid measurement result

Other values: reserved}

**Type:** signed integer **Field length:** 16 bits **Default Value:** N/A

###### measCmdSize (measurement command size)

**Description:** This parameter describes the total length of an RRM measurement command in ST 11, in units of 4-byte words, including the header with parameters mf and measTypeId, as well as any padding at the end.

**Value range:** {0x0001 - 0x3FFF}. The value 0x0000 and the range 0x4000 - 0xFFFF are reserved.

**Type:** unsigned integer **Field length:** 16 bits **Default Value:** N/A

###### numElements (number of measurement values)

**Description:** This parameter indicates the number of elements for which measurement values are provided in the report for MEAS\_ANT\_DMRS\_SNR, corresponding to number of array elements or number of elements after dimension reduction. It can cover 1 - 256 elements.

**Value range:** {0x00 - 0xFF}. The value 0x00 expresses 256 elements.

**Type:** unsigned integer.

**Field length:** 8 bits.

**Default Value:** N/A

###### sinrCompParam (SINR data compression parameter)

When used in Section Type 9 (see clause 7.4.11) the sinrCompParam follows format of udCompParam defined in clause 8.3.3.15 for udCompMeth = 0001b. See clauses 7.2.11 and 8.3.3.15 for further details.

###### sinrValue

When used in Section Type 9 (see clause 7.4.11) this parameter conveys SINR value. See clause 7.2.11 for further description of SINR reporting. The value format is the same as format of iSample and qSample used in U-Plane; see clauses 8.3.3.16 and 8.3.3.17 for further details on value format.

## Section Extension elements

#### Overview

Table 7.6.1-1 lists all the Section Extension parameters defined within the C-Plane:

**Table** **7.6.1-1: Section Extension commands**

|  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- |
| **extType** | **meaning** | **extLen** | **extension parameters** | **octets** | **meaning** |
| 0 | reserved | 1 (1  word) | reserved reserved | 1  1 | for future use for future use |
| 1 | beamforming weights | var | bfwCompHdr bfwCompParam bfwI (for TRX 0) bfwQ (for TRX 0)  ...  bfwI (for last TRX) bfwQ (for last TRX) | 1  1  var var  var var | IqWidth(3:0) | compMeth(3:0) depends on compr. method beamforming weight I value beamforming weight Q value  beamforming weight I value beamforming weight Q value |
| 2 | beamforming attributes | var | bfaCompHdr bfAzPt bfZePt bfAz3dd bfZe3dd bfAzSl  bfZeSl | 2  var var var var 3b  3b | BF attributes compr. header BF azimuth pointing param BF zenith pointing param  BF azimuth beamwidth param BF zenith beamwidth param BF azimuth sidelobe param  BF zenith sidelobe param |
| 3 | DL Precoding configuration parameters and indications | var (3 or 4 words) | codebookIndex layerId txScheme numLayers crsReMask crsSymNum crsShift beamIdAP1  beamIdAP2 beamIdAP3 | 1  4b 4b 4b 12b 4b 1b 15b  15b 15b | precoder codebook layer ID for DL Tx transmission scheme  number of layers in DL Tx CRS RE Mask  CRS symbol number CRS shift command Beam ID, Antenna Port 1  Beam ID, Antenna Port 2 Beam ID, Antenna Port 3 |
| 4 | modulation compr. params | 1 (1  word) | csf modCompScaler | 1b 15b | constellation shift flag mod. compr. scale value |
| 5 | modulation compression additional scaling  parameters | var | mcScaleReMask csf mcScaleOffset | 12b 1b 15b | Position of same scaling bits constellation shift flag  added mod. compr. scale values |
| 6 | Non-contiguous PRB allocation | 2 (2  words) | repetition rbgSize rbgMask priority  symbolMask | 1b 3b 28b 2b  14b | repetition flag number of PRBs in the group  mask of RBGs in the symbol(s) priority of section description mask of symbols in the slot |
| 7 | Multiple-eAxC designation | 1 | eAxCmask | 16b | eAxC mask |
| 8 | regularization factor | 1 | regularizationFactor | 16b | regularization factor |
| 9 | Dynamic Spectrum Sharing parameters | 1 | technology | 1 | interface name |
| 10 | Multiple ports grouping | var | beamGroupType numPortc beamId (or ueId) portListIndex | 2b 6b 15b 1 | type of beam grouping the number of ports beam ID (or UE ID)  port-list index associated with each UE ID or beam ID |

|  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- |
| **extType** | **meaning** | **extLen** | **extension parameters** | **octets** | **meaning** |
| 11 | Flexible BF weights | var | disableBFWs RAD  bundleOffset numBundPrb bfwCompHdr  bfwCompParam for bundle 0 beamId (for PRB bundle 0) bfwI (for TRX 0, bundle 0)  bfwQ (for TRX 0, bundle 0)  ...  bfwI (for last TRX, bundle 0) bfwQ (for last TRX bundle 0)  ... bfwCompParam for last bundle beamId (for last PRB bundle)  bfwI (for TRX 0, last bundle) bfwQ (for TRX 0, last bundle)  ...  bfwI (for last TRX, last bundle) bfwQ (for last TRX & bundle) | 1b 1b 6b 1  1  var 2  var var  ... var var  ... var 2  var var  var var | disable beamforming weights Reset After (PRB) Discontinuity PRB bundle offset  Number of bundled PRBs bitWidth(3:0) | compMeth(3:0) depends on compr. method Beam ID  BF weight I value for bundle 0 BF weight Q value for bundle 0  ...  BF weight I value for bundle 0 BF weight Q value for bundle 0  ...  depends on compr. method Beam ID  BF weight I value for last bundle BF weight Q value for last bundle  ...  BF weight I value for last bundle BF weight Q value for last bundle |
| 12 | non-contiguous PRB allocation with frequency ranges | var | priority, symbolMask offStartPrb(1) numPrb(1)  ... offStartPrb(R-1)  numPrb(R-1) | 2b 14b 8b 8b  8b 8b | priority of section description mask of symbols in the slot offset to start of PRB range #1 number of PRBs in the range #1  offset to start of PRB range number of PRBs in the range |
| 13 | frequency hopping | var | nextSymbolId(1) nextStartPrbc (1)  ... nextSymbolId (R-1), nextStartPrbc (R-1) | 4b 10b  4b 10b | start symbol of hop #1 start PRB for hop #1  start symbol of hop #R-1 start PRB for hop #R-1 |
| 14 | Null-layer Info. for  ueId-based beamforming | var | nullLayerInd | 1 | Nulling-layer indication |
| 15 | Mixed-numerology  Info. for ueId-based beamforming | var | frameStructure  freqOffset cpLength | 1  3  2 | FFT size, mu (SCS)  Frequency offset Cyclic prefix length |
| 16 | Antenna mapping for UE channel Info  based UL beamforming | var | antMask  ... antMask | 8  var | Bitmask of Max. 64 antenna  Bitmask of Max. 64 antenna |
| 17 | User port group  indication | var | numUeId | 4b | Number of ueIds per user |
| 18 | Uplink Transmission  Management | 2 (2  words) | transmissionWindowOffset transmissionWindowSize  toT | 16b 14b  2b | transmission window offset transmission window size  type of transmission |

|  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- |
| **extType** | **meaning** | **extLen** | **extension parameters** | **octets** | **meaning** |
| 19 | Compact multiple port beamforming information | var | disableBFWs repetition priority numPortc symbolMask bfwCompHdr  ... portReMask(for port 1)  portSymbolMask(for port 1)  bfwCompParam(for port 1)  ... beamId(for port 1)  bfwI (for port 1 and TRX 0)  ...  bfwQ (for port 1 and TRX 0)  ... portReMask(for last port)  portSymbolMask(for last port) bfwCompParam(for last port)  ... beamId(for last port)  bfwI (for last port and TRX 0)  ...  bfwQ (for last port and TRX 0)  ... | 1b 1b 2b 6b 14b 8b  12b 14b  var 2  var var | disable BF weights repetition flag  priority of section description num ports  resource symbol bitmask BF weight compression header  RE bitmask for port 1 Symbol bitmask for port 1  BF weight compression parameter for port 1  beam identifier for port 1  BF weight in-phase value for port 1 TRX0  BF weight quadrature-phase value port 1 TRX0  RE bitmask for last port Symbol bitmask last port  BF weight compression parameter for last port  beamId for last port  BF weight in-phase value for last port and TRX0  BF weight quadrature-phase value last port TRX0 |
| 20 | Dedicated puncturing | var | numPuncPatterns symbolMask(1)  startPuncPrb(1)  ... numPuncPrb(1)  ...  ... puncReMask(1) rb(1)  rbgIncl(1) rbgSize(1) rbgMask(1) symbolMask(last)  startPuncPrb(last)  ... numPuncPrb(last)  ...  ... puncReMask(last) rb(last) rbgIncl(last) rbgSize(last) rbgMask(last) multiSDScope (1)  ...  multiSDScope (last) | 8b 14b  10b 10b  12b 1b 1b 3b 28b 14b  10b 10b  12b 1b 1b 3b 28b 1b  ... | number of puncturing patterns first puncturing pattern symbol mask  first PRB to which puncturing pattern applies  number of contiguous PRBs to which first puncturing pattern applies  first puncturing pattern RE mask first RB indicator  first rbg included flag first rbg size  first rbg bitmask  last puncturing pattern symbol mask  last PRB to which puncturing pattern applies  number of contiguous PRBs to which last puncturing pattern applies  last puncturing pattern RE mask last RB indicator  last rbg included flag last rbg size  last rbg bitmask  first puncturing pattern scope  ...  last puncturing pattern scope |
| 21 | Variable PRB group size for Channel Information | 1 (1  word) | ciPrbGroupSize  prgSize | 1  2b | channel information PRB group size  precoding resource block group size |
| 22 | ACK/NACK request | 1 (1  word) | ackNackReqId | 2 | used to identify the section description for which ACK/NACK feedback is requested |

|  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- |
| **extType** | **meaning** | **extLen** | **extension parameters** | **octets** | **meaning** |
| 23 | Multiple symbol modulation compression parameters | var | numSymPrbPattern symMask prbPattern numMcScaleOffset  mcScaleReMask csf  prbMode  prbBlkSize prbBlkOffset | 4b 14b 4b 4b  12b  1b 1b  1  1 | number of symbol and resource block pattern  symbol mask part of symPrbPattern  physical resource block pattern part of symPrbPattern number of modulation  compression scaling value per symPrbPattern  modulation compression power scale RE mask  constellation shift flag  Bit flag to choose prbPattern mode or prb block mode  PRB block size when prb block mode is used  PRB block offset when prb block mode is used |
| 24 | PUSCH DMRS  configuration | var | aIpnPerSym antDmrsSnr userGroupSize userGroupId entryType dmrsPortNumber  (other parameters may be present depending on entryType) | 1b 1b 5b 8b 3b 5b | allocated IPN per symbol antenna DMRS SNR user group size  user group identifier type of DMRS config entry  DMRS port number |
| 25 | Symbol reordering for DMRS-BF | var | txWinForOnAirSymbol0  ... txWinForOnAirSymbol13 | 4b  ...  4b | transmission window for on-air symbol 0  ...  transmission window for on-air symbol 13 |
| 26 | Frequency offset feedback | var | numFoFb 1st freqOffsetFb  ...  last freqOffsetFb | 7b 16b var 16b | number of frequency offset 1st UE frequency offset  ...  the last UE frequency offset |
| 27 | O-DU controlled dimensionality reduction | var | beamType numElements 1st beamId  ...  last beamId | 2b 6b 15b var  15b | type of beam configuration Number of beamId values 1st beamId value  ...  the last beamId value |
| 28 | O-DU controlled frequency resolution for SINR reporting | var | numUeSinrRpt numSinrPerPrb of 1st UE numSinrPerPrb of 2nd UE  ...  numSinrPerPrb of last UE | 5b 3b 3b  var 3b | Number of sinr reported UEs 1st SINR frequency resolution 2nd SINR frequency resolution  ...  last SINR frequency resolution |
| 29-127 | reserved | 1 (1  word) | reserved reserved | 1  1 | for future use for future use |

#### Common parameters

###### extType (extension type)

**Description:** This parameter provides the extension type which provides additional parameters specific to the subject data extension. An O-RU or O-DU receiving a "reserved" Section Extension shall ignore the extension and all parameters contained within it.

**Value range:** {all zeros - all ones}. See Table 7.6.1-1 for values.

**Type:** unsigned integer.

**Field length:** 7 bits.

###### ef (extension flag)

**Description:** This parameter is used to indicate if there is another extension present (ef=1) or this is the last extension (ef=0).

**Value range:** {0b=no more extensions; 1b=one or more extensions are included after this one}.

**Type:** binary bit.

**Field length:** 1 bit.

###### extLen (extension length)

**Description:** This parameter provides the length of the Section Extension in units of 32-bit (or 4-byte) words. The value zero is reserved, as there is always at least one word in the extension (the word containing the extType and extLen).

**Value range:** {all zeros - all ones} - from one word to 255 words (8 bits) or from one word to 65535 words (16 bits). The value zero is reserved.

**Type:** unsigned integer.

**Field length:** 8 bits for all Section Extensions except for Section Extension 11, 19 and 20 for which the field length is 16 bits.

## Coding of Section Extension IEs

#### SE 1: Beamforming weights

###### Overview

Section Extension 1 applies to the sending of beamforming weights from the O-DU to the O-RU. When Section Extension 1 is present in a section description, O-RU shall associate the set of beamforming weights conveyed in Section Extension 1 with the beamId conveyed in the section description. In subsequent C-Plane messages, the same beamId can be invoked without sending the beamforming weights again.

NOTE: This allows downloaded weights to have "persistence" which saves DL throughput by not requiring sending of weights multiple times.

The parameter K is defined in clause 12.5.3. Refer to Annex D.1 for details on the usual weight byte order. The optional "little endian byte order" is applied to bfwI/bfwQ fields if configured via M-Plane. Refer to Annex D.2 for details of little endian byte order. This Section Extension applies only to Section Types 1 and 3. The structure of Section Extension 1 is presented in Table 7.7.1.1-1.

**Table 7.7.1.1-1: Format of Section Extension 1 (beamforming weights)**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **# of bytes** |  |
| ef | extType = 0x1 | | | | | | | 1 | Octet N |
| extLen | | | | | | | | 1 | Octet N+1 |
| bfwCompHdr | | | | | | | | 1 | Octet N+2 |
| bfwCompParam | | | | | | | | var | Octet N+3 |
| bfwI (for TRX 0) | | | | | | | | var |  |
| bfwQ (for TRX0) | | | | | | | | var |  |
| remaining beamforming weights bfwI and bfwQ up to K TRXs | | | | | | | | var |  |
| zero pad to 4-byte boundary | | | | | | | | var |  |

###### bfwCompHdr (beamforming weight compression header)

**Description:** This parameter defines the compression method and IQ bit width for the beamforming weights in the specific section in the C-Plane message. In this way each set of weights may employ a separate compression method. For the block compression methods, the block size is the entire vector of beamforming weights, not some subset of them.

If the O-RU supports static beamforming weight compression through M-Plane configuration, and static compression is configured, this field shall be set to a value corresponding to the compression method configured via M-Plane. If the

O-RU supports dynamic beamforming weight compression, then O-DU may configure dynamic compression via M- Plane with or without providing a list of compression methods that will be used dynamically (i.e. a subset of methods supported by O-RU). If dynamic compression is configured via M-Plane without providing a list of compression methods, this field shall be set to a value corresponding to one of dynamic compression methods supported by O-RU. If dynamic compression is configured with a list of compression methods, then this field shall be set to a value corresponding to one of compression methods in the list. If bfwCompHdr parameter value in a C-Plane message and M- Plane configuration are not compatible, then O-RU may discard the message or process the message as per M-Plane configuration or as per bfwCompHdr value.

**Value range:** {0000 0000b-1111 1111b}.

**Bit allocations:** see Table 7.7.1.2-1.

**Table 7.7.1.2-1: bfwCompHdr definition**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **Number of Octets** |  |
| bfwIqWidth (see Table 7.7.1.2-2) | | | | bfwCompMeth (see Table 7.7.1.2-3) | | | | 1 | Octet 1 |

**Table 7.7.1.2-2: bfwIqWidth definition**

|  |  |
| --- | --- |
| **bfwIqWidth** | **Bit width of each I and each Q** |
| 0000-1111b | Value of bfwIqWidth except a value of zero means 16 bits.  EXAMPLE 1: bfwIqWidth = 0000b means I and Q are each 16 bits wide. EXAMPLE 2: bfwIqWidth = 0001b means I and Q are each 1 bit wide.  EXAMPLE 3: bfwIqWidth = 1111b means I and Q are each 15 bits wide. |

**Table 7.7.1.2-3: bfwCompMeth definition**

|  |  |  |
| --- | --- | --- |
| **bfwCompMeth** | **compression method** | **bfwIqWidth meaning** |
| 0000b | no compression | bitwidth of each uncompressed I and Q value |
| 0001b | block floating point | bitwidth of each I and Q mantissa value |
| 0010b | block scaling | bitwidth of each I and Q scaled value |
| 0011b | ?-law | bitwidth of each compressed I and Q value |
| 0100b | beamspace compression type I | bitwidth of each beamspace I and Q coefficient |
| 0101b | beamspace compression type II | bitwidth of each beamspace I and Q coefficient |
| 0110b - 1111b | reserved for future methods | N.A. |

**Type:** unsigned integer (concatenated bit fields).

**Field length:** 8 bits.

**Default Value:** 0000 0000b (no compression, 16-bit I and Q).

* + - 1. bfwCompParam (beamforming weight compression parameter) **Description:** This parameter applies to the compression method specified by the associated bfwCompMeth value. **Value range:** {0000 0000b-1111 1111b}.

**Bit allocations:** As presented in Table 7.7.1.3-1, allocation of bits in bfwCompParam depends on value of subfield

bfwCompMeth of field bfwCompHdr described in clause 7.7.1.2.

**Table 7.7.1.3-1: bfwCompParam definition**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **bfwCompMeth** | **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **bwfCompParam size** |
| 0000b = no compression | absent | | | | | | | | 0 octets |
| 0001b = block floating point | reserved (set to all zeros) | | | | exponent (unsigned) | | | | 1 octet |
| 0010b = block scaling | blockScaler (unsigned, 1 integer bit, 7 fractional bits) | | | | | | | | 1 octet |
| 0011b = ?-law | compBitWidth | | | | compShift | | | | 1 octet |
| 0100b = beamspace I | activeBeamspaceCoefficientMask | | | | | | | | ceil(K/8) octets (see NOTE 1) |
| blockScaler (unsigned,1 integer bit,7 fractional bits) | | | | | | | | 1 octet |
| 0101b = beamspace II | activeBeamspaceCoefficientMask | | | | | | | | ceil(K/8) octets (see NOTE 1) |
| reserved (set to all zeros) | | | | exponent (unsigned) (see NOTE 2) | | | | 1 octet |
| NOTE 1: K is the number of elements in uncompressed beamforming weight vector (see clause 12.5.3 and Annex J). K is O-RU-specific and is calculated from parameters describing tx-array or rx-array, conveyed from the O-RU to the O-DU via the M-Plane as part of the initialization procedure.  NOTE 2: For bfwCompMeth value 0101b (beamspace II), block floating point compression is used for the beamspace coefficients. | | | | | | | | | |

**Type:** unsigned integer (concatenated bit fields).

**Field length:** an integer number of bytes; the length is given in column "bwfCompParam size" in Table 7.7.1.3-1.

###### bfwI (beamforming weight in-phase value)

**Description:** This parameter is the in-phase beamforming weight value. Refer to Annex D.1 for details on the usual weight byte order. The optional "little endian byte order" can be configured via M-Plane; see Annex D.2 for details on byte order. The maximum number of weights in the Section Extension is O-RU-specific and will be conveyed from the O-RU to the O-DU via the M-Plane as part of the initialization procedure. For bfwCompMeth indicating beamspace I and beamspace II the number of weights in the Section Extension is determined by activeBeamspaceCoefficientMask, for other bfwCompMeth values the number of weights in the Section Extension is always the maximum.

**Value range:** {all zeros - all ones}.

**Type:** signed integer.

**Field length:** 1-16 bits.

###### bfwQ (beamforming weight quadrature value)

**Description:** This parameter is the quadrature beamforming weight value. Refer to Annex D.1 for details on the usual weight byte order. The optional "little endian byte order" can be configured via M-Plane; refer to Annex D.2 for detail on byte order. The maximum number of weights in the Section Extension is O-RU-specific and will be conveyed from the O-RU to the O-DU via the M-Plane as part of the initialization procedure. For bfwCompMeth indicating beamspace I and beamspace II the number of weights in the Section Extension is determined by activeBeamspaceCoefficientMask, for other bfwCompMeth values the number of weights in the Section Extension is always the maximum.

**Value range:** {all zeros - all ones}.

**Type:** signed integer.

**Field length:** 1-16 bits.

#### SE 2: Beamforming attributes

###### Overview

Section Extension 2 applies only to Section Types 1 and 3. Section Extension 2 applies to the sending of beamforming attributes from the O-DU to the O-RU which is described in Annex J.

The Table 7.7.2.1-1 shows the format of Section Extension 2.

**Table 7.7.2.1-1: Section Extension 2 Data Format**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **# of bytes** |  |
| ef | extType = 0x02 | | | | | | | 1 | Octet N |
| extLen | | | | | | | | 1 | Octet N+1 |
| bfaCompHdr | | | | | | | | 2 | Octet N+2 |
| bfAzPt | | | | | | | | var | Octet N+3 |
| bfZePt | | | | | | | | var |  |
| bfAz3dd | | | | | | | | var |  |
| bfZe3dd | | | | | | | | var |  |
| zero-padding | | bfAzSl | | | bfZeSl | | | 1 |  |
| zero padding to achieve 4-byte alignment as needed | | | | | | | |  |  |

###### bfaCompHdr (beamforming attributes compression header)

**Description:** This parameter defines the bit width for the beamforming attributes extension parameters. In this way each set of beamforming attributes may employ a different bit width.

**Value range:** {0000 0000 0000b-1111 1111 1111b}.

**Bit allocations:** Table 7.7.2.2-1 shows bit allocations within bfaCompHdr.

**Table 7.7.2.2-1: bfaCompHdr definition**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **Number of Octets** |  |
| Reserved | | bfAzPtWidth (see Table 7.7.2.2-2) | | | bfZePtWidth (see Table 7.7.2.2-3) | | | 1 | Octet 1 |
| Reserved | | bfAz3ddWidth (see Table 7.7.2.2-4) | | | bfZe3ddWidth (see Table 7.7.2.2-5) | | | 1 | Octet 2 |

**Table 7.7.2.2-2: bfAzPtWidth definition**

|  |  |
| --- | --- |
| **bfAzPtWidth** | **Bit width of bfAzPt** |
| 000-111b | value of bfAzPtWidth |

**Table 7.7.2.2-3: bfZePtWidth definition**

|  |  |
| --- | --- |
| **bfZePtWidth** | **Bit width of bfZePt** |
| 000-111b | value of bfZePtWidth |

**Table 7.7.2.2-4: bfAz3ddWidth definition**

|  |  |
| --- | --- |
| **bfAz3ddWidth** | **Bit width of bfAz3dd** |
| 000-111b | value of bfAz3ddWidth |

**Table 7.7.2.2-5: bfZe3ddWidth definition**

|  |  |
| --- | --- |
| **bfZe3ddWidth** | **Bit width of bfZe3dd** |
| 000-111b | value of bfZe3ddWidth |

For each of the four bitwidth values in this parameter (bfAzPtWidth, bfZePtWidth, bfAz3ddWidth, and bfZe3ddWidth) the following mapping shall be used:

* 000b = no bits, the field is not applicable (e.g. O-RU does not support it) or the default value shall be used.
* 001b = 2-bit bitwidth
* 010b = 3-bit bitwidth
* 011b = 4-bit bitwidth
* 100b = 5-bit bitwidth
* 101b = 6-bit bitwidth
* 110b = 7-bit bitwidth
* 111b = 8-bit bitwidth (this is the highest bitwidth anticipated to be needed)

**Type:** unsigned integer (concatenated bit fields).

**Field length:** 16 bits (4 bits are reserved).

**Default Value:** 0011 1111 0011 1111b (8-bit azimuth and zenith pointing angle and 8-bit azimuth and zenith beamwidth).

###### bfAzPt (beamforming azimuth pointing parameter)

**Description:** This parameter is the azimuth beamforming pointing angle in degrees. The valid range of values is O-RU- specific and is conveyed from the O-RU to the O-DU as part of the initialization procedure via the M-Plane.

**Value range:** {all zeros - all ones}.

**Type:** signed integer.

**Field length:** 0-8 bits.

###### bfZePt (beamforming zenith pointing parameter)

**Description:** This parameter is the zenith beamforming pointing angle in degrees. The valid range of values is O-RU- specific and is conveyed from the O-RU to the O-DU as part of the initialization procedure via the M-Plane.

**Value range:** {all zeros - all ones}.

**Type:** unsigned integer.

**Field length:** 0-8 bits.

###### bfAz3dd (beamforming azimuth beamwidth parameter)

**Description:** This parameter is the azimuth beamforming beamwidth in degrees. The valid range of values is O-RU- specific and is conveyed from the O-RU to the O-DU as part of the initialization procedure via the M-Plane. The value (000b) corresponds to the minimum valid beamwidth.

**Value range:** {all zeros - all ones}.

**Type:** unsigned integer.

**Field length:** 0-8 bits.

###### bfZe3dd (beamforming zenith beamwidth parameter)

**Description:** This parameter is the zenith beamforming beamwidth in degrees. The valid range of values is O-RU- specific and is conveyed from the O-RU to the O-DU as part of the initialization procedure via the M-Plane. The value (000b) corresponds to the minimum valid beamwidth.

**Value range:** {all zeros - all ones}.

**Type:** unsigned integer.

**Field length:** 0-8 bits.

###### bfAzSl (beamforming azimuth sidelobe parameter)

**Description:** This parameter is the azimuth beamforming sidelobe suppression value in dB. The valid range of values is O-RU-specific and is conveyed from the O-RU to the O-DU as part of the initialization procedure via the M-Plane. The value of bfAzSl corresponds to a value of 10 dB for all zeros and increments in 5 dB steps (e.g. 001b corresponds to

15 dB, 010b corresponds to 20 dB, and so on). The value 111b corresponds to having a sidelobe suppression of 45 dB or more.

**Value range:** {all zeros - all ones}.

**Type:** unsigned integer.

**Field length:** 3 bits.

###### bfZeSl (beamforming zenith sidelobe parameter)

**Description:** This parameter is the zenith beamforming sidelobe suppression value in dB. The valid range of values is O-RU-specific and is conveyed from the O-RU to the O-DU as part of the initialization procedure via the M-Plane. The value of bfZeSl corresponds to a value of 10 dB for all zeros and increments in 5 dB steps (e.g. 001b corresponds to

15 dB, 010b corresponds to 20 dB, and so on). The value 111b corresponds to having a sidelobe suppression of 45 dB or more.

**Value range:** {all zeros - all ones}.

**Type:** unsigned integer.

**Field length:** 3 bits.

###### zero-padding

**Description:** This parameter is intended to pad out the data to the next 4-byte boundary. Because the preceding parameters are of varying bitwidth, in most cases padding will be needed to achieve the 4-byte alignment. Transmitter shall send value "0", while receiver shall ignore the value received.

**Value range:** {all zeros}.

**Type:** variable.

**Field length:** variable.

#### SE 3: DL precoding parameters

###### Overview

Section Extension 3 applies only to Category B O-RU and to Section Types 1 and 3. Section Extension 3 may be used only for precoding schemes Transmit Diversity and Spatial Multiplexing with Large Delay CDD; for other LTE transmission modes and for NR, if there is precoding in the DL processing chain, precoding shall be included in the beamforming operation (that is, encoded in the beamforming weights).

Table 7.7.3.1-1 shows the format of Section Extension 3 for the first data layer.

**Table 7.7.3.1-1: Format of Section Extension 3 for the first data layer**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **# of bytes** |  |
| ef | extType = 0x03 | | | | | | | 1 | Octet N |
| extLen = 0x04 (4 words) | | | | | | | | 1 | N+1 |
| codebookIndex | | | | | | | | 1 | N+2 |
| layerId = 0000b or 1111b | | | | numLayers[3:0] | | | | 1 | N+3 |
| txScheme[3:0] | | | | crsReMask[11:8] | | | | 1 | N+4 |
| crsReMask[7:0] | | | | | | | | 1 | N+5 |
| crsShift | reserved | | | crsSymNum[3:0] | | | | 1 | N+6 |
| reserved | | | | | | | | 3 | N+7 |
| reserved | beamIdAP1[14:8] | | | | | | | 1 | N+10 |
| beamIdAP1[7:0] | | | | | | | | 1 | N+11 |
| reserved | beamIdAP2[14:8] | | | | | | | 1 | N+12 |
| beamIdAP2[7:0] | | | | | | | | 1 | N+13 |
| reserved | beamIdAP3[14:8] | | | | | | | 1 | N+14 |
| beamIdAP3[7:0] | | | | | | | | 1 | N+15 |

Table 7.7.3.1-2 shows the format of Section Extension 3 for the non-first data layer.

**Table 7.7.3.1-2: Format of Section Extension 3 for non-first data layer**

|  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | **3** | | **4** | **5** | **6** | **7 (lsb)** | **# of bytes** |  |  |
| ef | extType = 0x03 | | | | | | | | 1 | Octet N | |
| extLen = 0x01 (1 word) | | | | | | | | | 1 | N+1 | |
| codebookIndex | | | | | | | | | 1 | N+2 | |
| layerId != 0000b or 1111b | | | | numLayers | | | | | 1 | N+3 | |

LTE precoding schemes Transmit Diversity and Spatial Multiplexing with Large Delay CDD support two or four antenna ports, hence two or four beamIds are needed (same beamId for user data and CRS REs). For Antenna Port 0, the beamId is contained in the C-Plane data section header, while the Antenna Ports 1-3 beamIds are contained in this Section Extension. When there are two antenna ports, the Section Extension only contains the second Antenna Port beam ID ("beamIdAP1") and the Section Extension length is 3 words ("extLen" = 0x3). When there are four antenna ports, the Section Extension contains the second, third and fourth Antenna Port beam IDs ("beamIdAP1", "beamIdAP2", and "beamIdAP3") and the Section Extension length is 4 words ("extLen" = 0x4).

For the txScheme indicating Transmit Diversity, one Pcid is used for all the user data and one section instantiation is needed using the corresponding C-Plane Rtcid, providing all the beam IDs (up to 4) for the user data; a second section instantiation (same sectionId) with a different reMask may be used to provide the CRS RE beam IDs (also up to 4). In the Transmit Diversity case the layerId shall be set to 1111b ("TxD").

For the txSchemes indicating Spatial Multiplexing with Large Delay CDD, each layer shall have its own Pcid for the user data with a corresponding C-Plane Rtcid conveying the user data's beamId, with this Section Extension showing a different layer number for each layer. Only within the Rtcid for layer ID zero, the CRS REs will be provided with their beamIds (one beamId in the section header and the other beamIds in this Section Extension). For the non-zero layer number Rtcids, this Section Extension will still be provided to guide the precoding operation (provide the layer ID) but will not include beamIds (extLen = 0x1), and the beamId in the section header should be ignored by the O-RU and should be set to the default value by the O-DU.

Considering scheduling of multiple UEs within a slot, each using Spatial Multiplexing with Large Delay CDD, association of first data layer with respective non-first data layer while using Section Extension 3 at the O-RU is required. To create this association the O-DU shall use a unique eAxC\_ID value for each data layer which shall not change within a slot. The value of eAxC\_ID for a given layer shall be static at a per slot, per carrier level in C-Plane

messages with Section Extension 3. The static value of eAxC\_ID per layer shall be used by the O-RU to create eAxC\_ID to layerId mapping. This mapping shall be same across all PRB allocations (across UEs) within a slot.

###### codebookIndex (precoder codebook used for transmission)

**Description:** This parameter is not used and shall be set to zero.

**Value range:** {0000 0000b - 1111 1111b}.

**Type:** unsigned integer.

**Field length:** 8 bits.

**Default Value:** 0000 0000b (used for invalid mode)

###### layerID (Layer ID for DL transmission)

**Description:** This parameter defines the layer ID that are used for DL transmission.

**Value range:** {0000b-1111b}. 0000b implies layer0, 0001b implies layer1, 0010b implies layer2, 0011b implies layer3. (for Transmit Diversity, set to all ones)

**Type:** unsigned integer.

**Field length:** 4 bits.

**Default Value:** 1111b (used for Transmit Diversity mode)

###### txScheme (transmission scheme)

**Description:** This parameter defines the precoding scheme used in this Section Type.

**Value range:** {0000b-1111b} Table 7.7.3.4-1 shows meaning of defined values.

**Table 7.7.3.4-1: txScheme values**

|  |  |
| --- | --- |
| **txScheme** | **TM scheme** |
| 0000b | Spatial Multiplexing with Large Delay CDD |
| 0001b | Reserved |
| 0010b | Transmit Diversity |
| 0011b-111b | Reserved |

**Type:** unsigned integer.

**Field length:** 4 bits.

###### numLayers (number of layers used for DL transmission)

**Description:** This parameter defines the number of layers that are used for DL transmission.

**Value range:** {0000b-1111b}. 0000b implies 1 layer, 0001 implies 2 layers, 0010 implies 3 layers, 0011b implies 4 layers.

**Type:** unsigned integer.

**Field length:** 4 bits.

###### crsReMask (CRS resource element mask)

**Description:** This parameter defines the CRS Resource Element (RE) mask within a PRB. Each bit in the crsReMask indicates if the section control is applicable to the RE sent in U-Plane messages (0=not applicable, 1=applicable). MSB corresponds to the RE of the lowest frequency in a PRB.

**Value range:** {0000 0000 0000b-1111 1111 1111b}.

**Type:** unsigned integer (bit mask).

**Field length:** 12 bits.

###### crsSymNum (CRS symbol number indication)

**Description:** This parameter defines the CRS symbol number within a PRB. The value of the crsSymNum index indicates the symbol number to the RE sent in U-Plane messages.

**Value range:** {0000b-1111b}, value indicates symbol number.

* 0000b - 1101b: use symbol number 0 - 13 respectively;
* 1110b - 1111b: reserved

**Type:** unsigned integer.

**Field length:** 4 bits.

###### crsShift (crsShift used for DL transmission)

**Description:** This parameter indicates the shift pattern to pick up the right index for CRS positions for N Antennas (see Figure I.4-3)

**Value range:** 0 or 1, implying shift patterns that are layer-dependent according to the Table 7.7.3.8-1 below (see Table I.5-1, Table I.5-2 and Table I.5-3 in Annex I for vShift).

**Table 7.7.3.8-1: crsShift values**

|  |  |  |  |
| --- | --- | --- | --- |
|  | **1 Layer** | **2 Layers** | **4 Layers** |
| **crsShift** | **=0 for** 0 <= vshift <= 5 | **0 for** 0 <= vshift <= 2  **1 for** 3 <= vshift <= 5 | **0 for** 0 <= vshift <= 2  **1 for** 3 <= vshift <= 5 |

**Type**: binary.

**Field length**: 1 bit.

###### beamIdAP1 (beam id to be used for antenna port 1)

**Description:** This parameter defines the beam pattern to be applied to the U-Plane data. beamId = 0 means no beamforming operation will be performed. No beamforming operation implies that the RU shall not apply any phase or amplitude weights to the U-Plane data and that the resulting RF signal will be applied to all antenna elements in the group equally.

**Value range:** {000 0000 0000 0001b-111 1111 1111 1111b}.

**Type:** unsigned integer.

**Field length:** 15 bits.

**Default Value:** 000 0000 0000 0000b (no beamforming).

###### beamIdAP2 (beam id to be used for antenna port 2)

**Description:** This parameter defines the beam pattern to be applied to the U-Plane data. beamId = 0 means no beamforming operation will be performed. No beamforming operation implies that the RU shall not apply any phase or amplitude weights to the U-Plane data and that the resulting RF signal will be applied to all antenna elements in the group equally.

**Value range:** {000 0000 0000 0001b-111 1111 1111 1111b}

**Type:** unsigned integer.

**Field length:** 15 bits.

**Default Value:** 000 0000 0000 0000b (no beamforming).

###### beamIdAP3 (beam id to be used for antenna port 3)

**Description:** This parameter defines the beam pattern to be applied to the U-Plane data. beamId = 0 means no beamforming operation will be performed. No beamforming operation implies that the RU shall not apply any phase or amplitude weights to the U-Plane data and that the resulting RF signal will be applied to all antenna elements in the group equally.

**Value range:** {000 0000 0000 0001b-111 1111 1111 1111b}

**Type:** unsigned integer.

**Field length:** 15 bits.

**Default Value:** 000 0000 0000 0000b (no beamforming).

#### SE 4: Modulation compression parameters

###### Overview

Section Extension 4 applies only to Section Types 1, 3 and 5. Section Extension 4 enables the O-DU to convey to the O-RU one set of "csf and modCompScaler values" which is needed for modulation compression described in Annex A.5.

**Table 7.7.4.1-1**shows the format of Section Extension 4.

**Table 7.7.4.1-1: Format of Section Extension 4 (modulation compression parameters)**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **# of bytes** |  |
| ef | extType = 0x04 | | | | | | | 1 | Octet N |
| extLen = 0x01 (1 word) | | | | | | | | 1 | N+1 |
| csf | modCompScaler[14:8] | | | | | | | 1 | N+2 |
| modCompScaler[7:0] | | | | | | | | 1 | N+3 |

###### csf (constellation shift flag)

**Description:** This binary flag indicates whether to shift the constellation (csf=1) or not (csf=0). "Shift" means subtract from (during compression) or add to (during decompression) the I and Q values the value 2-udIqWidth where "udIqWidth" is the number of I and Q bits in the U-Plane representation (see Table 7.7.4.2-1).

**Table 7.7.4.2-1: Constellation shift definition**

|  |  |
| --- | --- |
| **udIqWidth** | **Shift value** |
| 1  2  3  4  5 | 1/2  1/4  1/8  1/16  1/32 |

**Value range:** {0b-1b}

**Type:** binary.

**Field length:** 1 bit.

###### modCompScaler (modulation compression scaler value)

**Description:** This parameter conveys the scale factor O-RU shall apply to the unshifted constellation points during decompression. It is a fractional floating-point value having an unsigned but negative 4-bit exponent and an unsigned fractional 11-bit mantissa.

**Value range:** { 0 through + (1-2-11 ) }.

**Type:** unsigned fractional floating-point value.

The value of the scale factor conveyed as modCompScaler field shall be calculated with:

modCompScaler = mantissa ? 2-exponent

where exponent is the most significant 4 bits of the 15-bit modCompScaler field and mantissa is the least-significant 11 bits of the modCompScaler field. The values of exponent and mantissa shall be calculated with:

10

mantissa = ? modCompScaler[k] ? 2k-11

k=0

14

exponent = ? modCompScaler[k] ? 2k-11

k=11

where "modCompScaler[k]" is the kth bit of the modCompScaler field.

**Field length:** 15 bits.

#### SE 5: Modulation compression additional parameters

###### Overview

This Section Extension applies only to Section Types 1, 3 and 5. Section Extension 5 enables the O-DU to convey one or more set(s) of mcScaleReMask, csf and mcScaleOffset values to the O-RU which is needed for modulation compression described in Annex A.5. Table 7.7.5.1-1 and Table 7.7.5.1-2 shows the Section Extension format when

one set and two sets of "mcScaleReMasks, csf and mcScaleOffset values" are conveyed. Please note that Section Extension 5 may be used to convey more than two sets of "mcScaleReMasks, csf and mcScaleOffset values" in which case the frame structure is extended in similar fashion, i.e. the zero padding bits are added at the end of the Section Extension to maintain 4-byte alignment.

**Table 7.7.5.1-1: Format of Section Extension 5 with one scaler value, modulation compression parameters**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **# of bytes** |  |
| ef | extType = 0x05 | | | | | | | 1 | Octet N |
| extLen = 0x2 (2 words) | | | | | | | | 1 | N+1 |
| mcScaleReMask[11:4] | | | | | | | | 1 | N+2 |
| mcScaleReMask[3:0] | | | | csf | mcScaleOffset [14:12] | | | 1 | N+3 |
| mcScaleOffset [11:4] | | | | | | | | 1 | N+4 |
| mcScaleOffset [3:0] | | | | zero padding | | | | 1 | N+5 |
| zero padding | | | | | | | | 1 | N+6 |
| zero padding | | | | | | | | 1 | N+7 |

**Table 7.7.5.1-2: Format of Section Extension 5 with two scaler values, modulation compression parameters**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **# of bytes** |  |
| ef | extType = 0x05 | | | | | | | 1 | Octet N |
| extLen = 0x03 (3 words) | | | | | | | | 1 | N+1 |
| mcScaleReMask[11:4] | | | | | | | | 1 | N+2 |
| mcScaleReMask[3:0] | | | | csf | mcScaleOffset [14:12] | | | 1 | N+3 |
| mcScaleOffset [11:4] | | | | | | | | 1 | N+4 |
| mcScaleOffset [3:0] | | | | mcScaleReMask[11:8] | | | | 1 | N+5 |
| mcScaleReMask[7:0] | | | | | | | | 1 | N+6 |
| csf | mcScaleOffset [14:8] | | | | | | | 1 | N+7 |
| mcScaleOffset [7:0] | | | | | | | | 1 | N+8 |
| zero padding | | | | | | | | 1 | N+9 |
| zero padding | | | | | | | | 1 | N+10 |
| zero padding | | | | | | | | 1 | N+11 |

For a given extLen value, there are two possible cases for the number of sets of 'mcScaleReMask-csf-mcScaleOffset'. For example, when extLen equals to 4, the number of sets of 'mcScaleReMask-csf-mcScaleOffset' may be either 3 or 4;

i.e. both cases will fit within 16 bytes (extLen=4). This happens when extLen minus 2 bytes equals to an integer multiple of 3.5 bytes (28bits). In such cases, if the last 28 bits (length of one set) of Section Extension 5 parameters are all set to 0, then O-RU shall consider the smaller number of parameter sets. Otherwise, if they are not all set to 0, O-RU shall consider the larger number of parameter sets. Table 7.7.5.1-3 shows example of the format when 3 or 4 sets of parameters are included in the Section Extension.

**T****able 7.7.5.1-3: Format of Section Extension 5 when extLen = 4 (three or four modulation compression parameters may be present)**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **# of bytes** |  |
| ef | extType = 0x05 | | | | | | | 1 | Octet N |
| extLen = 0x04 (4 words) | | | | | | | | 1 | N+1 |
| mcScaleReMask[11:4] | | | | | | | | 1 | N+2 |
| mcScaleReMask[3:0] | | | | csf | mcScaleOffset [14:12] | | | 1 | N+3 |
| mcScaleOffset [11:4] | | | | | | | | 1 | N+4 |
| mcScaleOffset [3:0] | | | | mcScaleReMask[11:8] | | | | 1 | N+5 |
| mcScaleReMask[7:0] | | | | | | | | 1 | N+6 |
| csf | mcScaleOffset [14:8] | | | | | | | 1 | N+7 |
| mcScaleOffset [7:0] | | | | | | | | 1 | N+8 |
| mcScaleReMask[11:4] | | | | | | | | 1 | N+9 |
| mcScaleReMask[3:0] | | | | csf | mcScaleOffset [14:12] | | | 1 | N+10 |
| mcScaleOffset [11:4] | | | | | | | | 1 | N+11 |
| mcScaleOffset [3:0] | | | | mcScaleReMask[11:8] (or zero padding) | | | | 1 | N+12 |
| mcScaleReMask[7:0] (or zero padding) | | | | | | | | 1 | N+13 |
| csf (or zero padding) | mcScaleOffset [14:8] (or zero padding) | | | | | | | 1 | N+14 |
| mcScaleOffset [7:0] (or zero padding) | | | | | | | | 1 | N+15 |

###### mcScaleReMask (modulation compression power scale RE mask)

**Description:** This parameter defines the Resource Element (RE) mask to indicate the position of RE with same scaling and modulation type within a PRB. Each bit setting in the mcScaleReMask indicates if the mcScaleOffset and csf fields are applicable to the RE sent in U-Plane messages or not (0=not applicable; 1=applicable). Most significant bit of this parameter indicates the value for the RE of the lowest frequency in a PRB.

Different REs in a PRB may be indicated by different invocations of mcScaleReMask within the Section Extension 5. If any RE in a PRB is never pointed to by a mcScaleReMask (but other REs in that PRB are), the "missing" RE should be considered to represent not populated REs (e.g. no user data to transmit).

There is a relationship between the mcScaleReMask values and the section's reMask: no bit in any of the mcScaleReMasks shall be set (=1) in a position where the reMask has a zero, and every reMask bit that is set (=1) shall have exactly one bit = 1 in one of the mcScaleReMasks.

**Value range:** {0000 0000 0000b - 1111 1111 1111b}.

**Type:** unsigned integer (bit mask).

**Field length:** 12 bits.

**Default Value:** 1111 1111 1111b (all REs in the block applicable).

###### csf (constellation shift flag)

**Description:** refer to clause 7.7.4.2

###### mcScaleOffset (scaling value for modulation compression)

**Description:** This parameter is the scale factor to apply to the unshifted constellation points during decompression. It is a fractional floating-point value having an unsigned but negative 4-bit exponent and an unsigned fractional 11-bit mantissa.

**Value range:** {0 through +(1 - 2-11 ) }.

**Type:** unsigned integer.

Exponent is the most significant 4 bits of the 15-bit mcScaleOffset field and mantissa is the least-significant 11 bits of the mcScaleOffset field. mcScaleOffset[k] refers to the kth bit of the mcScaleOffset field. Therefore, the actual value of mcScaleOffset is:

mcScaleOffset = mantissa ? 2-exponent.

Field length: 15 bits.

#### SE 6: Non-contiguous PRB allocation in time and frequency domain

###### Overview

Section Extension 6 applies only to Section Types 1, 3 and 5.

Section Extension 6 enables allocation of non-contiguous sets of PRBs (Resource Block Groups, or RBGs) in frequency and time domain. This reduces the C-Plane overhead when users or channels are allocated with non-contiguous sets of PRBs in time and frequency.

If Section Extension 6 is present in a section description, then the following requirements apply:

1. Field startSymbolId in the message header and the fields rb, symInc, and numSymbol in the section description shall not be used for identification of symbols and PRBs referred by the section description.
2. O-DU may set symInc and numSymbol to any allowed value without restriction to values corresponding to symbols actually referred to by the section description; the values of these parameters may be used to affect range of symbols referred by subsequent section descriptions in the message.
3. O-DU shall set 'rb' bit to the value of zero. However, as an exception, if the O-RU supports the optional capability indicated by setting M-Plane feature flag "se6-rb-bit-supported", then the O-DU may use the "rb" bit. In this case, when the O-DU sets the "rb" bit to one, it shall also set the value of "rbgsize" to zero and the O-RU shall interpret the value of 'rb' bit as applicable to this data section.
4. O-DU shall set startSymbolId to the earliest symbol referred by any of section descriptions in the message, including, but not limited to, section descriptions with Section Extension 6. The earliest symbol referenced by a section description with Section Extension 6 is the earliest symbol selected by a set bit in the symbolMask. That means symbolMask's bit n, such that n < startSymbolId, shall be zero.

NOTE 1: Usage of Section Extension 6 does not affect the operation of user plane. The U-Plane data payload of a U-Plane message following a U-Plane data section header (see clause 8.3.2 and Table 8.3.2-1) contains a contiguous range of PRBs. By invoking the sectionId in multiple U-Plane data section headers citing different PRB ranges, either within a single message or in different messages, it is possible to handle sets of non-contiguous PRBs.

NOTE 2: Utilization of the Section Extension 6 does not put any restriction on utilization of sections with contiguous PRB utilization except for the general rules of utilization of sections e.g. in the context of one eAxC, a resource element is referenced by at most one data section description in the control plane.

In case C-Plane and U-Plane coupling via sectionId is used then control plane section descriptions with the same sectionId shall allocate same set of PRBs and symbols.

When utilizing this Section Extension together with Section Type 3 where freqOffset parameter is present, then freqOffset affects the frequency span for the specific range of PRB numbers.

The O-DU shall comply to the limits described in clause 7.8.2.1.2 assuming the number of PRB ranges in the section description with the Section Extension 6 is the number of non-contiguous PRB ranges allocated by Section Extension 6

i.e. number of sequences of 1s in rbgMask separated by at least one 0 as specified in clause 7.7.6.3. The structure of Section Extension 6 is presented in Table 7.7.6.1-1.

**Table 7.7.6.1-1: Section Format for Section Extension 6 (non-contiguous PRB allocation in time and frequency)**

|  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | **3** | **4** | | **5** | **6** | **7 (lsb)** | **# of bytes** |  |
| ef | extType = 0x06 | | | | | | | | 1 | Octet N |
| extLen = 0x02 (2 words) | | | | | | | | | 1 | N+1 |
| repetition | rbgSize [2:0] | | | | rbgMask [27:24] | | | | 1 | N+2 |
| rbgMask [23:16] | | | | | | | | | 1 | N+3 |
| rbgMask[15:8] | | | | | | | | | 1 | N+4 |
| rbgMask[7:0] | | | | | | | | | 1 | N+5 |
| priority[1:0] | | symbolMask[13:8] | | | | | | | 1 | N+6 |
| symbolMask[7:0] | | | | | | | | | 1 | N+7 |

###### rbgSize (resource block group size)

**Description:** This parameter indicates the size in number of PRBs of the resource block groups allocated by the bit mask. The size of the resource block group to be used by the application shall be taken from Table 7.7.6.2-1 below. See clause 7.7.6.3 for special handling of exceptional resource block groups. If the M-Plane feature flag "se6-rb-bit- supported" is not set, then the value of rbgsize value of zero shall be considered as "reserved" and shall not be used.

**Value range:** {000b-111b}. Table 7.7.6.2-1 presents meaning of values.

**Table 7.7.6.2-1: rbgSize**

|  |  |
| --- | --- |
| **rbgSize** | **Number of PRBs in resource block group** |
| 000b | rb bit may be valid, see requirement #3, clause 7.7.6.1 |
| 001b | 1 |
| 010b | 2 |
| 011b | 3 |
| 100b | 4 |
| 101b | 6 |
| 110b | 8 |
| 111b | 16 |

**Type:** unsigned integer.

**Field length:** 3 bits.

**Default Value:** 001b.

###### rbgMask (resource block group bit mask)

**Description:** This parameter is a bit mask where each bit indicates whether a corresponding resource block group is allocated. If rbgSize = 0 then O-RU shall ignore rbgMask and apply the section description to all PRBs selected by startPrbc, numPrbc, rb and other section extensions that may be present in the section description. Otherwise, the O-RU shall apply rbgMask as follows. If bit n in the mask is set, then the resource block group n is allocated where n can take values in range [0, lastRbgid] where:

* lastRbgid = ceiling((numPrbc + (startPrbc mod rbgSize))/ rbgSize ) - 1. The range of PRBs included in a resource block group is given as follows:
* Resource block group 0 include PRBs with id in the range [startPrbc, startPrbc + f(0) - 1].
* Resource block group n include PRBs with id in the range [startPrbc + f(0) + (n-1) ? f(n), startPrbc + f(0) + n ? f(n)-1] where 0 < n < lastRbgid.
* Resource block group n = lastRbgid include PRBs with id in the range [startPrbc + numPrbc - f(lastRbgid), startPrbc+ numPrbc -1].

Where f(n) specifies the number of PRBs included in resource block group n and is given as follows:

* f(0) = rbgSize - (startPrbc mod rbgSize)
* f(n) = rbgSize, where 0<n<lastRbgid.
* if (startPrbc + numPrbc) mod rbgsize > 0 then f(lastRbgid) = (startPrbc + numPrbc) mod rbgSize
* else f(lastRbgid) = rbgSize

Only PRBs within the range defined by startPrbc and numPrbc may be allocated i.e. [startPrbc, startPrbc + numPrbc-1]. In case numPrbc is zero the PRB range is all PRBs as defined by the eAxC and startPrbc shall be set to zero. The O-DU shall ensure that rbgMask does not have non-zero bits outside the valid range [0, lastRbgid]; if receiver detects non-zero bits outside the valid range, those shall be ignored.

The O-DU shall not use combinations of startPrbc, numPrbc and rbgSize leading to a value of lastRbgid larger than 27 (number of bits available in the rbgMask field - 1). Such combinations are invalid and if detected by the receiver the section shall be ignored.

MSB of rbgMask indicates the highest frequency resource block group.

When Section Extension 6 is used with Section Extension 13, value of f(0) for each frequency hop shall be same across each frequency hop specified using one instance of Section Extension 13. Stated another way, the number of PRBs in the first resource block group shall be the same in every hop.

**Value range:** {0000 0000 0000 0000 0000 0000 0000b - 1111 1111 1111 1111 1111 1111 1111b}.

**Type:** unsigned integer (bit mask).

**Field length:** 28 bits.

**Default Value:** 1111 1111 1111 1111 1111 1111 1111b (all resource block groups allocated).

The value of rbgSize used in the equations shall be the values in the column "Number of PRBs in resource block group" of Table 7.7.6.2-1.

EXAMPLE: Figure 7.7.6.3-1 shows an example of resource block grouping when startPrbc = 3, rbgSize = 2, and numPrbc = 14.

![](../assets/images/3114db26a801.png)

**Figure** **7.7.6.3-1: Resource block group definition example**

###### symbolMask (symbol bit mask)

**Description:** This parameter is a bit mask where each bit indicates whether the rbgMask applies to a given symbol in the slot. If bit n is set then the rbgMask shall be applied to symbol n, where n has range [0..13]. If no bits are set then the rbgMask shall not be applied to RBGs in the slot, in other words there are no RE allocations in the slot in this section description. If the symbolMask values indicate allocations beyond a slot boundary, such allocations shall be ignored (e.g. when there are fewer than 14 symbols in a slot).

LSB of symbolMask indicates symbol zero (the first symbol in a slot).

**Value range:** {00 0000 0000 0000b-11 1111 1111 1111b}.

**Type:** unsigned integer (bit mask).

**Field length:** 14 bits.

**Default Value:** 11 1111 1111 1111b (section repeated in 14 symbols).

###### priority

**Description:** This parameter is used in conjunction with C-Plane and U-Plane coupling via frequency and time with priorities (see clause 7.8.1.3). If this coupling method is not used (e.g. O-RU or O-DU do not have corresponding capability) O-DU shall send value zero. This parameter is used by O-RU to find the section description with the highest priority among section descriptions referencing the same RE that are present in one C-Plane message. O-RU shall restrict the scope of the search to one C-Plane message to avoid beamforming configuration errors that would occur if search would span multiple messages and one of them was lost. If Section Extension 6 is absent, then data section description priority is zero (this corresponds to the default priority). Within one C-Plane message a set of priority values shall be restricted to up to two priority values including value zero i.e. {0, +1} or {0, -1}.

Value -2 is reserved and shall not be used by O-DU.

**Value range:** {-1, 0, +1}.

**Type:** signed integer, 2's complement.

**Field length:** 2 bits.

**Default Value:** 0 (normal priority).

###### repetition (repetition flag)

**Description:** This parameter is used in conjunction with C-Plane and U-Plane coupling via frequency and time with priorities (optimized) described in clause 7.8.1.4. If this coupling method is used and the section description is duplicated (see requirement 3 in clause 7.8.1.3) then O-DU shall set this flag to 1. Otherwise, O-DU shall set this flag to zero. O-RU may use this flag to identify duplicated section descriptions.

**Value range:** {0b=no repetition; 1b=repeated highest priority data section in the C-Plane message}.

**Type:** binary bit.

**Field length:** 1 bit.

#### SE 7: eAxC mask

###### Overview

This Section Extension applies to Section Types 0, 1 and 3. Section Extension 7 allows a specific C-Plane message to apply to multiple eAxC\_ID values. Support for this Section Extension in any Section Type is optional and support for

this Section Extension in any Section Type does not imply support for this Section Extension in another Section Type. The exemplary use case applies to Section Type 0, wherein the intention is to allow transmission blanking (designated by Section Type 0) to be indicated for multiple eAxC\_ID values e.g. all component carriers. Table 7.7.7.1-1 shows the format of Section Extension 7.

**Table 7.7.7.1-1: Format of Section Extension 7 (eAxC mask)**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **# of bytes** |  |
| ef | extType = 0x07 | | | | | | | 1 | Octet N |
| extLen = 0x01 (1 word) | | | | | | | | 1 | N+1 |
| eAxCmask[15:8] | | | | | | | | 1 | N+2 |
| eAxCmask[7:0] | | | | | | | | 1 | N+3 |

When a C-Plane message with Section Extension 7 is received by an O-RU supporting Section Extension 7, the O-RU shall interpret it as if multiple C-Plane messages were received with all of the eAxC\_ID values permitted by the mask. O-RU shall ignore invalid eAxC\_ID values (that is, eAxC\_ID values not configured over M-Plane) permitted by the mask.

###### eAxCmask (eAxC Mask)

**Description:** This binary mask indicates which eAxC\_ID values the C-Plane message applies to. The C-Plane message shall be applied by O-RU to any eAxC\_ID configured over M-Plane for the same direction (UL or DL) as the C-Plane message, such that for any non-zero bit of the mask the corresponding bits of the eAxC\_ID configured over M-Plane have same values as the corresponding bits of eAxC\_ID in the C-Plane message. In other words, the O-RU shall apply the C-Plane message to configured eAxC\_ID values matching the eAxC\_ID value in the C-Plane message header with the matching operation checking only bits where the mask bits are non-zero.

NOTE 1: An all-zero eAxCmask means "use this message for all eAxC\_ID values" while an all-ones eAxCmask means "use this message for only the designated eAxC\_ID value". In the former case ("use this message for all eAxC\_ID values"), the actual eAxC\_ID value in the C-Plane message header could be any value because the message would apply to all eAxC\_ID values regardless of the actual value in the C-Plane message. In the latter case ("use this message for only the designated eAxC\_ID value") this Section Extension adds no value because that is the normal operation.

NOTE 2: The intended use of the mask is to indicate which sub-field of the eAxC\_ID the message applies to. For example, if a single sector single band of the O-RU will be blanked (designated by Section Type 0) for all component carriers, the RU-Port-ID and CC-ID sub-field portions of the eAxCmask would be all zeros ("use this message for all layers/spatial streams and all component carriers") while the other subfield portions of the eAxCmask would be all ones ("use this message for the specific band, sector, and DU\_Port\_ID values provided in the eAxC\_ID"). In this way a Section Type 0 message could indicate the blanking of all component-carriers in a band-sector in a single C-Plane message.

**Value range:** {0000 0000 0000 0000b-1111 1111 1111 1111b}.

**Type:** unsigned integer (bit mask).

**Field length:** 16 bits.

**Default Value:** 1111 1111 1111 1111b (all bits of eAxC\_ID are considered).

###### Interaction with other Section Extensions

Interaction of Section Extension 7 with other Section Extensions is defined in Table 7.7.7.3-1.

**Table 7.7.7.3-1: Section Extension 7 interactions with other Section Extensions**

|  |  |  |
| --- | --- | --- |
| **Section Extension** | **Title** | **Interaction of Section Extension 7 with other Section Extensions** |
| 1 | Beamforming weights | Section Extension 1 can be used with Section Extension 7 only if beamId from section description and the beamforming weights transferred using Section Extension 1 are the same for all spatial streams or data layers (eAxCs) having valid  eAxC\_ID values permitted by Section Extension 7 mask. Otherwise, Section Extension 1 cannot be used with Section Extension 7. |
| 2 | Beamforming attributes | Section Extension 2 can be used with Section Extension 7 only if beamId from section description and the beamforming attribute transferred using Section Extension 2 is same for all spatial streams or data layers (eAxCs) having valid  eAxC\_ID values permitted by Section Extension 7 mask. Otherwise, Section Extension 2 cannot be used with Section Extension 7. |
| 3 | DL precoding parameters | Section Extension 3 shall not be used with the Section Extension 7. |
| 4 | Modulation compression parameters | Section Extension 4 can be used with Section Extension 7 only if the parameters values provided within Section Extension 4 are applicable to all spatial streams or data layers (eAxC) having eAxC\_ID value permitted by SE 7 mask.  Otherwise, Section Extension 4 cannot be used with Section Extension 7. |
| 5 | Modulation compression  additional parameters | Section Extension 5 can be used with Section Extension 7 only if the parameters values provided within Section Extension 5 are applicable to all spatial streams or data layers (eAxC) having eAxC\_ID value permitted by SE 7 mask.  Otherwise, Section Extension 5 cannot be used with Section Extension 7. |
| 6 | Non-contiguous PRB allocation in time and frequency  domain | Section Extension 6 can be used with Section Extension 7 only if the non- contiguous PRB allocation is identical both in time and frequency for all spatial streams or data layers (eAxC) having eAxC\_ID value permitted by SE 7 mask.  Otherwise, Section Extension 6 cannot be used with Section Extension 7. |
| 8 | Regularization factor | Section Extension 8 can be used with Section Extension 7 only if the regularization parameter transferred using Section Extension 8 is the same for all spatial streams  or data layers (eAxCs) having valid eAxC\_ID values permitted by Section Extension 7 mask. Otherwise, Section Extension 8 cannot be used with Section Extension 7. |
| 9 | Dynamic Spectrum Sharing parameters | Section Extension 9 can be used with Section Extension 7 only if all spatial streams or data layers (eAxCs) having valid eAxC\_ID values permitted by Section Extension 7 mask are used for the same technology. Otherwise, Section Extension 9 cannot be used with Section Extension 7. |
| 10 | Group configuration of  multiple ports | Section Extension 10 cannot be used with Section Extension 7. See also clause 7.7.10.4. |
| 11 | Flexible beamforming weights | Section Extension 11 conveying beamforming weights can be used with Section Extension 7 only if beamIds and the beamforming weights transferred using Section Extension 11 are same for all spatial streams or data layers (eAxCs) having valid eAxC\_ID values permitted by Section Extension 7 mask. In general, the beamforming weight vectors will be different per data layer (eAxC\_ID) and Section Extension 11 cannot be used in conjunction.  Section Extension 11 not conveying beamforming weights can be used with Section Extension 7 only if beamIds indicated by Section Extension 11 are same for all spatial streams or data layers (eAxCs) having valid eAxC\_ID values permitted by Section Extension 7 mask. In general, beamIds will be different per data layer  (eAxC\_ID) and Section Extension 11 cannot be used in conjunction. |
| 12 | Non-contiguous PRB allocation with frequency  ranges | Section Extension 12 can be used with Section Extension 7 only if the non- contiguous PRB allocation is identical both in time and frequency for all spatial streams or data layers (eAxC) having eAxC\_ID value permitted by SE 7 mask.  Otherwise, Section Extension 12 cannot be used with Section Extension 7. |
| 13 | PRB allocation with frequency hopping | Section Extension 13 can be used with Section Extension 7 only if the PRB allocation with intra-slot frequency hopping is identical both in time and frequency for all spatial streams or data layers (eAxCs) having valid eAxC\_ID values permitted by Section Extension 7 mask. Otherwise, Section Extension 13 cannot be  used with Section Extension 7. |

|  |  |  |
| --- | --- | --- |
| 14 | Nulling layer information for  ueId based beamforming | Use of Section Extension 7 with Section Extension 14 is not specified. |
| 15 | Mixed numerology information for ueId based  beamforming | Use of Section Extension 7 with Section Extension 15 is not specified. |
| 16 | Antenna mapping in UE channel  information based UL beamforming | Use of Section Extension 7 with Section Extension 16 is not specified. |
| 17 | Indication of user port group | Section Extension 17 cannot be used with Section Extension 7 because Section Extension 17 applies to Section Extension 10 (see in clause 7.7.17.1) which cannot be used with Section Extension 7. |
| 18 | Uplink transmission  management | This interaction is described in clause 7.7.18.5. |
| 19 | Compact beamforming  information for multiple port | This interaction is described in clause 7.7.19.14. |
| 20 | Puncturing extension | This interaction is described in clause 7.7.20.11. |
| 21 | Variable PRB group size for channel information | Use of Section Extension 7 with Section Extension 21 is not specified. |
| 22 | ACK/NACK  request | Section Extension 22 can be used with Section Extension 7. In this case, O-DU and O-RU shall perform only one ACK/NACK procedure instance (see clause 7.2.8) for single section which has conjunction of Section Extension 22 and Section Extension 7 and this procedure applies to all spatial streams or data layers (eAxC) having valid eAxC\_ID values permitted by Section Extension 7 mask. Otherwise,  Section Extension 22 cannot be used with Section Extension 7. |
| 23 | Arbitrary symbol pattern modulation compression  parameters | Section Extension 23 can be used with Section Extension 7 only if the parameter values provided within Section Extension 23 are applicable for each spatial stream or data layer (eAxC) having eAxC\_ID value permitted by SE 7 mask.  Otherwise, Section Extension 23 cannot be used with Section Extension 7. |
| 24 | PUSCH DMRS  configuration | This interaction is described in clause 7.7.24.2. |
| 25 | Symbol reordering for DMRS-BF | Use of Section Extension 7 with Section Extension 25 is not specified. |
| 26 | Frequency offset feedback | Use of Section Extension 7 with Section Extension 26 is not specified. |
| 27 | O-DU controlled dimensionality reduction | Use of Section Extension 7 with Section Extension 27 is not specified. |

#### SE 8: Regularization factor

###### Overview

This Section Extension is used for conveying value of regularization factor used for generating multi-user beamforming weight for the scheduled UEs in a slot. Regularization factor is the noise variance used for MMSE (Minimum Mean Square Error) computation of multi-user beamforming weights. The intended use case applies to Section Type 5 for sending regularization factor instead of sending regularization factor over Section Type 6.

Support of this Section Extension is mandatory for O-RUs supporting Section Type 5 in the present document. If an O- RU reports a capability excluding support of this Section Extension (O-RUs supporting previous version of the present document or O-RUs not supporting Section Type 5), then the O-DU shall not employ it, and if the O-RU reports a capability including support of this Section Extension then O-DU supporting the present document shall employ this Section Extension instead Section Type 6 to convey regularization factor.

See Annex J for further description of the regularization factor's use in uplink and downlink. The format of this Section Extension shall follow Table 7.7.8.1-1.

**T****able 7.7.8.1-1: Format of Section Extension 8 (Regularization factor)**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0(msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7(lsb)** | **# of bytes** |  |
| ef | extType = 0x08 | | | | | | | 1 | Octet N |
| extLen = 0x01 (1 word) | | | | | | | | 1 | N+1 |
| regularizationFactor[15:8] | | | | | | | | 1 | N+2 |
| regularizationFactor[7:0] | | | | | | | | 1 | N+3 |

###### regularizationFactor (regularization factor)

**Description:** This parameter provides a regularization factor to support MMSE operation when UE is scheduled, and applied to Section Type 5.

**Value range:** {0000 0000 0000 0000b - 1111 1111 1111 1111b}.

**Type:** unsigned integer.

**Field length:** 16 bits.

#### SE 9: Dynamic Spectrum Sharing parameters

###### Introduction

This Section Extension applies to all Section Types.

Table 7.7.9.1-1 shows the format of this Section Extension.

**Table 7.7.9.1-1: Format for Section Extension 9 (DSS parameter)**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **# of bytes** |  |
| ef | extType = 0x09 | | | | | | | 1 | Octet N |
| extLen = 0x01 (1 word) | | | | | | | | 1 | N+1 |
| technology[7:0] | | | | | | | | 1 | N+2 |
| reserved | | | | | | | | 1 | N+3 |

This Section Extension is used for Dynamic Spectrum Sharing (DSS) operation and to inform the O-RU of the information (LTE or NR) transmitted to the eCPRI interface. O-RU shall use technology field in SE 9 to interpret whether the section description in the C-Plane message received applies for LTE or NR. O-RU shall consider that the C-Plane message received is for NR, if Section Extension 9 is not present in the C-Plane message for a carrier configured as DSS via the M-Plane. If Section Extension 9 is received in a C-Plane message for a carrier configured as LTE or NR (not DSS), the O-RU shall ignore the Section Extension 9 and may log the error. More details for DSS support can be found in clause 7.2.6.

###### technology (interface name)

**Description:** This parameter indicates if the data transmitted through eCPRI interface is LTE or NR in real time. In this way, O-RU knows the data format transmitted from O-DU and can decode the associated user data.

**Value range:** {0000 0000b-1111 1111b}:

* 0000 0000b: LTE (i.e. the C-Plane section applies to LTE).
* 0000 0001b: NR (i.e. the C-Plane section applies to NR).
* 0000 0010b - 1111 1111b: reserved.

**Type:** unsigned integer.

**Field length:** 8 bits.

**Default Value:** 0000 0000b (LTE).

#### SE 10: Group configuration of multiple ports

###### Overview

This Section Extension applies to Section Types 1, 3 and 5. In most cases, C-Plane section information for the multiple ports (i.e. layers or Tx/Rx paths) can be the same except beam IDs or UE IDs. When multiple ports share common section information within an O-RU, the C-Plane sections to be sent via corresponding ports are merged into one C- Plane section via a representative port using this Section Extension. The formatting of this Section Extension is determined by the value of beamGroupType parameter.

For beamGroupType = 00b, all ports use the same beamId and Section Extension 10 shall follow formatting in Table 7.7.10.1-1.

For beamGroupType = 01b, the ports use consecutive 'numPortc' beamIds, starting with the beamId in the section header and Section Extension 10 shall follow formatting in Table 7.7.10.1-1.

For beamGroupType '10b' and '11b', the M-Plane configured port-list shall be used (refer to clause 3.1 for port-list definition). M-Plane configures representative port by grouping the ports to be merged to represent them.

For beamGroupType = 10b, the 2nd port (for example, 2nd port beamId or ueId as given in Table 7.7.10.1-2) refers to the first member in the list of **member-tx-eaxc-id** or **member-rx-eaxc-id** specified in M-Plane, which also refers to the 2nd port entry in the port-list. The 1st port entry in the port-list refers to the **representative-tx-eaxc-id** or **representative-rx- eaxc-id** which is the eAxC\_ID in the transport header of the message carrying this Section Extension, and the beamId or ueId associated with the **representative-tx-eaxc-id** or **representative-rx-eaxc-id** is the beamId or ueId contained in the section header of the data section carrying this Section Extension. For beamGroupType = 10b Section Extension 10 shall follow formatting in Table 7.7.10.1-2.

For beamGroupType = 10b, if the O-RU reports the capability of 'non-scheduled-ueId-supported' = TRUE for an endpoint, and the O-DU configures 'non-scheduled-ueId-enabled' = TRUE, and Section Extention 10 with beamGroupType = 10b is applied to Section Type 5, the O-RU shall have the below interpretation for the following two cases:

* If the O-DU sets the ueId in the section header in ST 5 to 0x7FFF, the O-RU shall interpret that the PRBs in the section description are not scheduled for the representative eAxC\_ID (i.e. the eAxC\_ID in the transport header).
* If the O-DU sets ueId of a port in Section Extention 10 to 0x7FFF, the O-RU shall interpret that the PRBs in the section description are not scheduled for this port (refer to clause 7.9.13 for more details).

For beamGroupType = 11b, the parameter portListIndex shall be associated with each scheduled ueId or beamId in the section description in Section Type 1, 3, or 5 and accompanying Section Extension 10. When Section Type 5 is used with Section Extension 10, the portListIndex enables O-DU to associate scheduled UEs described in Section Type 5 and Section Extension 10 to any eAxC\_ID value in the M-Plane configured port-list. For beamGroupType 11b, SE 10 shall follow formatting in Table 7.7.10.1-3.

NOTE 1: In addition to beamGroupType = 10b, beamGroupType = 11b can also be used for specifying all UEs belonging to the same user group (refer to clause 3.1 for definition of the term user group and to clause 12.6.1.3.1 for details of how this can be used for DMRS-BF).

Unlike beamGroupType = 00b, 01b and 10b, support for beamGroupType=11b is explicitly advertised by the O-RU using the Boolean flag se-10-bgt-11b-supported. If an O-RU endpoint supports Section Extension 10 and supports beamforming method DMRS-BF then it shall support beamGroupType=10b and beamGroupType=11b.

If the O-RU and the O-DU support DMRS-BF, the O-RU and the O-DU shall support the feature **SE10-MEMBER- CANDIDATE-LIST**. The O-RU and the O-DU handling of the feature is described below:

1. For each endpoint supporting SE 10 (i.e. endpoint that can be used as a representative eAxC\_ID for SE 10), the O-RU shall report a pointer to a potentially shared list of endpoints (see M-Plane parameter **se10-member- candidate-list)** whose eAxC\_IDs (when configured by the O-DU) can be used as member entries in the O-DU configured **member-[tx/rx]-eaxc-id** list for that endpoint.
2. The list referenced by **se10-member-candidate-list** may contain endpoints that can be used as representative eAxC\_IDs for SE 10. The O-DU shall exclude the representative eAxC\_ID when populating a member-[tx/rx]- eaxc-id list associated with the representative eAxC\_ID.
3. If the O-DU and/or O-RU do not support the feature SE10-MEMBER-CANDIDATE-LIST (which implies the O-DU and/or O-RU do not support DMRS-BF), then the member-[tx/rx]-eaxc-id list shall include only eAxC\_IDs associated with endpoints supporting SE 10.

**Table** **7.7.10.1-1: Section Extension 10 for beamGroupType = 00b or 01b**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **# of bytes** |  |
| ef | extType = 0x0A | | | | | | | 1 | Octet N |
| extLen = 0x01 (1 word) | | | | | | | | 1 | N+1 |
| beamGroupType | | numPortc | | | | | | 1 | N+2 |
| reserved | | | | | | | | 1 | N+3 |

**Table** **7.7.10.1-2: Section Extension 10 for beamGroupType = 10b**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **# of bytes** |  |
| ef | extType = 0x0A | | | | | | | 1 | Octet N |
| extLen | | | | | | | | 1 | N+1 |
| beamGroupType = 10b | | numPortc | | | | | | 1 | N+2 |
| reserved | 2nd port beamId[14:8] (or ueId[14:8]) | | | | | | | 1 | N+3 |
| 2nd port beamId[7:0] (or ueId[7:0]) | | | | | | | | 1 | N+4 |
| reserved | 3rd port beamId[14:8] (or ueId[14:8]) | | | | | | | 1 | N+5 |
| 3rd port beamId[7:0] (or ueId[7:0]) | | | | | | | | 1 | N+6 |
| reserved | ... | | | | | | | 1 | var |
| ... | | | | | | | | 1 | var |
| reserved | (numPortc+1)th port beamId[14:8] (or ueId[14:8]) | | | | | | | 1 | var |
| (numPortc+1)th port beamId[7:0] (or ueId[7:0]) | | | | | | | | 1 | var |
| filler to ensure 4-byte boundary | | | | | | | | var | var |

**Table 7.7.10.1-3: Section Extension 10 for beamGroupType = 11b**

|  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **# of bytes** |  |
| ef | | extType = 0x0A | | | | | | | 1 | Octet N |
| extLen | | | | | | | | | 1 | N+1 |
| beamGroupType =11b | | | numPortc | | | | | | 1 | N+2 |
| 1st portListIndex | | | | | | | | | 1 | N+3 |
| reserved | 2nd port beamId[14:8] (or ueId[14:8]) referred to by 2nd portListIndex | | | | | | | | 1 | N+4 |
| 2nd port beamId[7:0] (or ueId[7:0]) referred to by 2nd portListIndex | | | | | | | | | 1 | N+5 |
| 2nd portListIndex | | | | | | | | | 1 | N+6 |
| .... | | | | | | | | | 1 | var |
| .... | | | | | | | | | 1 | var |
| reserved | (numPortc)th beamId[14:8] (or ueId[14:8]) referred to by (numPortc)th portListIndex | | | | | | | | 1 | var |
| (numPortc)th beamId[7:0] (or ueId[7:0]) referred to by (numPortc)th portListIndex | | | | | | | | | 1 | var |
| (numPortc)th portListIndex | | | | | | | | | 1 | var |
| filler to ensure 4-byte boundary | | | | | | | | | var | var |

###### beamGroupType

**Description:** This parameter indicates the type of beam grouping.

**Value range:** {00b - 11b}.

* **00b** (common beam): the beamId in the section header is used as a common beamId for all the 'numPortc' ports which are grouped by M-Plane. This beamGroupType is not used for Section Type 5, and extLen = 0x01.
* **01b** (beam matrix indication): the consecutive 'numPortc' beamIds subsequent to the beamId in the section header apply to the 'numPortc' ports. This beamGroupType is not used for Section Type 5, and extLen = 0x01.
* **10b** (beam vector listing): the beamIds or ueIds listed in the Section Extension apply to the 'numPortc' ports. The Section Extension shall include 'numPortc' beamIds or ueIds.
* **11b** (beamId/ueId listing with associated port-list index): beamGroupType using the portListIndex parameter for specifying participating ports from M-Plane configured port-list and associated ueId /beamId. The Section Extension shall include the parameters numPortc, portListIndex and ueIds or beamIds.

**Type:** unsigned integer.

**Field length: 2** bits.

**Default Value:** 00b (common beam).

###### numPortc

**Description:** This parameter indicates the number of eAxC ports indicated by the Section Extension. It can cover up to 64 ports. For beamGroupType = 10b, the value of this parameter is the number of beamId/ ueId values in the Section Extension and need not be equal to the size of member-[tr]x-eaxc-id list. For beamGroupType = 11b, the value of this parameter is the number of portListIndex values in the Section Extension.

**Value range:** {000000b - 111111b}. 00 0000b expresses 64 ports.

**Type:** unsigned integer.

**Field length:** 6 bits.

**Default Value:** 000000b.

###### a portListIndex

**Description:** This parameter is used for beamGroupType = 11b. This parameter indicates the index of an eAxC\_ID in the port-list containing the eAxC\_ID values, which enables selecting eAxC\_ID values from the eAxC\_ID values present in the port-list.

**Value range:** {0000 0001b - 1111 1111b, 0000 0000b = Reserved}.

Values {0000 0001b to 1111 1111b} are used to indicate an entry in the port-list for the ueId or beamId in the section description and for each ueId in Section Extension 10.

**Type:** unsigned integer.

**Field length:** 8 bits.

**Default Value:** 0000 0000b.

###### Interaction with other Section Extensions

Section Extension 10 can be used in all situations when same information is present in section headers and in Section Extension headers across multiple eAxC\_IDs. Interaction of Section Extension 10 with other Section Extensions is defined in Table 7.7.10.4-1.

**Table** **7.7.10.4-1: Section Extension 10 interactions with other Section Extensions**

|  |  |  |
| --- | --- | --- |
| **Section Extension** | **Title** | **Interaction with other Section Extensions** |
| 1 | Beamforming Weights | Section Extension 1 can be used with Section Extension 10 only if the beamforming weights transferred using Section Extension 1 are the same for all streams (or layers). In general, the beamforming weight vector will be different per data layer (eAxC\_ID) and Section Extension 10 cannot be used in conjunction. Once the beamforming weights are downloaded, then if the O-DU uses same beamforming vector by addressing beamId for a number of slots after the beamforming weight is downloaded, then in that case, O-DU can use Section Extension 10 to combine  multiple C-Plane messages to one single C-Plane message using the representative eAxC\_ID. |
| 2 | Beamforming Attributes | Section Extension 2 can be used with Section Extension 10 only if the beamforming attribute transferred using Section Extension 2 is same for all streams (or layers), otherwise, Section Extension 2 cannot be used with Section Extension 10. If O-DU uses beam attributes downloaded using Section Extension 2 later using beamId, then Section Extension 10 can be used to combine multiple C-Plane messages to  one C-Plane message. |
| 3 | DL Precoding | This Section Extension has different format for different layers (first layer has one set of parameters and rest of the layers have different set of parameters). So  Section Extension 3 cannot be used with the Section Extension 10. |
| 4 | Modulation Compression | Section Extension 4 can be used with Section Extension 10 (see clause 7.9.10). |
| 5 | Modulation Compression  Additional Parameters | Section Extension 5 can be used with Section Extension 10 (see clause 7.9.10). |
| 6 | Non-contiguous PRB | Section Extension 6 can be used with the Section Extension 10, if the section information of non-contiguous PRB allocation has same pattern for each spatial stream or data layer (eAxC). |
| 7 | eAxC Mask | Section Extension 7 cannot be used with Section Extension 10 because the use of Section Extension 10 includes the functionality of Section Extension 7. |
| 8 | Regularization Factor | Section Extension 8 can be used with Section Extension 10 only if the regularization parameter transferred using Section Extension 8 is the same for all streams (or layers), otherwise Section Extension 8 cannot be used with Section  Extension 10 |
| 9 | DSS Parameters | Section Extension 9 can be used with Section Extension 10 because all the spatial  streams or data layers (eAxCs) grouped by Section Extension 10 are used for the same technology. |
| 11 | Flexible Beamforming Weights | Section Extension 11 can be used with Section Extension 10 only if the beamforming weights transferred using Section Extension 11 are same for all streams (or layers). In general, the beamforming weight vector will be different per data layer (eAxC\_ID) and Section Extension 11 cannot be used in conjunction.  Once the beamforming weights are downloaded, then if the O-DU uses same beamforming vector by addressing beamId for a number of slots after the beamforming weights are downloaded, then in that case, the O-DU can use Section Extension 11 to combine multiple C-Plane messages to one single C-Plane  message using the representative eAxC\_ID. |
| 12 | Non-contiguous PRB allocation  with frequency ranges | Section Extension 12 can be used with Section Extension 10 only if the non- contiguous PRB allocation is identical both in time and frequency for all ueIds or beamIds referenced by Section Extension 10 |
| 13 | PRB allocation with frequency hopping | Section Extension 13 can be used with Section Extension 10 only if the PRB allocation with intra-slot frequency hopping is identical both in time and frequency for all ueIds or beamIds referenced by Section Extension 10 |
| 14 | Null-layer Info | Section Extension 14 can be used with Section Extension 10. In this case, extLen in the Section Extension 14 shall be set based on total number of nullLayerInd fields, i.e. equal to the total number of ueIds conveyed using section description  and Section Extension 10 (see Table 7.7.14.1-2). |

#### SE 11: Flexible beamforming weights

###### Overview

This section applies to the flexible sending of beamforming weights from the O-DU to the O-RU. This enables the O-DU to provide different beamforming weights for different PRBs within one section to facilitate, e.g. zero-forcing precoding. The O-DU provides the numBundPrb parameter, which informs the O-RU how many PRBs are bundled

together and share the same beamforming weights. The optional "little endian byte order" is applied to bfwI/bfwQ fields if chosen via M-Plane. Refer to Annex D.2 for details of little endian byte order. This Section Extension applies only to Section Types 1 and 3. Section Extension 11 shall follow formatting defined in Table 7.7.11.1-1 when disableBFW = 0 and Table 7.7.11.1-2 when disableBFWs = 1.

**T****able 7.7.11.1-1: Section Extension 11 Data Format (when disableBFWs = 0)**

|  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | | **3** | **4** | **5** | **6** | **7 (lsb)** | **# of bytes** |  |
| ef | extType = 0x0B | | | | | | | | 1 | Octet N |
| extLen[15:0] | | | | | | | | | 2 | Octet N+1 |
| disableBFWs | RAD | | bundleOffset [5:0] | | | | | | 1 | Octet N+3 |
| numBundPrb[7:0] | | | | | | | | | 1 | Octet N+4 |
| bfwCompHdr[7:0] | | | | | | | | | 1 | Octet N+5 |
| bfwCompParam (for PRB bundle 0) | | | | | | | | | var |  |
| contInd | beamId[14:8] (for PRB bundle 0) | | | | | | | | 1 |  |
| beamId[7:0] (for PRB bundle 0) | | | | | | | | | 1 |  |
| bfwI (for TRX 0 and PRB bundle 0) | | | | | | | | | var |  |
| bfwQ (for TRX0 and PRB bundle 0) | | | | | | | | | var |  |
| remaining beamforming weights bfwI and bfwQ up to L TRXs and PRB bundle 0 | | | | | | | | | var |  |
| bfwCompParam (for PRB bundle 1) | | | | | | | | | var |  |
| contInd | beamId[14:8] (for PRB bundle 1) | | | | | | | | 1 |  |
| beamId[7:0] (for PRB bundle 1) | | | | | | | | | 1 |  |
| bfwI (for TRX 0 and PRB bundle 1) | | | | | | | | | var |  |
| bfwQ (for TRX0 and PRB bundle 1) | | | | | | | | | var |  |
| remaining beamforming weights bfwI and bfwQ up to L TRXs and PRB bundle 1 | | | | | | | | | var |  |
| ... | | | | | | | | |  |  |
| bfwCompParam (for last PRB bundle) | | | | | | | | | var |  |
| contInd | beamId[14:8] (for last PRB bundle) | | | | | | | | 1 |  |
| beamId[7:0] (for last PRB bundle) | | | | | | | | | 1 |  |
| bfwI (for TRX 0 and last PRB bundle) | | | | | | | | | var |  |
| bfwQ (for TRX0 and last PRB bundle) | | | | | | | | | var |  |
| remaining beamforming weights bfwI and bfwQ up to L TRXs and last PRB bundle | | | | | | | | | var |  |
| zero pad to 4-byte boundary | | | | | | | | | var |  |

**T****able 7.7.11.1-2: Section Extension 11 Data Format (when disableBFWs = 1)**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **# of bytes** |  |
| ef | extType = 0x0B | | | | | | | 1 | Octet N |
| extLen[15:0] | | | | | | | | 2 | Octet N+1 |
| disableBFWs | RAD | bundleOffset[5:0] | | | | | | 1 | Octet N+3 |
| numBundPrb[7:0] | | | | | | | | 1 | Octet N+4 |
| contInd | beamId[14:8] (for PRB bundle 0) | | | | | | | 1 |  |
| beamId[7:0] (for PRB bundle 0) | | | | | | | | 1 |  |
| contInd | beamId[14:8] (for PRB bundle 1) | | | | | | | 1 |  |
| beamId[7:0] (for PRB bundle 1) | | | | | | | | 1 |  |
| ... | | | | | | | |  |  |
| contInd | beamId[14:8] (for last PRB bundle) | | | | | | | 1 |  |
| beamId[7:0] (for last PRB bundle) | | | | | | | | 1 |  |
| zero pad to 4-byte boundary | | | | | | | | var |  |

###### bfwCompHdr (beamforming weight compression header)

**Description:** refer to clause 7.7.1.2

This parameter defines the compression method and IQ bit width for the beamforming weights in the specific section in the C-Plane message. For the block compression methods, the block size is the vector of beamforming weights for a specific PRB bundle.

###### bfwCompParam for PRB bundle x (beamforming weight compression parameter)

**Description:** refer to clause 7.7.1.3

This parameter applies to the following vector of beamforming weights for a specific PRB bundle (i.e. bundle x).

###### numBundPrb (Number of bundled PRBs per beamforming weights)

**Description**: This parameter is the number of bundled PRBs per beamforming weight sets. The number of beamforming weight sets per TRX in Section Extension 11 should be equal to the total number of PRBs selected by section description in the C-Plane message (using startPrbc and numPrbc and other parameters present in other Section Extensions present in the section description) divided by numBundPrb. When the division outcome is fractional value, one additional beamforming weight for each respective TRX is included to cover the orphan PRBs (as defined in clause 7.9.4.2).

**Value range**: {all zeros - all ones}. The value zero is reserved.

**Type**: unsigned integer.

**Field length**: 8 bits.

###### bfwI (beamforming weight in-phase value)

**Description**: This parameter is the in-phase beamforming weight value. When optional "little endian byte order" is chosen via M-Plane, refer to Annex D.2 for details on byte order. The total number of weights in the section depends on the number TRX at the O-RU and the number of bundled PRBs per beamforming weight.

**Value range**: {all zeros - all ones}.

**Type:** signed integer.

**Field length:** 1-16 bits.

###### bfwQ (beamforming weight quadrature value)

**Description**: This parameter is the quadrature beamforming weight value. When optional "little endian byte order" is chosen via M-Plane, refer to Annex D.2 for detail on byte order. The total number of weights in the section depends on the number TRX at the O-RU and the number of bundled PRBs per beamforming weight

**Value range**: {all zeros - all ones}.

**Type**: signed integer.

**Field length**: 1 - 16 bits.

###### disableBFWs (disable beamforming weights)

**Description**: This parameter is used to indicate whether beamforming weights under Section Extension are disabled or not. The default is that the beamforming weights exist since this is the main objective of the Section Extension.

However, these can be disabled by setting this parameter to convey only the beamIds. In this case, all bfwI, bfwQ, and bfwCompParam fields as well as the bfwCompHdr field are not included in the Section Extension and the formatting of Section Extension 11 shall follow Table 7.7.11.1-2.

**Value range**: {0b=beamforming weights included in Section Extension; 1b= beamforming weights excluded}.

**Type:** binary bit.

**Field length:** 1 bit.

**Default Value:** 0b (beamforming weights included in Section Extension).

###### RAD (Reset after PRB discontinuity)

**Description:** This parameter is used when Section Extension 11 is used in conjunction with Section Extension allowing non-contiguous frequency allocation (Section Extensions 6, 12 and 13). When the section parameters refer to a continuous set of PRBs, the default value should be used, which is RAD = 1. When Section Extension allowing non- contiguous frequency allocation is used with Section Extension 11, this parameter indicates whether the PRB bundle boundary is reset after discontinuity in the PRB allocation (RAD = 1), or the PRB bundle boundaries are mapped to the PRBs regardless of the discontinuity (see examples in clause 7.9.4.2). When this extension is used with Section Extension 13 the discontinuity shall be interpreted as discontinuity in set of frequency ranges from all hops combined over time (see examples in clause 7.9.4.4).

**Value range:** {0b = No reset; 1b = reset).

**Type:** binary bit.

**Field length:** 1 bit.

**Default Value:** 1b (Reset after PRB discontinuity).

###### contInd (PRB region continuity flag)

**Description:** If the O-RU indicates support for this flag by M-Plane parameter se11-continuity-flag-supported and O- DU enables this function by setting M-Plane parameter se11-continuity-flag-enabled to TRUE then O-DU shall set the value of this flag to indicate the PRB region continuity between the current and next PRB bundle for the following cases:

* Current and next PRB bundles belong to the same "user group" and hence belong to a continuous PRB region.
* Current and next PRB bundle belong to the same PRG allocated for a given UE and belong to a continuous PRB region.

The O-RU advertises its capability to support the handling of this flag by setting the M-Plane Boolean flag 'se11- continuity-flag-supported' to 'TRUE'. The O-DU shall indicate it will send continuity information by setting the M- Plane per endpoint flag 'se11-continuity-bit-enabled' to TRUE. If the O-DU does not support the flag 'se11-continuity- bit-enabled' or if the O-DU supports the M-Plane flag and sets 'se11-continuity-flag-enabled' = FALSE, then the O-DU shall set the contInd flag to value 0 (reserved). In this case, no information regarding PRB region continuity is sent to the O-RU and the O-RU shall process the PRB bundles as it would have in the absence of the contInd flag. This behaviour shall be same as setting the field to reserved value (0b).

When Section Extension 11 is used in conjunction with Section Extension allowing non-contiguous frequency allocation (Section Extensions 6, 12 and 13), the O-DU may set the value of this flag to 1 in the presence of non- contiguous PRB allocation to indicate continuity across a gap described by the non-contiguous allocation.

The O-DU shall set the value of contInd flag to '0b'for the last PRB bundle.

The O-RU may use the continuity information to provide optimizations to user group processing, as an example, for beamforming weight interpolation across REs of user group boundaries.

Value range:

* 0b = PRB region discontinuity between the current and next PRB bundle is indicated;
* 1b = PRB region continuity between current and next PRB bundle is indicated.

**Type:** binary bit.

**Field length:** 1 bit.

**Default Value:** 0b

###### bundleOffset (PRB bundle offset)

**Description:** If the O-RU indicates support for this parameter by M-Plane parameter bundle-offset-in-se11-supported then O-DU shall set the value of this field to indicate the offset between the start of the first PRB bundle and the first PRB addressed by the section (startPrbc). Specifically, the start of PRB bundle is given by startPrbc - bundleOffset. A non-zero bundleOffset shall shift the position of PRB bundle boundaries but shall not affect PRBs referenced by the section description i.e. due to shift a part of the first and the last PRB bundle may be outside of the referenced PRBs.

If the O-DU does not support bundleOffset, then the O-DU handles the underlying bits in SE 11 as reserved bits and sets them to value 0. If the O-RU does not support bundleOffset, then the O-DU shall set the value of this parameter to 0.

If bundleOffset > 0 is used with a non-contiguous allocation and RAD=1 (see clause 7.7.11.8), then PRB bundle boundaries after the discontinuity are not affected by bundleOffset value.

**Value range:** {000000b - 111111b}.

**Type:** unsigned integer.

**Field length:** 6 bits.

**Default Value:** 000000b

#### SE 12: Non-contiguous PRB allocation with frequency ranges

###### Overview

Section Extension 12 applies only to Section Types 1, 3 and 5. It cannot be used with Section Extension 6 in the same section description.

Section Extension 12 enables allocation of non-contiguous sets of PRBs (Resource Block Groups, or RBGs) in time domain and frequency domain. This extension reduces the C-Plane overhead when users or channels are allocated with non-contiguous sets of PRBs in time or frequency. This extension is more space-efficient than Section Extension 6 if the allocation is continuous in frequency or extends over a frequency span wider than the range defined by rbgMask size and rbgMaskSize value. Structure of Section Extension 12 is presented in Table 7.7.12.1-1.

**Table 7.7.12.1-1: Format of Section Extension 12 (non-contiguous PRB allocation with frequency ranges)**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **# of bytes** |  |
| ef | extType[6:0] = 0x0C | | | | | | | 1 | Octet N |
| extLen (variable) | | | | | | | | 1 | N+1 |
| priority[1:0] | | symbolMask[13:8] | | | | | | 1 | N+2 |
| symbolMask[7:0] | | | | | | | | 1 | N+3 |
| offStartPrb(1) | | | | | | | | 1 | variable |
| numPrb(1) | | | | | | | | 1 | variable |
| offStartPrb(2) | | | | | | | | 1 | variable |
| numPrb(2) | | | | | | | | 1 | variable |
| ... | | | | | | | |  |  |
| offStartPrb(R-2) | | | | | | | | 1 | variable |
| numPrb(R-2) | | | | | | | | 1 | variable |
| offStartPrb(R-1) | | | | | | | | 1 | variable |
| numPrb(R-1) | | | | | | | | 1 | variable |

This extension consists of a fixed part (fields priority and symbolMask) and a variable size part (pairs of offStartPrb(r) and numPrb(r) for r = 1 ... R-1). The variable part may be empty allowing the use of priority and symbolMask without overhead.

If Section Extension 12 is present in a section description, then the section description shall be applied to symbols identified by symbolMask and one or more frequency ranges calculated from startPrbc and numPrbc from the section description and offStartPrb(r) and numPrb(r) pairs from this Section Extension.

If Section Extension 12 is present in a section description, then following requirements apply:

1. The field startSymbolId in the message header and the fields rb, symInc, and numSymbol in the section description shall not be used for identification of symbols and PRBs referred by the section description.
2. O-DU may set symInc and numSymbol to any allowed value without restriction to values corresponding to symbols actually referred by the section description; the values of these parameters may be used to affect range of symbols referred by subsequent section descriptions in the message.
3. O-DU shall set rb to the value of zero.
4. O-DU shall set startSymbolId to the earliest symbol referred by any of section descriptions in the message, including, but not limited to, section descriptions with Section Extension 12. The earliest symbol referenced by a section description with Section Extension 12 is the earliest symbol selected by a set bit in the symbolMask. That means symbolMask's bit n, such that n < startSymbolId, shall be zero.

If Section Extension 12 is present in a section description, then the section description shall be applied to one or more PRB ranges. Specifically, the section description shall be applied to R spectrum fragments identified by pairs startPrb(r) and numPrb(r) for r = 0,...,R-1 where startPrb(r) values are calculated by recurrence:

* + startPrb(0) and numPrb(0) are values of section description's parameter startPrbc and numPrbc; values of numPrb(1), numPrb(2), ... numPrb(R-1) are from the variable part of section description.
  + startPrb(r) = startPrb(r-1) + numPrb(r-1) + offStartPrb(r) for r = 1, ..., R-1

The section description applies to PRB #p if startPrb(r) <= p < startPrb(r) + numPrb(r) for any r = 0,...,R-1.

Number of frequency ranges R shall be derived from extLen: R = (extLen - 1) ? 2 + 1. Empty PRB ranges are allowed

e.g. numPrb(r) = 0 may be used to shift the following PRB range beyond limit of 8-bit offset. Similarly,

offStartPrb(r) = 0 may be used to concatenate two PRB ranges and effectively extend range width beyond the limit of 8- bit numPrb(r). If the last pair in the extension are present (due to extension size alignment to multiple of 4 bytes) but not used, then they shall have offStartPrb(R-1) = 0 and numPrb(R-1) = 0. The number of frequency ranges R per section description shall be less than or equal to the value of optional M-Plane parameter "max-prb-ranges-per-sec-ext-12" if this parameter exists. When an empty range (numPrb(r) = 0) is used for range extension the empty range shall not be counted against "max-prb-ranges-per-sec-ext-12", and when two PRB ranges are concatenated (offStartPrb(r)=0) the concatenated PRB ranges shall be counted as a single range when counted against "max-prb-ranges-per-sec-ext-12".

Additionally, number of frequency ranges R per highest priority section description shall be less than or equal to the value of another optional M-Plane parameter "max-prb-ranges-per-hp-section-sec-ext-12" if this parameter exists and this shall be applicable when C-Plane message limits apply (as specified in clause 7.8.2.2).

The O-DU shall comply to the limits described in clause 7.8.2.1.2 assuming the number of PRB ranges in the section description with the Section Extension 12 is the number of non-contiguous, non-empty (i.e. with numPrb(r) > 0) frequency ranges in the Section Extension 12. Two concatenated frequency ranges (see case with offStartPrb(r) = 0 in the preceding paragraph) shall be considered contiguous.

NOTE 1: Usage of Section Extension 12 does not affect the operation of user plane. The U-Plane data payload of a U-Plane message following a U-Plane data section header (see clause 8.3.2 and Table 8.3.2-1) contains a contiguous range of PRBs. By invoking the sectionId in multiple U-Plane data section headers citing different PRB ranges, either within a single message or in different messages, it is possible to handle sets of non-contiguous PRBs.

NOTE 2: Utilization of Section Extension 12 does not put any restriction on utilization of sections with contiguous PRB utilization except for the general rules of utilization of sections e.g. in context of one eAxC a resource element is referenced by at most one data section description in the control plane.

In case C-Plane and U-Plane coupling via sectionId is used then control plane section descriptions with the same sectionId shall allocate same set of PRBs and symbols.

When utilizing this Section Extension together with Section Type 3 where freqOffset parameter is present, then freqOffset affects the frequency span for the specific range of PRB numbers.

###### priority (priority of section description)

This parameter has same format and semantics as priority parameter in Section Extension 6 (see clause 7.7.6.5).

###### symbolMask (symbol bit mask)

This parameter has same format and semantics as symbolMask parameter in Section Extension 6 (see clause 7.7.6.4).

###### offStartPrb(r) (offset of PRB range start)

**Description:** This parameter indicates the offset to start of the r-th PRB range for r=1, ..., R-1.

**Value range:** 0 ... 255. **Type:** unsigned integer. **Field length:** 8 bits.

###### numPrb(r) (number of PRBs in PRB range)

**Description:** This parameter indicates the number of PRBs in the r-th PRB range for r=1, ..., R-1.

**Value range:** 0 ... 255. **Type:** unsigned integer. **Field length:** 8 bits.

#### SE 13: PRB allocation with frequency hopping

###### Overview

Section Extension 13 applies only to Section Types 1, 3 and 5.

Section Extension 13 allows to describe two or more PRB allocations starting at different symbols and different PRB. It is intended to be used for allocations with intra-slot frequency hopping. This Section Extension reduces the C-Plane overhead when users or channels are allocated with intra-slot frequency hopping. This extension is more space-efficient than the use of several section descriptions. Structure of Section Extension 13 is presented in Table 7.7.13.1-1.

**Table 7.7.13.1-1: Format of Section Extension 13 (PRB allocation with Frequency hopping)**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **# of bytes** |  |
| ef | extType[6:0] = 0x0D | | | | | | | 1 | Octet N |
| extLen (variable) | | | | | | | | 1 | N+1 |
| reserved[1:0] | | nextSymbolId(1)[3:0] | | | | nextStartPrbc(1)[9:8] | | 1 | N+2 |
| nextStartPrbc(1)[7:0] | | | | | | | | 1 | N+3 |
| ... | | | | | | | |  |  |
| reserved[1:0] | | nextSymbolId(R-2)[3:0] | | | | nextStartPrbc(R-2)[9:8] | | 1 | variable |
| nextStartPrbc(R-2)[7:0] | | | | | | | | 1 | variable |
| reserved[1:0] | | nextSymbolId(R-1)[3:0] | | | | nextStartPrbc(R-1)[9:8] | | 1 | variable |
| nextStartPrbc(R-1)[7:0] | | | | | | | | 1 | variable |

This extension is of variable size and conveys list of pairs nextSymbolId(n) and nextStartPrbc(n) for n = 1,...,R-1.

If this Section Extension is present in a section description, then the section description and all other Section Extensions included in it, shall be interpreted by O-RU as if startPrbc value was changed at specified symbols given in nextSymbolId(n) to values of nextStartPrbc(n) provided in the extension. The value of numPrbc from the section description applies to all frequency hops.

Specifically, the description and extensions shall be interpreted as if startPrbc value was as in nextStartPrbc(n) for symbols s, where nextSymbolId(n) <= s < nextSymbolId(n+1) for n=1 to R-1 and value of nextSymbolId(R) is a value greater by 1 than the number of the last symbol addressed by the description.

NOTE 1: nextSymbolId(R) is a guard value and does not have to identify actual symbol. If the section description includes a Section Extension that provides symbolMask parameters (Section Extension 6, 12 and 19) then nextSymbolId(R) is derived from symbolMask. Otherwise, nextSymbolId(R) is derived from startSymbolId from the message header and symInc and numSymbol parameters in the section description and in section descriptions preceding it in the message.

startPrbc from the section description shall be applied to symbols s0 <= s < nextSymbolId(1) where s0 is the first symbol addressed by the section description.

NOTE 2: s0 is determined by symbolMask if Section Extension 6, 12 or 19 is present; otherwise s0 is determined by startSymbolId from the message header and symInc and numSymbol parameters in the section description and in section descriptions preceding it in the message.

The set of symbols where startPrbc or nextStartPrbc(n) applies may be further restricted by symbolMask if Section Extension 6, 12 or 19 is also present.

Number of frequency hops R shall be derived from extLen: R = extLen ? 2. If the last pair in the extension are present (due to extension size alignment to multiple of 4 bytes) but not used, then they shall have values as in the preceding pair (e.g. if pair R-1 is not used then nextSymbolId(R-1) and nextStartPrbc(R-1) shall be set to nextSymbolId(R-2) and nextStartPrbc(R-2) respectively). The number of frequency hops R per section extension 13 shall be less than or equal to the value of optional M-Plane parameter "max-freq-hops-per-sec-ext-13" if this parameter exists.

###### nextSymbolId(n) (next hop start symbol)

**Description:** This parameter indicates the symbol at which n-th frequency hop occurs for n=1, ..., R-1. The value shall correspond to one of symbols addressed by the section description.

NOTE 1: If Section Extension 6, 12 and 19 are not present in the section description then set of symbols addressed by the description is determined by startSymbolId from the message header and symInc and numSymbol parameters in the section description and in section descriptions preceding it in the message

NOTE 2: If Section Extension 6, 12 or 19 is present in the section description then set of symbols addressed by the description is determined by symbolMask from Section Extension 6, 12 or 19.

O-DU shall ensure values are ordered in increasing order i.e. nextSymbolId(n+1) >= nextSymbolId(n).

O-DU shall set nextSymbolId(n) to value of nextSymbolId(n-1) and set nextStartPrbc(n) to value of nextStartPrbc(n-1) if pair (nextSymbolId(n), nextStartPrbc(n)) is used for padding.

**Value range:** {0000b-1111b}.

**Type:** unsigned integer.

**Field length:** 4 bits.

###### nextStartPrbc(n) (next hop startPrbc)

**Description:** This parameter indicates the value to be used instead of startPrbc for the n-th frequency hop for n=1, ..., R-1.

O-DU shall set nextSymbolId(n) to value of nextSymbolId(n-1) and set nextStartPrbc(n) to value of nextStartPrbc(n-1) if pair (nextSymbolId(n), nextStartPrbc(n)) is used for padding.

**Value range:** {00 0000 0000b-11 1111 1111b}.

**Type:** unsigned integer.

**Field length:** 10 bits.

#### SE 14: Nulling layer information for ueId based beamforming

###### Overview

This Section Extension applies to Section Type 5. This enables the O-DU to provide layer-by-layer indication, which denotes that the corresponding ueId is for nulling-layer indication.

Section Extension 14 shall follow the formatting defined in Table 7.7.14.1-1.

Section Extension 14 can be used together with Section Extension 10. In this case, SE14 has multiple nullLayerInd fields and shall follow the formatting defined in Table 7.7.14.1-2. SE 14 with more than one nullLayerInd field shall only be used when the O-RU supports both SE10 and SE14 and only when SE10 is used with the same section description.

**Table** **7.7.14.1-1: Section Extension 14 without Section Extension 10**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **# of bytes** |  |
| ef | extType = 0x0E | | | | | | | 1 | Octet N |
| extLen = 0x01 (1 word) | | | | | | | | 1 | N+1 |
| nullLayerInd | | | | | | | | 1 | N+2 |
| reserved | | | | | | | | 1 | N+3 |

O-RU generates beamforming weights considering all the ueIds, but once the beamforming weight is generated, O-RU shall set to zero weights for the layer(s) corresponding to those ueIds for which nullLayerInd is set to 0000 0001b.

**Table 7.7.14.1-2: Section Extension 14 with Section Extension 10**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **# of bytes** |  |
| ef | extType = 0x0E | | | | | | | 1 | Octet N |
| extLen = var [7:0] | | | | | | | | 1 | N+1 |
| 1st nullLayerInd (for 1st port ueId) [7:0] | | | | | | | | 1 | N+2 |
| 2nd nullLayerInd (for 2nd port ueId) [7:0] | | | | | | | | 1 | N+3 |
| ... | | | | | | | |  |  |
| (numPortc+1)th nullLayerInd (for (numPortc+1)th port ueId) [7:0] | | | | | | | | 1 |  |
| zero padding to ensure 4-byte boundary | | | | | | | | var |  |

SE10 is used to convey (numPortc + 1) ueIds with one section description and when Section Extension 14 is used together with Section Extension 10, SE 14 shall carry (numPortc+1) nullLayerInd fields, and in this case, extLen of SE14 will be greater than 0x01. When extLen is greater than 1, the total number of nullLayerInd shall be determined based on the value of (numPortc+1) from SE10.

###### nullLayerInd (null layer indication)

**Description:** This parameter indicates whether the corresponding layer is nulling-layer or not.

**Value range:** {0000 0000b - 0000 0001b}. The following mapping shall be used:

* 0000 0000b indicates the corresponding ueId is given for scheduled layer, no specific operation based on this field is performed by O-RU.
* 0000 0001b indicates the corresponding ueId is given for making beam-nulling dimension, so this layer shall be nulled. No user data is transmitted for the layer(s) corresponding to the ueId for which nullLayerInd is set to 0000 0001b, i.e. beamforming weights corresponding to the layer(s) shall be set to zero.

**Type:** unsigned integer.

**Field length:** 8 bits.

#### SE 15: Mixed numerology information for ueId based beamforming

###### Overview

This Section Extension applies to Section Types 5 and 6. When this Section Extension is applied to Section Type 6, the value of FFT type in frameStructure and cpLength can be set as 0.

Section Extension 15 shall follow the formatting defined in Table 7.7.15.1-1.

**Table** **7.7.15.1-1: Section Extension 15**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **# of bytes** |  |
| ef | extType = 0x0F | | | | | | | 1 | Octet N |
| extLen = 0x02 (2 words) | | | | | | | | 1 | N+1 |
| frameStructure | | | | | | | | 1 | N+2 |
| freqOffset | | | | | | | | 3 | N+3 |
| cpLength | | | | | | | | 2 | N+6 |

###### frameStructure (frame structure)

See clause 7.5.2.13 for the description of this parameter.

###### freqOffset (frequency offset)

See clause 7.5.3.11 for the description of this parameter.

###### cpLength (cyclic prefix length)

See clause 7.5.2.14 for the description of this parameter.

#### SE 16: Antenna mapping in UE channel information based UL beamforming

###### Overview

This Section Extension applies to Section Type 5. The Section Extension includes bitmask per RX endpoint to indicate the antennas to be pre-combined into the RX endpoint (i.e. eAxC\_ID) and shall follow formatting defined in

Table 7.7.16.1-1. This Section Extension can be used together with Section Extension 10. In this case, it has a list of the bitmasks as many the RX endpoints as used for the Section Extension 10 and shall follow formatting defined in

Table 7.7.16.1-2.

**Table** **7.7.16.1-1: Section Extension 16 without Section Extension 10**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **# of bytes** |  |
| ef | extType = 0x10 | | | | | | | 1 | Octet N |
| extLen = 0x03 (3 words) | | | | | | | | 1 | N+1 |
| antMask [63:0] | | | | | | | | 8 | N+2 |
| zero padding to ensure 4-byte boundary | | | | | | | | 2 | N+10 |

**T****able 7.7.16.1-2: Section Extension 16 with Section Extension 10**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **# of bytes** |  |
| ef | extType = 0x10 | | | | | | | 1 | Octet N |
| extLen [7:0] | | | | | | | | 1 | N+1 |
| antMask (1st RX eAxC) [63:0] | | | | | | | | 8 | N+2 |
| antMask (2nd RX eAxC) [63:0] | | | | | | | | 8 | N+10 |
| ... | | | | | | | | ... | ... |
| antMask (16th RX eAxC) [63:0] | | | | | | | | 8 | N+122 |
| zero padding to ensure 4-byte boundary | | | | | | | | 2 | N+130 |
| NOTE: For illustration purposes, this table shows an example configuration of SE 10 usage with 16 RX endpoints. | | | | | | | | | |

###### antMask

**Description:** This parameter indicates the indices of antennas to be pre-combined per RX endpoint.

**Value range:** {0x0000 0000 0000 0000 - 0xFFFF FFFF FFFF FFFF}.

Each bit indicates whether the antenna corresponding to the bit is pre-combined (bit set to 1) or not (bit set to 0). The maximum number of antennas is 64.

**Type:** unsigned integer.

**Field length:** 64 bits.

**Default Value:** 0x0000000000000000.

#### SE 17: Indication of user port group

###### Overview

This Section Extension applies to Section Extension 10 for beamGroupType=10b within Section Type 5 and cannot be used in standalone manner. This Section Extension provides the number ueIds of the users scheduled in preceding Section Type and Section Extension messages. A user may have more than one ueIds (i.e. more than one channel information, for example if the UE supports Transmit Antenna Switching feature for SRS transmission; by which O-DU can obtain different channel information corresponding to each of the transmit antennas). When this Section Extension is used, two restrictions shall apply: first, ueIds of each user are consecutive by exploiting the three reserved bits of ueId[2:0]. This means that the maximum number of ueIds per user that can be supported is 8. Second, in Section Extension 10, ueIds whose three reserved bits are all zero are configured repeatedly as many times as the number of layers scheduled for the corresponding user. Therefore, the preceding Section Type and extension messages implicitly provide the number of scheduled users(i.e. number of different ueIds) and number of layers of each user (i.e. number of same ueIds). Finally, the number of ueIds associated with each user is provided in this Section Extension.

Section Extension 17 shall follow the formatting defined in Table.7.7.17.1-1.

**Table** **7.7.17.1-1: Section Extension 17**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **# of bytes** |  |
| ef | extType = 0x11 | | | | | | | 1 | Octet N |
| extLen | | | | | | | | 1 | N+1 |
| numUeID of 1st user | | | | numUeID of 2nd user | | | | var | N+2 |
| ... | | | | | | | |  |  |
| .. | | | | numUeID of last user | | | |  |  |
| zero padding to ensure 4-byte boundary | | | | | | | |  |  |

###### numUeID

**Description:** This parameter indicates the number of ueIds per user.

**Value range:** {0001b - 1000b}. {1001b - 1111b} are reserved.

**Type:** unsigned integer.

**Field length:** 4 bits.

**Default Value:** 100b (4 ueIds per user).

#### SE 18: Uplink transmission management

###### Introduction

This Section Extension applies to sending of transmission windows information for management of the uplink user data transmission from the O-RU. With the two parameters included in this Section Extension the O-RU shall transmit the corresponding user data within that time window. The data shall either be sent in normal transmission mode or be uniformly distributed in time depending on value of toT parameter. The format of Section Extension 18 is specified in Table 7.7.18.1-1

**Table 7.7.18.1-1: Section Extension 18**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **# of bytes** |  |
| ef | extType = 0x12 | | | | | | | 1 | Octet N |
| extLen | | | | | | | | 1 | N+1 |
| transmissionWindowOffset[15;8] | | | | | | | | 1 | N+2 |
| transmissionWindowOffset[7:0] | | | | | | | | 1 | N+3 |
| Reserved | | transmissionWindowSize[13:8] | | | | | | 1 | N+4 |
| transmissionWindowSize[7:0] | | | | | | | | 1 | N+5 |
| Reserved | | | | | | toT | | 1 | N+6 |
| zero pad to 4-byte boundary | | | | | | | | 1 | N+7 |

###### transmissionWindowOffset

**Description:** This parameter indicates the start of the transmission window as an offset to when the transmission window would have been without this parameter, i.e. (Ta3\_max - Ta3\_min). The resolution of the parameter is symbols, where the duration of a symbol is either as determined via M-Plane (when used with message Type 1 and 5) or according to information in parameter frameStructure (when used with message Type 3) and assuming normal cyclic prefix.

If numSymbol in the section header is greater than 1, then the number of different transmission windows is equal to numSymbol. The start of each transmission window follows the same procedure as described above for every symbol.

See clause 4.6.2 for more detailed information about overlapping transmission windows.

If message is used for an eAxC configured for delay-managed traffic, then transmissionWindowOffset value in combination with the value of transmissionWindowSize shall not result in calculated buffering load that would exceed the O-RU buffering capacity. See clause 4.6.4 for more details.

If message is used for an eAxC configured for non delay-managed traffic, then transmissionWindowOffset value can exceed the O-RU buffering capacity. See clause 4.6.4 for more details.

**Value range:** {0 - 65535}.

**Type:** unsigned integer.

**Field length:** 16 bits.

**Default Value:** 0

###### transmissionWindowSize

**Description:** This parameter indicates the size of the transmission window in resolution us. If window size is set to a value smaller than (Ta3\_max - Ta3\_min) the O-RU will if possible, transmit the requested data reliably during that window size. If not possible due to for instance lack of transmission capability on link caused by other higher prioritized traffic, then the O-RU will use a default transmission window size of (Ta3\_max - Ta3\_min).

Maximum window size is 10000 us = 10 ms.

See clause 4.6.2 for more detailed information about overlapping transmission windows.

If message is used for an eAxC configured for delay-managed traffic, then transmissionWindowSize value in combination with the value of transmissionWindowOffset shall not result in calculated buffering load that would exceed the O-RU buffering capacity.

If message is used for an eAxC configured for non delay-managed traffic, then transmissionWindowSize which is not affecting O-RU operation shall be set to 0 (zero). See clause 4.6.4 for more details.

**Value range:** {0x0 - 0x2710}

**Type:** unsigned integer.

**Field length:** 14 bits.

**Default Value:** 0x00.

###### toT (type of transmission)

**Description:** This parameter indicates to the O-RU if the associated user plane data is sent in normal transmission mode or transmitted uniformly in time over the transmission window. The O-RU shall indicate via the M-Plane if it supports the possibility to change the type of transmission. If the O-RU does not support this feature, the O-RU will ignore this parameter.

The value of Type of Transmission shall be set to the same value for all sections that have Section Extension 18 within one C-Plane message.

See clause 4.6.2 for more detailed information about uniformly distribution of data.

**Value range:** {00b - 11b}.

* 00b = normal transmission mode, data can be distributed in any way the O-RU is implemented to transmit data
* 01b = uniformly distributed over the transmission window.
* 10b = Reserved
* 11b = Reserved

**Type:** bits

**Field length:** 2 bits

**Default Value:** 00b

###### Interaction with other Section Extensions

The Section Extension 18 is used when the UL traffic needs to be managed e.g. avoid peaks in the traffic on shared links between an O-DU and multiple O-RUs.

Table 7.7.18.5-1 lists how Section Extension 18 is used in combination with other Section Extensions.

**Table 7.7.18.5-1 Interaction table**

|  |  |  |
| --- | --- | --- |
| **Section Extension** | **Title** | **Interaction with section extension 18** |
| 1 | Beamforming weights | No special handling needed |
| 2 | Beamforming attributes | No special handling needed |
| 3 | DL Precoding configuration parameters  and indications | No special handling needed |
| 4 | Modulation compression parameters | No special handling needed |
| 5 | Modulation compression additional scaling parameters | No special handling needed |
| 6 | Non-contiguous PRB allocation | No special handling needed |
| 7 | Multiple-eAxC designation | The usage of this Section Extension has the effect that more than one eAxC is targeted with one C-Plane message. For UL this means that the same  transmission time and window size will be used for all targeted eAxCs. |
| 8 | Regularization factor | No special handling needed |
| 9 | Dynamic spectrum sharing parameters | No special handling needed |
| 10 | Multiple ports grouping | The usage of this Section Extension has the effect that more than one eAxC  is targeted with one C-Plane message. For UL this means that the same transmission time and window size will be used for all eAxCs. |
| 11 | Flexible BF weights | No special handling needed |
| 12 | Non-contiguous PRB allocation with frequency  ranges | No special handling needed |
| 13 | Frequency hopping | No special handling needed |
| 14 | Null-layer information for UE-ID-based beamforming | No special handling needed |
| 15 | Mixed-numerology  information for UE-ID- based beamforming | No special handling needed |
| 16 | Antenna mapping for UW  channel information-based UL beamforming | No special handling needed |
| 17 | User port group indication | The usage of Section Extension 17 is always combined with Section Extension 10, same attention as for number 10 is thus applicable. |

#### SE 19: Compact beamforming information for multiple port

###### Overview

This Section Extension applies to Section Types 1 and 3. This Section Extension shall be used for sending compact beamforming information for multiple antenna ports (the term 'port' used henceforth in context of this Section Extension refers to logical antenna port). The optional "little endian byte order" is applied to bfwI/bfwQ fields if chosen via M- Plane. Refer to Annex D.2 for details of little endian byte order. CSI-RS channel will benefit the most from using this extension, considering large number of CSI-RS ports and multiple CSI resource sets.

This Section Extension is structured into a common Section Extension header specifying total number of ports, consolidated symbol bitmask and beamforming weight compression header applicable for all the ports. This shall be followed by fields describing per port information. Per port fields in the extension specify the location of port using a separate portReMask and portSymbolMask. The per port section further contains fields to specify per port beamforming information. When using this for CSI-RS one instance of this extension can be used to specify one CSI-RS resource set.

For section description with this extension, reMask in section header is an aggregate of portReMask for all ports specified in SE 19. Also, if section description has SE 19, the beamId in section header shall be ignored.

The first instance of this extension shall be used with 'repetition=0' and shall contain beamweights/beamIds for all ports in the range of startPrbc and numPrbc. When used with highest priority sections, and the section is repeated, this extension can be sent with 'repetition=1', in which case, per port fields are excluded from the extension indicating the associated beamforming information has already been sent to the O-RU. Section Extension 19 invocations shall follow the format shown in Table 7.7.19.1-1. This Section extension can be used with any coupling method. Interaction with other extensions is presented in Table 7.7.19.14-1.

**Table 7.7.19.1-1: Section Extension 19**

|  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | **3** | | **4** | **5** | **6** | **7 (lsb)** | **# of bytes** |  |
| ef | extType = 0x13 | | | | | | | | 1 | Octet N |
| extLen[15:0] | | | | | | | | | 2 | N+1 |
| disableBFWs | repetition | numPortc[5:0] | | | | | | | 1 | N+3 |
| priority | | symbolMask[13:8] | | | | | | | 1 | N+4 |
| symbolMask[7:0] | | | | | | | | | 1 | N+5 |
| bfwCompHdr | | | | | | | | | var |  |
| reserved | | | | portReMask[11:8] (for port 1) | | | | | 1 |  |
| portReMask[7:0] (for port 1) | | | | | | | | | 1 |  |
| reserved | | portSymbolMask[13:8] (for port 1) | | | | | | | 1 |  |
| portSymbolMask[7:0] (for port 1) | | | | | | | | | 1 |  |
| reserved | beamId[14:8] (for port 1) | | | | | | | | 1 |  |
| beamId[7:0] (for port 1) | | | | | | | | | 1 |  |
| bfwCompParam (for port 1) | | | | | | | | | var |  |
| bfwI (for port 1 and TRX 0) | | | | | | | | | var |  |
| bfwQ (for port 1 and TRX 0) | | | | | | | | | var |  |
| remaining beamforming weights bfwI and bfwQ up to L TRXs | | | | | | | | | var |  |
| ... | | | | | | | | |  |  |
| reserved | | | | portReMask[11:8] (for last port) | | | | | 1 |  |
| portReMask[7:0] (for last port) | | | | | | | | | 1 |  |
| reserved | | portSymbolMask[13:8] (for last port) | | | | | | | 1 |  |
| portSymbolMask[7:0] (for last port) | | | | | | | | | 1 |  |
| reserved | beamId[14:8] (for last port) | | | | | | | | 1 |  |
| beamId[7:0] (for last port) | | | | | | | | | 1 |  |
| bfwCompParam (for last port) | | | | | | | | | var |  |
| bfwI (for last port and TRX 0) | | | | | | | | | var |  |
| bfwQ (for last port and TRX 0) | | | | | | | | | var |  |
| remaining beamforming weights bfwI and bfwQ up to L TRXs | | | | | | | | | var |  |
| Zero pad to 4-byte boundary | | | | | | | | | var |  |

###### disableBFWs (disable beamforming weights)

**Description**: refer to clause 7.7.11.7. This parameter is used to enable/disable sending of beamforming weights as part of this extension, same as in Section Extension 11.

###### repetition (repeat port info flag)

**Description:** This parameter shall be used to indicate repetition of port beamforming information within a C-Plane message with SE 19.(see clause 7.7.6.6).

**Value range:** {0b=per port info present in the extension; 1b=per port information not present in the extension}.

**Type:** binary bit.

**Field length:** 1 bit.

###### numPortc

**Description:** refer to clause 7.7.10.3.

For this extension, this parameter indicates the number of logical antenna ports for which associated RE information and beamforming information is contained in this extension. It can cover up to 64 ports.

###### priority (priority of section description)

**Description:** This parameter has same format and semantics as priority parameter in Section Extension 6 (see clause 7.7.6.5).

###### symbolMask (resource symbol bitmask)

**Description:** This parameter, similar in functionality to symbolMask in clause 7.7.6.4, is a consolidated symbol bitmask of all the ports described in this extension. This parameter applies to all PRBs specified by startPrbc and numPrbc in the section header containing this extension. If the symbolMask values indicate allocations beyond a slot boundary, such allocations shall be ignored (e.g. when there are fewer than 14 symbols in a slot). LSB of symbolMask indicates symbol zero (the first symbol to arrive in a slot).

This parameter in the common part of this extension along with reMask in section header helps the O-RU in optimized implementation; looping over per-port information in the extension is not required for consolidated port information (which is useful for puncturing low priority sections). Also, for the case where 'repetition = 1' in this extension, and per port information is not present in the extension, 'symbolMask' together with 'reMask (in section header)' is sufficient for carrying consolidated port information.

**Value range:** {00 0000 0000 0001b-11 1111 1111 1111b}.

**Type:** unsigned integer (bit mask).

**Field length:** 14 bits.

###### bfwCompHdr

**Description:** refer to clause 7.7.1.2

If 'repetition =1' or 'disableBFWs=1' beamforming weights are not present in the extension, and hence 'bfwComHdr' parameter is also not present in the extension header.

###### portReMask (RE bitmask per port)

**Description:** This parameter defines the port Resource Element (RE) mask within a PRB. Each bit set in the portReMask indicates the RE associated with the port. MSB indicates the value for the RE of the lowest frequency in a PRB.

**Value range:** {0000 0000 0001b-1111 1111 1111b}.

**Type:** unsigned integer (bit mask).

**Field length:** 12 bits.

###### portSymbolMask (symbol bitmask per port)

**Description:** This bitmask specifies the symbols associated with a specific port. It is a subset of symbolMask specified in clause 7.7.19.6.

**Value range:** {00 0000 0000 0001b-11 1111 1111 1111b}.

**Type:** unsigned integer (bit mask).

**Field length:** 14 bits.

###### bfwCompParam (beamforming weight compression parameter)

**Description:** refer to clause 7.7.1.3.

This parameter provides beamforming compression parameters associated with a port.

###### beamId (beam identifier for a port)

**Description:** refer to clause 7.5.3.9.

This parameter provides the beamId associated with a port

###### bfwI (beamforming weight in-phase value)

**Description:** refer to clause 7.7.1.4.

###### bfwQ (beamforming weight quadrature-phase value)

**Description:** refer to clause 7.7.1.5.

###### Interaction with Other Section Extensions

**Table 7.7.19.14-1: Section Extension 19 Interactions with other Section Extensions**

|  |  |  |
| --- | --- | --- |
| **Section Extension** | **Title** | **Interaction with existing Section Extensions** |
| 1 | Beamforming Weights | Section Extension 1 shall not be used in the same section as Section Extension 19, because Section Extension 19 provides an alternate way of specifying beamforming weights. |

|  |  |  |
| --- | --- | --- |
| **Section Extension** | **Title** | **Interaction with existing Section Extensions** |
| 2 | Beamforming Attributes | Section Extension 2 shall not be used in the same section as Section  Extension 19, because Section Extension 19 provides an alternate way of specifying beams. |
| 3 | DL Precoding | Section Extension 3 is not compatible with Section Extension 19 and shall not be used together in the same section. |
| 4 | Modulation Compression | Can be used with Section Extension 19. |
| 5 | Modulation  Compression (Additional) | Can be used with Section Extension 19. |
| 6 | Non-Contiguous PRB | Section Extension 6 shall not be used, because Section Extension 19 provides an alternate way of specifying priorities and symbol Masks. |
| 7 | eAxC Mask | Can be used with Section Extension 19. |
| 8 | Regularization factor | Not applicable as Section Extension 19 is not intended to be used with Section Type 5. |
| 9 | DSS Parameters | Can be used with Section Extension 19. |
| 10 | Group Configuration for multiple ports | Section Extension 19 can be used with Section Extension 10 only if the Beamforming Weights transferred using Section Extension 19 are the same for all streams (or layers). In general, the BF weight vector will be different per data layer (eAxC) and Section Extension 19 cannot be used in this case. Once the Beamforming Weights are downloaded, then if the O-DU uses same BF vector by addressing beamId for a number of slots after the BF Weights are downloaded, then in that case, the O-DU can use Section Extension 19 to combine multiple C-Plane messages to one single C-Plane  message using the representative eAxC\_ID. |
| 11 | Flexible Beamforming Weights | Section Extension 11 can be used with Section Extension 19, for providing per port flexible beamforming weights. Section Extension 19 shall appear before Section Extension 11. There would be one instance of Section Extension 11 per port. beamIds specified in Section Extension 19 shall be ignored and disableBFWs in section Extension 19 shall be set to '1' to  exclude beamweights in Section Extension 19. |
| 12 | Non-Contiguous PRB Allocation with Frequency Ranges | Section Extension 12 shall not be used, because Section Extension 19 provides an alternate way of specifying priorities and symbol Masks. |
| 13 | PRB Allocation with Frequency Hopping | Can be used with Section Extension 19. |
| 14 | Nulling-Layer Info | Not applicable because Section Extension 19 is not intended to be used with Section Type 5. |
| 15 | Mixed Numerology Info for ueId-based  beamforming | Not applicable because Section Extension 19 is not intended to be used with Section Type 5. |
| 16 | Antenna Information in UE Channel  Information based UL beamforming | Not applicable because Section Extension 19 is not intended to be used with Section Type 5. |
| 17 | Indication of User Port group | Not applicable because Section Extension 19 is not intended to be used with Section Type 5. |
| 18 | Uplink Transmission Management | Can be used with Section Extension 19. |
| 20 | Puncturing Extension | Can be used with Section Extension 19. |

#### SE 20: Puncturing extension

###### Overview

This extension specifies a puncturing pattern to be applied to a section. This extension contains a common header with the number of puncturing patterns, followed by symbolMask, PRB ranges, puncReMask and optionally RBG mask fields for each puncturing pattern.

O-RU shall process the fields of the puncturing pattern and remove all the overlapping REs from the current section description. For coupling via time and frequency with priorities (or optimized), Section Extension 20 is restricted to be used with only the lower priority section to avoid any ambiguity in application of puncturing patterns. The number of puncturing patterns in Section Extension 20 and the number of highest priority sections in a C-Plane message together should be less than **max-highest-priority-sec-per-cplane-message** limits defined in M-Plane.

The O-DU shall comply to the limits described in clause 7.8.2.1.2 assuming the number of PRB ranges in the section description with the Section Extension 20 is the number of non-contiguous PRB ranges allocated by Section Extension 20 with puncturing removing PRBs as specified in clause 7.7.6.3 if rbgMask is present in the Section Extension (i.e. rbgIncl=1 as described in clause 7.7.20.8).

The O-RU may optionally advertise a Boolean flag **se-20-multi-sd-punc-pattern-suported** to indicate the O-RUs support for handling Section Extension 20 with puncturing pattern which can span multiple section descriptions following the current section description. If the O-DU enables this feature by setting **se-20-multi-sd-punc-pattern- enabled-tx/rx** flag to TRUE (Boolean 1) for applicable endpoints, O-DU may set the field multiSDScope flag to TRUE as applicable, in which case following rules and restrictions apply:

1. The section description with Section Extension 20 which includes at least one puncturing pattern with multiSDScope = 1 shall be the first section description within a C-Plane message for sectionId based coupling and time and frequency coupling and shall be the first low priority section for time and frequency coupling with priority and time and frequency coupling with priority (Optimized).
2. A given instance of SE 20 may include both, puncturing pattern with multiSDScope =1 and puncturing patterns with multiSDScope = 0 where:
   * The puncturing pattern specified with multiSDScope = 1 shall be applicable for channels which span multiple user allocations in the following section descriptions including the current section description. The puncturing pattern specified with multiSDScope = 1 shall apply to the current section description and all section descriptions following the current section description within a C-Plane message.
   * The puncturing pattern specified with multiSDScope = 0 shall apply to the current section description only.
   * All puncturing pattern with multiSDScope = 1 shall be specified before the puncturing patterns with multiSDScope = 0.
3. The puncturing pattern specified by section description with multiSDScope = 1 shall not be repeated by following section description within a C-Plane message.
4. Counting the total number of puncturing patterns in Section Extension 20:
   * Each puncturing pattern with multiSDScope = 0 shall be counted as one puncturing pattern.
   * The number of puncturing patterns with multiSDScope = 1 shall be counted as the cumulative of all section descriptions within a C-Plane message the multiSDScope = 1 puncturing pattern applies to, which includes the current section description where multiSDScope= 1 and all the following section descriptions.
5. The total number of puncturing patterns which is a cumulative of, puncturing pattern with multiSDScope = 0, puncturing pattern with multiSDScope = 1 (counting number of puncturingPatterns with multiSDScope = 1 as described in 4.b) and the number of highest priority sections in a C-Plane message, together should be less than **max-highest-priority-sec-per-cplane-message** limits defined in M-Plane.
6. The scope of a section description with SE 20 containing a puncturing pattern multiSDScope = 1 is limited to a C-Plane message.

Section Extension invocations shall follow the format in Table 7.7.20.1-1.

**Table 7.7.20.1-1: Section Extension 20**

|  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | | **6** | **7(lsb)** | **# of bytes** |  |
| ef | extType = 0x14 | | | | | | | | 1 | Octet N |
| extLen[15:0] | | | | | | | | | 2 | N+1 |
| numPuncPatterns[7:0] | | | | | | | | | 1 | N+3 |
| symbolMask[13:6](1) | | | | | | | | | 1 | N+4 |
| symbolMask[5:0](1) | | | | | | | startPuncPrb[9:8] (1) | | 1 | N+5 |
| startPuncPrb[7:0](1) | | | | | | | | | 1 | N+6 |
| numPuncPrb[7:0](1) | | | | | | | | | 1 | N+7 |
| puncReMask[11:4](1) | | | | | | | | | 1 | N+8 |
| puncReMask[3:0](1) | | | | rb(1) | | reserved( 1) | multiSDScope (1) | rbgIncl(1) | 1 | N+9 |
| reserved(1) | rbgSize[2:0](1) | | | rbgMask[27:24](1) | | | | | 0-1 | var |
| rbgMask[23:16](1) | | | | | | | | | 0-1 | var |
| rbgMask[15:8](1) | | | | | | | | | 0-1 | var |
| rbgMask[7:0](1) | | | | | | | | | 0-1 | var |
| ... | | | | | | | | |  |  |
| symbolMask[13:6](last) | | | | | | | | | 0-1 |  |
| symbolMask[5:0](last) | | | | | | | startPuncPrb[9:8](last) | | 0-1 |  |
| startPuncPrb[7:0](last) | | | | | | | | | 0-1 |  |
| numPuncPrb[7:0](last) | | | | | | | | | 0-1 |  |
| puncReMask[11:4](last) | | | | | | | | | 0-1 |  |
| puncReMask[3:0](last) | | | | rb(last) | | reserved(l ast) | multiSDScope (last) | rbgIncl(last) | 0-1 |  |
| reserved(last) | rbgSize[2:0](last) | | | rbgMask[27:24](last) | | | | | 0-1 |  |
| rbgMask[23:16](last) | | | | | | | | | 0-1 |  |
| rbgMask[15:8](last) | | | | | | | | | 0-1 |  |
| rbgMask[7:0](last) | | | | | | | | | 0-1 |  |
| Zero pad to 4-byte boundary | | | | | | | | | var |  |

###### numPuncPatterns (number of puncturing pattern)

**Description**: This parameter is used to indicate total number of puncturing patterns contained within single instance of this extension.

**Value range**: {000000b-111111b}.

**Type:** unsigned integer.

**Field length:** 8 bits.

###### symbolMask (puncturing pattern symbol mask)

**Description**: This parameter (also see clause 7.7.6.4 and 7.7.19.9) is a bitmask where each bit indicates the symbols associated with the puncturing pattern. A value of '1' indicates that the symbol shall be considered for puncturing. A value of '0' indicates the symbol need not be considered for puncturing.

**Value range:** {00 0000 0000 0001b-11 1111 1111 1111b}.

**Type:** unsigned integer (bit mask).

**Field length:** 14 bits.

###### startPuncPrb (starting PRB to which one puncturing pattern applies)

**Description**: This parameter conveys the first PRB of the puncturing pattern.

**Value range:** {00 0000 000b-11 1111 1111b}.

**Type:** unsigned integer.

**Field length:** 10 bits.

###### numPuncPrb (number of contiguous PRBs to which one puncturing pattern applies)

**Description**: This parameter conveys the number of PRBs of the puncturing pattern

**Value range:** {0000 0000b-1111 1111b}.

**Type:** unsigned integer (bit mask).

**Field length:** 8 bits.

###### puncReMask (puncturing pattern RE mask)

**Description**: This parameter defines the Resource Element (RE) mask of the puncturing pattern within a PRB. Each bit in the puncReMask indicates the presence/absence of a puncturing RE within a PRB. A value of '1' indicates presence of a puncturing RE, and a value of '0' indicates absence of a puncturing RE. MSB indicates the value for the RE of the lowest frequency in a PRB.

**Value range:** {0000 0000 0001b-1111 1111 1111b}.

**Type:** unsigned integer (bit mask).

**Field length:** 12 bits.

###### rb (resource block indicator)

**Description:** refer to clause 7.5.3.2

This shall not be applicable (value shall be ignored) if rbgIncl flag is set to '1' in this extension

###### rbgIncl (rbg included flag)

**Description:** This parameter is used to indicate presence/absence of resource block group for the case of non- contiguous PRB allocation. If this flag is set to 0, two fields following this parameter i.e. rbgSize and rbgMask are absent and vice versa.

**Value range:** {0b=resource block group not included; 1b=resource block group included}.

**Type:** binary bit.

**Field length:** 1 bit.

###### rbgSize (rbg size)

**Description:** refer to clause 7.7.6.2.

###### rbgMask (rbg bitmask)

**Description:** refer to clause 7.7.6.3.

###### Interaction with Other Extensions

Section Extension 20 is compatible with all other Section Extensions. Section Extension 20 is used to describe the puncturing information of ***other channels and their associated sections*** on top of the current section. Other Section Extensions are used to describe the Beamforming and Scheduling information of the current section.

###### multiSDScope (multiple section description scope flag)

**Description:** This parameter is used by the O-DU to indicate the scope of the puncturing pattern where scope can only be current section description or can also be current section description and the following section descriptions.

**Value range:** {0b= Puncturing pattern applies to current section description; 1b= Puncturing pattern applies to current section description and following section descriptions within the C-Plane message}.

**Type:** Boolean.

**Field length:** 1 bit.

#### SE 21: Variable PRB group size for channel information

###### Overview

This Section Extension is sent with Section Type 5 and Section Type 6. It enables the O-DU to send channel information with dynamic PRB group size that can match the channel variation in the frequency domain and reduce the fronthaul traffic.

In addition to sending channel estimate PRB granularity, this Section Extension is also used by the O-DU for sending PRG size to the O-RU. The 3GPP specification allows changes to PRG size slowly, on a timescale of many slots and fast, on a timescale of a slot. Hence, sending PRG size in SE-21 enables both the 3GPP supported configurations i.e.

slow and fast update of PRG size. When supporting the exchange of PRG size on the fronthaul interface, the O-RU shall indicate supports of one or both of the below described features via M-Plane:

1. PRG-SIZE-SUPP-SE-21-WITH-ST6 - This optional feature allows the O-RU to handle slowly changing PRG size provided by the O-DU. The O-DU can choose to enable/disable this feature using the read-write Boolean flag 'prg-size-supp-se-21-with-st6-enabled'. If this flag is set to 'FALSE', 'prgSize' information cannot be sent from the O-DU to the O-RU and this aligns with the legacy behaviour where the PRG size information was not sent from O-DU to the O-RU using Section Type 6.
2. PRG-SIZE-SUPP-SE-21-WITH-ST5 - This optional feature allows the O-RU to handle quickly changing PRG size provided by the O-DU. The O-DU can choose to enable/disable this feature using the read-write Boolean flag 'prg-size-supp-se-21-with-st5-enabled'. If this flag is set to 'FALSE', 'prgSize' information cannot be sent from the O-DU to the O-RU using Section Type 5.

When sending PRG size information from the O-DU to the O-RU at any time, the O-DU shall enable only one of the features 'PRG-SIZE-SUPP-SE-21-WITH-ST6' or 'PRG-SIZE-SUPP-SE-21-WITH-ST5'. Usage of these two features for describing PRG size is limited to Channel Information Based Beamforming method.

Section Extension 21 shall follow the formatting defined in Table 7.7.21-1.

**T****able 7.7.21-1: Section Extension 21 for variable PRB group size and prgSize**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **# of bytes** |  |
| ef | extType = 0x15 | | | | | | | 1 | Octet N |
| extLen = 1 | | | | | | | | 1 | N+1 |
| ciPrbGroupSize | | | | | | | | 1 | N+2 |
| reserved | | | | | | prgSize[1:0] | | 1 | N+3 |

###### ciPrbGroupSize (channel information PRB group size)

**Description:** This parameter indicates the PRB group size of channel information. If this Section Extension exists, O- RU shall apply every pair of ciIsample/ciQsample for one PRB group received in Section Type 6 to ciPrbGroupSize number of continuous PRBs starting from index startPrbc + *i* ? ciPrbGroupSize, where index *i* ranges from 0 to numPrbc -1. If this Section Extension exists, the 'numPrbc' in Section Type 6 indicates the number of PRB groups per antenna and is used to determine the length of the Section Type 6 message, and the actual number of PRBs to which Section Type 6 is applied is determined by the method described above. Also, numPrbc shall not be set to 0 when ciPrbGroupSize is configured. If startPrbc + *i* ? ciPrbGroupSize is larger than the maximum available PRBs configured via M-Plane (**number-of-prb**), the channel information shall only be applied to those PRBs within the maximum available PRBs. If both M-Plane configuration **ci-prb-group-size** and Section Extension 21 exist, O-RU shall use the ciPrbGroupSize received in Section Extension 21.

**Value range:** {2 - 254}.

Value 0, 1 and 255 are reserved for future use.

**Type**: unsigned integer.

**Field length**: 8 bits.

###### prgSize (precoding resource block group size)

* + - * 1. Description

This parameter shall have the following interpretations based on which of the two features PRG-SIZE-SUPP-SE-21- WITH-ST5 and/or PRG-SIZE-SUPP-SE-21-WITH-ST6 is supported by the O-RU and one of these features is optionally enabled/disabled by the O-DU.

* + - * 1. Sending PRG size with Section Type 6

If the O-DU enables the feature PRG-SIZE-SUPP-SE-21-WITH-ST6 by setting the 'prg-size-supp-se-21-with-st6- enabled=TRUE', the O-DU shall set the value of octet N+3 as described below:

**Value range**:

* 00b = if ciPrbGroupSize is 2 or 4, then precoding resource block group size = ciPrbGroupSize, otherwise precoding resource block group size = WIDEBAND,
* 01b = Precoding resource block group size as WIDEBAND,
* 10b = Precoding resource block group size 2,
* 11b = Precoding resource block group size 4.

**Type:** bit field

* + - * 1. Sending PRG size with Section Type 5

If the O-DU enables the feature PRG-SIZE-SUPP-SE-21-WITH-ST5 by setting the flag 'prg-size-supp-se-21-with-st5- enabled=TRUE', the O-DU shall specify a non-zero value of 'prgSize' field as described below:

**Value range**:

* 00b = reserved,
* 01b = Precoding resource block group size as WIDEBAND,
* 10b = Precoding resource block group size 2,
* 11b = Precoding resource block group size 4.

**Type:** bit field

* + - * 1. PRB grid and Carrier resource Block(CRB grid) offset for prgSize

The value of prgSize is in units of PRBs. The resource grid used for 'startPrbc' and 'numPrb' in Section Type 5 or Section Type 6 is the 'PRB grid' which is different from 'CRB grid' used for 'prgSize'. For the O-RU to correctly apply the value of 'prgSize' the offset between the start of the two grids shall be specified using the M-Plane parameter **crb-to- prb-grid-offset**, to be configured by the O-DU per **tx-array-carrier**. This parameter specifies the value of 'offsetToCarrier' parameter as specified in the 3GPP Specification TS 38.331, which is the offset in frequency domain, between RE0 of CRB 0, which is the start of CRB grid and the lowest usable subcarrier which is (RE0 of PRB0), of the **tx-array-carrier**, in units of number of PRBs (using the SCS defined for the tx-array-carrier).

Considering the case where CRB and PRB grid may not be aligned, as show in the Figure 7.7.21.3.4-1, where **crb-to- prb-grid-offset** = 3 and prgSize=4, with the prgSize and the **crb-prb-grid-offset** known to the O-RU, the O-RU may choose to apply prgSize information for BFW derivation at PRB0 and NOT at PRB3 which would have been the case if **crb-to-prb-grid-offset** = 0.

![A screenshot of a computer  Description automatically generated](../assets/images/6235f3d12639.png)

**Figure 7.7.21.3.4****-1: Example for Offset between start of CRB grid and start of PRB grid**

#### SE 22: ACK/NACK request

###### Overview

Section Extension 22 enables the O-DU to request ACK/NACK feedback using Section Type 8 C-Plane message for a section description. Refer to clause 7.2.8 for the usage of this Section Extension. Section Extension 22 shall follow the format defined in Table 7.7.22.1-1.

**Table 7.7.22.1-1: Section Extension 22 for ACK/NACK request**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **# of bytes** |  |
| ef | extType = 0x16 | | | | | | | 1 | Octet N |
| extLen = 0x01 (1 word) | | | | | | | | 1 | N+1 |
| ackNackReqId | | | | | | | | 2 | N+3 |

###### ackNackReqId (ACK/NACK request Id)

**Description:** This parameter indicates the ACK/NACK request ID of a section description. The value of ackNackReqId shall be unique within a slot (the same value can be reused in different slots). The value of ackNackReqId shall be used for ackId and nackId in Section Type 8.

**Value range**: {0000 0000 0000 0000b-1111 1111 1111 1111b}.

**Type**: unsigned integer.

**Field length**: 16 bits.

#### SE 23: Arbitrary symbol pattern modulation compression parameters

###### Overview

This Section Extension enables specifying multiple sets of 'mcScaleReMask, csf and mcScaleOffset' values for one or more 'SymPrbPatterns'. The term 'SymPrbPattern' is used to specify set of PRBs that can span an entire PRB range (specified using prbPattern) and multiple symbols (specified using symMask). In context of this Section Extension the term SymPrbPattern is defined for each mode of operation:

* for PRB-MASK mode SymPrbPattern is one set of parameters symMask and prbPattern,
* for PRB-BLOCK mode SymPrbPattern is one set of parameters symMask, prbBlkOffset and prbBlkSize.

The proposed extension is motivated by the fact that in 5G NR reference signals like DM-RS, PT-RS, and data channel experience the same channel conditions (same beamId) but may use different MCS and hence different mcScaleOffset.

This Section Extension applies to Section Types 1, 3 and 5. SE 23 can also be used for specifying channels like SSB since SSB has similar requirements as DMRS and PT-RS for specifying modulation compression parameters.

This Section Extension has a nested structure comprising of two loops. The outermost loop which is bounded by the field 'numSymPrbPattern' shall specify multiple SymPrbPatterns. The innermost loop is bounded by the field "numMcScaleOffset" and shall specify multiple sets of 'mcScaleReMask, csf, and mcScaleOffset' per SymPrbPattern. Refer to Table 7.7.23.1-1 for details of the structure of SE 23.

SE 23 can be used in two modes. When 'prbMode = 0' SE 23 operates in PRB-MASK mode in which case 'prbPattern' field shall be used to specify the PRB pattern as shown in Table 7.7.23.1-1. When 'prbMode = 1' SE 23 operates in PRB-BLOCK mode, in which case 'prbBlkOffset' and 'prbBlkSize' fields shall apply as shown in figure Table 7.7.23.1-

2. All other fields shall remain the same for both the modes. When SE 23 operates in PRB-BLOCK mode, SE 23 shall specify single or multiple PRB blocks, using combination of 'symMask', 'prbBlkOffset', 'prbBlkSize' fields. One PRB block is a range of contiguous PRBs spanning from (startPrbc + prbBlkOffset) to (startPrbc + prbBlkOffset + prbBlkSize) over symbols specified in 'symMask'.

O-RU shall advertise support for PRB-BLOCK mode of SE 23 on a per endpoint basis using the flag 'se-23-prb-block- mode-supported'. For an O-RU which does not advertise support for 'se-23-prb-block-mode-supported', O-DU shall assume only SE 23 PRB-MASK mode of operation supported by the O-RU, in which case 'prbMode' flag shall be treated as 'reserved' field and set to '0'; PRB-BLOCK mode specific fields, prbBlkOffset and prbBlkSize shall not be specified by the O-DU and shall not be interpreted by the O-RU.

If Section Extension 23 is present in a section description, then the following requirements shall apply for both modes (PRB-MASK and PRB-BLOCK) of operation:

1. Requirements 1, 2 and 3 as specified in clause 7.7.6.1 for SE 6.
2. SE 23 using a combination of symMask, prbPattern in PRB-MASK mode OR prbBlkOffset, prbBlkSize in PRB-BLOCK mode, and mcScaleReMask shall specify mcScaleOffset values for all the symbols and REs whose scheduling information is specified in the section header (startSymbolId) and section description (numSymbols, reMask) or via the use of SE 6 or SE 12.
3. Specifically for SE 6 and SE 12 prbPattern shall apply to all allocated non-contiguous PRBs jumping over the un-allocated RBGs.
4. Any PRB on time-freq grid shall be addressed by only one SymPrbPattern in any instance of SE 23
5. Each section description shall specify only one instance of SE 23 per eAxC\_ID. When SE 23 is used in combination with SE 10 refer to clause 7.9.10.
6. For every SymPrbPattern all REs in the PRBs as designated in the reMask in section header shall be assigned "mcScaleReMask, csf and mcScaleOffset" value. No bit in any of the mcScaleReMasks shall be set (=1) in a position where the reMask has a zero, and every reMask bit that is set (=1) shall have exactly one bit =1 in one of the mcScaleReMasks.

EXAMPLE: For section header reMask = 1111 1111 1111 b, union of mcScaleReMask - 1 = 1010 1010 1010b and mcScaleReMask-2 = 0101 0101 0101b shall be equal to the reMask value.

1. When SE 23 is used in a section description, the number of sets of {mcScaleReMask, csf, mcScaleOffset} values per symPrbPattern shall be limited by the M-Plane O-RU capability parameter 'max-mcscaleremask- per-prb'.
2. The following restriction is specific to prbMode = PRB-BLOCK: When SE 23 is used in PRB-BLOCK mode, number of PRB blocks or SymPrbPattern which can be specified using one instance of SE 23 is limited by O- RU advertised M-Plane parameter 'max-prb-blks-per-sec-ext-23'. The O-DU shall comply to the limits described in clause 7.8.2.1.2 assuming the number of PRB blocks in the section description with Section Extension 23 PRB-BLOCK mode is the number of non-empty (i.e. with prbBlkSize > 0) frequency ranges in the Section Extension 23.

**Table 7.7.23.1****-1: Section Extension 23 for modulation compression for multiple symbols with prbMode = PRB-MASK**

|  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | | **1** | **2** | **3** | **4** | **5** | **6** | **7(lsb)** | **# of bytes** |  |
| ef | | extType = 0x17 | | | | | | | 1 | Octet N |
| extLen[7:0] | | | | | | | | | 1 | N+1 |
| numSymPrbPattern[3:0] | | | | | reserved | | | prbMode | 1 | N+2 |
| reserved | | | | | | | | | 1 | N+3 |
| reserved | | | symMask[13:8] (1) | | | | | | 1 | N+4 |
| symMask[7:0] (1) | | | | | | | | | 1 | N+5 |
| numMcScaleOffset[3:0] (1) | | | | | prbPattern[3:0] (1) | | | | 1 | N+6 |
| reserved | | | | | | | | | 1 | N+7 |
| reserved | | | | | mcScaleReMask[11:8] (1.1) | | | | 1 | N+8 |
| mcScaleReMask[7:0] (1.1) | | | | | | | | | 1 | N+9 |
| csf (1.1) | mcScaleOffset[14:8] (1.1) | | | | | | | | 1 | N+10 |
| mcScaleOffset[7:0] (1.1) | | | | | | | | | 1 | N+11 |
| reserved (1.2) | | | | | mcScaleReMask [11:8] (1.2) | | | | 1 | N+12 |
| mcScaleReMask [7:0] (1.2) | | | | | | | | | 1 | N+13 |
| csf (1.2) | mcScaleOffset[14:8] (1.2) | | | | | | | | 1 | N+14 |
| mcScaleOffset[7:0] (1.2) | | | | | | | | | 1 | N+15 |
| ... | | | | | | | | |  |  |
| reserved | | | symMask[13:8] (n) | | | | | |  |  |
| symMask1[7:0] (n) | | | | | | | | |  |  |
| numMcScaleOffset[3:0] (n) | | | | | prbPattern[3:0] (n) | | | |  |  |
| reserved | | | | | | | | |  |  |
| reserved | | | | | mcScaleReMask [11:8] (n.1) | | | |  |  |
| mcScaleReMask [7:0] (n.1) | | | | | | | | |  |  |
| csf (n.1) | mcScaleOffset[14:8] (n.1) | | | | | | | |  |  |
| mcScaleOffset[7:0] (n.1) | | | | | | | | |  |  |

**Table 7.7.23.1-2: Section Extension 23 for modulation compression for multiple symbols with prbMode = PRB-BLOCK**

|  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | | **1** | **2** | **3** | **4** | **5** | **6** | **7(lsb)** | **# of bytes** |  |
| ef | | extType = 0x17 | | | | | | | 1 | Octet N |
| extLen[8:0] | | | | | | | | | 1 | N+1 |
| numSymPrbPattern[3:0] | | | | | reserved | | | prbMode | 1 | N+2 |
| reserved | | | | | | | | | 1 | N+3 |
| reserved | | | symMask[13:8] (1) | | | | | | 1 | N+4 |
| symMask[7:0] (1) | | | | | | | | | 1 | N+5 |
| numMcScaleOffset[3:0] (1) | | | | | prbBlkOffset[7:4] (1) | | | | 1 | N+6 |
| prbBlkOffset [3:0] (1) | | | | | prbBlkSize[7:4] (1) | | | | 1 | N+7 |
| prbBlkSize[3:0] (1) | | | | | mcScaleReMask[11:8] (1.1) | | | | 1 | N+8 |
| mcScaleReMask[7:0] (1.1) | | | | | | | | | 1 | N+9 |
| csf (1.1) | mcScaleOffset[14:8] (1.1) | | | | | | | | 1 | N+10 |
| mcScaleOffset[7:0] (1.1) | | | | | | | | | 1 | N+11 |
| reserved (1.2) | | | | | mcScaleReMask [11:8] (1.2) | | | | 1 | N+12 |
| mcScaleReMask [7:0] (1.2) | | | | | | | | | 1 | N+13 |
| csf (1.2) | mcScaleOffset[14:8] (1.2) | | | | | | | | 1 | N+14 |
| mcScaleOffset[7:0] (1.2) | | | | | | | | | 1 | N+15 |
| ... | | | | | | | | |  |  |
| reserved | | | symMask[13:8] (n) | | | | | |  |  |
| symMask1[7:0] (n) | | | | | | | | |  |  |
| numMcScaleOffset[3:0] (n) | | | | | prbBlkOffset[7:4] (n) | | | |  |  |
| prbBlkOffset [3:0] (n) | | | | | prbBlkSize[7:4] (n) | | | |  |  |
| prbBlkSize[3:0] (n) | | | | | mcScaleReMask [11:8] (n.1) | | | |  |  |
| mcScaleReMask [7:0] (n.1) | | | | | | | | |  |  |
| csf (n.1) | mcScaleOffset[14:8] (n.1) | | | | | | | |  |  |
| mcScaleOffset[7:0] (n.1) | | | | | | | | |  |  |

###### numSymPrbPattern (number of symbol and resource block patterns)

**Description**: This parameter specifies the number of SymPrbPatterns specified by SE 23 instance.

**Value range**: {0001b - 1111b} or {1 - 15} in decimal

**Type:** unsigned integer

**Field length:** 4 bits.

* + - 1. symMask (symbol mask part of symPrbPattern) **Description**: This parameter is a bitmask for the symbols specified by SymPrbPattern. 0: 'SymPrbPattern' does not apply to the associated symbol.

1: 'SymPrbPattern' applies to the associated symbol.

**Value range:** {00 0000 0000 0001b - 11 1111 1111 1111b}.

**Type:** unsigned integer (bit mask).

**Field length:** 14 bits.

###### prbPattern (resource block pattern part of symPrbPattern)

**Description**: This parameter is a 4-bit pattern mask for the PRBs specified by SymPrbPattern. This pattern repeats over all the allocated PRBs. When there are allocation discontinuities e.g.SE 6, SE 12, the pattern only applies to the allocated PRBs. If the prb range is not a multiple of 4 then the last prbPattern shall be truncated. In the specified mask LSB represents the lowest frequency PRB and MSB represents the highest frequency PRB in the prbPattern.

0: 'SymPrbPattern' does not apply to the associated PRB 1: 'SymPrbPattern' applies to the associated PRB.

**Value range:** {0000b - 1111b}. **Type:** unsigned integer (bit mask). **Field length:** 4 bits.

###### numMcScaleOffset (number of modulation compression scaling value per symPrbPattern)

**Description**: This parameter indicates the number of modulation compression parameter sets i.e. 'mcScaleReMask, csf and mcScaleOffset' values, present for each SymPrbPattern. Refer to requirement#6 in clause 7.7.23.1 for limits that apply to this parameter.

**Value range:** {0001b-1111b} or {1 - 15} in decimal. 1 - 12: Valid range.

0, 13, 14, 15: reserved. **Type:** unsigned integer. **Field length:** 4 bits.

###### mcScaleReMask (modulation compression power scale RE mask)

**Description**: refer to clause 7.7.5.2 for description of this parameter. Usage of this parameter in SE 23 shall apply only to PRBs, and symbol specified by SymPrbPattern.

###### csf (constellation shift flag)

**Description**: refer to clause refer to clause 7.7.4.2.

###### Interaction with Other Section Extensions

Interaction of Section Extension 23 with other Section Extensions is defined in Table 7.7.23.8-1.

**Table 7.7.23.8****-1: Section Extension 23 Interactions with other Section Extensions**

|  |  |  |
| --- | --- | --- |
| **Section Extension** | **Title** | **Interaction with existing Section Extensions** |
| 1 | Beamforming Weights | This Section Extension is independent of SE 23 |
| 2 | Beamforming Attributes | SE 2 can be used with SE 23 only if the Beamforming Attribute transferred using SE 2 is same for DL data and control channel (DM-RS and PT-RS) |
| 3 | DL Precoding | This Section Extension is independent of SE 23 |
| 4 | Modulation Compression | SE 23 cannot co-exist with this Section Extension in the same data section |
| 5 | Modulation Compression (Additional) | SE 23 cannot coexist with this Section Extension in the same data section |
| 6 | Non-Contiguous PRB | SE 6 can be used with SE 23. SE 23 shall apply to PRB allocations with SE 6.  For PRB-BLOCK mode the prbBlkOffset field is relative to the startPrbc field in the section header. |
| 7 | eAxC Mask | Section Extension 23 can be used with Section Extension 7 with restrictions described in clause 7.7.7.3. |
| 8 | Regularization factor | This Section Extension is independent of SE 23 |
| 9 | DSS Parameters | This Section Extension is independent of SE 23 |
| 10 | Group Configuration for multiple ports | No special handling needed . Refer to clause 7.9.10 for the interaction details. |
| 11 | Flexible Beamforming Weights | This Section Extension is independent of SE 23 |
| 12 | Non-Contiguous PRB Allocation with Frequency Ranges | Interaction same as SE 6 |
| 13 | PRB Allocation with Frequency Hopping | Interaction same as SE 6 |
| 14 | Nulling-Layer Info | This Section Extension is independent of SE 23 |
| 15 | Mixed Numerology Info for ueId-based beamforming | This Section Extension is independent of SE 23 |
| 16 | Antenna Information in UE Channel Information based UL beamforming | This Section Extension is independent of SE 23 |
| 17 | Indication of User Port group | This Section Extension is independent of SE 23 |
| 18 | Uplink Transmission Management | This Section Extension is independent of SE 23 |
| 19 | Compact multiple port beamforming information | SE=19 is used for specifying separate beamforming weights for data and reference signals (CSI-RS), usage of SE=23 with SE=19 hence is hence restricted |
| 20 | Puncturing Extension | This Section Extension is independent of SE 23 |
| 21 | Variable PRB group size for channel information | This Section Extension is independent of SE 23 |

###### prbMode (PRB Mode)

**Description**: This parameter is a bit flag that changes the mode of Section Extension 23 to be used for specifying different PRB patterns. Changing the value of this flag only impacts the way PRBs are specified in frequency domain.

**Value range**: {0, 1}.

* 0: PRB-MASK mode
* 1: PRB-BLOCK mode

**Type:** Boolean.

**Field length:** 1 bit.

###### prbBlkOffset (PRB block offset)

**Description**: This parameter is applicable when prbMode = '1' i.e. PRB-BLOCK mode. The parameter is used to indicate the offset to start of a given PRB Block for a given SymPrbPattern relative to 'startPrbc in section description or startPrbc present in applicable extension. This parameter when added to startPrbc defines the lower bound of a PRB block for a given SymPrbPattern.

**Value range**: {0000 0001b - 1111 1111b}.

**Type:** unsigned integer.

**Field length:** 8 bits.

###### prbBlkSize (PRB block size)

**Description**: This parameter is applicable when prbMode = '1' i.e. PRB-BLOCK mode. The parameter is used to indicate the size of one PRB block of one SymPrbPattern in PRB-BLOCK mode. This parameter when added to startPrbc and prbBlkOffset, defines the upper bound of a given PRB block.

**Value range**: {0000 0001b - 1111 1111b}.

**Type:** unsigned integer.

**Field length:** 8 bits.

#### SE 24: PUSCH DMRS configuration

###### Overview

The Section Extension 24 is used with Section Type 5 to convey PUSCH DMRS configuration used for DMRS-BF-EQ and DMRS-BF-NEQ beamforming methods. The principles of providing DMRS configuration in Section Type 5 are specified in clause 12.6.1.3.1.

The Section Extension 24 consists of a header conveying parameters extType, extLen, aIpnPerSym (allocated IPN per symbol, see clause 7.7.24.4), antDmrsSnr (antenna DMRS SNR, see clause 7.7.24.5), userGroupSize (see clause 7.7.24.6) and userGroupId (see clause 7.7.24.7) and a variable size table of DMRS configurations (see clause 7.7.24.3). The table is followed by a padding of 0 to 3 bytes to align the size of the Section Extension with 4-byte boundary; the padding length shall be 0 if the table ends at 4-byte boundary. The header of Section Extension 24 is presented in Table 7.7.24.1-1. Table 7.7.24.1-2 shows an example of Section Extension 24 structure.

**Table 7.7.24.1****-1: Section Extension 24 Header**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **# of bytes** | **Octet** |
| ef | extType = 0x18 | | | | | | | 1 | N |
| extLen = variable | | | | | | | | 1 | N+1 |
| aIpnPerS ym | antDmrsS nr | reserved | userGroupSize[4:0] | | | | | 1 | N+2 |
| userGroupId[7:0] | | | | | | | | 1 | N+3 |

**Table 7.7.2****4.1-2: Section Extension 24 Example**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **# of bytes** | **Octet** |
| ef | extType = 0x18 | | | | | | | 1 | 0 |
| extLen = 7 | | | | | | | | 1 | 1 |
| aIpnPerS ym | antDmrsS nr | reserved | userGroupSize[4:0] = 0 | | | | | 1 | 2 |
| userGroupId[7:0] = 0 | | | | | | | | 1 | 3 |
| entryType[2:0] = 2 | | | dmrsPortNumber[4:0] | | | | | 1 | 4 |
| ueIdReset | reserved | dmrsSymbolMask[13:8] | | | | | | 1 | 5 |
| dmrsSymbolMask[7:0] | | | | | | | | 1 | 6 |
| scrambling[15:8] | | | | | | | | 1 | 7 |
| scrambling[7:0] | | | | | | | | 1 | 8 |
| nscid | dType | cdmWithoutData[1:0] | | lambda[1:0] | | firstPrb[8:7] | | 1 | 9 |
| firstPrb[6:0] | | | | | | | lastPrb[8] | 1 | 10 |
| lastPrb[7:0] | | | | | | | | 1 | 11 |
| reserved | | | | | | | | 1 | 12 |
| reserved | | | | | | | | 1 | 13 |
| entryType[2:0] = 0 | | | dmrsPortNumber[4:0] | | | | | 1 | 14 |
| entryType[2:0] = 1 | | | dmrsPortNumber[4:0] | | | | | 1 | 15 |
| entryType[2:0] = 1 | | | dmrsPortNumber[4:0] | | | | | 1 | 16 |
| entryType[2:0] = 0 | | | dmrsPortNumber[4:0] | | | | | 1 | 17 |
| entryType[2:0] = 3 | | | dmrsPortNumber[4:0] | | | | | 1 | 18 |
| ueIdReset | reserved | dmrsSymbolMask[13:8] | | | | | | 1 | 19 |
| dmrsSymbolMask[7:0] | | | | | | | | 1 | 20 |
| scrambling[15:8] | | | | | | | | 1 | 21 |
| scrambling[7:0] | | | | | | | | 1 | 22 |
| nscid | reserved | lowPaprType[1:0] | | hoppingMode[1:0] | | firstPrb[8:7] | | 1 | 23 |
| firstPrb[6:0] | | | | | | | lastPrb[8] | 1 | 24 |
| lastPrb[7:0] | | | | | | | | 1 | 25 |
| reserved | | | | | | | | 1 | 26 |
| reserved | | | | | | | | 1 | 27 |
| entryType[2:0] = 0 | | | dmrsPortNumber[4:0] | | | | | 1 | 28 |
| entryType[2:0] = 0 | | | dmrsPortNumber[4:0] | | | | | 1 | 29 |
| zero padding to ensure 4-byte boundary | | | | | | | | var |  |
| NOTE: Different entries in the table of DMRS configurations are marked with a different colour. This example presents SE 24 as used when user-group-mode = SELF-ASSEMBLY-WITH-GROUP-ID is not used  (see clause 7.7.24.6 and 7.7.24.7). | | | | | | | | | |

When Section Extension 24 is used, the O-DU shall not exceed the related capabilities reported by the O-RU via M- Plane. The following capabilities are applicable to uplink endpoints (RX endpoints) supporting DMRS-BF. In general, capabilities of different uplink endpoints (RX endpoints) in the O-RU may be different.

1. The O-RU shall report list of supported values of entryType (refer to M-Plane parameter supported-entry- types). The O-RU shall report this capability per endpoint type. The O-RU shall support entryType 0 if the O-RU supports ueId persistence over multiple slots (ueIdReset = 0, see point #8 and clause 7.7.24.10). The O-RU shall support entryType 1. The O-RU shall support entryType 2 if the O-RU supports PUSCH with transform precoding disabled. The O-RU shall support entryType 3 if the O-RU supports PUSCH with transform precoding enabled.
2. The O-RU shall report maximum number of user groups per slot (refer to M-Plane parameter

max-user-groups-per-slot). The O-RU shall report this capacity per endpoint type. The O-RU may report this capacity per group of endpoints sharing a capacity.

1. The O-RU shall report maximum of total number of entries in the tables of DMRS configurations in all instances of Section Extension 24 within slot (refer to M-Plane parameter max-entries-per-slot). The O-RU shall report this capacity parameter per endpoint type. The O-RU may report this capacity parameter per group of endpoints sharing capacity.
2. The O-RU may report maximum number of different DMRS configurations (excluding differences in dmrsPortNumber and ueIdReset) per user group (refer to M-Plane parameter max-dmrs-configs-per-user- group-incl-first-last-prb). The O-RU may report maximum number of different DMRS configurations (excluding differences in dmrsPortNumber, ueIdReset, firstPrb, and lastPrb) per user group (refer to M-Plane parameter max-dmrs-configs-per-user-group-excl-first-last-prb). If provided, only one of these capacities shall be reported per endpoint type. For evaluation of these capacities two configurations are different if any of parameters (excluding differences listed above) are different.
3. O-RU shall report lists of supported dmrsSymbolMask values (with provision for a concise indication of support for all possible values) each list of dmrsSymbolMask values in relation to the corresponding maximum DMRS antenna port number and maximum number of UE data layers per user group (refer to M-Plane parameter dmrs-symbol-mask, max-dmrs-ant-port-number and max-user-data-layers). The O-RU shall report this capability separately for entryType = 2 (transform precoding disabled) and for entryType = 3 (transform precoding enabled). The O-RU shall report this capability per endpoint type.
4. The O-RU shall report a list of supported values of parameter dType applicable for entryType = 2 (see clause 7.7.24.14; refer to M-Plane parameter d-type) and indication if PUSCH multiplexing with DMRS is supported for each dType value (refer to M-Plane parameter pusch-dmrs-muxing-supported). The O-RU shall report this capability per endpoint type.
5. The O-RU shall report a list of supported combinations of values of parameters: lowPaprType and hoppingMode parameters which are applicable for entryType = 3 (see clauses 7.7.24.16 and 7.7.24.17; refer to M-Plane parameters low-papr-type and hopping-mode). The O-RU shall report this capability per endpoint type.
6. The O-RU shall report if it supports ueId persistence over multiple slots (ueIdReset = 0, see clause 7.7.24.10; refer to M-Plane feature UEID-PERSISTENCE).
7. The O-RU shall report if it supports configuration of point A frequency offset (refer to M-Plane feature POINT-A-OFFSET-TO-ABSOLUTE-FREQUENCY-CENTER, see clause 7.7.24.3).
8. The O-RU shall report support for different values of cdmWithoutData in different UE data layer within user group (see clause 7.7.24.15 and M-Plane parameter different-cdm-without-data-in-user-group-supported). The O-RU shall report this capability per endpoint type.
9. The O-RU shall report capability to support concurrent use of both entryType = 2 (transform precoding disabled) and entryType = 3 (transform precoding enabled) in one user group (refer to M-Plane parameter different-transform-precoding-in-user-group-supported). The O-RU shall report this capability per endpoint type.
10. The O-RU shall report capability to support partial overlap of UE allocation in time and capability to support partial overlap of UE allocation in frequency (refer to M-Plane parameters ue-time-partial-overlap-supported and ue-freq-partial-overlap-supported). The O-RU shall report the capabilities per endpoint type.
11. The O-RU shall report the maximum number of user groups a UE allocation can be split into in a time-domain within a slot due to partial overlap of the allocation with allocation of other UE (refer to M-Plane parameter max-user-groups-per-ue-in-time). The O-RU shall report this capability per endpoint type.

When Section Extension 24 is used, the O-DU shall apply the following general restrictions:

1. The O-DU shall ensure that configurations provided for a ueId in different instances of Section Extension 24 within a slot are the same. The term "configuration provided for ueId" is a configuration consisting of all parameters conveyed explicitly or implicitly by an entry in the table of DMRS configurations (see clause 7.7.25.3).
2. The O-DU shall ensure that all configurations provided in Section Extension 24 instance for ueId values associated with one UE are consistent. The term "configuration provided for ueId" has same meaning as in the restriction #1.
3. The O-DU shall ensure that the set of ueId values associated with one UE is the same in every section description within a slot where any of ueId values associated with the UE is present.
4. If SE 24 is present in a section description of ST 5 message, then the O-DU shall convey in the section description the time and frequency allocation of UE/UEs within the user group without excluding DMRS symbols and REs with DMRS (it implies reMask in ST 5 section description will be all ones).
5. The O-DU shall ensure configuration it provides to the O-RU in M-Plane and C-Plane does not exceed any of applicable capabilities reported by the O-RU.
6. The O-DU shall ensure that no RE is allocated to both PUSCH data and DMRS (see clause 7.7.24.15).

###### Interaction with Other Section Extensions

Section Extension 24 is specific for reception of uplink radio signal with DMRS-BF and can be used only with subset of Section Extensions allowed in Section Type 5 messages. In the present document use of Section Extension 24 with Section Extensions 1-5, 7-9, 11, 14-21 and 23 is not specified.

When Section Extension 24 is used with Section Extension 6 or Section Extension 12 then symbolMask in Section Extension 6 or Section Extension 12 does not restrict DMRS symbols indicated by dmrsSymbolMask in Section Extension 24.

Section Extension 13 can be used with Section Extension 24 under the following conditions:

* the frequency hopping is restricted to two frequency hops and
* the section description where Section Extension 24 and Section Extension 13 are present covers all hops (hops are not split into two or more section descriptions addressing a partial hop) and
* all allocations in frequency and time for UE data layers in the user group for which Section Extension 24 provides configuration are the same (implies the same hopping).

When Section Extension 13 is used with Section Extension 24 then a single instance of Section Extension 13 shall be present in all section descriptions for the user group; the case with more than one section description per user group is relevant when user group self-assembly is used (see also clause 7.7.24.7).

When Section Extension 24 is used with Section Extension 13 then values of firstPrb and lastPrb in the entry in the table of DMRS configurations with entryType = 3 in Section Extension 24 shall indicate respectively the lowest and the highest PRB index that is allocated to the UE data layer associated with the entry in any symbol within the first hop (i.e. the hop where startPrbc from the section description is applied, see clause 7.7.13.1 for more details). The O-RU shall calculate the lowest and the highest PRB index that is allocated to the UE data layer for hops other the first hop assuming firstPrb and lastPrb are shifted in given hop by nextStartPrbc(n) - startPrbc (see clauses 7.7.13.1 and 7.7.13.3). For entry entryType = 2 the above does not apply and definition of firstPrb and lastPrb provided in clauses

7.7.24.19 and 7.7.24.20 respectively is used when Section Extension 13 is present i.e. the firstPrb and lastPrb represent a PRB index range covering all PRBs allocated for a given data layer in any of symbols allocated for the UE data layer and over all frequency hops.

###### Table of DMRS configurations

The table of DMRS configurations conveys parameters describing PUSCH DMRS configuration for one or more UE data layers. There shall be exactly one entry in the table for each ueId value associated with UE data layer that is included in the section description in which the Section Extension 24 is present. The entries of the table shall be mapped to ueId values in order of occurrence of ueId values in the section description (that is, the ueId value in the Section

Type 5 section description followed by ueId values in Section Extension 10 if present). There shall be no entry in the

table which is not associated with a ueId value. There shall be no entry in the table associated with a ueId value not associated with UE data layer (i.e. value 0x7FFF). The number of entries in the table shall not exceed the maximum supported number of UE data layers per user group (see clause 7.7.24.1). Clause 12.6.1.3.1 defines further requirements for providing DMRS configuration with Section Type 5.

An entry in table of DMRS configurations can convey different set of parameters depending on the type of the entry conveyed in the parameter entryType:

* An entry with entryType = 0 is used for UE data layers that inherit the configuration from the last preceding entry with entryType = 2 or 3 in the same SE 24 instance, and to implicitly convey ueIdReset = 0.
* An entry with entryType = 1 is used for UE data layers that inherit the configuration from the last preceding entry with entryType = 2 or 3 in the same SE 24 instance, and to implicitly convey ueIdReset = 1.
* An entry with entryType = 2 is used for UE data layers that have transform precoding disabled and conveys related parameters.
* An entry with entryType = 3 is used for UE data layers that have transform precoding enabled and conveys related parameters.

If entryType = 0 or 1, then the parameter dmrsPortNumber shall be provided in the entry. In this case, for the UE data layer associated with the entry, the O-RU shall use the dmrsPortNumber provided in the entry and all other parameters (excluding ueIdReset) provided in the last preceding entry that has either entryType = 2 or 3. This also means the O-RU shall assume transform precoding is disabled or enabled based on the entryType of the last preceding entry.

While the parameter ueIdReset is not present in the entry with entryType = 0 or 1, the value of the ueIdReset is conveyed implicitly and the O-RU shall assume ueIdReset = 0 for entryType = 0 and ueIdReset = 1 for entryType = 1 (see clause 7.7.24.10 for definition of ueIdReset).

When the O-RU does not indicate support for ueId persistence over multiple slots (M-Plane feature UEID- PERSISTENCE), the O-DU shall set ueIdReset = 1, and shall not send entries with entryType = 0.

The first entry in the table shall not have entryType = 0 or 1.

Table 7.7.24.3-1 shows the structure of the entry with entryType = 0 and entryType = 1.

**Table 7.7.24.3-1: Format of entry with entryType = 0 and entryType = 1**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **# of bytes** | **Octet** |
| entryType[2:0] = 0 or 1 | | | dmrsPortNumber[4:0] | | | | | 1 | 0 |

If entryType = 2, then the parameters: dmrsPortNumber, ueIdReset, dmrsSymbolMask, scrambling, nscid, dType, cdmWithoutData, lambda, lastPrb and firstPrb shall be provided in the entry. In this case, for the UE data layer associated with the entry O-RU shall use the dmrsPortNumber and the additional parameters provided in the entry for DMRS-BF and assume that the transform precoding is disabled (see 3GPP TS 38.211v17.6 [55] for details on DMRS signal generation when transform precoding is disabled). Table 7.7.24.3-2 shows the structure of the entry with entryType = 2. When transform precoding is disabled, the generation and mapping of DMRS sequence values to the allocated RBs for a UE data layer uses Point A (the first subcarrier of the first CRB on the CRB grid, see clause 4.4.4.2 3GPP TS 38.211v17.6 [55]) as a reference. When the O-RU supports M-Plane parameter point-a-offset-to-absolute- frequency-center then the O-DU may configure this M-Plane parameter to indicate the offset between centre frequency of channel bandwidth (given in M-Plane parameter center-of-channel-bandwidth) and Point A. For generation and mapping of DMRS sequence values to allocated RBs of a UE data layer for transform precoding disabled, the O-RU shall use the value of point-a-offset-to-absolute-frequency-center (expressed in steps of half of a reference SCS: 15 kHz for FR1 and 60 kHz for FR2) together with the value of the M-Plane parameter offset-to-absolute-frequency-center (expressed in steps of half of the SCS configured for a given endpoint) to determine the offset in number of RBs between Point A and RE #0 of PRB #0 indicated by offset-to-absolute-frequency-center. If the parameter point-a-offset-

to-absolute-frequency-center is not configured, then the O-RU shall assume Point A coincides with the RE #0 of PRB #0 indicated by M-Plane parameter offset-to-absolute-frequency-center.

**Table 7.7.24.3-2: Format of entry with entryType=2**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **# of bytes** | **Octet** |
| entryType[2:0] = 2 | | | dmrsPortNumber[4:0] | | | | | 1 | 0 |
| ueIdReset | reserved | dmrsSymbolMask[13:8] | | | | | | 1 | 1 |
| dmrsSymbolMask[7:0] | | | | | | | | 1 | 2 |
| scrambling[15:8] | | | | | | | | 1 | 3 |
| scrambling[7:0] | | | | | | | | 1 | 4 |
| nscid | dType | cdmWithoutData[1:0] | | lambda[1:0] | | firstPrb[8:7] | | 1 | 5 |
| firstPrb[6:0] | | | | | | | lastPrb[8] | 1 | 6 |
| lastPrb[7:0] | | | | | | | | 1 | 7 |
| reserved | | | | | | | | 1 | 8 |
| reserved | | | | | | | | 1 | 9 |

If entryType = 3 then the parameters: dmrsPortNumber, ueIdReset, dmrsSymbolMask, scrambling, nscId, lowPaprType, hoppingMode, lastPrb and firstPrb shall be provided in the entry. In this case, for the UE data layer associated with the entry O-RU shall use the dmrsPortNumber and the additional parameters provided in the entry for DMRS-BF and assume that the transform precoding is enabled (see 3GPP TS 38.211v17.6 [55] for details on DMRS signal generation when transform precoding is enabled). The O-RU shall assume that dType = 0 and cdmWithoutData = 2. Table 7.7.24.3-3 shows the structure of the entry with entryType = 3.

**Table 7.7.24.3-3: Format of entry with entryType=3**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **# of bytes** | **Octet** |
| entryType[2:0] = 3 | | | dmrsPortNumber[4:0] | | | | | 1 | 0 |
| ueIdReset | reserved | dmrsSymbolMask[13:8] | | | | | | 1 | 1 |
| dmrsSymbolMask[7:0] | | | | | | | | 1 | 2 |
| scrambling[15:8] | | | | | | | | 1 | 3 |
| scrambling[7:0] | | | | | | | | 1 | 4 |
| nscid | reserved | lowPaprType[1:0] | | hoppingMode[1:0] | | firstPrb[8:7] | | 1 | 5 |
| firstPrb[6:0] | | | | | | | lastPrb[8] | 1 | 6 |
| lastPrb[7:0] | | | | | | | | 1 | 7 |
| reserved | | | | | | | | 1 | 8 |
| reserved | | | | | | | | 1 | 9 |

###### aIpnPerSym (Allocated IPN Per Symbol)

**Description:** This parameter is provided per Section Extension 24 when RRM measurement MEAS\_IPN\_ALLOC (allocated IPN measurement, see clause 9.2.2.4) is enabled via M-Plane. If the measurement is not enabled, the O-DU shall set it to 0 and the O-RU shall ignore it. This parameter indicates how RRM measurement MEAS\_IPN\_ALLOC shall be reported by the O-RU. Further details on MEAS\_IPN\_ALLOC reporting and related capabilities are provided in clause 9.2.2.4.

If aIpnPerSym = 0 and the MEAS\_IPN\_ALLOC reporting is enabled, then the O-RU shall report one allocated IPN value per all allocated symbols with DMRS (see clause 9.2.2.4).

If aIpnPerSym = 1 and the MEAS\_IPN\_ALLOC reporting is enabled, then the O-RU shall report one allocated IPN value per group of consecutive DMRS symbols (see clause 9.2.2.4).

**Value range:** 0 - 1.

**Type:** unsigned integer.

**Field length:** 1 bit.

###### antDmrsSnr (Antenna DMRS SNR request)

**Description:** This parameter is provided per Section Extension 24 when RRM measurement MEAS\_ANT\_DMRS\_SNR (DMRS SNR per antenna, see clause 9.2.2.6) is enabled via M-Plane. If the measurement is not enabled, the O-DU shall set it to 0 and the O-RU shall ignore it. This parameter indicates if MEAS\_ANT\_DMRS\_SNR shall be reported by the O-RU for the specific user group described by the SE 24 in which this parameter appears. Further details on the MEAS\_ANT\_DMRS\_SNR reporting and related capabilities are provided in clause 9.2.2.6.

* If antDmrsSnr = 0, then the O-RU shall not report the MEAS\_ANT\_DMRS\_SNR.
* If antDmrsSnr = 1, then the O-RU shall report the MEAS\_ANT\_DMRS\_SNR.

**Value range:** 0 - 1. **Type:** unsigned integer. **Field length:** 1 bit.

###### userGroupSize

**Description:** This parameter is provided per Section Extension 24. This parameter is used in conjunction with the parameter userGroupId (see clause 7.7.24.7) and indicates number of UE data layers in the user group identified by the value of userGroupId. The handling of the userGroupSize parameter depends on the O-RU's capability and configuration regarding assembly of user groups:

1. By default, userGroupSize is not used. In this case, parameter userGroupSize is reserved and the O-DU shall set userGroupSize to a value 0.
2. If the O-RU supports "user group self assembly with group ID" and the feature is activated via M-Plane by user-group-mode = SELF-ASSEMBLY-WITH-GROUP-ID, then the O-DU shall set userGroupSize to the number of layers in the user group identified by the value of the userGroupId parameter.

**Value range:** 0 - 12. Values 13 - 31 are reserved.

**Type:** unsigned integer.

###### userGroupId

**Description:** This parameter is provided per Section Extension 24. This parameter indicates user group described by the section (see also clause 12.6.1.3.1.2). The handling of the parameter depends on the O-RU's capability and configuration regarding assembly of user groups:

1. By default, section description with SE 24 shall include configuration of all layers in a user group and userGroupId is not used to identify the user groups within a slot. In this case the O-DU shall set userGroupId to a value 0.
2. If the O-RU supports "user group self assembly with group ID" and the feature is activated via M-Plane by user-group-mode = SELF-ASSEMBLY-WITH-GROUP-ID, then a section description with SE 24 may include configuration of a subset of layers in a user group. In this case, the O-DU shall set userGroupId to a value that identifies the user group within a slot for an array carrier. The O-RU may use the userGroupId to identify section descriptions which provide configuration for the user group.
3. If the O-RU supports "user group self assembly without group ID" and the feature is activated via M-Plane by user-group-mode = SELF-ASSEMBLY-WITHOUT-GROUP-ID, then a section description with SE 24 may

include configuration of a subset of layers in a user group but userGroupId is not used to identify user groups within a slot. In this case, the O-DU shall set userGroupId to a value 0, and the O-RU shall identify section descriptions which provide configuration for the user group by analysing the PRB ranges of each UE-layer in each section description.

1. The value of userGroupId shall be in range 0 to N-1, where N is the value of the M-Plane parameter max-user- groups-per-slot reported by the O-RU. The O-RU shall not assume that userGroupId value assigned to a user group in a slot has any meaning in another slot. The O-RU shall assume the value of userGroupId is specific to array carrier i.e. user groups associated with different array carriers may have the same userGroupId value assigned.

**Value range:** 0 to N-1, where N is the value of the M-Plane parameter max-user-groups-per-slot reported by the O-RU. Value 255 is reserved.

**Type:** unsigned integer.

**Field length:** 8 bits.

###### entryType

**Description:** This parameter is provided per entry in the table of DMRS configurations. This parameter indicates format of the entry. See clause 7.7.24.3 for meaning of values.

**Value range:** 0 - 3. Values 4 - 7 are reserved.

**Type:** unsigned integer.

**Field length:** 3 bits.

###### dmrsPortNumber

**Description:** This parameter is provided per entry in the table of DMRS configurations. This parameter indicates the DMRS antenna port number for the ueId associated with the entry.

This parameter directly corresponds to p specified in 3GPP TS 38.211 v17.6 [55], clause 6.4.1.1.3.

**Value range:** 0 - 11. Values 12 - 31 are reserved.

**Type:** unsigned integer.

###### ueIdReset

**Description:** This parameter is provided per entry in the table of DMRS configurations when entryType = 2 or 3. This parameter indicates if the ueId value for which the configuration is provided in the entry is associated with the same UE as it was associated in the preceding slot or not. If ueIdReset = 0, then the O-RU may assume that the ueId value for which the configuration is provided in the entry is associated with the same UE as it was associated in the preceding slot. Otherwise (ueIdReset = 1), O-RU shall not assume that the ueId value for which the configuration is provided in the entry is associated with the same UE as it was associated in the preceding slot (ueId is reset).

While the parameter ueIdReset is not present in the entry with entryType = 0 and 1, the ueIdReset value (0 or 1) is conveyed implicitly by the value of entryType and the O-RU shall assume ueIdReset = 0 for entryType = 0 and ueIdReset = 1 for entryType = 1.

When the O-RU does not indicate support for ueId persistence over multiple slots (M-Plane feature UEID- PERSISTENCE) or the feature is not enabled by the O-DU (ueid-persistence-enabled is not configured or is set to FALSE), the O-DU shall set ueIdReset = 1, and shall not send entries with entryType = 0, and the O-RU shall ignore the value of ueIdReset and O-RU shall reset the ueId.

**Value range:** 0 - 1. **Type:** unsigned integer. **Field length:** 1 bit.

###### dmrsSymbolMask

**Description:** This parameter is provided per entry in the table of DMRS configurations when entryType = 2 or 3. This parameter is used to inform the O-RU about symbols within the slot containing DMRS for the UE data layer associated with the entry in the table. The bits in the parameter correspond to symbols within a slot and the bit values indicate presence of DMRS signal. If bn = 1 then there is DMRS in the symbol n, where bn is n-th bit of dmrsSymbolMask,

n = 0, 1, ..., 13 and b0 is the least significant bit of dmrsSymbolMask indicating the first symbol of the slot arriving at the O-RU. If bn = 0 then there is no DMRS in the symbol n. The value of this parameter represents DMRS symbol locations in the whole slot and is not restricted to the symbol set referenced by the section description where Section Extension 24 is present. The value of dmrsSymbolMask shall correspond to a DMRS configuration allowed by 3GPP TS 38.211 v17.6 [55] and by the O-RU capability reported over M-Plane.

**Value range:** 0x0000 - 0x3FFF. **Type:** unsigned integer (bitmask). **Field length:** 14 bits.

###### scrambling

**Description:** This parameter is provided per entry in the table of DMRS configurations when entryType = 2 or 3. This parameter is used to calculate the seed value required to initialize pseudo-random generator for DMRS binary sequence applicable for a given DMRS antenna port.

If transform precoding is disabled (entryType = 2), this parameter corresponds to N

n?

SCID as defined in 3GPP TS

38.211v17.6 [55], clause 6.4.1.1.1.1.

ID

If transform precoding is enabled (entryType = 3) and Low-PAPR sequence generator type 2 for long sequence lengths is used, this parameter corresponds to NnSCID defined in 3GPP TS 38.211v17.6 [55], clause 6.4.1.1.1.2.

ID

If transform precoding is enabled (entryType = 3) and Low-PAPR sequence generator type 1 is used, or Low-PAPR sequence type 2 for short sequence lengths, this parameter encodes the quantity nID as defined in 3GPP TS 38.211v17.6

RS

[55], clause 6.4.1.1.1.2.

**Value range:** 0x0000 - 0xFFFF.

**Type:** unsigned integer.

**Field length:** 16 bits.

###### nscid

**Description:** This parameter is provided per entry in the table of DMRS configurations when entryType = 2 or 3. This parameter is used to calculate the seed value for pseudo-random generator of DMRS binary sequence applicable for a given DMRS antenna port.

* If transform precoding is disabled (entryType = 2), this parameter corresponds to n? as defined in 3GPP TS

SCID

38.211v17.6 [55], clause 6.4.1.1.1.1.

* If transform precoding is enabled (entryType = 3) and Low-PAPR sequence generator type 2 for long sequence lengths is used, this parameter corresponds to nSCID as defined in 3GPP TS 38.211v17.6 [55], clause 6.4.1.1.1.2.
* Otherwise, this parameter is unused and shall be set to value zero by the O-DU.

**Value range:** 0 - 1. **Type:** unsigned integer. **Field length:** 1 bit.

###### dType

**Description:** This parameter is provided per entry in the table of DMRS configurations when entryType = 2. This parameter indicates PUSCH DMRS configuration type, as specified in 3GPP TS 38.211v17.6 [55], clause 7.4.1.1.2. This parameter impacts DMRS RE location and density within a single PRB.

If dType = 0, the O-RU shall assume that DMRS configuration type is 1, otherwise the O-RU shall assume that DMRS configuration type is 2.

While the parameter dType is not present in the entry with entryType = 3 (transform precoding enabled), the O-RU shall assume dType = 0 when entryType = 3.

**Value range:** 0 - 1. **Type:** unsigned integer. **Field length:** 1 bit.

###### cdmWithoutData

**Description:** This parameter is provided per entry in the table of DMRS configurations when entryType = 2. The value directly indicates the number of DMRS CDM groups without data, according to definition in 3GPP TS 38.212v17.6 [56], clause 7.3.1.1. This parameter is used to indicate frequency multiplexing of PUSCH data and DMRS in DMRS symbols.

NOTE: For cdmWithoutData = N, CDM groups 0, ..., N-1 are without data e.g. for cdmWithoutData = 2, CDM groups 0 and 1 have no data.

While the parameter cdmWithoutData is not present in the entry with entryType = 3 (transform precoding enabled), the O-RU shall assume cdmWithoutData = 2 when entryType = 3.

For DMRS symbol(s) and PRBs of the user group described by the section description with SE 24, the O-RU shall use dType and cdmWithoutData (provided explicitly for entryType = 2 or implied for entryType = 3) for each UE data layer in the user group to determine which REs are allocated to PUSCH (if any).

EXAMPLE:

1. For each UE data layer in the user group:
   1. The O-RU uses value of dType to determine the number of CDM groups and corresponding REs for each CDM group in DMRS symbol(s).
   2. If transform precoding is enabled for the UE data layer or the O-RU declared no support for PUSCH multiplexing with DMRS (refer to M-Plane parameter pusch-dmrs-muxing-supported

= false), then:

* + 1. The O-DU sets cdmWithoutData equal to the number of CDM groups determined in Step 1a.
    2. The O-RU determines that PUSCH is not multiplexed in DMRS symbols for this UE data layer.
  1. If transform precoding is disabled for the UE data layer and the O-RU declared support for PUSCH multiplexing with DMRS (refer to M-Plane parameter pusch-dmrs-muxing-supported

= true), then:

* + 1. The O-RU uses value of cdmWithoutData to determine a set of CDM groups without data and determines that the corresponding REs are not allocated for PUSCH.
    2. The O-RU determines the set of CDM groups with data as a subset of the set of CDM groups determined in step 1.a that do not belong to the set of CDM groups without data (determined in step 1.c.i).
    3. If the set of CDM groups with data determined in step 1.c.ii is not empty, then the O-RU determines that the REs of CDM groups with data are allocated for PUSCH and that PUSCH is multiplexed in DMRS symbol(s) for this UE data layer. Otherwise, the O-RU determines that PUSCH is not multiplexed in DMRS symbol(s) for this UE data layer.

1. If the O-RU determines that PUSCH is multiplexed in DMRS symbol(s) in step 1.c for any UE data layer:
   1. If the O-RU declared no support for different values of cdmWithoutData in different UE data layer within user group (refer to M-Plane parameter different-cdm-without-data-in-user-group- supported = false), the O-RU will assume that all UE data layer(s) in the user group have PUSCH in the REs of all CDM groups in the set determined in step 1.c.ii.
   2. If the O-RU declared support for different values of cdmWithoutData in different UE data layer within user group (refer to M-Plane parameter different-cdm-without-data-in-user-group- supported = true), and different UE data layers in the user group have different values of cdmWithoutData, the O-RU will not assume that all UE data layer(s) in the user group have PUSCH in the REs of all CDM groups in the set determined in step 1.c.ii.

Within DMRS symbol(s), the procedure for determining how to send in the U-Plane REs of UE data layer associated with the entry in SE 24 is as follows:

* If the UL IQ data compression method configured via M-Plane or C-Plane to be used for the data sections described by the section description containing the Section Extension 24 does not include selective RE sending (i.e. selective RE sending is not used):
  + When DMRS sending is not enabled via M-Plane:
    - If the O-RU determines that PUSCH is multiplexed in DMRS symbol(s) for the UE data layer associated with the entry in SE 24 (step 1 in the Example above), the O-RU shall send in the U- Plane all 12 REs for each respective PRB of the DMRS symbols. The REs used by DMRS and the REs (if any) unused by DMRS and PUSCH should be set to zero, following the "missing" RE case specified for REs indicated by the 0's in reMask in Clause 7.5.3.5.
    - If the O-RU determines that PUSCH is not multiplexed with DMRS symbols(s) for the UE data layer associated with the entry in SE 24 (step 1 in the Example above), the O-RU shall not send in the U-Plane any REs in DMRS symbols.
  + When DMRS sending is enabled via M-Plane, the O-RU shall send in the U-Plane all 12 REs for each respective PRB of the DMRS symbols. The REs (if any) unused by DMRS and PUSCH should be set to

zeros, following the "missing" RE case specified for REs indicated by the 0's in reMask in Clause 7.5.3.5.

* If the UL IQ data compression method configured via M-Plane or C-Plane to be used for the data sections described by the section description containing the Section Extension 24 includes selective RE sending (i.e. selective RE sending is used):
  + When DMRS sending is not enabled via M plane:
    - If the O-RU determines that PUSCH is multiplexed in DMRS symbol(s) for the UE data layer associated with the entry in SE 24 (step 1 in the Example above), the O-RU shall send in the U- Plane only REs used for PUSCH in DMRS symbol(s).
    - If the O-RU determines that PUSCH is not multiplexed with DMRS symbols(s) for the UE data layer associated with the entry in SE 24 (step 1 in the Example above), the O-RU shall not send in the U-Plane any REs in DMRS symbol(s).
  + When DMRS sending is enabled via M-Plane, the O-RU shall send in the U-Plane only the REs used by DMRS and the REs (if any) used by PUSCH.

**Value range:** 1 - 3. Value 0 is reserved.

**Type:** unsigned integer.

**Field length:** 2 bits.

###### lambda

**Description:** This parameter is provided per entry in the table of DMRS configurations when entryType = 2. The parameter conveys a value of ???, where ? is defined in 3GPP TS 38.211v17.6 [55], clause 6.4.1.1.1.1 and symbol "?x?"

2

denotes a floor function. This value is used to calculate the seed value for pseudo-random generator of DMRS binary sequence applicable for a given DMRS antenna port.

**Value range:** 0 - 1. **Type:** unsigned integer. **Field length:** 2 bits.

###### lowPaprType

**Description:** This parameter is provided per entry in the table of DMRS configurations when entryType = 3. The parameter lowPaprType indicates the type of Low-PAPR sequence generator used to derive DMRS sequence when transform precoding is enabled (entryType = 3). See 3GPP TS 38.211v17.6 [55], clause 6.4.1.1.1.2 for more details.

If lowPaprType = 0, Low-PAPR sequence generator type 1 for short sequence lengths as described in 3GPP TS 38.211v17.6 [55], clause 5.2.2.2 shall be used.

If lowPaprType = 1, Low-PAPR sequence generator type 1 for long sequence lengths as described in 3GPP TS 38.211v17.6 [55], clause 5.2.2.1 shall be used.

If lowPaprType = 2, Low-PAPR sequence generator type 2 for short sequence lengths as described in 3GPP TS 38.211v17.6 [55], clause 5.2.3.2 shall be used.

If lowPaprType = 3, Low-PAPR sequence generator type 2 for long sequence lengths as described in 3GPP TS 38.211v17.6 [55], clause 5.2.3.1 shall be used.

**Value range:** 0 - 3.

**Type:** unsigned integer.

**Field length:** 2 bits.

###### hoppingMode

**Description:** This parameter is provided per entry in the table of DMRS configurations when entryType = 3. This parameter controls the hopping mode used for DMRS sequence generation when transform precoding is enabled, according to the definition in 3GPP TS 38.211v17.6 [55], clause 6.4.1.1.1.2.

If hoppingMode = 0, neither group, nor sequence hopping is enabled.

If hoppingMode = 1, group hopping is enabled and sequence hopping is disabled. If hoppingMode = 2, sequence hopping is enabled and group hopping is disabled. **Value range**: 0 - 2. Value 3 is reserved.

**Type**: unsigned integer.

**Field length**: 2 bits.

###### firstPrb

**Description:** This parameter is provided per entry in the table of DMRS configurations when entryType = 2 or 3. This parameter provides to the O-RU information about PRB allocation for UE data layer or layers. The value of this parameter represents the frequency domain resource allocation for UE data layer or layers and is not restricted to the PRB set referenced by the section description where Section Extension 24 is present.

If entryType = 2 (transform precoding disabled), then this parameter indicates to the O-RU that the configuration provided in the entry does not apply to a PRB with index less than firstPrb in any symbol of the slot. The O-RU may assume that a PRB with index less than the value of firstPrb is not allocated within a slot to any UE data layer for which the entry provides parameters. The O-RU may use firstPrb to optimize DMRS sequence generation and mapping for DMRS symbols indicated in dmrsSymbolMask.

If entryType = 3 (transform precoding enabled), then this parameter indicates to the O-RU the lowest PRB index that is allocated to the UE data layer associated with the entry in any symbol referenced by the section description where Section Extension 24 is present if Section Extension 13 is absent (see clause 7.7.24.2 for description of firstPrb in case Section Extension 13 is present). The O-RU may use firstPrb and lastPrb (see clause 7.7.24.20) to determine the length of the DMRS sequence in all DMRS symbols indicated by dmrsSymbolMask and use this length for DMRS sequence generation. The O-RU may use firstPrb to map DMRS sequence to REs in DMRS symbols indicated by dmrsSymbolMask.

**Value range:** 0x000 - 0x1FF.

**Type:** unsigned integer.

**Field length:** 9 bits.

###### lastPrb

**Description:** This parameter is provided per entry in the table of DMRS configurations when entryType = 2 or 3. This parameter provides to the O-RU information about PRB allocation for UE data layer or layers. The value of this parameter represents the frequency domain resource allocation for UE data layer or layers and is not restricted to the PRB set referenced by the section description where Section Extension 24 is present.

If entryType = 2 (transform precoding disabled), then this parameter indicates to the O-RU that the configuration provided in the entry does not apply to a PRB with index greater than lastPrb in any symbol of the slot. The O-RU may

assume that a PRB with index greater than the value of lastPrb is not allocated within a slot to any UE data layer for which the entry provides parameters. The O-RU may use lastPrb to optimize DMRS sequence generation and mapping for DMRS symbols indicated by dmrsSymbolMask.

If entryType = 3 (transform precoding enabled), then this parameter indicates to the O-RU the highest PRB index that is allocated to the UE data layer associated with the entry in any symbol referenced by the section description where Section Extension 24 is present if Section Extension 13 is absent (see clause 7.7.24.2 for description of lastPrb in case Section Extension 13 is present). The O-RU may use firstPrb (see clause 7.7.24.19) and lastPrb to determine the length of the DMRS sequence in all DMRS symbols indicated by dmrsSymbolMask and use this length for DMRS sequence generation. The O-RU may use lastPrb to map DMRS sequence to REs in DMRS symbols indicated by dmrsSymbolMask.

**Value range:** 0x000 - 0x1FF.

**Type:** unsigned integer.

**Field length:** 9 bits.

#### SE 25: Symbol reordering for DMRS-BF

###### Overview

This Section Extension shall be used to deliver symbol reordering information for DMRS-BF. The O-RU shall rearrange U-Plane message transmission based on symbol reordering information provided in Section Extension 25 and this operation is generally referred to as symbol reordering. There are two symbol reordering methods, "per-window symbol reordering" (described in clause 7.7.25.2) and "per-section tx-window reassignment" (described in clause 7.7.25.3). The format of SE 25 shall follow as shown in Table 7.7.25.1-1. The Section Extension 25 applies to Section Type 5 with dataDirection bit = 0 and shall only be used with Section Extension 24 which provides DMRS configuration information.

O-RU may indicate support for symbol reordering via **supported-symb-reorder-capability** as 'per-window symbol reordering with DMRS sending', 'per-window symbol reordering without DMRS sending' or 'per-section tx-window reassignment'.

When symbol reordering is supported, the O-RU and the O-DU may support interpreting symbolId in U-Plane messages as 'on-air symbol number' or 'transmission window number' or both. The 'on-air symbol number' is defined as the identifier of the symbol in a slot received in order at the air-interface of the O-RU. The transmission window number of an on-air symbol N is defined as the tx window on which U-Plane message corresponding to the on-air symbol N would have been transmitted when natural order is used, i.e. when symbol reordering is not enabled.

For all endpoints supporting symbol reordering, the O-RU reports the supported U-Plane symbolId interpretation capability, **up-symbolId-type-supported** to the O-DU, and the O-DU shall configure compatible U-Plane symbolId interpretation **config-symb-reorder-upSymbId-type** intended to be used for symbol reordering, i.e. either 'on-air symbol number' or 'transmission window number' to the O-RU. All endpoints supporting symbol reordering shall be configured with same symbolId interpretation. If the O-DU does not support a compatible option reported by O-RU, then symbol reordering shall not be enabled.

When an O-RU supports and the O-DU activates DMRS-BF, and the O-DU configures symbol reordering to be used for the DMRS beamformed PUSCH channel(s), the O-RU shall allow simultaneous use of symbol reordering by some endpoints for DMRS-BF and natural order (i.e. keeping symbols in air interface order) in other endpoints, for PUCCH or other channels using non-DMRS-BF methods. When symbol reordering is configured, all endpoints supporting DMRS-BF shall be configured with same reordering method.

Symbol reordering shall only be applied to PRBs beamformed with DMRS-BF and SINR reporting. When symbol reordering and SINR reporting is configured, symbol reordering shall be applied to both U-Plane messages and SINR reporting in the same way.

Section Extension 25 provides exactly 14 'txWinForOnAirSymbol(0-13)' values corresponding to 14 symbols that are applicable to all layers in case of per-window symbol reordering method. Section Extension 25 provides 14 'txWinForOnAirSymbol(0-13)' values corresponding to 14 symbols separately for each layer in case of per-section window reassignment method.

The field 'txWinForOnAirSymbol(0-13)' represents the transmission window within which the on-air symbol number (0-13)'s IQ data is to be transmitted in the U-Plane message from O-RU to O-DU after symbol reordering. For example, if the on-air symbol#0 IQ data will be placed in the 5th transmission window, the value of 'txWinForOnAirSymbol0' will be set to 4 (five minus one).

The capacity restrictions present for each TX window when symbol reordering is not performed remain in effect during symbol reordering. As a result, the O-DU shall adhere to the same capacity restrictions on the fronthaul per TX window as if no symbols or sections were requested to be reordered.

**Table 7.7.25.1-1: Section Extension 25 for symbol reordering**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **# of bytes** |  |
| ef | extType = 0x19 | | | | | | | 1 | Octet N |
| extLen (variable) | | | | | | | | 1 | N+1 |
| txWinForOnAirSymbol0 (1st layer/all layers) | | | | txWinForOnAirSymbol1 (1st layer/all layers) | | | | 1 | N+2 |
| ... | | | | | | | |  |  |
| txWinForOnAirSymbol12 (1st layer/all layers) | | | | txWinForOnAirSymbol13 (1st layer/all layers) | | | | 1 | N+8 |
| txWinForOnAirSymbol0 (2nd layer) | | | | txWinForOnAirSymbol1 (2nd layer) | | | | 1 | N+9 |
| ... | | | | | | | |  |  |
| txWinForOnAirSymbol12 (2nd layer) | | | | txWinForOnAirSymbol13 (2nd layer) | | | | 1 | var |
| ... | | | | | | | |  |  |
| txWinForOnAirSymbol0 (Nth layer) | | | | txWinForOnAirSymbol1 (Nth layer) | | | | 1 | var |
| ... | | | | | | | |  |  |
| txWinForOnAirSymbol12 (Nth layer) | | | | txWinForOnAirSymbol13 (Nth layer) | | | | 1 | var |
| ... | | | | | | | |  |  |
| Zero pad for 4-byte boundary | | | | | | | | 1 | var |

###### Per-window symbol reordering

When "per-window symbol reordering" method is used, all endpoints configured to use DMRS-BF shall use this method and Section Extension 25 shall be used to transplant a symbol tx-window's PRBs to a different symbol tx- window, and every tx-window shall be used only once. In this method, section descriptions of all endpoints configured for DMRS-BF shall use same symbol order within a slot. When the O-RU is configured to send port reduced DMRS symbols to the O-DU, the O-RU shall support per-window symbol reordering if any symbol reordering method is supported. The O-RU may declare that per-window symbol reordering is supported when port reduced DMRS symbols are not configured to be sent to the O-DU using the M-Plane capability parameter **supported-symb-reorder- capability**. The O-DU may choose to exercise per-window symbol reordering or not, when DMRS symbols are sent or not, at its discretion and based on the declared O-RU capabilities.

The purpose of "per-window symbol reordering" is to provide UE layer symbols to the O-DU with the DMRS symbols early in the sequence, which allows the O-DU to start its DMRS processing early. Because all DMRS-BF endpoints will use the same reordering pattern, and because different DMRS configurations locate the DMRS symbols in different time-locations, the DMRS symbols may not be strictly preceding the non-DMRS symbols.

The Figure 7.7.25.2-2 and Figure 7.7.25.2-3 show an example of U-Plane transmission timing when per-window symbol reordering is used. The Figure 7.7.25.2-1 shows an example of on-air reception of 14 symbols described using two section descriptions. Based on the SE 25 instruction as shown in Table 7.7.25.2-1, Figure 7.7.25.2-2 shows the order of U-Plane transmission after per-window symbol reordering is applied to the two sections when the U-Plane symbolId interpretation is configured as 'on-air symbol number'. As seen in the Figure 7.7.25.2-2, on-air symbols of

both section description#0 and section description#1 are transmitted in the same transmission order, which is 2, 3, 10, 11, 0, 1, 4, 5, 6, 7, 8, 9, 12, 13 and the U-Plane symbolId fields are set to same as the on-air symbol number.

![](../assets/images/f58fbb64d169.png) DMRS IQ PUSCH IQ of user group#0 PUSCH IQ of user group#1

**On-air reception**

OTA symbol number

|  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 | 12 | 13 |
| 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 | 12 | 13 |
| 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 | 12 | 13 |

OTA symbol number of PRB 0~x in section#0 OTA symbol number of PRB x+1~y in section#1

**Figure 7.7.25.2-1: On-air symbol reception**

**Symbol reordering with U-plane symbolId is on-air symbol number**

|  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 | 12 | 13 |
| 2 | 3 | 10 | 11 | 0 | 1 | 4 | 5 | 6 | 7 | 8 | 9 | 12 | 13 |
| 2 | 3 | 10 | 11 | 0 | 1 | 4 | 5 | 6 | 7 | 8 | 9 | 12 | 13 |
| 2 | 3 | 10 | 11 | 0 | 1 | 4 | 5 | 6 | 7 | 8 | 9 | 12 | 13 |
| 2 | 3 | 10 | 11 | 0 | 1 | 4 | 5 | 6 | 7 | 8 | 9 | 12 | 13 |

OTA symbol number

OTA symbol number of the IQ data in U-plane message for PRB 0~x in section#0 U-plane symbolId for PRB 0~x in section#0

OTA symbol number of the IQ data in U-plane message for PRB x+1~y in section#1 U-plane symbolId for PRB x+1~y in section#1

**Figure 7.7.25.2-2: Per-window symbol reordering method with U-Plane symbolId as on-air symbol number**

Symbol reordering with U-plane symbolId is transmission window number

|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 | 12 | 13 | OTA symbol number  OTA symbol number of the IQ data in U-plane message for PRB 0~x in section#0 U-plane symbolId for PRB 0~x in section#0  OTA symbol number of the IQ data in U-plane message for PRB x+1~y in section#1  U-plane symbolId for PRB x+1~y in section#1 |
| 2 | 3 | 10 | 11 | 0 | 1 | 4 | 5 | 6 | 7 | 8 | 9 | 12 | 13 |
| 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 | 12 | 13 |
| 2 | 3 | 10 | 11 | 0 | 1 | 4 | 5 | 6 | 7 | 8 | 9 | 12 | 13 |
| 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 | 12 | 13 |

**Figure 7.7.25.2-3: Per-window symbol reordering method with U-Plane symbolId as transmission window number**

When the U-Plane symbolId interpretation is configured as 'transmission window number', the IQ data is transmitted in the order configured by the SE25, i.e. on-air symbol numbers 2, 3, 10, 11, 0, 1, 4, 5, 6, 7, 8, 9, 12, 13, but the U-Plane

symbolId field is set to transmission window number, i.e. 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13 respectively as shown

in Figure 7.7.25.2-3.

When using per-window symbol reordering, all layers of all UEs in all user groups using DMRS-BF in a slot shall be reordered in the same order regardless of use of SE10. Therefore, for per-window symbol reordering, Section Extension 25 shall contain information pertaining to reordering once for all layers and all symbols in the slot 'txWinForOnAirSymbol(0~13)' as shown in the example Table 7.7.25.2-1.

If a symbol is not referenced by any ST 5 section description with SE 24 within the slot, then the corresponding 'txWinForOnAirSymbol' field in SE 25 shall be set to 0xF, which means no symbol reordering information is provided for that on-air symbol. txWinForOnAirSymbol = 0xF provides no information to indicate that the corresponding TX window is occupied or not occupied.

When a C-Plane message has multiple sections, to avoid the wastage of bandwidth and the O-RU processing, there shall only be one Section Extension 25 appended with the first section using SE 24 in the C-Plane message, other section

descriptions using SE 24 shall apply the same symbol reordering, i.e. the first SE 25 shall include reordering information for all symbols in the slot.

When multiple C-Plane messages are scheduled in a slot, every C-Plane message's first section description using SE 24 shall include a Section Extension 25 which is used by all the section descriptions using SE 24 in the message. The SE 25 shall include reordering information for all symbols in the slot and shall be the same in every C-Plane message.

**Table 7.7.25.2-1: Example of SE 25 for per-window symbol reordering method**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **Extension Type 25 for Section Id=0 and 1** | | | | | | | | | |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **# of bytes** |  |
| ef | extType = 0x19 | | | | | | | 1 | Octet N |
| extLen = 0x03 | | | | | | | | 1 | N+1 |
| txWinForOnAirSymbol0 (all layers) = 4 | | | | txWinForOnAirSymbol1 (all layers) = 5 | | | | 1 | N+2 |
| txWinForOnAirSymbol2 (all layers) = 0 | | | | txWinForOnAirSymbol3 (all layers) = 1 | | | | 1 | N+3 |
| ... | | | | | | | |  |  |
| txWinForOnAirSymbol10 (all layers) = 2 | | | | txWinForOnAirSymbol11 (all layers) = 3 | | | | 1 | N+7 |
| txWinForOnAirSymbol12 (all layers) = 12 | | | | txWinForOnAirSymbol13 (all layers) = 13 | | | | 1 | N+8 |
| Zero pad for 4-byte boundary | | | | | | | | 3 | N+9 |

###### Per-section tx-window reassignment

When "per-section tx-window reassignment" method is used, the U-Plane symbolId interpretation shall be configured as 'on-air symbol number' and the symbolId in U-Plane message shall be interpreted as on-air symbol number. The O-DU may request to rearrange the PRBs of each U-Plane section in different order to prioritize some U-Plane sections (UE- layers) or to expedite the transmission by overloading the PRBs from more than one on-air symbol into a transmission window if permitted by the available fronthaul bandwidth. When SE 25 is used to expedite the transmission, the O-DU shall ensure that the tx-window of the O-RU is not overloaded with more U-Plane data than is possible to fit in that tx- window identified e.g. using number of layers or spatial streams and scheduled PRBs. If a symbol is not referenced by the section description with SE 24, the corresponding 'txWinForOnAirSymbol' field in SE 25 shall be set to 0xF, which means no symbol reordering information is provided for that on-air symbol in this SE 25 instance.

When "per-section tx-window reassignment" is supported, the O-RU shall report the maximum number of unique symbol reassignment patterns supported per slot per rx-array-carrier using the capability parameter **max-num-symbol- reordering-pattern-per-slot** to the O-DU. The O-DU shall ensure that total number of different reassignment patterns per slot is no more than the value of **max-num-symbol-reordering-pattern-per-slot**.

When Section Extension 25 is combined with Section Extension 10, and multiple UEs are scheduled, the number of layers in Section Extension 25 shall be equal to the number of ueIds. Every layer has its own tx-window reassignment information, which means a higher priority UE can have a low latency transmission.

NOTE: When the O-DU will execute equalization, all UE-layers in each user group are expected to be co- processed so the same order is likely needed for every UE-layer in each user group.

Figure 7.7.25.3-2 shows an example of per-section tx-window reassignment usage for UE prioritization use case. The order of the air reception symbols for the two sections are shown in Figure 7.7.25.3-1, and the U-Plane transmission timing of those on-air symbols after tx-window reassignment is applied according to Table 7.7.25.3-1 (section extension 25 contents are different in sectionId#0 and sectionId#1) is shown in Figure 7.7.25.3-2. The U-Plane messages corresponding to sectionId#0 are transmitted on the transmission window of the first 7 symbols and sectionId#1 are transmitted on the transmission window of the last 7 symbols, which means the U-Plane messages corresponding to sectionId#0 transmission will be completed 7 symbols in advance compared with the nature order. For simplicity, only one layer is shown in the example, but SE 25 can provide tx-window reassignment for multiple layers and each layer can be reordered differently.

![](../assets/images/d8336a0bb20a.png)DMRS IQ or OTA symbol number ![](../assets/images/0ef1eadaf12f.png) PUSCH IQ or OTA symbol number of user group#0

PUSCH IQ or OTA symbol number of user group#1

**On-air reception**

OTA symbol number

|  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 | 12 | 13 |
| 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 | 12 | 13 |
| 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 | 12 | 13 |

OTA symbol number of PRB 0~x in section#0 OTA symbol number of PRB x+1~y in section#1

**Figure 7.7.25.3-1: On-air symbol reception**

**Symbol reordering for UE prioritization**

|  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 | 12 | 13 |
| 2 | 0 | 3 | 5 | 7 | 9 | 12 | 2 | 10 | 0 | 4 | 6 | 8 | 12 |
| 2 | 0 | 3 | 5 | 7 | 9 | 12 | 2 | 10 | 0 | 4 | 6 | 8 | 12 |
| 11 | 1 | 4 | 6 | 8 | 10 | 13 | 3 | 11 | 1 | 5 | 7 | 9 | 13 |
| 11 | 1 | 4 | 6 | 8 | 10 | 13 | 3 | 11 | 1 | 5 | 7 | 9 | 13 |

PRB 0~x for section#0 PRB x+1~y for section#1

OTA symbol number

OTA symbol number of the IQ data in U-plane message U-plane symbolId

OTA symbol number of the IQ data in U-plane message U-plane symbolId

**Figure 7.7.25.3-2: A UE prioritization use case of per-section tx-window reassignment method**

**Table 7.7.25.3-1: A UE prioritization use case of per-section tx-window reassignment method**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **Extension Type 25 for Section Id=0** | | | | | | | | | |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **# of bytes** |  |
| ef | extType = 0x19 | | | | | | | 1 | Octet N |
| extLen = 0x03 | | | | | | | | 1 | N+1 |
| txWinForOnAirSymbol0 (1st layer) = 1 | | | | txWinForOnAirSymbol1 (1st layer) = 1 | | | | 1 | N+2 |
| txWinForOnAirSymbol2 (1st layer) = 0 | | | | txWinForOnAirSymbol3 (1st layer) = 2 | | | | 1 | N+3 |
| ... | | | | | | | |  |  |
| txWinForOnAirSymbol10 (1st layer) = 5 | | | | txWinForOnAirSymbol11 (1st layer) = 0 | | | | 1 | N+7 |
| txWinForOnAirSymbol12 (1st layer) = 6 | | | | txWinForOnAirSymbol13 (1st layer) = 6 | | | | 1 | N+8 |
| Zero pad for 4-byte boundary | | | | | | | | 3 | N+9 |
| **Extension Type 25 for Section Id=1** | | | | | | | | | |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **# of bytes** |  |
| ef | extType = 0x19 | | | | | | | 1 | Octet N |
| extLen = 0x03 | | | | | | | | 1 | N+1 |
| txWinForOnAirSymbol0 (1st layer) = 9 | | | | txWinForOnAirSymbol1 (1st layer) = 9 | | | | 1 | N+2 |
| txWinForOnAirSymbol2 (1st layer) = 7 | | | | txWinForOnAirSymbol3 (1st layer) = 7 | | | | 1 | N+3 |
| ... | | | | | | | |  |  |
| txWinForOnAirSymbol10 (1st layer) = 8 | | | | txWinForOnAirSymbol11 (1st layer) = 8 | | | | 1 | N+7 |
| txWinForOnAirSymbol12 (1st layer) = 13 | | | | txWinForOnAirSymbol13 (1st layer) = 13 | | | | 1 | N+8 |
| Zero pad for 4-byte boundary | | | | | | | | 3 | N+9 |

Figure 7.7.25.3-4 shows the example of per-section tx-window reassignment usage for multiple layers prioritization use case. The two layers in sectionId#0 belong to two users in a MU-MIMO user group. The order of the air reception symbols are shown in Figure 7.7.25.3-3, and the U-Plane transmission timing of those on-air symbols after tx-window reassignment is applied according to Table 7.7.25.3-2 is shown in Figure 7.7.25.3-4. This case is similar with the UE

prioritization one, but it is the layer transmission tx-window reassignment within a section description. After tx-window reassignment, the U-Plane messages corresponding to layer#0 transmission will be completed earlier.

**On-air reception**

|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 | 12 | 13 | OTA symbol number  OTA symbol number of layer#0 in section#0 OTA symbol number of layer#1 in section#0 |
| 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 | 12 | 13 |
| 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 | 12 | 13 |

**Figure 7.7.25.3-3: On-air symbol reception**

**Symbol reordering for UE layer prioritization**

|  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 | 12 | 13 |
| 2 | 0 | 3 | 5 | 7 | 9 | 12 | 2 | 0 | 3 | 5 | 7 | 9 | 12 |
| 2 | 0 | 3 | 5 | 7 | 9 | 12 | 2 | 0 | 3 | 5 | 7 | 9 | 12 |
| 11 | 1 | 4 | 6 | 8 | 10 | 13 | 11 | 1 | 4 | 6 | 8 | 10 | 13 |
| 11 | 1 | 4 | 6 | 8 | 10 | 13 | 11 | 1 | 4 | 6 | 8 | 10 | 13 |

Layer#0 for section#0 Layer#1 for section#0

OTA symbol number

OTA symbol number of the IQ data in U-plane message U-plane symbolId

OTA symbol number of the IQ data in U-plane message U-plane symbolId

**Figure 7.7.25.3-4: A UE layer prioritization use case of per-section tx-window reassignment method Table 7.7.25.3-2: A UE layer prioritization use case of per-section tx-window reassignment method**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **Extension Type 25 for Section Id=0** | | | | | | | | | |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **# of bytes** |  |
| ef | extType = 0x19 | | | | | | | 1 | Octet N |
| extLen = 0x04 | | | | | | | | 1 | N+1 |
| txWinForOnAirSymbol0 (1st layer) = 1 | | | | txWinForOnAirSymbol1 (1st layer) = 1 | | | | 1 | N+2 |
| txWinForOnAirSymbol2 (1st layer) = 0 | | | | txWinForOnAirSymbol3 (1st layer) = 2 | | | | 1 | N+3 |
| ... | | | | | | | |  |  |
| txWinForOnAirSymbol10 (1st layer) = 5 | | | | txWinForOnAirSymbol11 (1st layer) = 0 | | | | 1 | N+7 |
| txWinForOnAirSymbol12 (1st layer) = 6 | | | | txWinForOnAirSymbol13 (1st layer) = 6 | | | | 1 | N+8 |
| txWinForOnAirSymbol0 (2nd layer) = 8 | | | | txWinForOnAirSymbol1 (2nd layer) = 8 | | | | 1 | N+9 |
| txWinForOnAirSymbol2 (2nd layer) = 7 | | | | txWinForOnAirSymbol3 (2nd layer) = 9 | | | | 1 | N+10 |
| ... | | | | | | | |  |  |
| txWinForOnAirSymbol10 (2nd layer) = 12 | | | | txWinForOnAirSymbol11 (2nd layer) = 7 | | | | 1 | N+14 |
| txWinForOnAirSymbol12 (2nd layer) = 13 | | | | txWinForOnAirSymbol13 (2nd layer) = 13 | | | | 1 | N+15 |

Figure 7.7.25.3-6 shows an example of per-section tx-window reassignment usage for low-latency transmission. It allows the O-RU to send PRB ranges earlier than they would otherwise have been sent. As illustrated in Figure 7.7.25.3-5, there is only one section, and only 50% of the PRB is allocated i.e. 50% of the fronthaul bandwidth is not utilized. With per-section tx-window reassignment, otherwise unutilized fronthaul bandwidth can be utilized for reducing latency of the U-Plane transmission. When per-section tx-window reassignment is applied based on the SE 25 format shown in Table 7.7.25.3-3, the U-Plane transmission latency is reduced, because all the U-Plane messages are transmitted completely by the end of the tx window corresponding to the on-air symbol number 6 as shown in

Figure 7.7.25.3-6.

![](../assets/images/0f5aac4f1277.png)DMRS ![](../assets/images/c339b76bc4f9.png) PUSCH user data of user group#0 ![](../assets/images/6dbe0b62eb47.png) Empty PRBs

**On-air reception**

OTA symbol number

|  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 | 12 | 13 |
| 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 | 12 | 13 |
| 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 | 12 | 13 |

OTA symbol number of PRB 0~x in section#0 Unused PRBs y~z

NOTE: The value z-y should equal or exceed x to assure the tx-window is not overloaded

**Figure 7.7.25.3-5: On-air symbol reception**

**Symbol reordering for low-latency transmission**

|  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 | 12 | 13 |
| 2 | 0 | 3 | 5 | 7 | 9 | 12 |  |  |  |  |  |  |  |
| 2 | 0 | 3 | 5 | 7 | 9 | 12 |  |  |  |  |  |  |  |
| 11 | 1 | 4 | 6 | 8 | 10 | 13 |  |  |  |  |  |  |  |
| 11 | 1 | 4 | 6 | 8 | 10 | 13 |  |  |  |  |  |  |  |

PRB 0~x for section#0

OTA symbol number

OTA symbol number of the IQ data in U-plane message U-plane symbolId

OTA symbol number of the IQ data in U-plane message U-plane symbolId

**Figure 7.7.25.3-6: A Low-latency transmission use case of per-section tx-window reassignment method**

**Table 7.7.25.3-3: A Low-latency transmission use case of per-section tx-window reassignment method**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **Extension Type 25 for Section Id=0** | | | | | | | | | |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **# of bytes** |  |
| ef | extType = 0x19 | | | | | | | 1 | Octet N |
| extLen = 0x03 | | | | | | | | 1 | N+1 |
| txWinForOnAirSymbol0 (1st layer) = 1 | | | | txWinForOnAirSymbol1 (1st layer) = 1 | | | | 1 | N+2 |
| txWinForOnAirSymbol2 (1st layer) = 0 | | | | txWinForOnAirSymbol3 (1st layer) = 2 | | | | 1 | N+3 |
| ... | | | | | | | |  |  |
| txWinForOnAirSymbol10 (1st layer) = 5 | | | | txWinForOnAirSymbol11 (1st layer) = 0 | | | | 1 | N+7 |
| txWinForOnAirSymbol12 (1st layer) = 6 | | | | txWinForOnAirSymbol13 (1st layer) = 6 | | | | 1 | N+8 |
| Zero pad for 4-byte boundary | | | | | | | | 3 | N+9 |

###### txWinForOnAirSymbol(0-13) (tx window for on-air symbol)

**Description:** This clause describes the definition of 14 different parameters txWinForOnAirSymbol0, txWinForOnAirSymbol1, ..., and txWinForOnAirSymbol13. These parameters indicate the transmission window within which the specific on-air symbol number's IQ data is transmitted in the U-Plane message from O-RU to O-DU after symbol reordering. For example, if the on-air symbol#0 IQ data will be placed in the 5th transmission window, the first value of txWinForOnAirSymbol0 will be 4 (five minus one).

For cases where the addressed numerology of the air interface utilizes extended cyclic prefix whose frame structure is limited to 12 symbols within a slot, the field txWinForOnAirSymbol shall be restricted to the value range (0000b- 1011b), however, including 0xF which shall be applied to the fields txWinForOnAirSymbol12 and txWinForOnAirSymbol13. The SE 25 structure remains unchanged in extended and normal cyclic prefix cases.

**Value range**:{0000b-1101b, 1111b}. For normal cyclic prefix frame structures.

{0000b-1011b, 1111b}. For extended cyclic prefix frame structures.

1111b means no reordering information is provided for the corresponding on-air symbol and 1110b is reserved.

**Type**: unsigned integer.

**Field length**: 4 bits.

#### SE 26: Frequency offset feedback

###### Overview

This Section Extension is used with Section Type 5 to deliver the UE frequency offset from the O-DU to the O-RU and is valid only when dataDirection bit = 0 and when SE 24 is present and SE 24 shall precede SE 26. The O-RU derives frequency offset value for channel estimation using the received value and the estimated value. The format of SE 26 is defined in Table 7.7.26.1-1.

The motivation of Section Extension 26 is to improve the performance of DMRS channel estimation. In some scenarios, the O-RU cannot estimate and compensate the UE frequency offset. When the O-RU declares support of Section Extension 26 using M-Plane capability reporting, the O-DU should deliver UE frequency offset information to the O- RU using SE 26 and the O-RU can use the received value to optimize the frequency offset estimation. The O-DU intending to use SE 26 to deliver UE frequency offset information shall configure the M-Plane parameter **se26-usage- enabled** = TRUE.

When Section Extension 26 is used in combination with Section Extension 10, the value of 'numFoFb' shall equal to the total number of UEs described in the section description and SE 26 shall use same order of UEs as in SE 10. A UE can be identified by the most-significant bits of ueId (refer to 12.6.1.3.1 for more details). In instances where a UE is described multiple times within SE 10, the first occurrence shall be used to establish the order, and the Nth freqOffsetFb shall be associated with the Nth UE described in the section description. When SE 26 is used without SE 10, then the value of 'numFoFb' shall be equal to 1.

In a given slot, when O-DU provides freqOffsetFb value for a given UE, O-RU can assume same value applies for that UE if the same UE is described in other section descriptions in the same slot. In other words, when a UE is described in multiple section descriptions with SE 26, the O-DU shall provide same frequency offset value for that UE.

**Table 7.7.26.1-1: Section Extension 26 for Frequency offset feedback**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **# of bytes** |  |
| ef | extType = 0x1A | | | | | | | 1 | Octet N |
| extLen = 0x01 | | | | | | | | 1 | N+1 |
| reserved | | | | | | | | 1 | N+2 |
| reserved | numFoFb[6:0] | | | | | | | 1 | N+3 |
| 1st freqOffsetFb | | | | | | | | 2 | N+4 |
| 2nd freqOffsetFb | | | | | | | | 2 | N+6 |
| ... | | | | | | | |  |  |
| (numFoFb)th freqOffsetFb | | | | | | | | 2 | var |
| zero padding to 4-byte boundary | | | | | | | | var | var |

###### numFoFb (number of frequency offset feedback)

**Description:** This parameter defines the number of frequency offset feedback values indicated by the Section Extension.

**Value range**: {000 0001b -111 1110b}. 000 0000b and 111 1111b are reserved.

**Type:** unsigned integer.

**Field length:** 7 bits.

###### freqOffsetFb (UE frequency offset feedback)

**Description:** This parameter defines the UE frequency offset. The unit is 2(u-2) Hz where u represents the subcarrier spacing configuration. For example, 30 kHz SCS has u=1, which gives resolution of 0.5 Hz. The range of frequency offset is +- 0.5 subcarrier spacing.

**Value range**: {0x0000 (0): no frequency offset

0x0001 (+1) - 0x7530 (+30 000): positive frequency offset, (0, +0.5] subcarrier

0x8AD0 (-30 000) - 0xFFFF (-1): negative frequency offset, [-0.5, 0) subcarrier 0x8000 (-32768): value not provided

Other values: reserved}

**Type**: signed integer.

**Field length**: 16 bits.

#### SE 27:O-DU controlled dimensionality reduction

###### Overview

This Section Extension may be used in Section Type 5 C-Plane messages addressing endpoints configured for DMRS- BF to control the dimensionality reduction applied by the O-RU for DMRS-BF. The configuration conveyed in this Section Extension depends on values of parameter beamType and numElements. For beamType = 00b or 01b the Section Extension conveys a list of N beamId values or a range of N consecutive beamId values respectively and is an instruction for the O-RU to use the beamId values (conveyed as a list or a range) to reduce the dimension of input for DMRS-BF from K to N where N = numElements if numElements > 0 and N = 256 otherwise and K is the number of array elements.

The format of this Section Extension is presented in Table 7.7.27.1-1 and Table 7.7.27.1-2 for beamType = 00b and beamType = 01b respectively.

**Table 7.7.27.1-1: Section Extension 27 for beamType = 00b**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **# of bytes** | **Octet** |
| ef | extType = 0x1B | | | | | | | 1 | N |
| extLen | | | | | | | | 1 | N+1 |
| beamType[1:0] = 00b | | reserved | | | | | | 1 | N+2 |
| numElements[7:0] | | | | | | | | 1 | N+3 |
| reserved | 1st beamId[15:0] | | | | | | | 2 | N+4 |
| reserved | 2nd beamId[15:0] | | | | | | | 2 | N+6 |
| ... | | | | | | | | var |  |
| reserved | The last beamId[15:0] | | | | | | | 2 |  |
| zero padding to 4-byte boundary (NOTE 1) | | | | | | | | 0/2 |  |
| NOTE 1: The zero padding to 4-byte boundary is used only if the numElements is odd. | | | | | | | | | |

**Table 7.7.27.1-2: Section Extension 27 for beamType = 01b**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **# of bytes** | **Octet** |
| ef | extType = 0x1B | | | | | | | 1 | N |
| extLen | | | | | | | | 1 | N+1 |
| beamType[1:0] = 01b | | reserved | | | | | | 1 | N+2 |
| numElements[7:0] | | | | | | | | 1 | N+3 |
| reserved | 1st beamId[15:0] | | | | | | | 2 | N+4 |
| zero padding to 4-byte boundary | | | | | | | | 2 | N+6 |

The O-RU reports over M-Plane support for static and/or dynamic control of dimensionality reduction (M-Plane parameter se-27-odu-controlled-dimensionality-reduction-supported), support for omitting SE 27 when control of dimensionality reduction is enabled (M-Plane parameter se-27-omission-when-enabled-supported) and a list of supported values of numElements parameter per number of UE data layers scheduled in user group (M-Plane parameter supported-se-27-configurations).

If the O-RU supports and the O-DU enables static use of Section Extension 27 via M-Plane parameter se-27-odu- controlled-dimensionality-reduction-enabled set to STATIC, then the O-DU shall set M-Plane parameter se-27-num- elements to one of the values supported by the O-RU and the O-DU shall send Section Extension 27 in every section description of Section Type 5 used for DMRS-BF with numElements set to the configured value of se-27-num- elements. If the O-RU supports omission of SE 27 then the O-DU may disable the control of dimensionality reduction by omitting SE 27 from the section description.

If the O-RU supports and the O-DU enables dynamic use of this Section Extension via M-Plane parameter se-27-odu- controlled-dimensionality-reduction-enabled set to DYNAMIC, then the O-DU shall send this Section Extension in every section description of Section Type 5 used for DMRS-BF with numElement set to one of the values supported by the O-RU. If the O-RU supports omission of SE 27 then the O-DU may disable the control of dimensionality reduction by omitting SE 27 from the section description.

When beamType = 00b the Section Extension 27 conveys a list of beamId values. The number of beamId values in the list is N where N = numElements if numElements > 0 and N = 256 otherwise (i.e. numElements = 1 indicates one beamId value, numElements = 0 indicates 256 beamId values, etc.).

When beamType = 01b the Section Extension 27 conveys a range of beamId values. In this case, the first beamId value included in the Section Extension and the O-RU shall use beams identified by a range of N consecutive beamId values starting with the beamId value conveyed in the Section Extension where N = numElements if numElements > 0 and N = 256 otherwise (i.e. beamId, beamId+1, beamid+2, ..., beamId+N-1).

The O-RU receiving this Section Extension in a section description of Section Type 5 C-Plane message shall apply the instruction conveyed in this Section Extension for a cross section of the symbols and PRBs associated with the section description for DMRS-BF reception of all layers in the user group represented by the section description.

###### beamType

**Description**: This parameter determines the type of beam configuration conveyed in Section Extension 27.

* 00b - Section Extension 27 conveys a list of beamId values.
* 01b - Section Extension 27 conveys a range of beamId values. Meaning of values of **beamType** is specified in clause 7.7.27.1.

**Value range**: {0 - 1, other values reserved}.

**Type:** unsigned integer.

**Field length:** 2 bits.

###### numElements (number of elements)

**Description**: This parameter determines number of beamId values to be used for input signal dimensionality reduction for DMRS-BF from K (number of array elements) to N where N = numElements if numElements > 0 and N = 256 otherwise. Meaning of value of numElements is specified in clause 7.7.27.1.

**Value range**: {0 - 255}. **Type:** unsigned integer. **Field length:** 8 bits.

###### beamId

**Description**: This parameter identifies a beam that shall be used for reducing input signal dimensions for DMRS-BF. See clause 7.5.3.9 for further details of the value format.

#### SE 28: O-DU controlled frequency resolution for SINR reporting

###### Overview

Section Extension 28 is used with Section Type 5 to indicate the SINR frequency resolution values to be used by the O- RU for SINR reporting, and is valid only when dataDirection bit = 0 and when SE 24 is present. Use of SE 28 with other Section Extensions is not restricted except for the restrictions following from the fact that SE 28 is used exclusively with SE 24 (the restrictions on use of SE 24 with other Section Extensions are specified in clause 7.7.24.2).

The SINR frequency resolution values provided in SE 28 by the O-DU may be determined based on, for example, number of scheduled layers, MCS, fronthaul bandwidth, etc. The value of 'numSinrPerPrb' shall be constrained by the **supported-sinr-resolutions** list declared by the O-RU via M-Plane. When SE 28 is used, the O-DU shall configure the same SINR frequency resolution values for all scheduled layers belonging to the same UE within a user group and across multiple user groups if the UE allocation spans multiple user groups. The O-RU shall use the configured SINR frequency resolution value to report SINR. See clause 7.2.11 for further details on SINR reporting.

If the capability of O-DU controlled frequency resolution for SINR reporting (refer to M-Plane parameter **dynamic- sinr-per-prb-supported**) is supported by the O-RU, and enabled by the O-DU (refer to M-Plane parameter **dynamic- sinr-per-prb-enabled**), the O-DU may send this Section Extension with SE 24 (for PUSCH DMRS configuration) to indicate the frequency resolution values for SINR reporting.

The O-RU may declare if different frequency resolution values for SINR reporting are supported for different users in a user group (refer to M-Plane parameter **diff-freq-resolutions-supported**). If it is not supported, only one numSinrPerPrb value shall be present in this Section Extension, and numUeSinrRpt value shall be equal to 1 which means the SINR frequency resolution value shall be applied to all UEs in the user group. If it is supported, different

users may be configured with different SINR frequency resolution values. SE 28 may provide numSinrPerPrb per UE, and the order of the numSinrPerPrb values in SE 28 shall be the same as the order of the UEs described in the section description. In instances where a UE is described multiple times within a section description (e.g. via SE10), the first occurrence shall be used to establish the order.If block size is supported by the O-RU and is configured by the O-DU, then the number of SINR values in SE 28 shall be less than or equal to the block size configured by the O-DU. The O- RU shall report SINR using Section Type 9 with value of 'numSinrPerPrb' when SE 28 is sent.

The format of SE 28 is defined in Table 7.7.28.1-1. The number of numSinrPerPrb in the Section Extension is indicated by the value of numUeSinrRpt. If the numUeSinrRpt value is an odd number, the least significant 4 bits field in the byte which contains the last numSinrPerPrb shall be set to zero. For example, when numUeSinrRpt equals to 1, the least significant 4-bit filed in the (N+3)th byte shall be set to zero.

**Table 7.7.28.1-1 Format of Section Extension 28**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **# of bytes** |  |
| ef | extType = 0x1C | | | | | | | 1 | Octet N |
| extLen = var | | | | | | | | 1 | N+1 |
| reserved | | | numUeSinrRpt | | | | | 1 | N+2 |
| reserved | numSinrPerPrb[2:0] of 1st UE | | | reserved | numSinrPerPrb[2:0] of 2nd UE | | | 1 | N+3 |
| ... | | | | | | | | var | var |
| .. | | | | reserved | numSinrPerPrb[2:0] of last UE | | | var | var |
| zero padding to ensure 4-byte boundary | | | | | | | | var | var |

###### numUeSinrRpt (number of sinr reported UEs)

**Description:** This parameter defines the number of numSinrPerPrb in Section Extension 28.

**Value range:** {1 - 12}. Others are reserved.

**Type:** unsigned integer.

**Field length:** 5 bits.

## Aspects of C-Plane operation

#### Coupling of C-Plane and U-Plane

###### Overview

Selected types of C-Plane messages (Section Types 1, 3 and 5) carry data section descriptions that convey information applicable to data sections carried in U-Plane messages. This clause describes a method of coupling data section descriptions from C-Plane and data sections in U-Plane.

###### Coupling via sectionId value

This method of C-Plane and U-Plane coupling shall be used by default. The O-DU may configure the O-RU to use the other methods via the M-Plane. In this method, information from section description D in C-Plane message CM is applied to resource element R in PRB P (PRB is understood as 12 resource elements of one OFDM symbol consecutive in frequency) in data section S in U-Plane message UM if:

1. CM corresponds to UM i.e. both have the same eAxC\_ID and CM.**dataDirection** value matches direction of UM.
2. CM.**frameId** = UM.**frameId** and CM.**subframeId** = UM.**subframeId** and CM.**slotId** = UM.**slotId**.
3. symbol identified by UM.**symbolId** is described by the section description D.

This requires evaluation of CM.**startSymbolId**, **symInc** and **numSymbol** in CM or checking D.**symbolMask** in Section Extension 6 , 12 or 19 if any of the extensions is present.

1. PRB P is described by the section description D. This requires checking that D.**startPrbc** <= P < (D.**startPrbc**

+ D.**numPrbc ?** (D.**rb** + 1)), if D.**rb** = 1 checking that D.**startPrbc** modulo 2 = P modulo 2; it requires evaluating D.**rbgMask** in Section Extension 6 if this extension is present in D. Checking Section Extension 12, 13, 19 and 20 is required if any of them is present in D.

1. D.**reMask** has value 1 in a bit corresponding to RE R. Checking effect of Section Extension 20 is required if this extension is present in D.
2. D.**sectionId** = S.**sectionId.**

In addition, the following requirements and restrictions apply (in the context of one eAxC):

1. If a PRB is present in a U-Plane message, the PRB shall occur only once across all U-Plane messages related to the same OFDM symbol.
2. A resource element shall be "referenced" (see conditions 3, 4 and 5 above) by one section description.
3. All section descriptions that are applicable to a PRB (see conditions 3 and 4 above) shall have same value of sectionId.
4. Section descriptions that are not applicable to same PRB (see conditions 3 and 4 above) shall have different value of sectionId.
5. The O-DU shall send in sectionId a value that is unique within a slot.
6. Section descriptions that have the same value of sectionId shall have same value of **rb**, **startPrbc**, **numPrbc**

and **numSymbol**.

###### Coupling via frequency and time

This coupling method shall be used if a corresponding capability is reported by the O-RU via the M-Plane and use of this coupling method for an eAxC is configured via the M-Plane. In this method, information from section description D in C-Plane message CM is applied to resource element R in PRB P (PRB is understood as 12 resource elements of one OFDM symbol consecutive in frequency) in data section S in U-Plane message UM if:

1. CM corresponds to UM i.e. both have the same eAxC\_ID and CM.**dataDirection** value matches direction of UM.
2. CM.**frameId** = UM.**frameId** and CM.**subframeId** = UM.**subframeId** and CM.**slotId** = UM.**slotId**.
3. Symbol identified by UM.**symbolId** is described by the section description D.

This requires evaluation of CM.startSymbolId, symInc and numSymbol in CM or checking D.symbolMask in Section Extension 6, 12 or 19 if any of the extensions is present.

1. PRB P is described by the section description D. This requires checking that

D.**startPrbc** <= P < (D.**startPrbc** + D.**numPrbc ?** (D.**rb** + 1)), if D.**rb** = 1 checking that D.**startPrbc** modulo 2

= P modulo 2; it requires evaluating D.**rbgMask** in Section Extension 6 if this extension is present in D. Checking Section Extension 12, 13, 19 and 20 is required if any of them is present in D.

1. D.**reMask** has value 1 in a bit corresponding to RE R. Checking effect of Section Extension 20 is required if this extension is present in D.

In addition, the following requirements and restrictions apply (in context of one eAxC):

1. If a PRB is present in a U-Plane message, the PRB shall occur only once across all U-Plane messages related to the same OFDM symbol.
2. A resource element shall be "referenced" (see conditions 3, 4 and 5 above) by one section description.
3. The O-DU shall send in sectionId a value 4095.
4. The O-DU shall order section descriptions within a C-Plane message such that any section descriptions referencing to any RE (non-zero value of reMask) are present before section descriptions that do not reference any RE (i.e. zero value in reMask). This allows O-RU to more quickly identify section descriptions that carry beamforming configuration for any RE and makes them localized in memory which can improve message processing performance.

###### Coupling via frequency and time with priorities

This coupling method shall be used if a corresponding capability is reported by the O-RU via the M-Plane and use of this coupling method for an eAxC is configured via the M-Plane. In this method information from section description D in C-Plane message CM is applied to resource element R in PRB P (PRB is understood as 12 resource elements of one OFDM symbol consecutive in frequency) in data section S in U-Plane message UM if:

1. CM corresponds to UM i.e. both have the same eAxC\_ID and CM.**dataDirection** value matches direction of UM.
2. CM.**frameId** = UM.**frameId** and CM.**subframeId** = UM.**subframeId** and CM.**slotId** = UM.**slotId**.
3. symbol identified by UM.**symbolId** is described by the section description D.

This requires evaluation of CM.startSymbolId, symInc and numSymbol in CM or checking D.symbolMask in Section Extension 6, 12 or 19 if any of the extensions is present.

1. PRB P is described by the section description D. This requires checking that D.**startPrbc** <= P < (D.**startPrbc**

+ D.**numPrbc ?** (D.**rb** + 1)), if D.**rb** = 1 checking that D.**startPrbc** modulo 2 = P modulo 2; it requires evaluating D.**rbgMask** in Section Extension 6 if this extension is present in D. Checking Section Extension 12, 13, 19 and 20 is required if any of them is present in D.

1. D.**reMask** has value 1 in a bit corresponding to RE R and D has highest priority among data section descriptions referencing the RE R in the message CM. Checking effect of Section Extension #20 is required if this extension is present in D. Priority of data section description is the value of priority field in Section Extension 6 (see clause 7.7.6.4), 12 (see clause 7.7.12.1) or 19 (see clause 7.7.12.1) if any of the extensions is present in D and zero if the extensions are absent. The scope of search for highest priority description is restricted to one C-Plane message to avoid beamforming configuration errors that would be unavoidable if scope would be covering multiple messages and one of them would be lost. See also note in restriction #3 below.

In addition, the following requirements and restrictions apply (in context of one eAxC):

1. If a PRB is present in a U-Plane message, the PRB shall occur only once across all U-Plane messages related to the same OFDM symbol.
2. Data section descriptions that refer to the same RE and are conveyed in the same C-Plane message shall have different priority in order to avoid ambiguity.
3. If a complete beamforming configuration does not fit into one C-Plane message, then sender shall duplicate highest priority data section descriptions, specifically each C-Plane message shall contain the highest priority section description referring to any RE that is referred in a message. This is required to ensure that O-RU will interpret configuration received in each message correctly. If such duplication is needed to avoid misinterpretation it does not violate restriction #4 below. Optionally, each C-Plane message can also contain highest priority data section description(s) referring to REs that are not referred to by non-highest priority data section description(s) in a message. As an alternate to duplicating highest priority section descriptions, Section Extension 20 can be used (refer to clause 7.7.20, and clause 7.9.12 for more details).
4. Sender shall avoid sending data section descriptions which are not necessary e.g. descriptions that carry the same configuration (but refer to the requirement #3 above). An example (relevant only when optional

restriction on sending of beamforming weights is used, see clause 12.4.3.2) of a necessary section description would be a high priority section description containing scheduling decisions and beamforming weights that completely fills a message, thereby requiring a second C-Plane message containing the same high priority section description (scheduling decision) but without beamforming weights (just beamIds).

1. The O-DU shall send in sectionId a value 4095.
2. The O-DU shall order section descriptions within a C-Plane message such that any section descriptions referring to any RE (non-zero value of reMask) are present before section descriptions that do not reference any RE (i.e. zero value in reMask); section descriptions referring to any RE shall be ordered by effective priority (highest priority first). Ordering section descriptions with non-zero reMask first allows the O-RU to more quickly identify section descriptions that carry beamforming configuration for any RE and also makes them localized in memory which can improve message processing performance. Ordering section descriptions by highest priority first is intended to optimize O-RU C-Plane message processing i.e. RE beamforming configuration can be determined from the earliest section description occurring in the message.

###### Coupling via frequency and time with priorities (optimized)

All the requirements and restrictions remain the same as "coupling via frequency and time with priorities" as described in clause 7.8.1.4 except requirement #5, which is replaced with:

5) The O-DU shall send in sectionId value 4095 for section description with lower priority. For highest priority sections unique sectionIds shall be set in a defined range starting from "0" to "max-highest-priority-sections- per-slot" specified through M-Plane, this sectionId range shall be per endpoint. For endpoints belonging to the same capacity sharing group, the number of used highest priority sections over all such endpoints shall not be greater than the value advertised by O-RU for a given capacity sharing group (limiting this range helps the O- RU reduce the search space for repeated highest priority section descriptions detection). While duplicating highest priority sections, all fields including sectionId shall be duplicated except the 'repetition' bit. In addition to this, for C-Plane message processing O-RUs, additional limits to restrict the number of highest priority sections per C-Plane message on top of eAxC limits shall be applied (clause 7.8.2.2).

In addition to associating unique sectionId to highest priority section as described above, the O-DU shall set repetition=1 for every repeated C-Plane message (see clause 7.7.6.6), if the 'repetition' bit is available in the Section Extension. The O-RU may ignore the flag based on its implementation.

#### O-RUs per endpoint and per C-Plane message limits

###### O-RU per endpoint processing limits

* + - * 1. Overview

When O-RUs processing granularity is endpoint based i.e. processing resources in O-RU to handle C/U-Plane messages are allocated per endpoint, certain limits may be imposed by the O-RU per endpoint e.g. endpoint-section-capacity, endpoint-beam-capacity, endpoint-prb-capacity. When such limits are imposed by the O-RU, the O-DU shall comply with the limits, otherwise the stated O-RU capacity may be compromised.

* + - * 1. Limits on Number of PRB ranges

One type of per endpoint limits is related to overall number of PRB ranges addressed in C-Plane messages. If O-RU reports the capability in M-Plane parameter "max-prb-ranges-per-symbol" then O-DU shall ensure the number of PRB ranges in C-Plane messages meet the following condition:

The total number of PRB ranges in all section descriptions in a symbol shall not exceed the value reported by the O-RU in the M-Plane parameter "max-prb-ranges-per-symbol". The restriction shall be applied per an endpoint and per groups of endpoints sharing the capacity.

For evaluation of the above condition the following PRB range counting rules shall be applied:

1. Evaluation of PRB ranges per symbol shall be done for each symbol separately.
2. Number of PRB ranges in a symbol is the smallest number of sections without section extensions that could represent the beamforming configuration requested for the symbol.

###### O-RU C-Plane message limits

For O-RUs with per C-Plane message processing limits in addition to per endpoint processing limits, the O-RU may choose to advertise its limitations on a per C-Plane message basis. The O-DU may indicate that it adheres to the associated limitations. The defined limits are the maximum number of beams, maximum number of highest priority sections and maximum number of PRB ranges per highest priority section with Section Extension 12 within a C-Plane message. Refer to clause 15.8 of the M-Plane Specification [7] for details on usage of this feature for various scenarios.

## C-Plane optimizations

#### C-Plane optimization using Section Extension 6

Section Extension 6 can be used for non-contiguous PRB allocation in both time and frequency domains. Section Extension 6 conveys two bitmasks: symbolMask and rbgMask. The first allows to select an arbitrary subset of symbols within a slot. The second allows to select arbitrary subset of blocks of subcarriers (each block has 12 ? rbgSize subcarriers) between startPrbc and startPrbc+numPrbc. The selected set of RE is a cross-section of symbols and subcarriers selected by both masks. This allows to describe a wide range of non-contiguous resource allocations with one section description.

In addition, O-RU may support optional feature allowing it to interpret a non-zero value priority carried in this Section Extension. This optimization is described in clause 7.9.5.

#### C-Plane Optimization using Section Extension 7

Void.

#### C-Plane optimization using Section Extension 10

###### Overview

In general, O-DU uses unique eAxC\_IDs to address each layer or spatial stream when sending C-Plane and U-Plane messages to the O-RU. In many situations, information contained in C-Plane messages for the different spatial streams is the same or similar. For example, a single user MIMO allocation with 8 layers may have same values for startPrbc, NumPrbc, reMask, and numSymbol in the section header for all 8 C-Plane messages, one message per layer. In this case, Section Extension 10 can be used along with a 'representative eAxC\_ID' (configured via M-Plane) to reduce C- Plane overhead of sending multiple messages by sending one single C-Plane message. This is an optional feature which can be taken advantage of by the O-DU if the O-RU capability indicates that the O-RU supports Section Extension 10. Based on this capability, the O-RU can be configured with a 'representative eAxC\_ID' representing all 8 eAxC\_IDs in above example. Once a 'representative eAxC\_ID' is configured, the O-DU can send one single C-Plane message addressed to the 'representative eAxC\_ID' along with the Section Extension 10 instead of 8 C-Plane messages in above example. Once the O-RU receives a C-Plane message addressed to the 'representative eAxC\_ID' and with Section Extension 10, then the O-RU applies this message to all endpoints pointed to by the 'representative eAxC\_ID' whereby

performing same operation just like O-RU had received 8 different C-Plane messages. Figure 7.9.3.1-1 below illustrates the example.

**C-Plane without SE 10**

**O-DU**

**O-RU**

**C-plane for eAxC #1**

**+ beamId/ueId for eAxC #1 C-plane for eAxC #2**

**+ beamId/ueId for eAxC #2**

**C-plane for eAxC #3**

**+ beamId/ueId for eAxC #3**

**C-plane for eAxC #N**

**+ beamId/ueId for eAxC #N**

**eAxC #N**

**eAxC #3**

**eAxC #2**

**C-Plane**

**Processing**

**eAxC #1**

**eAxC #N**

**eAxC #3**

**eAxC #2**

**eAxC #1**

**C-Plane**

**Processing**

**C-Plane using SE 10**

**O-DU**

**C-plane for eAxC #1**

**(Representative eAxC)**

**O-RU**

**eAxC #1**

**eAxC #1**

**C-Plane**

**Processing**

**+ beamId/ueId for eAxC #1**

**+ beamId/ueId for eAxC #2**

**+ beamId/ueId for eAxC #3**

**.**

**.**

**+ beamId/ueId for eAxC #N**

**eAxC #N**

**eAxC #N**

**eAxC #3**

**eAxC #3**

**eAxC #2**

**eAxC #2**

**C-Plane**

**Processing**

**Figure 7.9.3.1-1: Operation of Section Extension 10**

###### Section Extension 10 port-list interaction with beamGroupType =10b and 11b

For a given instance of Section Extension 10, either beamGroupType = 10b or 11b can be used by the O-DU for indicating assignment of consecutive or non-consecutive ports from the port list to beamId's/ueId's. Figures below are intended to show example cases for both beamGroupType = 10b and 11b.

Figure 7.9.3.2-1 shows two examples wherein out of seven eAxC\_IDs in the M-Plane configured port-list, four consecutive ports (Example-1) and four non-consecutive ports (Example-2) are specified using invocation of SE 10 with beamGroupType = 10b

![A close-up of a list  Description automatically generated](../assets/images/db3128ac33d8.png)

**Figure 7.9.3.2-1 Consecutive and non-consecutive ports scheduled using beamGroupType=10b**

Figure 7.9.3.2-2 and Figure 7.9.3.2-3 show two examples wherein out of seven eAxC\_IDs in the port-list, four are selected to be used in a specific invocation of SE 10 with beamGroupType = 11b.

![A diagram of a computer  Description automatically generated with medium confidence](../assets/images/849969a772e6.png)

**Figure 7.9.3.2-2 ueId and portListIndex association example using beamGroupType=11b, portListIndex = 1 selecting first entry i.e. representative-tx-eaxc-id from M-Plane configured port-list**

![A diagram of a computer  Description automatically generated with medium confidence](../assets/images/ff2193bcf18a.png)

**Figure 7.9.3.2-3 ueId and portListIndex association example using beamGroupType=11b, portListIndex = 2 selecting NON first entry i.e. member-tx-eaxc-id from M-Plane configured port-list**

#### C-Plane optimization using Section Extension 11

###### Overview

Section Extension 11 refers to flexible beamforming weight transmission. One way to transfer per-PRB beamforming weights is using Section Extension 1 and creating one section for each PRB. This introduces overhead in the form of section headers and Section Extensions. The objective of Section Extension 11 is to eliminate this problem by allowing the inclusion of the beamforming weights for multiple PRBs in a single section.

Example use case include zero-forcing beamforming (or similar methods) by using per-PRB channel information to calculate per-PRB beamforming weights. Specifically, the O-RU sends uplink pilots (SRS) to O-DU, which in return calculates per-PRB beamforming weights in the O-DU, then transfer them to the O-RU. These weights can be updated every slot, as an example.

Section Extension 11 gives the flexibility of either sending the sets of beamforming weights along with the Section Extension beamIds, or only the Section Extension beamIds (after, loading the beamforming weights in a previous time).

When Section Extension 11 is used, O-RU shall ignore the beamId in the section description.

###### Interaction between Section Extension 11 and Section Extension 6

* + - * 1. Overview

Section Extension 6 is used for non-contiguous PRB allocation in both time and frequency domains. The main parameter in Section Extension 6 that is used to identify the PRB groups is rbgSize. On the other hand, numBundPrb is used in Section Extension 11 to identify the number of bundled PRBs that share the same beamforming weights vector for L TRXs.

* + - * 1. Interaction when RAD = 1

When Section Extension 11 and Section Extension 6 is used together, following requirements shall apply when RAD is set to 1:

1. The value of the numBundPrb field may be different from rbgSize field.
2. For each contiguous set of PRBs as defined under Section Extension 6 (if used), the O-RU shall start counting for the number of bundled PRBs and apply the sets of beamforming weights to PRB bundles in an increasing order of PRBs.
   1. If the last bundled PRB does not coincide with the last RBG in the contiguous set of PRBs, then the unassigned PRBs (i.e. PRBs with unassigned beamforming weights) will be considered orphan PRB(s).
3. Orphan PRBs are allocated the next set of beamforming weights (i.e. set after the last set that was assigned to a regular PRB bundle) although the number of PRBs is less than a PRB bundle. For any set of PRBs that are not being assigned using Section Extension 6, no beamforming weight sets shall be assigned.
4. For the set of contiguous PRBs allocated in the same symbol after the discontinuity, the O-RU shall apply the next set of beamforming weights (starting from the last set of beamforming weights allocated to the last PRB bundle in the previous contiguous PRB set).
5. The process continues until all the PRBs defined under Section Extension 6 are assigned beamforming weights.
6. O-RU shall apply the same sets of beamforming weights to the corresponding PRB bundles in all symbols selected via symbolMask.

EXAMPLE: RAD = 1b (see Figure 7.9.4.2.2-1 below). symbolMask = 10 0001 0001 0000b.

rbgSize = 3.

numBundPrb = 2.

Total number of L beamforming weights set = 7.

![](../assets/images/4ba03ac9ce14.png)

**Figure 7.9.4.2.2-1: Example for how Section Extension 6 interacts with Section Extension = 11: Case RAD = 1**

* + - * 1. Interaction when RAD = 0

When Section Extension 11 and Section Extension 6 is used together, following requirements shall apply when RAD is set to 0. The set of beamforming weights for a given bundle shall be applied to the PRBs in increasing order regardless of the discontinuity in the PRBs allocation in Section Extension 6. O-DU shall send beamforming weights for a PRB bundle if and only if a PRB allocated using Section Extension 6 is part of the PRB bundle.

EXAMPLE: RAD = 0b (see Figure 7.9.4.2.3-1 below). symbolMask = 10 0001 0001 0000b.

rbgSize = 3.

numBundPrb = 10.

Total number of L beamforming weights set = 3.

![](../assets/images/9e2d432c13af.png)

**Figure 7.9.4.2.3-1: Example for how Section Extension =6 interacts with Section Extension 11: Case RAD = 0**

###### Interaction between Section Extension 11 and Section Extension 12

Section Extension 12 is used for non-contiguous PRB allocation in both time and frequency domains. Section Extension 11 can be combined with Section Extension 12 in one section description in the same way as how Extension 11 may be combined with Section Extension 6. That is, description in clause 7.9.4.2 applies also to Section Extension 12. See also the examples below.

EXAMPLE 1: for RAD = 0 (see Figure 7.9.4.3-1 below). symbolMask = 00 0000 0000 0101b.

grey rectangles represent unallocated frequency ranges (a single PRB discontinuity starting at PRB 5).

numBundPrb = 3.

Total number of L beamforming weights set = 4.

numBundPrb

15

14

13 PRB Bund 3

12

11

10

9

8

7

6

5

4

3

2

1

0

15

14

13

12

11

10

9

8

7

6

5

4

3

2

1

0

PRB Bund 3

PRB Bund 2

PRB Bund 2

Orphan

PRB Bund 1

Orphan

PRB Bund 1

PRB Bund 0

PRB Bund 0

numBundPrb

numBundPrb

numBundPrb

numBundPrb

Symbol 0 Symbol 2

**Figure 7.9.4.3-1: Example for how Section Extension 12 interacts with Section Extension 11: Case RAD=0**

EXAMPLE 2: for RAD = 1 (see Figure 7.9.4.3-2 below). symbolMask = 00 0000 0000 0101b.

grey rectangles represent unallocated frequency ranges (a single PRB discontinuity starting at PRB 5).

numBundPrb = 3.

Total number of L beamforming weights set = 4.

numBundPrb

15

14

13

12

11

10

9

8

7

6

5

4

3

2

1

0

Orphan

PRB Bund 3

15

14

13

12

11

10

9

8

7

6

5

4

3

2

1

0

Orphan

PRB Bund 3

PRB Bund 2

PRB Bund 2

Orphan

PRB Bund 1

Orphan

PRB Bund 1

PRB Bund 0

PRB Bund 0

numBundPrb

numBundPrb

numBundPrb

Symbol 0 Symbol 2

**Figure 7.9.4.3-2: Example for how Section Extension 12 interacts with Section Extension 11: Case RAD = 1**

###### Interaction between Section Extension 11 and Section Extension 13

Section Extension 13 is used for non-contiguous PRB allocation with frequency hopping. Section Extension 11 can be combined with Section Extension 13 in one section description in the same way as Section Extension 11 is combined with Section Extension 6 as described in clause 7.9.4.2 with following additional requirements:

* beamIds and beamforming weights carried by Section Extension 11 shall be provided for a combined PRB set that is result of merging PRB sets of all hops. This rule is general and applies to Section Extension 13 combined with Section Extensions allowing non-contiguous PRB allocation (Section Extensions 6 and 12).
* PRB discontinuities are discontinuities of the combined PRB set.

EXAMPLE 1: for RAD = 0 (see Figure 7.9.4.4-1 below).

startSymbolId=0 (and message includes only one section description) startPrbc = 10, numPrbc = 5, numSymbol=3.

nextStartSymbolId(0) = 1, nextStartPrbc(0) = 0.

nextStartSymbolId(1) = 2, nextStartPrbc(1) = 7.

grey rectangles represent unallocated frequency ranges .

note the combined set of PRB has one discontinuity starting at PRB 5 . numBundPrb = 3.

Total number of L beamforming weights set = 5.

numBundPrb

15 15

14 14

13 PRB Bund 4 13

12 12

11 11

15

14

13

12

11

|  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- |
| numBundPrb |  | 10 | PRB Bund 3 | 10 |  | 10 | PRB Bund 3 |
|  |  | 9 |  | 9 |  | 9 |  |
|  |  | 8 |  | 8 |  | 8 |  |
| numBundPrb |  | 7 |  | 7 |  | 7 | PRB Bund 2 |
|  |  | 6 |  | 6 |  | 6 |  |
|  |  | 5 |  | 5 |  | 5 |  |
| numBundPrb |  | 4 |  | 4 | Orphan | 4 |  |
|  |  | 3 |  | 3 | PRB Bund 1 | 3 |  |
|  |  | 2 |  | 2 |  | 2 |  |
| numBundPrb |  | 1 |  | 1 | PRB Bund 0 | 1 |  |
|  |  | 0 |  | 0 |  | 0 |  |
|  |  |  |  |  |  |  |  |

Symbol 0

Symbol 1

Symbol 2

**Figure 7.9.4.4-1: Example for how Section Extension 13 interacts with Section Extension 11: Case RAD = 0**

EXAMPLE 2: for RAD = 1 (see Figure 7.9.4.4-2 below).

startSymbolId=0 (and message includes only one section description) startPrbc=10, numPrbc=5, numSymbol=3.

nextStartSymbolId(1)=1, nextStartPrbc(1) = 0. nextStartSymbolId(2)=2, nextStartPrbc(2) = 7.

Grey rectangles represent unallocated frequency ranges

Note the combined set of PRB has one discontinuity starting at PRB 5. numBundPrb = 3.

Total number of L beamforming weights set = 5.

|  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- |
|  |  | 15 |  | 15 |  | 15 |  |
| numBundPrb |  | 14 | Orphan | 14 |  | 14 |  |
|  |  | 13 | PRB Bund 4 | 13 |  | 13 |  |
|  |  | 12 |  | 12 |  | 12 |  |
| numBundPrb |  | 11 | PRB Bund 3 | 11 |  | 11 | Orphan |
|  |  | 10 |  | 10 |  | 10 | PRB Bund 3 |
|  |  | 9 |  | 9 |  | 9 |  |
| numBundPrb |  | 8 |  | 8 |  | 8 | PRB Bund 2 |
|  |  | 7 |  | 7 |  | 7 |  |
|  |  | 6 |  | 6 |  | 6 |  |
|  |  | 5 |  | 5 |  | 5 |  |
| numBundPrb |  | 4 |  | 4 | Orphan | 4 |  |
|  |  | 3 |  | 3 | PRB Bund 1 | 3 |  |
|  |  | 2 |  | 2 |  | 2 |  |
| numBundPrb |  | 1 |  | 1 | PRB Bund 0 | 1 |  |
|  |  | 0 |  | 0 |  | 0 |  |
|  |  |  | Symbol 0 |  | Symbol 1 |  | Symbol 2 |

**Figure 7.9.4.4-2: Example for how Section Extension 13 interacts with Section Extension 11: Case RAD = 1**

EXAMPLE 3: for RAD = 0 with a non-contiguous PRB allocation using Section Extension 12 and 13 (see Figure 7.9.4.4-3)

startPrbc=8, numPrbc=2. nextStartSymbolId(1)=2, nextStartPrbc(1) = 0. symbolMask= 00 0000 0000 0101b. offStartPrb(1)=4, numPrb(1)=2.

Grey rectangles represent unallocated frequency ranges.

Note the combined set of PRB has two discontinuities starting at PRB 2 and PRB 10. numBundPrb = 3.

Total number of L beamforming weights set = 5.

numBundPrb

16

15

14

13

12

11

10

9

8

7

6

5

4

3

2

1

0

PRB Bund 4

PRB Bund 3

PRB Bund 2

PRB Bund 1

16

15

14

13

12

11

10

9

8

7

6

5

4

3

2

1

0

PRB Bund 1

PRB Bund 0

numBundPrb

numBundPrb

numBundPrb

numBundPrb

Symbol 0 Symbol 2

**Figure 7.9.4.4-3: Example for how Section Extension 13 and 12 interact with Section Extension 11: Case RAD = 0**

EXAMPLE 4: for RAD = 1 with a non-contiguous PRB allocation using Section Extension 12 and 13 (see Figure 7.9.4.4-4)

startPrbc=8, numPrbc=2. nextStartSymbolId(1)=2, nextStartPrbc(1) = 0. symbolMask= 00 0000 0000 0101b. offStartPrb(1)=4, numPrb(1)=2.

Grey rectangles represent unallocated frequency ranges.

Note the combined set of PRB has two discontinuities starting at PRB 2 and PRB 10. numBundPrb = 3.

Total number of L beamforming weights set = 4.

numBundPrb

16

15

14

13

12

11

10

9

8

7

6

5

4

3

2

1

0

PRB Bund 3

PRB Bund 2

PRB Bund 1

16

15

14

13

12

11

10

9

8

7

6

5

4

3

2

1

0

PRB Bund 1

PRB Bund 0

numBundPrb

numBundPrb

numBundPrb

Symbol 0 Symbol 2

**Figure 7.9.4.4-4: Example for how Section Extension 13 and 12 interact with Section Extension 11: Case RAD = 1**

#### C-Plane optimization using Section Extension 12

The Section Extension 12 can be used for non-contiguous PRB allocation in time and frequency domains. The Section Extension conveys priority, symbolMask and a variable size list of frequency ranges. Section Extension 12 is more space efficient than Section Extension 6 in scenarios where:

1. PRB allocation is contiguous in frequency domain but non-contiguous in time domain (in this case the list of frequency ranges can be empty).
2. PRB allocation consists of few contiguous fragments of spectrum that are spread over wide frequency span (in this case size of rbgMask is the factor limiting application of Section Extension 6).

This optimization cannot be combined with Section Extension 6 in one section description.

#### C-Plane optimization using Section Extension 13

The Section Extension 13 can be used for PRB allocation with intra-slot frequency hopping. The Section Extension 13 conveys a variable size list of pairs of parameters indicating a value to be used in place of startPrbc and a time instant (symbol number) starting from which the startPrbc shall be substituted.

When using intra-slot frequency hopping, Section Extension 13 is more size efficient than realizing the frequency hopping using only section descriptions. Section Extension 13 can be combined with other Section Extensions. In such case interpretation of frequency parameters conveyed by the section description and all Section Extensions shall be as if value of startPrbc was modified at time instances according to parameters in Section Extension 13.

#### Coupling via frequency and time with priorities

This optimization uses the coupling mechanism described in clause 7.8.1.4 and allows the reduction of the number of section descriptions. The coupling mechanism with priorities allows to unambiguously describe beamforming configuration even if section descriptions overlap (i.e. refer to the same RE) provided they have different priorities. Message size reduction can be achieved by moving beamforming configuration of selected REs (e.g. REs allocated to reference signals) to a combined section description with a higher priority. With this, other section descriptions of lower priority can be simplified (e.g. details of RE allocation in PRB conveyed in reMask can be simplified by setting reMask to all ones) and may be combined. Combining section descriptions requires use of coupling mechanism that does not use sectionId. The meaning of "higher priority" and "lower priority" is relative e.g. priority 0 is higher than priority -1.

To enable O-RU to decide beamforming of an RE by processing a single C-Plane message, O-DU shall ensure that each message that has a section description referring to an RE includes the section description referring to the RE with highest priority. This may result in duplicating a subset of section description in more than one message but does not result in beamforming configuration ambiguity. The "highest priority" is relative e.g. if an RE is referenced only by section description with priority -1 then this is the section description with the highest priority.

The following example is simplified (e.g. symbolMask and reMask have less bits than actual fields in a message) to demonstrate the optimization mechanism and does not reflect a realistic resource allocation.

EXAMPLE: Initial set of section descriptions (assuming coupling via sectionId) is presented in Table 7.9.7-1 below.

**Table 7.9.7-1: Initial set of section descriptions**

|  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- |
| **#** | **sectionId** | **symbolMask** | **startPrbc** | **numPrbc** | **reMask** | **beamId** | **Note** |
| 1 | 100 | 0110110 | 0 | 4 | 111111 | 100 | UE1 |
| 2 | 101 | 1001000 | 0 | 4 | 110110 | 100 | UE1 |
| 3 | 101 | 1001000 | 0 | 4 | 001000 | 1 | Reference signal |
| 4 | 101 | 1001000 | 0 | 4 | 000001 | 2 | Reference signal |
| 5 | 200 | 0110110 | 4 | 4 | 111111 | 200 | UE2 |
| 6 | 201 | 1001000 | 4 | 4 | 110110 | 200 | UE2 |
| 7 | 201 | 1001000 | 4 | 4 | 001000 | 1 | Reference signal |
| 8 | 201 | 1001000 | 4 | 4 | 000001 | 2 | Reference signal |
| 9 | 300 | 0110110 | 8 | 4 | 111111 | 300 | UE3 |
| 10 | 301 | 1001000 | 8 | 4 | 110110 | 300 | UE3 |
| 11 | 301 | 1001000 | 8 | 4 | 001000 | 1 | Reference signal |
| 12 | 301 | 1001000 | 8 | 4 | 000001 | 2 | Reference signal |
| 13 | 400 | 0000001 | 5 | 2 | 111111 | 3 | Special channel |

Optimized set of section descriptions (sectionId value is fixed and not significant) is presented in Table 7.9.7-2 below.

**Table 7.9.7-2: Optimized set of section descriptions**

|  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- |
| **#** | **priority** | **symbolMask** | **startPrbc** | **numPrbc** | **reMask** | **beamId** | **Note** |
| 1 | +1 | 1001000 | 0 | 12 | 001000 | 1 | Reference signal |
| 2 | +1 | 1001000 | 0 | 12 | 000001 | 2 | Reference signal |
| 3 | 0 | 1111110 | 0 | 4 | 111111 | 100 | UE1 |
| 4 | 0 | 1111110 | 4 | 4 | 111111 | 200 | UE2 |
| 5 | 0 | 1111110 | 8 | 4 | 111111 | 300 | UE3 |
| 6 | 0 | 0000001 | 5 | 2 | 111111 | 3 | Special channel |

In this example, in the optimized set of section descriptions, section descriptions 3, 4, 5 and 6 span over a continuous set of symbols and have priority 0 (default). They can be represented without Section Extension 6.

If optimized set of section descriptions does not fit in one message, then it is divided into several messages e.g. as presented in tables Table 7.9.7-3, Table 7.9.7-4 and Table 7.9.7-5 below. The split into messages is only to demonstrate duplication of highest priority section descriptions.

**Table 7.9.7-3: Message #1**

|  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- |
| **#** | **priority** | **symbolMask** | **startPrbc** | **numPrbc** | **reMask** | **beamId** | **Note** |
| 1 | +1 | 1001000 | 0 | 12 | 001000 | 1 | Reference signal |
| 2 | +1 | 1001000 | 0 | 12 | 000001 | 2 | Reference signal |
| 3 | 0 | 1111110 | 0 | 4 | 111111 | 100 | UE1 |
| 4 | 0 | 1111110 | 4 | 4 | 111111 | 200 | UE2 |

**Table 7.9.7-4: Message #2**

|  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- |
| **#** | **priority** | **symbolMask** | **startPrbc** | **numPrbc** | **reMask** | **beamId** | **Note** |
| 1 | +1 | 1001000 | 0 | 12 | 001000 | 1 | Reference signal |
| 2 | +1 | 1001000 | 0 | 12 | 000001 | 2 | Reference signal |
| 3 | 0 | 1111110 | 8 | 4 | 111111 | 300 | UE3 |

In the message #2 presented in Table 7.9.7-4 section descriptions 1 and 2 are duplicated because they are highest priority section descriptions referring to REs referred by section descriptions in the message (here section description 3).

**Table 7.9.7-5: Message #3**

|  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- |
| **#** | **Priority** | **symbolMask** | **startPrbc** | **numPrbc** | **reMask** | **beamId** | **Note** |
| 1 | 0 | 0000001 | 5 | 2 | 111111 | 3 | Special channel |

In the message #3 presented in Table 7.9.7-5 section description 1 is the section description with highest priority and there is no need to duplicate section descriptions with priority +1. In other words: for every RE referenced from the message the message contains the highest priority section description referring to the RE.

#### Coupling via frequency and time with priorities (optimized)

This optimization is an extension of optimization described in clause 7.9.7 that allows to identify duplication of highest priority section descriptions. When highest priority section descriptions are duplicated, O-RU processes the duplicated sections multiple times. To identify duplication, if 'coupling via frequency and time with priorities optimized' is enabled, O-DU shall set each highest priority section to have a unique sectionId (see clause 7.8.1.5). This enables O-RU to identify duplicate highest priority sections and take an optimized action.

EXAMPLE: Using the same example as in clause 7.9.7 the optimized set of section descriptions is presented in Table 7.9.8-1 with sectionId column added (sectionId value is fixed to 4095 for lower priority sections whereas highest priority section will have unique sectionId values in a defined range).

**Table 7.9.8-1: Optimized set of section descriptions**

|  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **#** | **sectionId** | **priority** | **symbolMask** | **startPrbc** | **numPrbc** | **reMask** | **beamId** | **Note** |
| 1 | 0 | +1 | 1001000 | 0 | 12 | 001000 | 1 | Reference signal |
| 2 | 1 | +1 | 1001000 | 0 | 12 | 000001 | 2 | Reference signal |
| 3 | 4095 | 0 | 1111110 | 0 | 4 | 111111 | 100 | UE1 |
| 4 | 4095 | 0 | 1111110 | 4 | 4 | 111111 | 200 | UE2 |
| 5 | 4095 | 0 | 1111110 | 8 | 4 | 111111 | 300 | UE3 |
| 6 | 4095 | 0 | 0000001 | 5 | 2 | 111111 | 3 | Special channel |

As described in in clause 7.9.7 when section description does not fit in one message, the message is divided across several message where the highest priority sections are duplicated.

**Table 7.9.8-2: Message #1**

|  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **#** | **sectionId** | **priority** | **symbolMask** | **startPrbc** | **numPrbc** | **reMask** | **beamId** | **Note** |
| 1 | 0 | +1 | 1001000 | 0 | 12 | 001000 | 1 | Reference signal |
| 2 | 1 | +1 | 1001000 | 0 | 12 | 000001 | 2 | Reference signal |
| 3 | 4095 | 0 | 1111110 | 0 | 4 | 111111 | 100 | UE1 |
| 4 | 4095 | 0 | 1111110 | 4 | 4 | 111111 | 200 | UE2 |

In the message #1 presented in Table 7.9.8-2 highest priority sections are associated with unique sectionIds to be identified by O-RU when same highest priority sections are duplicated across C-Plane messages. Sections with priority 0 are still assigned 4095 as the sectionId since they are not duplicated.

**Table 7.9.8-3: Message #2**

|  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **#** | **sectionId** | **priority** | **symbolMask** | **startPrbc** | **numPrbc** | **reMask** | **beamId** | **Note** |
| 1 | 0 | +1 | 1001000 | 0 | 12 | 001000 | 1 | Reference signal |
| 2 | 1 | +1 | 1001000 | 0 | 12 | 000001 | 2 | Reference signal |
| 3 | 4095 | 0 | 1111110 | 8 | 4 | 111111 | 300 | UE3 |

Duplicated section descriptions across message #1 and message #2 presented in Table 7.9.8-3 can now be identified by O-RU using sectionId.

**Table 7.9.8-4: Message #3**

|  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **#** | **sectionId** | **Priority** | **symbolMask** | **startPrbc** | **numPrbc** | **reMask** | **beamId** | **Note** |
| 1 | 4095 | 0 | 0000001 | 5 | 2 | 111111 | 3 | Special channel |

The message #3 presented in Table 7.9.8-4 is the same as in clause 7.9.7.

#### U-Plane Operation Without C-Plane

O-RU may support U-Plane operation without C-Plane. In general, this function can be used for channels with resource allocation known (at least approximately, see below) during eAxC activation (e.g. PRACH and SRS). If this function is enabled via M-Plane for a given eAxC then for this eAxC, C-Plane is not used to provide control information. Instead, the O-DU shall configure the O-RU with a static control information (resource allocation details and beamforming configuration are set before activation) via M-Plane. For more details see clause 8.2.2.

This functionality can also be used for channels where only approximate resource allocation is known during activation (e.g. SRS channel reception is scheduled periodically at known interval even if no UE is present). In this case it is possible that resource allocation conveyed via M-Plane exceeds actual resource allocation e.g. O-RU would be statically configured to receive channel related REs without reflecting actual, varying over time allocations. Such approximations generally cause additional UL U-Plane traffic related to unallocated (at given time) resource elements. Since O-DU is in control of DL U-Plane, allocation of DL U-Plane traffic for unallocated resources is not expected.

This C-Plane optimization method is not compatible with any Section Extensions since C-Plane messages are not used for selected eAxC.

#### Modulation compression with Section Extension 10

Section Extension 10 is used for group configuration of multiple ports. Section Extension 4, Section Extension 5 and Section Extension 23 are used for modulation compression. Extension type 10 can be used together with extension type 4 or 5 or 23. When all parameter values of Section Extension 4 or 5 is same for all eAxC\_IDs, one single Section Type 4 or 5 or 23 shall be appended after Section Extension 10. When parameter values are different for all eAxCs, Section

Extension 4 or 5 or 23 for all eAxC\_IDs in sequence based on eAxC\_ID order shall be appended after Section Extension 10.

If O-RU receives only one Section Extension 4 or 5 or 23 with Section Extension 10, O-RU applies same parameters to all eAxC\_IDs. If O-RU receives equal to the number of the eAxC\_IDs grouped, O-RU applies the Section Extension 4 or 5 or 23 in the order of how eAxC\_IDs are grouped. Any other number of Section Extension 4 or 5 or 23 is an error condition. O-RU shall use numPortc parameter in Section Extension 10 to identify number of Section Extension 4 or 5 or 23 that are present.

EXAMPLE 1: Example with 4 Layers (numPortc = 3), beamGroupType = 00b or 01b for Section Extension 10 and all eAxC\_IDs share same modulation compression parameters is shown in Table 7.9.10-1. One Section Extension 5 is appended after Section Extension 10 in this case (Section Extension 5 with two scaler values, modulation compression parameters is used in this example).

**T****able 7.9.10-1: Section Extension 10 for beamGroupType = 00b or 01b with one Section Extension 5**

|  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | | **3** | | **4** | | **5** | | **6** | **7(lsb)** | **# of bytes** |  |
| ef | extType = 0x0A | | | | | | | | | | | 1 | Octet N |
| extLen = 0x01 (1 word) | | | | | | | | | | | | 1 | N+1 |
| beamGroupType | | | numPortc=3 | | | | | | | | | 1 | N+2 |
| reserved | | | | | | | | | | | | 1 | N+3 |
| ef | extType = 0x05 | | | | | | | | | | | 1 | N+4 |
| extLen = 0x3 (3 words) | | | | | | | | | | | | 1 | N+5 |
| mcScaleReMask[11:4] | | | | | | | | | | | | 1 | N+6 |
| mcScaleReMask[3:0] | | | | | | | csf | | mcScaleOffset [14:12] | | | 1 | N+7 |
| mcScaleOffset [11:4] | | | | | | | | | | | | 1 | N+8 |
| mcScaleOffset [3:0] | | | | | mcScaleReMask[11:8] | | | | | | | 1 | N+9 |
| mcScaleReMask[7:0] | | | | | | | | | | | | 1 | N+10 |
| csf | mcScaleOffset [14:8] | | | | | | | | | | | 1 | N+11 |
| mcScaleOffset [7:0] | | | | | | | | | | | | 1 | N+12 |
| zero padding | | | | | | | | | | | | 1 | N+13 |
| zero padding | | | | | | | | | | | | 1 | N+14 |
| zero padding | | | | | | | | | | | | 1 | N+15 |

EXAMPLE 2: Example with4 Layer (numPortc=3), beamGroupType = 00b or 01b for Section Extension 10 and eAxC\_IDs use different modulation compression parameters is shown in Table 7.9.10-2. Four instances of Section Extension 5 are appended after Section Extension 10 in this case (Section Extension 5 with one scaler value, modulation compression parameters is used in this example).

**T****able 7.9.10-2: Section Extension 10 for beamGroupType = 00b or 01b with multiple Section Extension 5**

|  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | | **3** | | **4** | | **5** | | **6** | **7(lsb)** | **# of bytes** |  |
| ef | extType = 0x0A | | | | | | | | | | | 1 | Octet N |
| extLen = 0x01 (1 word) | | | | | | | | | | | | 1 | N+1 |
| beamGroupType | | | numPortc=3 | | | | | | | | | 1 | N+2 |
| reserved | | | | | | | | | | | | 1 | N+3 |
| ef | extType = 0x05 | | | | | | | | | | | 1 | N+4 |
| extLen = 0x2 (2 words) | | | | | | | | | | | | 1 | N+5 |
| mcScaleReMask[11:4] | | | | | | | | | | | | 1 | N+6 |
| mcScaleReMask[3:0] | | | | | | | csf | | mcScaleOffset [14:12] | | | 1 | N+7 |
| mcScaleOffset [11:4] | | | | | | | | | | | | 1 | N+8 |
| mcScaleOffset [3:0] | | | | | zero padding | | | | | | | 1 | N+9 |
| zero padding | | | | | | | | | | | | 1 | N+10 |
| zero padding | | | | | | | | | | | | 1 | N+11 |
| ef | extType = 0x05 | | | | | | | | | | | 1 | N+12 |
| extLen = 0x2 (2 words) | | | | | | | | | | | | 1 | N+13 |
| mcScaleReMask[11:4] | | | | | | | | | | | | 1 | N+14 |
| mcScaleReMask[3:0] | | | | | | | csf | | mcScaleOffset [14:12] | | | 1 | N+15 |
| mcScaleOffset [11:4] | | | | | | | | | | | | 1 | N+16 |
| mcScaleOffset [3:0] | | | | | zero padding | | | | | | | 1 | N+17 |
| zero padding | | | | | | | | | | | | 1 | N+18 |
| zero padding | | | | | | | | | | | | 1 | N+19 |
| ef | extType = 0x05 | | | | | | | | | | | 1 | N+20 |
| extLen = 0x2 (2 words) | | | | | | | | | | | | 1 | N+21 |
| mcScaleReMask[11:4] | | | | | | | | | | | | 1 | N+22 |
| mcScaleReMask[3:0] | | | | | | | csf | | mcScaleOffset [14:12] | | | 1 | N+23 |
| mcScaleOffset [11:4] | | | | | | | | | | | | 1 | N+24 |
| mcScaleOffset [3:0] | | | | | zero padding | | | | | | | 1 | N+25 |
| zero padding | | | | | | | | | | | | 1 | N+26 |
| zero padding | | | | | | | | | | | | 1 | N+27 |
| ef | extType = 0x05 | | | | | | | | | | | 1 | N+28 |
| extLen = 0x2 (2 words) | | | | | | | | | | | | 1 | N+29 |
| mcScaleReMask[11:4] | | | | | | | | | | | | 1 | N+30 |
| mcScaleReMask[3:0] | | | | | | | csf | | mcScaleOffset [14:12] | | | 1 | N+31 |
| mcScaleOffset [11:4] | | | | | | | | | | | | 1 | N+32 |
| mcScaleOffset [3:0] | | | | | zero padding | | | | | | | 1 | N+33 |
| zero padding | | | | | | | | | | | | 1 | N+34 |
| zero padding | | | | | | | | | | | | 1 | N+35 |

EXAMPLE 3: Example with 4 Layer (numPortc=3), beamGroupType = 10b for Section Extension 10, and all eAxC\_IDs share same modulation compression parameters is shown in Table 7.9.10-3. One Section Extension 5 is appended after Section Extension 10 in this case (Section Extension 5 with two scaler values, modulation compression parameters in this example).

**Table** **7.9.10-3: Section Extension 10 for beamGroupType = 10b with one single Section Extension 5**

|  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | | **3** | | **4** | | **5** | | **6** | **7(lsb)** | **# of bytes** |  |
| ef | extType = 0x0A | | | | | | | | | | | 1 | Octet N |
| extLen = 0x03 (3words) | | | | | | | | | | | | 1 | N+1 |
| beamGroupType | | | numPortc=3 | | | | | | | | | 1 | N+2 |
| reserved | 2nd port beamId[14:8] (or ueId[14:8]) | | | | | | | | | | | 1 | N+3 |
| 2nd port beamId[7:0] (or ueId[7:0]) | | | | | | | | | | | | 1 | N+4 |
| reserved | 3rd port beamId[14:8] (or ueId[14:8]) | | | | | | | | | | | 1 | N+5 |
| 3rd port beamId[7:0] (or ueId[7:0]) | | | | | | | | | | | | 1 | N+6 |
| reserved | 4th port beamId[14:8] (or ueId[14:8]) | | | | | | | | | | | 1 | N+7 |
| 4th port beamId[7:0] (or ueId[7:0]) | | | | | | | | | | | | 1 | N+8 |
| zero padding | | | | | | | | | | | | 1 | N+9 |
| zero padding | | | | | | | | | | | | 1 | N+10 |
| zero padding | | | | | | | | | | | | 1 | N+11 |
| ef | extType = 0x05 | | | | | | | | | | | 1 | N+12 |
| extLen = 0x3 (3 words) | | | | | | | | | | | | 1 | N+13 |
| mcScaleReMask[11:4] | | | | | | | | | | | | 1 | N+14 |
| mcScaleReMask[3:0] | | | | | | | csf | | mcScaleOffset [14:12] | | | 1 | N+15 |
| mcScaleOffset [11:4] | | | | | | | | | | | | 1 | N+16 |
| mcScaleOffset [3:0] | | | | | mcScaleReMask[11:8] | | | | | | | 1 | N+17 |
| mcScaleReMask[7:0] | | | | | | | | | | | | 1 | N+18 |
| csf | mcScaleOffset [14:8] | | | | | | | | | | | 1 | N+19 |
| mcScaleOffset [7:0] | | | | | | | | | | | | 1 | N+20 |
| zero padding | | | | | | | | | | | | 1 | N+21 |
| zero padding | | | | | | | | | | | | 1 | N+22 |
| zero padding | | | | | | | | | | | | 1 | N+23 |

EXAMPLE 4**:** Example with 4 Layer (numPortc=3), beamGroupType = 10b for Section Extension 10, and eAxC\_IDs use different modulation compression parameters is shown in Table 7.9.10-4. Four instances of Section Extension 5 are appended after Section Extension 10 in this case (Section Extension 5 with one scaler value, modulation compression parameters is used in this example).

**T****able 7.9.10-4: Section Extension 10 for beamGroupType = 10b with multiple Section Extension 5**

|  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | | **3** | | **4** | | **5** | | **6** | **7(lsb)** | **# of bytes** |  |
| ef | extType = 0x0A | | | | | | | | | | | 1 | Octet N |
| extLen = 0x03 (3words) | | | | | | | | | | | | 1 | N+1 |
| beamGroupType | | | numPortc=3 | | | | | | | | | 1 | N+2 |
| reserved | 2nd port beamId[14:8] (or ueId[14:8]) | | | | | | | | | | | 1 | N+3 |
| 2nd port beamId[7:0] (or ueId[7:0]) | | | | | | | | | | | | 1 | N+4 |
| reserved | 3rd port beamId[14:8] (or ueId[14:8]) | | | | | | | | | | | 1 | N+5 |
| 3rd port beamId[7:0] (or ueId[7:0]) | | | | | | | | | | | | 1 | N+6 |
| reserved | 4th port beamId[14:8] (or ueId[14:8]) | | | | | | | | | | | 1 | N+7 |
| 4th port beamId[7:0] (or ueId[7:0]) | | | | | | | | | | | | 1 | N+8 |
| zero padding | | | | | | | | | | | | 1 | N+9 |
| zero padding | | | | | | | | | | | | 1 | N+10 |
| zero padding | | | | | | | | | | | | 1 | N+11 |
| ef | extType = 0x05 | | | | | | | | | | | 1 | N+12 |
| extLen = 0x2 (2 words) | | | | | | | | | | | | 1 | N+13 |
| mcScaleReMask[11:4] | | | | | | | | | | | | 1 | N+14 |
| mcScaleReMask[3:0] | | | | | | | csf | | mcScaleOffset [14:12] | | | 1 | N+15 |
| mcScaleOffset [11:4] | | | | | | | | | | | | 1 | N+16 |
| mcScaleOffset [3:0] | | | | | zero padding | | | | | | | 1 | N+17 |
| zero padding | | | | | | | | | | | | 1 | N+18 |
| zero padding | | | | | | | | | | | | 1 | N+19 |
| ef | extType = 0x05 | | | | | | | | | | | 1 | N+20 |
| extLen = 0x2 (2 words) | | | | | | | | | | | | 1 | N+21 |
| mcScaleReMask[11:4] | | | | | | | | | | | | 1 | N+22 |
| mcScaleReMask[3:0] | | | | | | | csf | | mcScaleOffset [14:12] | | | 1 | N+23 |
| mcScaleOffset [11:4] | | | | | | | | | | | | 1 | N+24 |
| mcScaleOffset [3:0] | | | | | zero padding | | | | | | | 1 | N+25 |
| zero padding | | | | | | | | | | | | 1 | N+26 |
| zero padding | | | | | | | | | | | | 1 | N+27 |
| ef | extType = 0x05 | | | | | | | | | | | 1 | N+28 |
| extLen = 0x2 (2 words) | | | | | | | | | | | | 1 | N+29 |
| mcScaleReMask[11:4] | | | | | | | | | | | | 1 | N+30 |
| mcScaleReMask[3:0] | | | | | | | csf | | mcScaleOffset [14:12] | | | 1 | N+31 |
| mcScaleOffset [11:4] | | | | | | | | | | | | 1 | N+32 |
| mcScaleOffset [3:0] | | | | | zero padding | | | | | | | 1 | N+33 |
| zero padding | | | | | | | | | | | | 1 | N+34 |
| zero padding | | | | | | | | | | | | 1 | N+35 |
| ef | extType = 0x05 | | | | | | | | | | | 1 | N+36 |
| extLen = 0x2 (2 words) | | | | | | | | | | | | 1 | N+37 |
| mcScaleReMask[11:4] | | | | | | | | | | | | 1 | N+38 |
| mcScaleReMask[3:0] | | | | | | | csf | | mcScaleOffset [14:12] | | | 1 | N+39 |
| mcScaleOffset [11:4] | | | | | | | | | | | | 1 | N+40 |
| mcScaleOffset [3:0] | | | | | zero padding | | | | | | | 1 | N+41 |
| zero padding | | | | | | | | | | | | 1 | N+42 |
| zero padding | | | | | | | | | | | | 1 | N+43 |

#### Optimization with Section Extension 19

The benefits of Section Extension 19 can be explained with a CSI-RS example. Consider a CSI-RS resource with 32 ports, FD-CDM2. Each port is associated with a separate beam. Up to 16 ports (belonging to one CDM group) can be

sent in a single layer (eAxC). Without use of Section Extension 19 this would require 16 section invocations. Each section invocation is 8 bytes for a total of 128 bytes. Assuming 4 CSI-RS resources, this amounts to 64 sections and 512 bytes.

When used with Time and Frequency coupling with priorities, this example will result in 64 highest priority sections. Fragmentation of C-Plane packets would further result in duplicating these highest priority sections in every C-Plane message, adding further to the fronthaul load in addition to O-DU and O-RU processing.

With Section Extension 19 in the same example as above, as opposed to processing up to 16 section headers per CSI-RS resource, only one section header would need be processed by the O-RU. Processing highest priority sections for removing overlapping reMask bits would become more efficient. Rather than accumulating reMasks and symbolMask across 16 high priority sections, the combined reMask and symbolMask of the entire CSI-RS resource would be provided in one shot via reMask in the section header & symbolMask in the Section Extension. This would make the

O-DU and O-RU processing more efficient, especially when dealing with fragmentation of C-Plane packets.

Moreover, when repeating highest priority sections, the port information associated with Section extension 19 would not be repeated, leading to fronthaul savings.

#### Optimizations with Section Extension 20

###### General

Section Extension 20 (see clause 7.7.20) is like coupling via frequency and time with priorities, see clause 7.8.1.4, but more efficient and more widely applicable. Using Section Extension 19 rather than Section Extension 20, if there is

C-Plane application layer packet fragmentation, each C-Plane message shall contain the highest priority section descriptions referring to any RE that is referred in a message (see clause 7.8.1.3 restriction item #3). This can lead to increased fronthaul and processing overhead.

Section Extension 20 optimizes the method of specifying the overlapping RE information (puncturing information) with reduced fronthaul and processing overhead. This extension contains only the puncturing information (specified via Resource Element masks) of the channels without any beamforming information. It further consolidates the puncturing information of several channels into a single extension. If there is C-Plane application layer packet fragmentation, beamforming information needs to be sent only once and only puncturing information (which is compact) needs to be repeated in every C-Plane message. Using Section Extension 20 simplifies the section description (e.g. details of RE allocation in PRB conveyed in reMask may be simplified by setting reMask to all ones). This can reduce the number of sections required.

This Section Extension can be used with all coupling methods as described in clause 7.8.1, thereby benefiting all coupling methods with reduced number of sections.

###### Enhancement to Section Extension 20 using multiSDScope

For specifying common control channels e.g. CSI-RS and SSB even though the puncturing pattern may be same per user allocation, the puncturing pattern is required to be repeated per user allocation/section description within a C-Plane message. This repetition results from Section Extension 20 scope being limited to a single section description. To handle this inefficiency, the 'multiSDScope' flag in Section Extension 20 can be used. If the value of this flag is set to the value '1' by the O-DU, it implies that the corresponding puncturing pattern applies to all the following section descriptions within the C-Plane message, which eliminates the need for repeating the same puncturing pattern per user allocation/section description.

#### Optimizations with ueId indicating non-scheduled PRB range

In channel-information-based beamforming, the O-RU calculates the BF weight based on the channel information of the ueId(s) from Section Type 5 and/or Section Extension 10. In MU-MIMO scheduling, co-scheduled UEs/layers may be scheduled with different number of PRBs, as shown in Figure 7.9.13-1.

Layer 5

|  |  |  |  |
| --- | --- | --- | --- |
| UE4 (ueId = 30) | | | |
| UE3 (ueId = 24) |  |  |  |
| UE2 (ueId = 11) | | |
| UE2 (ueId = 10) | | |
| UE1 (ueId = 2) | |  |
| UE1 (ueId = 1) | |
|  |  |
| RB0~RB18 | RB19~RB33 | RB34~RB46 | RB47~RB99 |

Layer 4

Layer 3

Layer 2

Layer 1

Layer 0

**Figure 7.9.13-1 Example of co-scheduled UEs with different PRB allocation**

In the example shown in Figure 7.9.13-1, in a C-Plane message, Section Type 5 with Section Extension 10 can only be sent to indicate allocation for first 19 PRBs and rest of the allocation needs to be indicated using individual C-Plane messages per port or eAxC\_ID. Even if the O-DU tries to use SE 10 for rest of the frequency and layer allocation, it would require to use multiple C-Plane messages.

This can be solved by indicating the 'non-scheduled' information using ueId = 0x7FFF in Section Type 5 and/or Section Extension 10 with beamGroupType = 10b to indicate the non-scheduled ueId in specific PRB ranges. When ueId = 0x7FFF is used, O-RU shall interpret that those PRBs in the specified port are not allocated and hence shall not be considered for BF weight generation. This means that O-RU shall interpret the representative eAxC\_ID (i.e. the eAxC\_ID in the transport header) is not scheduled when ueId in the section header in ST 5 is set to 0x7FFF. Table 7.9.13-1 and Figure 7.9.13-2 shows an example of describing the layer and PRB allocation in Figure 7.9.13-1 using four section descriptions (sectionId#A, B, C and D) using non-scheduled-ueId. SectionId#A describes RB0 to RB18 for Layer0 to Layer5 using SE10, sectionId#B describes RB19 to RB33 for Layer0 to Layer5 using SE10 and so on. Layer0 is the layer corresponding to the representative eAxC\_ID in the example below.

sectionId#A sectionId#B sectionId#C sectionId#D

Layer 5

Layer 4

|  |  |  |  |
| --- | --- | --- | --- |
|  |  |  |  |
| UE4 (ueId = 30) | UE4 (ueId = 30) | UE4 (ueId = 30) | UE4 (ueId = 30) |
| UE3 (ueId = 24) | ueId = 0x7FFF | ueId = 0x7FFF | ueId = 0x7FFF |
| UE2 (ueId = 11) | UE2 (ueId = 11) | UE2 (ueId = 11) | ueId = 0x7FFF |
| UE2 (ueId = 10) | UE2 (ueId = 10) | UE2 (ueId = 10) | ueId = 0x7FFF |
| UE1 (ueId = 2) | UE1 (ueId = 2) | ueId = 0x7FFF | ueId = 0x7FFF |
| UE1 (ueId = 1) | UE1 (ueId = 1) | ueId = 0x7FFF | ueId = 0x7FFF |
|  |  |  |  |
| RB0~RB18 | RB19~RB33 | RB34~RB46 | RB47~RB99 |

Layer 3

Layer 2

Layer 1

Layer 0

**Figure 7.9.13-2: Example of four ST 5 sections with SE 10 when non-scheduled-ueId is enabled Table 7.9.13-1: Example of four ST 5 sections with SE 10, non-scheduled-ueId enabled**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7**  **(lsb)** | **# of bytes** |  |
| transport header, see clause 5.1.3 | | | | | | | | 8 | Octet 1 |
| Radio application header | | | | | | | | 8 | Octet 9 |
| sectionId = A | | | | | | | | 1 | Octet 17 |
| sectionId | | | | rb | symInc | startPrbc | | 1 | Octet 18 |
| startPrbc = 0 | | | | | | | | 1 | Octet 19 |
| NumPrbc = 19 | | | | | | | | 1 | Octet 20 |

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7**  **(lsb)** | **# of bytes** |  |
| reMask[11:4] | | | | | | | | 1 | Octet 21 |
| reMask[3:0] | | | | numSymbol | | | | 1 | Octet 22 |
| ef = 1 | ueId[14:8] | | | | | | | 1 | Octet 23 |
| ueId[7:0] = 1 | | | | | | | | 1 | Octet 24 |
| ef = 0 | extType = 0x0A | | | | | | | 1 | Octet 25 |
| extLen | | | | | | | | 1 | Octet 26 |
| beamGroupType=10b | | NumPortc = 5 | | | | | | 1 | Octet 27 |
| reserved | 2nd port beamId[14:8] (or ueId[14:8]) | | | | | | | 1 | Octet 28 |
| 2nd port beamId[7:0] (or ueId[7:0]) = 2 | | | | | | | | 1 | Octet 29 |
| reserved | 3rd port beamId[14:8] (or ueId[14:8]) | | | | | | | 1 | Octet 30 |
| 3rd port beamId[7:0] (or ueId[7:0]) = 10 | | | | | | | | 1 | Octet 31 |
| reserved | 4th port beamId[14:8] (or ueId[14:8]) | | | | | | | 1 | Octet 32 |
| 4th port beamId[7:0] (or ueId[7:0]) = 11 | | | | | | | | 1 | Octet 33 |
| reserved | 5th port beamId[14:8] (or ueId[14:8]) | | | | | | | 1 | Octet 34 |
| 5th port beamId[7:0] (or ueId[7:0]) = 24 | | | | | | | | 1 | Octet 35 |
| reserved | 6th port beamId[14:8] (or ueId[14:8]) | | | | | | | 1 | Octet 36 |
| 6th port beamId[7:0] (or ueId[7:0]) = 30 | | | | | | | | 1 | Octet 37 |
| Padding to 4-byte boundary | | | | | | | | 3 | Octet 38 |
| sectionId = B | | | | | | | | 1 | Octet 41 |
| sectionId | | | | rb | symInc | startPrbc | | 1 | Octet 42 |
| startPrbc = 19 | | | | | | | | 1 | Octet 43 |
| NumPrbc = 15 | | | | | | | | 1 | Octet 44 |
| reMask[11:4] | | | | | | | | 1 | Octet 45 |
| reMask[3:0] | | | | numSymbol | | | | 1 | Octet 46 |
| ef = 1 | ueId[14:8] | | | | | | | 1 | Octet 47 |
| ueId[7:0] = 1 | | | | | | | | 1 | Octet 48 |
| ef = 0 | extType = 0x0A | | | | | | | 1 | Octet 49 |
| extLen | | | | | | | | 1 | Octet 50 |
| beamGroupType=10b | | NumPortc = 5 | | | | | | 1 | Octet 51 |
| reserved | 2nd port beamId[14:8] (or ueId[14:8]) | | | | | | | 1 | Octet 52 |
| 2nd port beamId[7:0] (or ueId[7:0]) = 2 | | | | | | | | 1 | Octet 53 |
| reserved | 3rd port beamId[14:8] (or ueId[14:8]) | | | | | | | 1 | Octet 54 |
| 3rd port beamId[7:0] (or ueId[7:0]) = 10 | | | | | | | | 1 | Octet 55 |
| reserved | 4th port beamId[14:8] (or ueId[14:8]) | | | | | | | 1 | Octet 56 |
| 4th port beamId[7:0] (or ueId[7:0]) = 11 | | | | | | | | 1 | Octet 57 |
| reserved | 5th port beamId[14:8] (or ueId[14:8]) = 0x7F | | | | | | | 1 | Octet 58 |
| 5th port beamId[7:0] (or ueId[7:0]) = 0xFF | | | | | | | | 1 | Octet 59 |
| reserved | 6th port beamId[14:8] (or ueId[14:8]) | | | | | | | 1 | Octet 60 |
| 6th port beamId[7:0] (or ueId[7:0]) = 30 | | | | | | | | 1 | Octet 61 |
| Padding to 4-byte boundary | | | | | | | | 3 | Octet 62 |
| sectionId = C | | | | | | | | 1 | Octet 65 |
| sectionId | | | | rb | symInc | startPrbc | | 1 | Octet 66 |
| startPrbc = 34 | | | | | | | | 1 | Octet 67 |
| NumPrbc = 13 | | | | | | | | 1 | Octet 68 |
| reMask[11:4] | | | | | | | | 1 | Octet 69 |
| reMask[3:0] | | | | numSymbol | | | | 1 | Octet 70 |
| ef = 1 | ueId[14:8] = 0x7F | | | | | | | 1 | Octet 71 |
| ueId[7:0] = 0xFF | | | | | | | | 1 | Octet 72 |
| ef = 0 | extType = 0x0A | | | | | | | 1 | Octet 73 |
| extLen | | | | | | | | 1 | Octet 74 |
| beamGroupType=10b | | NumPortc = 5 | | | | | | 1 | Octet 75 |
| reserved | 2nd port beamId[14:8] (or ueId[14:8]) = 0x7F | | | | | | | 1 | Octet 76 |

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7**  **(lsb)** | **# of bytes** |  |
| 2nd port beamId[7:0] (or ueId[7:0]) = 0xFF | | | | | | | | 1 | Octet 77 |
| reserved | 3rd port beamId[14:8] (or ueId[14:8]) | | | | | | | 1 | Octet 78 |
| 3rd port beamId[7:0] (or ueId[7:0]) = 10 | | | | | | | | 1 | Octet 79 |
| reserved | 4th port beamId[14:8] (or ueId[14:8]) | | | | | | | 1 | Octet 80 |
| 4th port beamId[7:0] (or ueId[7:0]) = 11 | | | | | | | | 1 | Octet 81 |
| reserved | 5th port beamId[14:8] (or ueId[14:8]) = 0x7F | | | | | | | 1 | Octet 82 |
| 5th port beamId[7:0] (or ueId[7:0]) = 0xFF | | | | | | | | 1 | Octet 83 |
| reserved | 6th port beamId[14:8] (or ueId[14:8]) | | | | | | | 1 | Octet 84 |
| 6th port beamId[7:0] (or ueId[7:0]) = 30 | | | | | | | | 1 | Octet 85 |
| Padding to 4-byte boundary | | | | | | | | 3 | Octet 86 |
| sectionId = D | | | | | | | | 1 | Octet 89 |
| sectionId | | | | rb | symInc | startPrbc | | 1 | Octet 90 |
| startPrbc = 47 | | | | | | | | 1 | Octet 91 |
| NumPrbc = 53 | | | | | | | | 1 | Octet 92 |
| reMask[11:4] | | | | | | | | 1 | Octet 93 |
| reMask[3:0] | | | | numSymbol | | | | 1 | Octet 94 |
| ef = 1 | ueId[14:8] = 0x7F | | | | | | | 1 | Octet 95 |
| ueId[7:0] = 0xFF | | | | | | | | 1 | Octet 96 |
| ef = 0 | extType = 0x0A | | | | | | | 1 | Octet 97 |
| extLen | | | | | | | | 1 | Octet 98 |
| beamGroupType=10b | | NumPortc = 5 | | | | | | 1 | Octet 99 |
| reserved | 2nd port beamId[14:8] (or ueId[14:8]) = 0x7F | | | | | | | 1 | Octet 100 |
| 2nd port beamId[7:0] (or ueId[7:0]) = 0xFF | | | | | | | | 1 | Octet 101 |
| reserved | 3rd port beamId[14:8] (or ueId[14:8]) = 0x7F | | | | | | | 1 | Octet 102 |
| 3rd port beamId[7:0] (or ueId[7:0]) = 0xFF | | | | | | | | 1 | Octet 103 |
| reserved | 4th port beamId[14:8] (or ueId[14:8]) = 0x7F | | | | | | | 1 | Octet 104 |
| 4th port beamId[7:0] (or ueId[7:0]) = 0xFF | | | | | | | | 1 | Octet 105 |
| reserved | 5th port beamId[14:8] (or ueId[14:8]) = 0x7F | | | | | | | 1 | Octet 106 |
| 5th port beamId[7:0] (or ueId[7:0]) = 0xFF | | | | | | | | 1 | Octet 107 |
| reserved | 6th port beamId[14:8] (or ueId[14:8]) | | | | | | | 1 | Octet 108 |
| 6th port beamId[7:0] (or ueId[7:0]) = 30 | | | | | | | | 1 | Octet 109 |
| Padding to 4-byte boundary | | | | | | | | 3 | Octet 110 |

#### Optimization with USER-GROUP-OPTIMIZATION feature

As shown in the example Figure 7.9.13-1, PRB allocations for co-scheduled UEs/layers need not exactly overlap. The O-DU may send separate C-Plane message for each set of overlapping PRB allocation using one Section Type 5 and Section Extension 10 e.g.:

* C-Plane Message#1: ST 5 + SE 10 for RB0-33; ueId-1 and 2, Layer-0,1
* C-Plane Message#2: ST 5 + SE 10 for RB0-46; ueId-10 and 11, Layer-2,3
* C-Plane Message#3: ST 5 + SE 10 for RB0-18; ueId-24, Layer-4
* C-Plane Message#4: ST 5 + SE 10 for RB0-99; ueId-30, Layer-5

Sending section descriptions in separate C-Plane messages may be sub-optimal for the O-RU considering computation incurred at the O-RU for identifying user group boundaries. For example, the O-RU can perform or skip performing beamforming weight interpolation at respective user group PRB boundary.

However, if the O-RU advertises support for the feature 'USER-GROUP-OPTIMIZATION' by setting the flag **user- group-optimization-supported** = TRUE for a given tx/rx endpoint, and if the O-DU enables this feature by setting **user-group-optimization-enabled** = TRUE, the O-DU shall send all layers for a given user group UEs i.e. UEs with

same time-frequency allocation, using single section description with SE 10 (in case of single UE layer, SE 10 may be omitted). Figure 7.9.14-1 shows an example of sending multiple user group information using Section Type 5 with Section Extension 10. This feature shall be applicable for channel-information-based beamforming method.

Layer 5

Layer 4

Layer 3

Layer 2

Layer 1

Layer 0

Section Description #1 User-Group#1

representative eAxC\_ID is Layer 5

|  |  |  |  |
| --- | --- | --- | --- |
|  |  |  |  |
| UE4 (ueId = 30) | UE4 (ueId = 30) | UE4 (ueId = 30) | UE4 (ueId = 30) |
| UE3 (ueId = 24) | (ueId = 0x7FFF) | (ueId = 0x7FFF) |  |
| UE2 (ueId = 11) | UE2 (ueId = 11) | UE2 (ueId = 11) |  |
| UE2 (ueId = 10) | UE2 (ueId = 10) | UE2 (ueId = 10) |  |
| UE1 (ueId = 2) | UE1 (ueId = 2) |  |  |
| UE1 (ueId = 1) | UE1 (ueId = 1) |  |  |
|  |  |  |  |
|  |  |  |  |
| RB0~RB18 | RB19~RB33 | RB34~RB46 | RB47~RB99 |

Section Description #2 User-Group#2

representative eAxC\_ID is Layer 5

Section Description #3 User-Group#3

representative eAxC\_ID is Layer 5

Section Description #4 User-Group#4 eAxC\_ID is Layer 5

**Figure 7.9.14-1 Example of four ST 5 sections with SE 10 to send multiple user group scheduling information.**

When using the 'USER-GROUP-OPTIMIZATION' feature, the data section descriptions sent from O-DU to O-RU for the example in Figure 7.9.14-1 would be:

* C-Plane Message#1, Section Description#1: ST 5 + SE 10 for RB0 - RB18; ueId-30, 24, 11, 10, 2, 1;

numPortc = 5

* C-Plane Message#1, Section Description#2: ST 5 + SE 10 for RB19 - RB33; ueId-30, 0x7FFF, 11, 10, 2, 1; numPortc = 5
* C-Plane Message#1, Section Description#3: ST 5 + SE 10 for RB34 - RB46; ueId-30, 0x7FFF, 11, 10; numPortc = 3
* C-Plane Message#1, Section Description#4: ST 5 (no SE 10) for RB47 - RB99; ueId-30.

The above example assumes the representative eAxC\_ID is Layer 5, and the ordered list of eAxC\_IDs configured by M-Plane is {Layer 5, Layer 4, Layer 3, Layer 2, Layer 1, Layer 0} and the 'NON-SCHEDULED-UEID' feature is also used.

Apart from saving the number of C-Plane messages required for sending non-overlapping user group information, this feature localizes complete configuration for a given user group in one C-Plane data section thus saving O-RU processing, otherwise incurred to process and combine information from multiple C-Plane section and C-Plane message to identify UEs belonging to the same user group.

The O-DU can use 'USER-GROUP-OPTIMIZATION' feature with or without enabling 'NON-SCHEDULED-UEID' feature described in Clause 7.9.13:

* Usage of feature 'USER-GROUP-OPTIMIZATION' with feature 'NON-SCHEDULED-UEID' enables a more optimized implementation with a smaller number of section descriptions in a single C-Plane message (i.e. using a single eAxC\_ID being the representative eAxC\_ID). The Figure 7.9.14-1 shows an example of using 'USER-GROUP-OPTIMIZATION' with 'NON-SCHEDULED-UEID' feature.
* Usage of feature 'USER-GROUP-OPTIMIZATION' without feature 'NON-SCHEDULED-UEID' still allows specifying all the UEs belonging to the same user group within the same data section description, however individual C-Plane messages are required for sending each user group with different representative eAxC\_ID.

When 'USER-GROUP-OPTIMIZATION' feature is used with Section Extensions describing PRB allocations e.g. Section Extension 6 or 12, O-DU shall use single section description for a given user group if the entire PRB allocation belongs to the same user group.

# U-Plane Protocol

## General

#### U-Plane transport

Either eCPRI or IEEE 1914.3 (see clause 5.1.3) shall be used as an encapsulation mechanism for the User Plane messages. Due to the nature of these messages (very strict delay constraints), it is assumed that message acknowledgements are not possible. Likewise, different data flows may be used for the User Plane and Control Plane messages.

#### U-Plane data compression

U-Plane IQ data, (both DL and UL) including user data, PRACH and control channels may be transmitted in compressed format. There are several envisioned compression methods including an "uncompressed" format. The method of compression may vary based on sectionId but shall be constant for every U-Plane data section referenced in a single C-Plane message. Likewise, the I and Q bitwidth of the compressed samples may vary based on sectionId but shall be constant for every U-Plane data section referenced in a single C-Plane message. The block compression methods shall be performed on a Physical Resource Block (PRB) basis (that is, block compression shall be executed on blocks of 12 Resource Elements in a single PRB). More specific details on the supported compression methods may be found in Annex A.

A static IQ format and compression method, in which case the M-Plane configures the static IQ format (bitwidth) and compression method, is also defined. In this case there are four fewer bytes in the U-Plane section header, at the cost of less flexibility. This allows the taking advantage of the static format while still allowing some compression flexibility

e.g. allowing modulation compression on the DL (which only applies to DL) and some other compression method on the UL.

#### Digital power scaling

###### Definition of IQ power in dBFS

IQ power level in dBFS (dB full scale) is a logarithmic representation of the power level for an IQ sample carried over the fronthaul interface. IQ power level in dBFS is calculated as below:

IQ power level [dBFS] = 10.log10(I2 + Q2) - 10.log10(*FS*) = 10?log10 (I2 + Q2) - 10?log10(FS0 ? 2-*FS\_Offset* ) Where:

* *I* is the in-phase portion of a received constellation point;
* *Q* is the quadrature portion of a received constellation point;
* *FS* is the Full Scale (maximum) permitted value of I or Q based on their digital representations;
* *FS\_Offset* is an M-Plane parameter (value 0 is used if this parameter is not supported by O-RU or not set by O- DU);
* FS0 = max(I2) = max(Q2) is the largest IQ power that can be represented with arbitrary phase in the given IQ data format (IQ bit-widths and compression format). IQ power for a given RE is defined by (I2 + Q2).

The actual IQ values that may occur in a U-Plane message are restricted by:

(I2 + Q2) <= FS = FS0 ? 2-FS\_Offset.

For frequency domain IQ data, 0 dBFS shall be the maximum IQ power level which can be carried by one subcarrier. The smallest non-zero IQ power level is defined by the interface resolution.

It can be expected that an O-RU will normalize any received DL value to its internal representation of full scale so that a 0 dBFS can be properly handled.

EXAMPLE 1:

FS\_Offset = 0

I = min I, Q = 0

With 9-bit mantissa 2's complement + 4-bit exponent compression:

min I = -256?2*15* = -2*23* => FS*0* = 2*46*,

FS = FS*0* ?2-*FS\_Offset* = 246

0 dBFS ? MAX(I2 + Q2) = 246

Interface resolution = 10 ? log10(1/(246)) = -138.47 dBFS EXAMPLE 2:

FS\_Offset=10 I=min I, Q=0

With 14-bit mantissa 2's complement + 4-bit exponent compression:

min I = -213?215 = -228 => FS0 = 256, FS = FS0 ? 2*-FS\_Offset* = 256*-*10 = 246

0 dBFS ? MAX(I2 + Q2) = 246

Interface resolution = 10 ? log10(1/(246)) = -138.47 dBFS

###### Definition of gain over fronthaul interface

* + - * 1. DL and UL gain definition commonality

The gain of an array is the relation between the levels of a test signal seen at its input and output, also called digital power scaling. The gain of an array may be calculated from the gain of one element of the array while assuming all elements have same gain**.** Figure 8.1.3.2.1-1 depicts the gain relations between the fronthaul interface and the RF reference plane to an assumed lossless antenna (i.e. antenna insertion losses are counted as part of the gain in both DL and UL direction). For DMRS-BF-EQ, UL gain is not applicable since equalization will compensate the IQ output level for channel variations. See clause 8.1.3.2.4.

DL gain [dB(mW/FS)] = output RF level [dBm] - input IQ power level [dBFS]

Fronthaul interface: IQ power level [dBFS]

**1 TX array element**

**O-RU**

**1 RX array element**

Air interface: RF level [dBm]

Reference plane

to RF external connector to lossless antenna

UL gain [dB(FS/mW)] = output IQ power level [dBFS] - input RF level [dBm]

**Figure 8.1.3.2.1-1: DL and UL gain over fronthaul interface**

Both DL and UL gains in [dB] shall be described by the following relations:

* DL gain [dB(mW/FS)] = output RF level [dBm] - input IQ power level [dBFS]
* UL gain [dB(FS/mW)] = output IQ power level [dBFS] - input RF level [dBm]

NOTE: In this document notation "dB(X)"(where X is "FS/mW" or "mW/FS") is used as a convention to indicate unit or references of the numerator value and the denominator value before performing logarithm.

where:

* 'output RF level [dBm]' and 'input RF level [dBm]' are RF signal power in dBm at a reference plane to an assumed lossless antenna when the antenna is integrated inside the O-RU, or at the antenna connector if the antenna is not integrated inside the O-RU. The rms output power [dBm] is measured per array element as Total Radiated Power TRP (i.e. excluding any antenna directivity gain). The rms input power [dBm] is measured per array element after including the antenna directivity gain. The antenna directivity gain is the array element directivity + 10.log10(number of elements). Hence, when evaluating the array element gain, the antenna directivity is reduced to the array element directivity.
* 'input IQ power level [dBFS]' and 'output IQ power level [dBFS]' are 10.log10(average(*I*2+*Q*2)) normalized such that 0 dBFS is the maximum nominal (r.m.s.) IQ power level which can be achieved with a constant IQ signal with arbitrary phase (i.e. for frequency-domain IQ signal for **one sub-carrier,** constant over time).

In O-RUs supporting beamforming, the actual DL gain and UL gain of the array element may be impacted by the gain level of beamforming weight used and which may change dynamically during operation. **Such dependency on the beam pattern shall be excluded when describing any configurable gain or reported gain (as O-RU capability)**.

For an exact definition of DL and UL gain, the respective input test signals shall be declared by the O-RU vendor; this is not in scope of the present document. [For information only: This can be e.g. continuous-wave (CW) signal at carrier centre or test signals/reference signals defined by 3GPP; for DL gain those being defined to test accuracy of the maximum output power (3GPP TS 36.141 [40], clause 6.2 or TS 38.141 [41], clause 6.2) and for UL gain those being defined to test absolute accuracy of Received Interference Power (3GPP TS 36.133 [38], clause 10.1.1 or TS 38.133 [37], clause 10.1.1)]. In Figure 8.1.3.2.1-2 the details of DL gain are described. For every tx-array, the O-RU shall report (as a capability) the maximal configurable DL gain of **one element of the array** (alternatively the nominal power per tx-array element mapped to 0 dBFS). In addition, the O-DU shall configure over the M-Plane the DL gain to be used per tx-array element for a certain carrier configuration.

The values for the max configurable DL gain and configured DL gain shall be configured assuming:

* No power loss/gain due to beamforming weights;
* all available DL power may be allocated to one RE in a single eAxC (if dynamic range optimization is used by configuring non-zero value in M-Plane parameter Reference\_Level then single RE can have allocated available DL power less Reference\_Level value; see clause 8.1.3.3).

##### DL gain [dB(mW/FS)] = output RF level [dBm] - input IQ power level [dBFS]

Digital Input to O-RU

**reference plane to fronthaul interface**

Simplified example of TX path.

Actual design is expected to include other parts (e.g. iFFT, DA converters, Beamforming weight power loss in analog domain)

**reference plane to lossless antenna**

Input to lossless antenna

Physical antenna connector (if exists)

lossless antenna

Input IQ power level are measured in dBFS.

For CAT-B O-RU this can be generalized as power level of IQ

e.g. losses

of TX filter

**PA**

losses of

antenna

Output RF power level can be measured without knowing the directivity by integrating the radiation density over the full sphere

resulting from decompression.

**BF weight loss**

depends on beamID

**Configured DL\_gain Max configurable DL\_gain** does not depend on beamID and values of Beamforming weight

**DL gain [dB(mW/FS)]**

**Antenna Directivity [dBi]**

**Input IQ power level [dBFS]**

**Output RF level [dBm]**

In case of integrated antenna

**EIRP**

**[dBm]**

Output RF power level = TRP (Total Radiated Power)

**Figure 8.1.3.2.1-2: Details of DL gain**

In Figure 8.1.3.2.1-3 the details of UL gain are described. For every rx-array, O-RU shall report (as a capability) an UL gain\_correction\_range in dB of **one element of the array (applicable to all the elements of the array)**. The gain\_correction\_range shall be signed, have a max and min value, and a step size. In addition, the O-DU shall configure over the M-Plane a gain\_correction value to be applied to the signal received by each array-element to calculate the IQ data in each eAxC (for purpose of backward compatibility this shall be configured as a sum of a common gain correction applicable to all eAxCs of given array carrier and an individual gain correction of each eAxC). The O-RU shall then configure its UL gain (see clause 8.1.3.2.3) of the rx-array element for that carrier (rx-array carrier element) if the IQ compression method is configured as static. In case the compression method is dynamic, the UL gain of the O- RU shall be dynamic and based on compression information received in real time over the C-Plane as specified in clause 8.1.3.2.3.

The values for the UL gain shall be configured assuming no power loss/gain due to beamforming weights.

UL gain [dB(FS/mW)] = output IQ power level [dBFS] - input RF level [dBm]

Digital Output of O-RU

**reference plane to fronthaul interface**

Simplified example of RX path.

Actual design is expected to include other parts (e.g. FFT, AD converters, Beamforming weight power loss in analog domain)

![](../assets/images/c23544bb4df0.png)![](../assets/images/9438d28c0343.png)

**reference plane to lossless antenna**

Output of lossless antenna

Physical antenna connector (if exists)

lossless antenna

Output IQ power level are measured in dBFS.

**BF weight loss**

**LNA**

e.g. losses of RX filter

**Configured UL\_gain**

losses of antenna

Input RF power level can be measured from a known equivalent isotropic received power after embedding the antenna directivity.

(i.e. if not known, the directivity can be

measured by integrating the incident radiation

depends on beamID

does not depend on Beamforming weight,

does depend on used IQ data format and gain\_correction

**UL gain [dB(FS/mW)]**

density over full sphere and comparing to the measured power from a specific direction.)

**Antenna Directivity [dBi]**

**Output IQ power level**

**[dBFS]**

**Input RF level**

**[dBm]**

**PISO, Equivalent isotropic received power**

**[dBm]**

**Figure 8.1.3.2.1-3: Details of UL gain**

* + - * 1. DL gain definition

The DL gain of a TX array carrier element shall be provided as part of the O-RU carrier set-up procedure. The configured (by the O-DU over the M-Plane) DL gain of a TX array carrier element (i.e. "TX array carrier element" refers to the TX array element serving the respective carrier configured on the respective TX array) shall be defined by mapping the Reference\_Level [dBFS] (see clause 8.1.3.3) carried over any subcarrier (of the carrier) on the fronthaul interface to the maximum RMS power the TX array carrier element may output at the assumed-lossless antenna connector port (i.e. including all insertion losses). In single-carrier operation, the configured DL gain shall apply to the carrier. In multiple-carrier operation, the configured DL gain should be lower accommodating the number of multiple carriers and their bandwidths. The O-DU shall scale down the level of the signals at the interface and/or set tx-array- carrier gain values to avoid saturation in the O-RU for single or multiple-carrier configurations.

Configured DL\_gain [dB(mW/FS)] <= maximum TX power per array element [dBm] - Reference\_Level [dBFS], which is valid for each individual spatial stream served under the TX array carrier element.

The following statements shall apply to the above equation:

1. The maximum configured DL gain of a TX array carrier is equivalent to mapping 0 dBFS carried over any subcarrier (of the carrier) on the fronthaul interface to the maximum RMS power the TX array carrier element is supposed to output + 10 ? log10 (the number of array elements) - Reference\_Level [in dBFS].
2. For a category A O-RU, the tx-array output rms power is measured over 1 polarization
3. For a category B O-RU, the tx-array output rms power shall be measured over all polarizations addressed by the respective precoding operations
4. Configured DL\_gain [dB(mW/FS)] = target TX carrier power per array element [dBm] - Reference\_Level [dBFS] where target TX carrier power per array element <= maximum TX power per array element.
5. If the O-RU reports a minimum DL gain capability, then the O-DU shall also ensure that

Configured DL\_gain [dB(mW/FS)] >= minimum DL gain per array element [dB(mW/FS)] - (Reference\_Level [dBFS] - 0 [dBFS])

where the minimum DL gain per array element is the capability reported by O-RU.

* + - * 1. UL gain definition except for DMRS-BF-EQ

This clause defines UL gain for all cases except when DMRS-BF-EQ is used. For DMRS-BF-EQ, the notion of a configured UL gain is not applicable and instead the output level is described in clause 8.1.3.4. The UL gain or scaling of an rx-array carrier element (i.e. "rx-array carrier element" refers to the rx-array element serving the respective eAxC configured on the respective rx-array) shall be defined by mapping -152 dBm at the assumed-lossless antenna port to the smallest power level an IQ sample can carry over the fronthaul interface (i.e. average(I2+Q2) = 1) while considering the configured gain\_correction value and the IQ compression properties to be used; configured gain\_correction is sum of RX carrier specific gain\_correction and eAxC specific gain\_correction. In addition, in order to avoid saturation over the interface when beamforming is used over the rx-array carrier, the largest power level that can be received at the assumed-lossless antenna port by the rx-array carrier element shall be equivalent to 0 dBFS - 10.log10(number of array elements). The configured gain-correction shall allow the adjustment of the level of the smallest & largest receivable power.

The following principles shall apply:

1. The UL gain of an RX eAxC shall be equal to the UL gain of the rx-array carrier element, and contributions to IQ in the eAxC from all rx-array elements shall have the same gain.
2. The minimum and maximum power levels that can be received by the RX eAxC shall be scaled by

+10.log10(number of array elements) from the respective values of the rx-array carrier element (i.e. when signals are received with equal levels from all the elements of the rx array meaning no tapering used and all rx elements have same design properties). In case an rx-array has only one rx-array element, then the scale factor shall be unity. The reason behind this principle is to allow applying tapering (beam ID dependent) to an rx- array without impacting the quality of the IQ data being transferred over the interface (i.e. in a worst case scenario, the signal is received from only one rx-array element from the rx-array).

1. Assumed-lossless antenna port means antenna losses shall be part of the unit under test.
2. The -152 dBm shall be considered as the smallest level that can be measured by a narrow subcarrier of

1.25 kHz for a system with 3 dB of equivalent noise figure and without being impacted by the interface noise (i.e. 20 dB margin considered). This relation with the smallest non-zero IQ power and the signal power defines Default\_UL\_gain.

Default\_UL\_gain [dB] = Interface resolution [dBFS] - (-152) [dBm]

1. Configured\_UL\_gain [dB(FS/mW)] = Default\_UL\_gain[dB(FS/mW)] + gain\_correction [dB]; Default\_UL\_gain is kept by O-RU while gain\_correction is configured by O-DU. O-RU ensures that IQ power shall follow Configured\_UL\_gain including Default\_UL\_gain and gain\_correction for each eAxC flow.

The Default\_UL\_gain shall depend on the fronthaul interface resolution (in dBFS) representing the smallest level that can be used. The interface resolution depends on the compression scheme which can be static or dynamic. For this reason, when multiple compression methods or IQ bitwidths are used for data streams received from an rx-array carrier element, the configured gain shall be applied to all the intended compression methods and IQ bitwidths following the formula defined in principle #4 and #5 above for each compression method and IQ bitwidth. The Configured\_UL\_gain depends on the compression method and IQ bitwidth, therefore, IQ power in UL direction has, in absence of beamfoming, a fixed relation to the signal power regardless of compression formats and IQ bitwidths.

For example, when using block floating point compression, the interface resolution shall be defined as: Interface resolution [dBFS]=-20 x log (2Mantissa\_bits -1 x 22Exponent\_bits-1)

10

where:

* + *Mantissa\_bits* is the number of mantissa bits in the defined block floating point notation.
  + *Exponent\_bits* is the number of exponent bits in the defined block floating point notation.

It is assumed that the gain\_correction is 0 dB by default, unless a different value is needed due to special circumstances (details beyond the scope of the present document).

The gain\_correction is configured as one value per rx array carrier and does not change once an array carrier is activated. The O-RU applies a configured value of gain\_correction regardless of used compression.

EXAMPLE: With rx-array formed by 10 array elements and gain\_correction of 0 dB:

9-bit mantissa 2's complement + 4-bit exponent => Interface resolution=-138.5 dBFS Configured\_UL\_gain [dB(FS/mW)] = -138.5 dBFS + 152 dBm + 0 dB = 13.5 dB The UL gain and power scaling are summarized in Table 8.1.3.2.3-1.

**Table 8.1.3.2.3-1: Example of UL gain and power scaling for an rx array with 10 elements and for block floating point compression based on 9-bit mantissa and 4-bit exponent**

|  |  |  |
| --- | --- | --- |
| **Interface resolution = -138.5 dBFS** | **rx-array carrier element** | **Rx-array carrier with 10 elements** |
| **Configured\_UL\_gain** | 13.5 dB(FS/mW) | 13.5 dB(FS/mW) |
| **Lowest received power level without degradation due to interface (excluding losses due to**  **beamforming weights)** | -152 dBm => -138.5 dBFS | -142 dBm => -128.5 dBFS |
| **Largest possible received power level** | -23.5 dBm => -10 dBFS | -13.5 dBm => 0 dBFS |

###### TX power budget for Category A and Category B O-RUs

This clause describes the handling of the power budget in a category A and category B O-RU. In general, care shall be taken to avoid exceeding the maximum rms power rating of a tx-array element.

In this clause, ma,k is the maximum rms power rating (in W) of tx-array element *k* of a tx-array *a* with *K* elements. For simplicity it is assumed all *K* elements of the array have the same maximum rms power rating (i.e. for every array *a* and every k and k', ma,k = ma,k'). **For an O-RU with tx-array *a*, the maximum rms power rating of tx-array element shall be reported as read-only parameter. This will be a common value for all array elements of the tx-array *a*.**

NOTE 1: The maximum rms power rating can be reported as form of gain when mapped to 0 dBFS.

The maximum rms power rating of array can be derived from ma,k by scaling linearly with the number of elements *K*

(i.e. ma = *K*.ma,k)

In addition, let gc,a,k be the gain [dB(mW/FS)] configured for tx-array element k of tx-array a for array carrier c. It is considered that the configured gain is same to every element (i.e. for every tx-array carrier c, every tx-array a and every element k and k', gc,a,k = gc,a,k'). **Hence, the O-DU shall configure the O-RU by providing a value for gc,a,k in parameter 'gain' of tx-array-carrier.**

The total gain of array carrier *c* served on array *a* can be derived from the configured gain gc,a,k as:

gc,a [dB(mW/FS)] = gc,a,k [dB(mW/FS)] + 10 ? log10(*K*).

where:

* gc,a is the total gain of array carrier *c* served on array *a*
* gc,a,k is the configured gain of array element *k* of array *a* for carrier *c*

Hence, the power pc,a,k of array carrier *c* served on tx-array element *k* of array *a* can be derived as:

pc,a,k [dBm] = gc,a,k [dB(mW/FS)] + 0 dBFS.

As a result, the total power of pc,a of array carrier *c* served on tx-array *a* is derived as:

pc,a [dBm]= pc,a,k [dBm] + 10 ? log10(*K*),

where:

* *K* is the total number of array elements in array *a*

Finally, the total power pa.k (mW) used on tx-array element *k* of tx-array *a* serving all configured carriers is derived as:

pc,a,k

pa,k = 10 ? log10 ? 10 10 .

c

In scenarios where a tx-array element k is shared between multiple tx-arrays, the O-DU shall ensure that the configured gains gc,a,k are constrained by:

gc,a,k+Reference\_Levelc

? ? 10 10

<= 1000 ? mk

where:

a c

mk = min(ma,k)

a

*Reference\_Level*c [dBFS] is the array-carrier specific IQ power level used as a reference for normalization, which is optionally configured via M-Plane per array carrier (the value 0 is used if this parameter is not supported by the O-RU or not configured by the O-DU).

The index *a* spans over every tx-array *a* that shares array element *k* and has array carrier configured. The summing over

*c* includes every array carrier *c* that is configured for tx-array *a*.

NOTE 2: In general *m*a,k can be different for different values of tx-array *a*. However, tx-arrays not used in a given configuration do not contribute to the above constraint.

If O-RU reports via M-Plane the minimum gain of the tx-array element then the O-DU shall ensure that the configured gains gc,a,k are constrained by:

Min\_Gaina,k <= gc,a,k + (Reference\_Levelc - 0 dBFS)

where *Min\_Gain*a,k [dB(mW/FS)] is the tx-array element specific minimum gain optionally reported by the O-RU via the M-Plane parameter min-gain.

For every configured array carrier *c* over a tx-array *a*, the O-DU shall ensure that the input IQ power levels of all resource elements used over all eAxCs x are constrained by:

REdBFS

n,x,c,a

Reference\_Levelc

? ? 10 10 <= 10 10

and

Where:

x n

dBFS

RE <= 0

n,x,c,a

* REdBFS = input IQ power level [dBFS] of an RE *n* of an eAxC *x* of array carrier *c* configured over tx-array *a*.

n,x,c,a

* REdBFS = 10 ? log10(In,x,c,a2 + Qn,x,c,a2) - 10 ? log10(FS0 ? 2-FS\_Offset )

n,x,c,a

where:

* In,x,c,a and Qn,x,c,a are decompressed IQ sample value components, FS0 and *FS\_Offset* are defined in clause 8.1.3.1.

The summing over *x* includes every eAxC *x* of array carrier *c* that is used simultaneously in DL on the tx-array a. The summing over *n* includes every RE of the eAxC *x* that is used simultaneously in DL.

When beamforming is used in O-RU, an additional constraint applies to all the beamforming weights to be used for beamforming in order to ensure that the tx power per tx-array element after the beamforming has well-defined upper bound and does not exceed the limit of the maximum rms power rating of the tx-array element. To simplify the notation and cover all beamforming types, i.e. frequency-domain beamforming and time-domain beamforming, any individual beamforming weight (a complex number multiplier used by O-RU in beamforming operation) is denoted as *w*.

**For any beamforming weight *w* to be used by O-RU to perform beamforming operations, the entity controlling the generation of the weight (i.e. O-DU or O-RU) shall ensure that:**

|w|2 <= 1.

This constraint is applicable to every beamforming weight, used in frequency or time domain. The constraint is applicable to every explicit or implied beamforming weight applied by O-RU regardless of the source of the beamforming weight (e.g. received from O-DU, predefined by O-RU, generated by O-RU from beam attributes or from channel information, etc.).

###### UL IQ output level for DMRS-BF-EQ

This clause defines the UL IQ output level when DMRS-BF-EQ is used. In this case, a configured UL gain (see clause 8.1.3.2.3) as used for other beamforming methods is not applicable. In general, the IQ output level shall be scaled by the O-RU, as configured by the O-DU, to avoid detrimental overflow when encoding data for the interface.

As described in clause 12.6.3.5, the equalized IQ sample output from DMRS-BF-EQ for RE n and layer l is expressed as:

IEQ + jQEQ = Xn,l x Gn,l + ?n,l

n,l n,l

where Xn,l is a random variable representing the respective wanted signal (i.e. a complex modulation symbol as defined by 3GPP TS 38.211 [4] clause 5.1 for CP-OFDM, and an output of the DFT of the complex modulation symbols for DFT-spread OFDM), ?n,l is an unknown residual term including e.g. the respective interference plus noise and any channel estimation errors, and Gn,l is the respective positive real-valued scaling from the equalization. Two scaling functions specified in clause 12.6.3.5.

For Scaling function 1, Gn,l is a monotonic function of SINR with the following properties:

0 < Gn,l <= 1 and lim

SINRn,l->?

For Scaling function 2, Gn,l = 1, which is independent of SINR.

Gn,l = 1.

For an MMSE equalizer, Scaling function 1 matches the equalizer output bias. For an equalizer without output bias, Scaling function 2 matches the equalizer. In other cases, the O-RU shall, when necessary, apply appropriate scaling to the output of the equalizer, so that the resulting output bias matches that of the selected scaling function, see also clause 12.6.3.5.

The power of a statistical signal is defined as the mean value of the instantaneous power of the signal. Therefore, the IQ output power of the equalizer for RE n and layer l is expressed as:

P = E [|IEQ 2

EQ 2

2 2 + ?2

IQ,n,l

n,l |

+ |Qn,l | ] = E [|Xn,l| ] x Gn,l

n,l

where ?2

2 is the power of the residual term.

n,l = E [|?n,l| ]

For both CP-OFDM and DFT-spread OFDM, the power of Xn,l equals one:

2

PX,n,l = E [|Xn,l| ] = 1.

Then, the IQ power of equalizer output is expressed as:

P = E [|IEQ 2

EQ 2

2 + ?2

IQ,n,l

n,l |

+ |Qn,l | ] = Gn,l

n,l

Independent of scaling option used, when SINR is high it can be assumed that G2 = 1 and ?2 << 1. Then, in this case,

n,l n,l

PIQ,n,l ? 1. However, the magnitude of I or Q or both can be larger than one when high-order modulation is used. For example, the corner constellation points of 64-QAM have magnitude 7/?42 ? 1.08 for each of I and Q. Further, the I and Q magnitude can become larger than one due to residual noise plus interference, e.g. when SINR is low. For DFT- spread OFDM, the I and Q magnitudes can be significantly larger than one due to its high crest factor in frequency domain.

To avoid overflow when encoding data for the fronthaul interface, an O-RU scale offset in dB, **eq-scale-offset-config**, is configured by the O-DU via M-Plane as part of endpoint creation. The configured value shall be within the range indicated by O-RU declared **eq-scale-offset-min** and **eq-scale-offset-max**, where none of the values shall exceed 0 dB. After endpoint creation, the O-RU shall report the read-only parameter **eq-scale-offset-used**. This parameter shall be the O-RU's best approximation of the eq-scale-offset-config, but shall not exceed eq-scale-offset-config. After scaling, the IQ data on the fronthaul interface shall fulfil:

eq\_scale\_offset\_used

EQ

EQ

In,l + jQn,l = ?FS0 x 10 20 x (In,l + jQn,l ),

where FS0 = max(I2) = max(Q2) is the full scale (maximum) instantaneous power that can be represented by each of I and Q for the selected fronthaul data format. The restriction on full scale here differs from the definition in clause

8.1.3.1 in that it only pertains to instantaneous power of each of I and Q, not to the sum of their powers, since the purpose of the scaling is only to avoid overflow when quantizing to the fronthaul data format, not to limit IQ power, and also since equalized data are not subject to random phase rotation from the channel.

For high SINR (Gn,l = 1 and residual noise + interference power approaching zero), the power in dBFS of each of I and Q on the fronthaul interface approximately equals to the value of eq-scale-offset-used. The O-DU should configure the scale offset to, with sufficiently high probability (as determined by the O-DU at its discretion), avoid overflow when the O-RU encodes IQ data for the interface, i.e. with sufficiently high probability achieve:

EQ

EQ

-eq\_scale\_offset\_used

max(|In,l |, |Qn,l |) <= 10

which ensures that, with same probability,

20 ,

2 2

max (|In,l| , |Qn,l| ) <= FS0.

## Elementary procedures

#### IQ data transfer procedure

This procedure (an alternative procedure IQ data transfer is described in clause 8.2.2) shall be used to transfer frequency domain IQ data samples between the O-DU and O-RU. Data shall be transmitted symbol by symbol as U-Plane messages. U-Plane data (UL and DL) shall always be preceded by control information (C-Plane) except for U-Plane data covered under M-Plane static configuration e.g. see clauses 8.3.5.3 and 8.3.5.4 pertaining to PRACH and SRS. U- Plane data shall be sent in a different data flow from the C-Plane with its own header and encapsulated payload.

C-Plane messages pertaining to U-Plane data may be sent for every slot (or for LTE, TTI). An overview of the logic for transmission of both the data-associated control information and IQ data is depicted in Figure 8.2.1-1.

|  |  |  |
| --- | --- | --- |
| **IP & Ethernet Headers** | **C-Plane header** | **Control info** |

|  |  |  |
| --- | --- | --- |
| **IP & Ethernet Headers** | **U-Plane header** | **IQ Data** ![](../assets/images/5807c890b6f3.png) |

|  |  |  |
| --- | --- | --- |
|  |  | **Control Info** |

|  |  |  |
| --- | --- | --- |
|  |  | **IQ Data** |

|  |  |  |
| --- | --- | --- |
|  |  | **Control Info** |

|  |  |  |
| --- | --- | --- |
|  |  | **IQ Data** |

|  |  |  |
| --- | --- | --- |
|  |  | **IQ Data** |

|  |  |  |
| --- | --- | --- |
|  |  | **IQ Data** |

**Figure 8.2.1-1: DL IQ data transfer overview**

![](../assets/images/abcd3e665205.png)![](../assets/images/48eb0092ed7c.png)![](../assets/images/4ca50610c805.png)![](../assets/images/6a08c0686083.png)![](../assets/images/25e4d49b8805.png)![](../assets/images/093852120383.png)![](../assets/images/4ca50610c805.png)![](../assets/images/72943f950b56.png)

**Application Layer**

**Legend**

Control Info

for SLOT #n

U-Plane IQ Data for SLOT #n

for a single flow of data, point of view of sender

Control Info

for SLOT #n+1

U-Plane IQ Data for SLOT #n+1

**Transport Layer**

**IQ Data**

**IQ Data**

**Control Info**

**IQ Data**

**IQ Data**

**Control Info**

C-Plane and U-Plane messages are not concatenated but are sent in physically separate frames

The IQ transfer procedure shall comprise of two types of messages:

* Message containing scheduling and beamforming commands information (i.e. data-associated control).
* Message containing frequency domain IQ samples.

The data-associated control information shall be bundled in messages within a single data flow (albeit possibly in multiple C-Plane messages). However, control information for UL and DL shall be sent separately (See Figure 8.2.1-2). As shown in Figure 8.2.1-2, the C-Plane messages for a given slot and given symbol(s) exchanged between the O-DU and O-RU are followed by the U-Plane data for that slot and symbol(s), one symbol at a time. U-Plane messages shall be sent by the O-DU and O-RU in order of the symbol for which they carry IQ data. C-Plane and DL U-Plane messages shall be sent by the O-DU in advance (see clause 4.5 for details) such that they arrive at O-RU within a time window that is early enough to leave the O-RU time to process them. Figure 8.2.1-2 shows the case where O-DU sends DL C- Plane message describing symbols #M, M+1,..., N of slot S between "T1a\_max\_cp\_dl" and "T1a\_min\_cp\_dl" before the start of DL symbol #M (the earliest symbol described by the message). As shown in Figure 8.2.1-2, the end of receive time window for DL C-Plane messages describing symbol #M, M+1, ..., N of slot S (where M is the earliest symbol described by each of messages) is by "Tcp\_adv\_dl" earlier than the end of receive time window for DL U-Plane messages carrying IQ data for symbol #M. The O-DU shall send and the O-RU shall receive DL U-Plane message as per the transmission window and reception window specified in clause 4.5. Similarly, the O-DU shall send UL C-Plane messages describing symbols #M, M+1, ..., N of slot S between "T1a\_max\_cp\_ul" and "T1a\_min\_cp\_ul" before the start of the UL symbol #M (the earliest symbol described by the message). The end of receive time window for UL C- Plane messages describing symbol #M, M+1, ..., N (where M is the earliest symbol described by each of messages) shall be "T2a\_min\_cp\_ul" earlier than the start of UL symbol #M. The O-RU shall send and the O-DU shall receive UL U-Plane message as per the transmission window and reception window specified in clause 4.5. For non-PRACH

channels the O-RU shall send UL U-Plane message carrying IQ data for symbol #M between "Ta3\_min" and "Ta3\_max" after the reception of the earliest air interface sample of UL symbol #M (this corresponds to start of cyclic prefix). For PRACH channels the O-RU shall send UL U-Plane messages carrying IQ data for a PRACH Symbol between "Ta3\_min" and "Ta3\_max" after the reception of the earliest air interface sample that is necessary to generate the IQ data in the message (this corresponds to the start of the FFT sampling window).

Also shown in Figure 8.2.1-2 is the fact that there is a certain period of time between the O-RU's receipt of C-Plane messages for a symbol and the need for the O-RU to process U-Plane data for that symbol. In particular, in the DL there shall be a period of time, "Tcp\_adv\_dl" which provides for some number of microseconds for the O-RU to e.g. update beamforming weights prior to processing the DL data arriving from the O-DU. In the UL there shall be a period of time, "t2a\_min\_cp\_ul" between the O-RU's receiving the C-Plane messages governing the processing of UL data and the receipt of UL signals at the O-RU's antennas. These time intervals, when combined with network delays and other processing latencies, result in the RAN's HARQ loop to be closed allowing feedback in the air interface processing.

**DL C-Plane and DL U-Plane**

![](../assets/images/eb33a8ffba72.png)![](../assets/images/c9e21c7f87ff.png)![](../assets/images/9e267b6c31b9.png)

**UL C-Plane and UL U-Plane**

**network**

**delay**

the start of UL U-plane transmit window for symbol #N

**time flow**

**...**

the start of UL U-plane transmit window for symbol #M+1

the start of UL U-plane transmit window for symbol #M

the earliest air interface UL signal sample for symbol #M arrives at O-RU antenna

the end of UL C-plane receive window for symbol #M

messages arrive at RU before the deadline by a margin > inaccuracies of timing params.

**O-DU**

**(@ FH interface)**

**O-RU**

**(@ FH interface)**

messages arrive at RU before the deadline by a margin > inaccuracies of timing params.

**O-RU**

**(@ FH interface)**

**O-DU**

**(@ FH interface)**

**network**

**delay**

**Tcp\_adv\_dl** min. time the O-RU has to

**t2a\_min\_cp\_ul** min. time the O-RU has to prepare to

**network** process UL signals

the end of DL C-plane receive window for symbol #M

messages arrive at RU before the deadline

by a margin > inaccuracies of timing params.

the end of DL U-plane receive window for symbol #M

prepare to process DL data from the O-DU

**delay**

at the antenna

**ta3\_min**

the end of DL U-plane receive window for symbol #M+1

**...**

the end of DL U-plane receive window for symbol #N

**time flow**

NOTE 1: A DL C-Plane message describing multiple symbols shall arrive at O-RU at least **Tcp\_adv\_dl** before the end of DL U-Plane receive window for symbol **startSymbolId** (the earliest symbol described by the message).

NOTE 2: A UL C-Plane message describing multiple symbols shall arrive at O-RU at least **t2a\_min\_cp\_ul** before the earliest air interface UL signal sample of symbol **startSymbolId** (the earliest symbol described by the message) arrives at O-RU antenna.

**Figure 8.2.1-2: C-Plane and U-Plane message transfer procedure (DL & UL shown)**

Regardless of the level of compression, user plane data may exceed the maximum packet size (e.g. MTU of 1500 Bytes for regular not Jumbo frames) even in case of one symbol of granularity. Thus, IQ data for each symbol may require packetization over multiple packets.

User plane messages are sent as resource blocks ("PRBs") and the data for each PRB shall start on a byte boundary. If due to the IQ bit-width being used the natural end of the data in the PRB does not fall on a byte boundary, then zero bits shall be appended until a byte boundary is reached.

PRACH data shall be handled similarly, such that the PRACH REs are packaged into 12-RE blocks analogous with data PRBs. Each 12-RE block shall be padded with zero bits to end on a byte boundary. In cases when there is not an even

factor of 12 REs in the PRACH data (e.g. 839 PRACH REs), added zero-value REs shall be added to fill out the block to 12 REs, and then if needed zero-padding will then be appended to reach a byte boundary.

#### IQ data transfer procedure without C-Plane

This is an optional procedure used to transfer frequency domain IQ data samples between the O-DU and O-RU without C-Plane control. With respect to IQ data transfer, this procedure shall follow the rules described in clause 8.2.1 with an exception: data-associated control information for selected eAxCs shall not be transferred in C-Plane messages but configured via M-Plane. This method is applicable to channels with predictable scheduling (like PRACH or SRS) which do not require changes of data-associated control information in real-time.

In the present document this procedure is applicable to eAxCs assigned to receive a subset of uplink signals and channels - specifically PRACH and SRS (see clause 8.3.5.3 and clause 8.3.5.4):

1. O-DU shall provide via M-Plane data-associated control information (this consists of scheduling and beamforming configuration) to O-RU and shall activate the eAxC. C-Plane messages shall not be sent for this eAxC.
2. O-RU will periodically receive uplink radio signal following the configured schedule and shall send U-Plane messages containing frequency domain IQ data (as in clause 8.2.1). Values of fields in U-Plane message headers and data section headers shall be derived from parameters configured via M-Plane as per rules described in M-Plane specification [7].

For more details on parameters that convey scheduling and beamforming configuration and rules for mapping them to U-Plane messages refer to M-Plane specification [7].

In addition, IQ data transfer without C-Plane may be applied to DL U-Plane data. This is applicable to deployment use cases where the O-RU is a category A O-RU without beamforming. When the feature is supported by the O-RU as indicated via the M-Plane feature **UPLANE-ONLY-DL-MODE** and enabled via the M-Plane parameter **uplane-only- dl-mode-enable** the O-DU may omit sending DL C-Plane messages to the O-RU. For minimal impact on the O-DU DL processing the O-DU may continue to transmit DL C-Plane messages despite enabling the U-Plane only DL mode on the O-RU. The following aspects shall apply for this mode of operation:

* + The O-RU is a category A O-RU and supports U-Plane only DL mode operation.
  + For any received DL U-Plane messages the O-RU shall assume all bits in reMask are set for the received PRBs.
  + The O-RU shall ignore any received DL C-Plane messages.
  + The mode, when enabled, shall apply to all TX endpoints of the O-RU.
  + The usage of real-time endpoint configuration (scs, cpLength, etc.) via DL section type 3 is not supported.
  + Beamforming is not supported.

NOTE: U-Plane only DL mode is intended to entirely disable processing of DL C-Plane messages to

provide the opportunity for processing and power savings on the O-RU and O-DU. However, the O-DU may be actively interfacing to multiple O-RUs and as such may not be able to completely disable generating and transmitting DL C-Plane messages.

## Elements for the U-Plane protocol

#### General

U-Plane messages shall be encapsulated using a two-layered header approach. The first layer shall consist of an eCPRI or IEEE 1914.3 common header, including fields used to indicate the message type, while the second layer shall be an application layer including necessary fields for control and synchronization. When the optional "little endian byte order"

is configured via M-Plane, the iSample/qSample fields shall use little endian byte order to transmit the complex numbers. Annex D.2 shows little endian byte order format for various I/Q data length.

#### DL/UL data

A common frame format shall be used for U-Plane messages consisting of a transport layer and an application layer. The application layer shall be within the transport payload and shall consist of a common header for time reference, followed by information and parameters dependent and specific to the Section Type in use. Data from multiple sections of the same value may be lined up one after another within the payload. To minimize packet rate over the interface, transmitter should fill messages with as many subsequent sections as possible. Data from sections of different Section Types may be mixed within a single U-Plane message for a given eAxC when the Section Types do not have differences in format and values of user plane application header or format of user plane section header. Whenever necessary, padding bits shall be added at the end of a section after (possibly compressed) I and Q sample data to achieve 1-Byte alignment. Within a resource block, unless an sReSMask is included in the udCompParam field, 12 REs shall always be sent across the interface. If some REs are meant to be blank some data (perhaps zero value) shall be sent anyway because the U-Plane data parser will expect exactly 12 complex RE values per resource block.

The following bullet list of information elements ("fields") shall be used within U-Plane messages as applicable, use of those fields shall observe the byte formatting as described in table 8.3.2-1:

* Transport Layer - see clause 5.1.3.
* Application Layer.
* Section Type 0 fields (used for indicating idle or guard periods from O-DU to O-RU):
  + No U-Plane messages are associated with Section Type 0.
* Section Type 1 fields (used for most Downlink and Uplink physical radio channels):
  + Common header fields
    - **dataDirection** (data direction (gNB Tx/Rx)) field: 1 bit.
    - **payloadVersion** (payload version) field: 3 bits:

Value = "1" shall be set (1st protocol version for payload and time reference format).

* + - **filterIndex** (filter index) field: 4 bits.
    - **frameId** (frame identifier) field: 8 bits.
    - **subframeId** (subframe identifier) field: 4 bits.
    - **slotID** (slot identifier) field: 6 bits.
    - **symbolId** (symbol identifier) field: 6 bits.
  + Section header fields:
    - **sectionId** (section identifier) field: 12 bits.
    - **rb** (resource block indicator) field: 1 bit.
    - **symInc** (symbol number increment command) field: 1 bit.
    - **startPrbu** (starting PRB of user plane section) field: 10 bits.
    - **numPrbu** (number of contiguous PRBs per data section) field: 8 bits.
    - **udCompHdr** (user data compression header) field, not always present: 8 bits.
    - **reserved** (reserved for future use) field, only present with udCompHdr: 1 byte.
    - **udCompLen** (PRB field length) field, not always present: 16 bits.
    - **sReSMask1** (selective RE sending mask), not always present: 12 bits
    - **sReSMask2** (selective RE sending mask), not always present: 12 bits
  + PRB fields:
    - **udCompParam** (user data compression parameter) field: 0, 8 or 16 bits.
    - **iSample** (in-phase sample) field: 1-16 bits.
    - **qSample** (quadrature sample) field: 1-16 bits.
* Section Type 3 fields (used for PRACH and mixed-numerology channels (see NOTE)):
* Timing header, section header and PRB fields same as for Section Type 1.
* Section Type 4 fields (used for sending slot level configuration):
* No U-Plane messages are associated with Section Type 4.
* Section Type 5 fields (used for UE scheduling information):
* Timing header, section header and PRB fields same as for Section Type 1.
* Section Type 6 fields (used for sending channel information for a specific UE ID):
* No U-Plane messages are associated with Section Type 6.
* Section Type 7 fields (used for LBT procedure):
* No U-Plane messages are associated with Section Type 7.
* Section Type 8 fields (used for providing ACK/NACK feedback and Wake-up Ready Indication):
* No U-Plane messages are associated with Section Type 8.

NOTE: Regarding Section Type 3, it is also true that Section Type 1 messages can also be used for PRACH channel data. The UL U-Plane processing in this case is same as a non-PRACH channel in O-RU.

U-Plane messages shall conform to the information element format described in table 8.3.2-1.

**Table** **8.3.2-1: IQ data frame format**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **Section Type 1,3,5: DL/UL IQ data msgs** | | | | | | | | | |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **# of bytes** |  |
| transport header, see clause 5.1.3 | | | | | | | | 8 | Octet 1 |
| dataDirection | payloadVersion | | | filterIndex | | | | 1 | Octet 9 |
| frameId | | | | | | | | 1 | Octet 10 |
| subframeId | | | | slotId | | | | 1 | Octet 11 |
| slotId | | symbolId | | | | | | 1 | Octet 12 |
| sectionId | | | | | | | | 1 | Octet 13 |

|  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **Section Type 1,3,5: DL/UL IQ data msgs** | | | | | | | | | | |
| **0 (msb)** | **1** | **2** | **3** | | **4** | **5** | **6** | **7 (lsb)** | **# of bytes** |  |
| sectionId | | | | | rb | symInc | startPrbu | | 1 | Octet 14 |
| startPrbu | | | | | | | | | 1 | Octet 15 |
| numPrbu | | | | | | | | | 1 | Octet 16 |
| udCompHdr (not always present) | | | | | | | | | 0/1 | Octet 17 |
| reserved (not always present) | | | | | | | | | 0/1 | Octet 18 |
| udCompLen (not always present) | | | | | | | | | 0/2 | Octet 17/19 |
| reserved (not always present) | | | | sReSMask1[11:8] (not always present) | | | | | 0/1 | Octet 17/19/21 |
| sReSMask1[7:0] (not always present) | | | | | | | | | 0/1 | Octet 18/20/22 |
| reserved (not always present) | | | | sReSMask2[11:8] (not always present) | | | | | 0/1 | Octet 19/21/23 |
| sReSMask2[7:0] (not always present) | | | | | | | | | 0/1 | Octet 20/22/24 |
| udCompParam (not always present) | | | | | | | | | 0/1/2 | Octet 17/19/21/23/25 |
| iSample (1st RE in the PRB) | | | | | | | | | 1 | K=  17/19/20/21/23/25/  26/27 |
| qSample (1st RE in the PRB) | | | | | | | | | 1 | K+1 |
| ... | | | | | | | | |  |  |
| iSample (12th RE in the PRB) | | | | | | | | | 1 | K+22 |
| qSample (12 th RE in the PRB) | | | | | | | | | 1 | K+23 |
| udCompParam (not always present) | | | | | | | | | 0/1/2 | K+24 |
| iSample (1st RE in the PRB) | | | | | | | | | 1 | K+24/25/26 |
| qSample (1st RE in the PRB) | | | | | | | | | 1 | K+25/26/27 |
| ... | | | | | | | | |  |  |
| iSample (12th RE in the PRB) | | | | | | | | | 1 | K+46/47/48 |
| qSample (12 th RE in the PRB) | | | | | | | | | 1 | K+47/48/49 |
| ... | | | | | | | | |  |  |
| sectionId | | | | | | | | | 1 | Octet M |
| sectionId | | | | | rb | symInc | startPrbu | | 1 | M+1 |
| startPrbu | | | | | | | | | 1 | M+2 |
| numPrbu | | | | | | | | | 1 | M+3 |
| udCompHdr (not always present) | | | | | | | | | 0/1 | M+4 |
| reserved (not always present) | | | | | | | | | 0/1 | M+5 |
| udCompLen (not always present) | | | | | | | | | 0/2 | M+4/6 |
| reserved (not always present) | | | | sReSMask1[11:8] (not always present) | | | | | 0/1 | M+4/6/8 |
| sReSMask1[7:0] (not always present) | | | | | | | | | 0/1 | M+5/7/9 |
| reserved (not always present) | | | | sReSMask2[11:8] (not always present) | | | | | 0/1 | M+6/8/10 |
| sReSMask2[7:0] (not always present) | | | | | | | | | 0/1 | M+7/9/11 |
| udCompParam (not always present) | | | | | | | | | 0/1/2 | M+4/6/8/10/12 |
| iSample (1st RE in the PRB) | | | | | | | | | 1 | K=M+4/6/7/8/10/ 12/13/14 |
| qSample (1st RE in the PRB) | | | | | | | | | 1 | K+1 |
| ... | | | | | | | | |  |  |
| iSample (12th RE in the PRB) | | | | | | | | | 1 | K+22 |
| qSample (12 th RE in the PRB) | | | | | | | | | 1 | K+23 |
| udCompParam (not always present) | | | | | | | | | 0/1/2 | K+24 |
| iSample (1st RE in the PRB) | | | | | | | | | 1 | K+24/25/26 |
| qSample (1st RE in the PRB) | | | | | | | | | 1 | K+25/26/27 |
| ... | | | | | | | | |  |  |
| iSample (12th RE in the PRB) | | | | | | | | | 1 | K+46/47/48 |
| qSample (12 th RE in the PRB) | | | | | | | | | 1 | K+47/48/49 |
| NOTE 1: Shading: yellow is transport header, pink is radio application header, others are repeated sections.  NOTE 2: Octet count given when the iqWidth = 8 but other iqWidth values are possible; the octet count assumes all REs are present which may not be the case when field sReSMask is present in udCompParam. | | | | | | | | | | |

#### UL/DL data coding of information elements

###### General

See clause 5.1.3 for transport header information element details.

###### dataDirection (data direction (gNB Tx/Rx))

See clause 7.5.2.1.

###### payloadVersion (payload version)

See clause 7.5.2.2.

###### filterIndex (filter index)

See clause 7.5.2.3.

###### frameId (frame identifier)

See clause 7.5.2.4.

frameId in U-Plane message shall be set to the frameId value signaled in the corresponding C-Plane message.

###### subframeId (subframe identifier)

See clause 7.5.2.5.

subframeId in U-Plane message shall be set to the subframeId value signaled in the corresponding C-Plane message.

###### slotId (slot identifier)

See clause 7.5.2.6.

slotId in U-Plane message shall be set to the slotId value signaled in the corresponding C-Plane message.

###### symbolId (symbol identifier)

**Description:** This parameter identifies a symbol number within a slot. When a C-Plane message describes a single symbol (or in case of PRACH, a single PRACH Symbol), symbolId in the U-Plane message for that symbol (or PRACH Symbol) shall be set to the startSymbolId value signaled in the C-Plane message. When a C-Plane message describes multiple symbols (or in case of PRACH/NPRACH, multiple PRACH Symbols), symbolId in the U-Plane message for the first symbol (or PRACH Symbol) shall be set to the startSymbolId value signaled in the C-Plane message. symbolId in the U-Plane message for the subsequent symbols (or PRACH Symbols) are incremented thereon.

**Value range:** {00 0000b-11 1111b}

**Type:** unsigned integer.

**Field length:** 6 bits.

###### sectionId (section identifier)

See clause 7.5.3.1.

###### rb (resource block indicator)

See clause 7.5.3.2.

###### symInc (symbol number increment command)

See clause 7.5.3.3.

###### startPrbu (starting PRB of user plane section)

**Description:** This parameter is the starting PRB (lowest frequency) of a user plane data section. Values of rb, startPrbu and numPrbu shall ensure that data sections shall never overlap: a single PRB (a block of 12 resource elements consecutive in frequency) shall only exist within one data section for a given eAxC. For one section description in a C- Plane message, there may be multiple U-Plane data sections associated with it. The freqOffset parameter conveyed in the corresponding section description affects the frequency span for specific range of PRB numbers (formulas in clause 7.5.3.6 apply with startPrbu replacing startPrbc). Therefore "shall never overlap" shall consider the value of freqOffset.

U-Plane data sections shall include only PRBs addressed by the corresponding C-Plane section descriptions, but the O- RU shall be prepared for possibility of lost C-Plane or U-Plane messages. Depending on the method of coupling of C- Plane and U-Plane more specific rules apply.

If the coupling of C-Plane and U-Plane via sectionId value is used then values of rb, startPrbu and numPrbu shall ensure only PRBs addressed by section descriptions with the same sectionId as the user plane data section are present in the user plane data section. If the coupling of C-Plane and U-Plane via frequency and time (with or without priorities) is used then values of rb, startPrbu and numPrbu shall ensure only PRBs addressed by section descriptions are present in the user plane data section.

Due to fragmentation (an application level fragmentation to meet restriction of message size or a fragmentation of section in frequency, e.g. as a result of presence of Section Extension 6 or 12 in a corresponding section description) there may be multiple user plane data sections for a C-Plane section description. Presence of rb = 1 (see clause 7.5.3.2) in a C-Plane section description shall require the presence of rb = 1 in the associated user plane data section and does not require multiple user plane data sections.

**Value range:** {00 0000 0000b-11 1111 1111b}.

**Type:** unsigned integer.

**Field length:** 10 bits.

###### numPrbu (number of PRBs per user plane section)

**Description:** This parameter defines the number of PRBs (blocks of 12 resource elements consecutive in frequency) in the user plane data section. If the parameter rb (see clause 8.3.3.9) is zero, then the PRBs in the user plane data section shall be consecutive in frequency. Otherwise, the set of PRBs includes only every other PRB in frequency. Values of rb, startPrbu and numPrbu shall ensure that data sections shall never overlap: a single PRB may only exist within one data section for a given eAxC. The freqOffset parameter conveyed in the corresponding section description affects the frequency span for specific range of PRB numbers (formulas in clause 7.5.3.6 apply with startPrbu replacing startPrbc). Therefore "shall never overlap" shall consider the value of freqOffset.

U-Plane data section shall include only PRBs addressed by the corresponding C-Plane section descriptions, but the O- RU shall be prepared for possibility of lost C-Plane or U-Plane messages. Depending on the method of coupling of C- Plane and U-Plane more specific rules apply.

If the coupling of C-Plane and U-Plane via sectionId value is used then values of rb, startPrbu and numPrbu shall ensure only PRBs addressed by C-Plane section descriptions with the same sectionId as the user plane data section are present in the user plane data section. If the coupling of C-Plane and U-Plane via frequency and time (with or without priorities) is used then values of rb, startPrbu and numPrbu shall ensure only PRBs addressed by C-Plane section descriptions are present in the user plane data section.

Due to fragmentation (an application level fragmentation to meet restriction of message size or a fragmentation of section in frequency, e.g. as a result of presence of Section Extension 6 or 12 in a corresponding section description) there may be multiple user plane data sections for a C-Plane section description. Presence of rb = 1 (see clause 7.5.3.2) in a C-Plane section description shall require the presence of rb = 1 in the associated user plane data section and does not require multiple user plane data sections.

**Value range:** {0000 0001b-1111 1111b, 0000 0000b = all PRBs in the specified SCS and carrier bandwidth }.

Value 0000 0000b shall be reserved for NR cases wherein the total number of PRBs may be more than 255; for other cases a non-zero value of numPrbc shall be used. In this case, the sending node shall set the startPrbu value to zero and the receiving node shall ignore whatever startPrbu value is received and assume it is zero.

**Type:** unsigned integer.

**Field length:** 8 bits.

###### udCompHdr (user data compression header)

**Description:** This parameter defines the compression method and IQ bit width for the user data in a data section. This means that, in the DL at least, each data section may have a different udCompHdr value. In the UL, the O-RU shall copy the received udCompHdr value in the C-Plane message to the udCompHdr field in the UL U-Plane message. This C-Plane instruction provides a single udCompHdr value for all data sections defined in the C-Plane message. This field shall be absent from U-Plane messages when the static IQ format and compression method is configured via the M- Plane. In this way a single compression method and IQ bit width is provided (per UL and DL, per LTE and NR) without adding more overhead to U-Plane messages. Table 8.3.3.13-1 provides the udIqWidth and udCompMeth bit allocation, and Table 8.3.3.13-2 and 8.3.3.13-3 provide udIqWidth and udCompMeth definitions respectively, all of which shall be followed in the construction of U-Plane messages.

**Value range:** {0000 0000b-1111 1111b}.

**Table 8.3.3.13-1: Bit allocations**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **Number of Octets** |  |
| udIqWidth | | | | udCompMeth | | | | 1 | Octet 1 |

**T****able 8.3.3.13-2: udIqWidth definition**

|  |  |
| --- | --- |
| **udIqWidth** | **Bit width of each I and each Q** |
| 0000-1111b | 16 for udIqWidth = 0, otherwise equals udIqWidth e.g. udIqWidth = 0000b means I and Q are each 16 bits wide;  e.g. udIQWidth = 0001b means I and Q are each 1 bit wide;  e.g. udIqWidth = 1111b means I and Q are each 15 bits wide |

**Table** **8.3.3.13-3: udCompMeth definition**

|  |  |  |
| --- | --- | --- |
| **udCompMeth** | **compression method** | **udIqWidth meaning** |
| 0000b | no compression | bitwidth of each uncompressed I and Q value |
| 0001b | block floating point (BFP) | bitwidth of each I and Q mantissa value |
| 0010b | block scaling | bitwidth of each I and Q scaled value |
| 0011b | ?-law | bitwidth of each compressed I and Q value |
| 0100b | modulation compression | bitwidth of each compressed I and Q value |
| 0101b | BFP + selective RE sending | bitwidth of each compressed I and Q value |
| 0110b | mod-compr + selective RE sending | bitwidth of each compressed I and Q value |
| 0111b | BFP + selective RE sending with masks in section header | bitwidth of each compressed I and Q value |
| 1000b | Mod-compr + selective RE sending with masks in section header | bitwidth of each compressed I and Q value |
| 1001b - 1111b | reserved for future methods | depends on the specific compression method |

**Type:** unsigned integer (concatenated bit fields).

**Field length:** 8 bits.

###### reserved (reserved for future use)

**Description:** This parameter provides 1 byte for future definition, should be set to all zeros by the sender and ignored by the receiver. This field is only present when udCompHdr is present, and is absent when the static IQ format and compression method is configured via the M-Plane.

**Value range:** {0000 0000b-1111 1111b}, but shall be set to all zeros.

**Type:** unsigned integer.

**Field length:** 8 bits.

###### udCompParam (user data compression parameter)

**Description:** This parameter applies to whatever compression method is used for the PRB (configured statically via M- Plane or specified in udCompHdr of the data section containing the PRB). U-Plane messages shall conform to the information element formatting as described in Table 8.3.3.15-1.

**Value range:** {0000 0000b-1111 1111b}.

**Table 8.3.3.15-1: Bit allocations**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **udCompMeth** | **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **udcompPar am size** |
| 0000b = no compression | absent | | | | | | | | 0 octets |
| 0001b = block floating point (BFP) | reserved (set to all zeros) | | | | exponent (unsigned) | | | | 1 octet |
| 0010b = block scaling | sblockScaler (unsigned, 1 integer bit, 7 fractional bits) | | | | | | | | 1 octet |
| 0011b = ?-law | compBitWidth | | | | compShift | | | | 1 octet |
| 0100b = modulation compr. | absent | | | | | | | | 0 octets |
| 0101b = BFP + selective RE sending | sReSMask[11:8] | | | | exponent (unsigned) | | | | 2 octets |
| sReSMask[7:0] | | | | | | | |
| 0110b = mod-compr + selective RE sending | sReSMask[11:8] | | | | reserved | | | | 2 octets |
| sReSMask[7:0] | | | | | | | |
| 0111b = BFP + selective RE  sending with masks in U-Plane section header | reserved (set to all zeros) | | | | exponent (unsigned) | | | | 1 octet |
| 1000b = mod-compr + selective RE sending with masks in U-Plane section header | absent | | | | | | | | 0 octets |
| 1001b - 1111b (reserved) | not specified | | | | | | | | not specified |

**Type:** variable.

**Field length:** zero for udCompMeth values 0000b and 0100b, 8 bits for udCompMeth values 0001b, 0010b and 0011b, 16 bits for udCompMeth values 0101b and 0110b; other udCompMeth values may imply other lengths but will always be an integer number of bytes.

###### iSample (in-phase sample)

**Description:** This parameter is the In-phase sample value. When the optional "little endian byte order" is configured via M-Plane, refer to Annex D.2 for detail byte order, otherwise see Annex D.1 for example sample formatting.

**Value range:** {all zeros - all ones}.

**Type:** signed integer.

**Field length:** 1-16 bits.

###### qSample (quadrature sample)

**Description:** This parameter is the Quadrature sample value. When the optional "little endian byte order" is configured via M-Plane, refer to Annex D.2 for detail byte order, otherwise see Annex D.1 for example sample formatting.

**Value range:** {all zeros - all ones}.

**Type:** signed integer.

**Field length:** 1-16 bits.

###### sReSMask (selective RE sending mask)

**Description:** This parameter is part of the bit allocations for udCompParam, see clause 8.3.3.15, when using the compression methods block floating point + Selective RE sending or modulation compression + Selective RE sending. It defines the IQ usage mask i.e. IQ-samples in corresponding PRB that are included in the U-Plane message shall be

indicated with bit-value 1b in the mask, IQ-samples that are not included in U-Plane message are indicated with the bit- value 0b. The notation of the IQ-samples 1st, 2nd ... is according to the same order as shown in Table 8.3.2-1. The most significant bit in this mask is defined as the bit for the highest frequency RE in the PRB. The U-Plane message using sReSMask shall use the formatting shown in Table 8.3.3.18-1.

**Value range:** { 0000 0000 0000b - 1111 1111 1111b}. See Table 8.3.3.18-1 and also Table 8.3.3.15-1.

**Bit allocations:**

**Table 8.3.3.18-1: sReSMask bit allocations**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **Number of Octets** |  |
| 12th | 11th | 10th | 9th | not part of sReSMask | | | | 1 | Octet 1 |
| 8th | 7th | 6th | 5th | 4th | 3rd | 2nd | 1st | 1 | Octet 2 |

**Type:** unsigned integer.

**Field length:** 12 bits.

###### udCompLen (PRB field length)

**Description:** This parameter specifies the total number of octets in the current section. This includes bit-padding (performed per PRB after the last part of the last IQ sample of the PRB) in all PRBs in the current section. The maximum supported PRB field length is 216-1, but the actual size may be further limited by the maximum payload size of the underlying transport network. This field shall only be present for the following compression methods:

* + - * + udCompMeth 0101b = BFP + selective RE sending.
        + udCompMeth 0110b = Modulation compression + selective RE sending.
        + udCompMeth 0111b = BFP + selective RE sending with masks in section header.
        + udCompMeth 1000b = Modulation compression + selective RE sending with masks in section header.

If an O-RU declares support of the field then udCompLen shall be included in the U-Plane message (DL and UL). If the O-RU does not declare support of this field then this field shall not be included in the U-Plane message. This ensures backward-compatibility with v03.00 of the present document.

**Value range:** {0000 0000 0000 0010b - 1111 1111 1111 1111b},

{0000 0000 0000 0000b, 0000 0000 0000 0001b} Reserved.

**Type:** unsigned integer.

**Field length:** 16 bits.

###### sReSMask1 (selective RE sending mask 1)

**Description:** This parameter defines the IQ usage mask when using the compression methods 'BFP + selective RE sending with masks in section header' or 'Mod-compr + selective RE sending with masks in section header'. IQ-samples in corresponding PRB that are included in the U-Plane message shall be indicated with bit-value 1b in the mask. IQ- samples that are not included in U-Plane message are indicated with the bit-value 0b. The notation of the IQ-samples 1st, 2nd ... is according to the same order as shown in Table 8.3.2-1. The most significant bit in this mask is defined as the bit for the highest frequency RE in the PRB. The U-Plane message using sReSMask1 shall use the formatting shown in Table 8.3.3.20-1.

sReSMask1 is applicable for PRBs according to:

startPrbu, numPrbu <= 2

startPrbu, startPrbu+2, startPrbu+4, ... , startPrbu+numPrbu-1, numPrbu > 2 and for odd numPrbu startPrbu, startPrbu+2, startPrbu+4, ... , startPrbu+numPrbu-2, numPrbu > 2 and for even numPrbu

If rb (resource block indicator) is set to 1b, see 7.5.3.2, sReSMask1 shall be used for all PRBs in the section.

**Value range:** { 0000 0000 0000b - 1111 1111 1111b}. See Table 8.3.3.20-1 and Table 8.3.3.15-1.

**Bit allocations:**

**Table 8.3.3.20****-1: sReSMask1 and sReSMask2 bit allocations**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **Number of Octets** |  |
| reserved | | | | 12th | 11th | 10th | 9th | 1 | Octet 1 |
| 8th | 7th | 6th | 5th | 4th | 3rd | 2nd | 1st | 1 | Octet 2 |

**Type:** unsigned integer.

**Field length:** 12 bits.

###### sReSMask2 (selective RE sending mask 2)

**Description:** This parameter defines the IQ usage mask when using the compression methods 'BFP + selective RE sending with masks in section header' or 'Mod-compr + selective RE sending with masks in section header'. IQ-samples in corresponding PRB that are included in the U-Plane message shall be indicated with bit-value 1b in the mask. IQ- samples that are not included in U-Plane message are indicated with the bit-value 0b. The notation of the IQ-samples 1st, 2nd ... is according to the same order as shown in Table 8.3.2-1. The most significant bit in this mask is defined as the bit for the highest frequency RE in the PRB. The U-Plane message using sReSMask2 shall use the formatting shown in Table 8.3.3.18-1.

sReSMask2 is applicable for PRBs according to:

none, numPrbu = 1

startPrbu+1, startPrbu+3, startPrbu+5, ... , startPrbu+numPrbu-2, numPrbu >= 1 and for odd numPrbu startPrbu+1, startPrbu+3, startPrbu+5, ... , startPrbu+numPrbu-1, numPrbu >= 1 and for even numPrbu

If rb (resource block indicator) is set to 1b, see 7.5.3.2, sReSMask2 shall be set to 0 and ignored. **Value range:** { 0000 0000 0000b - 1111 1111 1111b}. See Table 8.3.3.20-1 and Table 8.3.3.15-1. **Bit allocations:** See Table 8.3.3.20-1

**Type:** unsigned integer.

**Field length:** 12 bits.

#### DL data precoding

When Section Extension 3 is used for C-Plane and there is present an associated sectionId for U-Plane, then:

* O-RU should read 12 REs which have CRS reference signals in that PRB.
* O-RU shall understand the crsShift and crsReMask field to map appropriately the CRS REs to each antenna port.

Table 8.3.4-1 shows an example of DL data precoding showing several information element values.

**T****able 8.3.4-1: DL data precoding example**

|  |  |  |
| --- | --- | --- |
|  |  |  |
|  |  |  |
|  |  |  |

|  |  |
| --- | --- |
| **C-Plane example**  **DL Precoding configuration parameters and indications (Section Extension 3)** | **O-RU Outcome** |
| * Section ext = 3 * txScheme = 'txD' * codeBookIndex = '00000000' (invalid) * numLayer = 4 * layerId = '0000' (TxD) * crsReMask = 001001001001 (Assuming MSB..LSB) * crsSymNum = 0000 * crsShift = 0 * beamIdAP1 * beamIdAP2 * beamIdAP3 | * Based on numLayers, crsShift, crsSymNum and crsReMask bit positions, CRS ports are mapped to the appropriate RE position and rest are left blank.   **CRS (4 If crsSymNum crsReMask Bit Layer) Position**  (crs\_Ant0) 0 {0,6} + vShift  (crs\_Ant1) 0 {3,9} + vShift |

#### Data transfer for special cases

###### Data message mapping and packetization

See clause 8.3.2.

###### Uplink data transfer

Uplink IQ data transfer is covered in clause 8.3.2. In particular, PRACH and other common channels as well as SRS and other reference signal channels may use the same frequency domain IQ data packetization as with user data channels (PDSCH, PUSCH) following the transfer procedure described in clause 8.2.1. Optionally, PRACH and SRS related IQ data may be transferred as described in clause 8.3.5.3 and clause 8.3.5.4.

###### PRACH data transfer without C-Plane

In addition to general uplink data transfer (see clause 8.3.5.2), PRACH related IQ data may be transferred using the IQ data transfer procedure without C-Plane (see clause 8.2.2). In this case parameters controlling signal reception and sending U-Plane messages shall be provided via M-Plane. Refer to "Static PRACH" in M-Plane specification (see [7]) for description of M-Plane parameters and rules for sending U-Plane messages and interpretation of fields in U-Plane messages.

###### SRS data transfer without C-Plane

In addition to the general uplink data transfer (see clause 8.3.5.2), SRS related IQ data may be transferred with IQ data transfer procedure without C-Plane (see clause 8.2.2). In this case parameters controlling signal reception and sending U-Plane messages shall be provided via M-Plane. Refer to "Static SRS" in M-Plane specification (see [7]) for description of M-Plane parameters and rules for sending U-Plane messages.

## U-Plane optimizations

#### Coupling via frequency and time

Coupling between C-Plane section descriptions and U-Plane data sections via frequency and time (for more details see clause 7.8.1.3) is a mode of operation enabled per eAxC via the M-Plane. It allows to optimize U-Plane message size by combining data sections that are continuous in frequency and are within the same symbol. Combined data sections shall share the same data section header (sectionId, rb, symInc, startPrbu, numPrbu and optionally udCompHdr) resulting in reduced message size. Value of sectionId shall be the same for all sections (predefined value) and does not prevent combining. If udCompHdr is present, then data sections can be combined only if value of udCompHdr is the same.

Details of resource allocation (e.g. discontinuity in frequency, differences in compression) can restrict combining but resulting U-Plane message size shall always be less than or equal to the size without combining.

This U-Plane optimization method is compatible with all Section Types and Section Extensions with an exception for Section Type 3. With this coupling method, when multiple Section Type 3 messages are sent each with two (or more) different "freqOffset" values and/or "frameStructures", but same startPrbc and numPrbc, each C-Plane message can be uniquely identified by "freqOffset" and/or "frameStructure" fields, however associated U-Plane message with sectionId as 4095 and with no "freqOffset" or "frameStructure" cannot be uniquely identified. Hence, Section Type 3 shall not be used in conjunction with Time-Frequency Coupling. A frequency discontinuity of beamforming configuration in

C-Plane does not imply discontinuity of data sections in U-Plane.

EXAMPLE 1: Before combining in symbol *s* there are two data sections: A and B such that A.udCompHdr = B.udCompHdr and A.startPrbu < B.startPrbu and A.rb = B.rb = 0. If B.startPrbu = A.startPrbu + A.numPrbu then A and B can be combined into data section C such that C.rb = 0, C.startPrbu = A.startPrbu, C.numPrbu = A.numPrbu + B.numPrbu.

EXAMPLE 2: Before combining in symbol *s* there are two data sections: A and B such that A.udCompHdr = B.udCompHdr and A.startPrbu < B.startPrbu and A.rb = B.rb = 1. If B.startPrbu = A.startPrbu + 2 ? A.numPrbu then A and B can be combined into data section C such that C.rb = 1, C.startPrbu

= A.startPrbu, C.numPrbu = A.numPrbu + B.numPrbu.

EXAMPLE 3: Before combining in symbol *s* there are two data sections: A and B such that A.udCompHdr = B.udCompHdr and A.startPrbu < B.startPrbu and A.rb = B.rb = 1. If B.startPrbu = A.startPrbu + 1 and A.numPrbu = B.numPrbu then A and B can be combined into data section C such that C.rb = 0, C.startPrbu = A.startPrbu, C.numPrbu = A.numPrbu + B.numPrbu.

The above examples are non-exhaustive.

#### Data blanking

###### Overview

Data blanking refers to the process of not sending PRBs on the fronthaul interface for some time and frequency resources in DL and/or UL directions. The objectives of data blanking include reduction of the fronthaul interface bitrate, power saving, and to provide an interval for antenna calibration. Data blanking may be performed by the O-DU in case of DL. In the UL case, the O-RU shall follow the O-DU instructions received in the C-Plane message(s).

Data blanking can take one of two forms: PRB blanking and Transmission blanking.

###### PRB blanking

PRB blanking is an inherent feature of the frequency-domain-based fronthaul split 7-2x, where unallocated PRBs are not sent across the fronthaul interface to reduce the fronthaul throughput. An unallocated PRB is a PRB with all REs unallocated.

In the case of DL, if one or more sets of PRBs are not allocated within one or more symbols of a specific slot (based on the scheduler), the O-DU should not refer to those unallocated PRBs within the C-Plane message(s). Consequently, the O-DU should not send zeros in the corresponding time/frequency REs related to those unallocated PRBs in the U-Plane messages.

NOTE: An O-DU is permitted to send C-Plane messages referring to the unallocated PRBs and then send in U- Plane messages zero values in the corresponding time/frequency resources (REs). This allows a more efficient use of C-Plane messages, for example, in the specific case of rate matching where PRBs are unallocated for certain layers.

Similarly, for UL, only allocated PRBs should be indicated by the O-DU in the UL C-Plane message(s). The O-RU shall send U-Plane messages only for the indicated PRBs.

###### Transmission blanking

Transmission blanking is a feature directly related to Section Type 0, where the O-DU indicates to the O-RU that certain PRBs or symbols in DL or UL will not be used (idle periods, guard periods). Likewise, there are no associated U-Plane messages containing IQ data for Section Type 0. The purpose is to inform the O-RU that transmissions may be halted during the specified idle interval for example to save power or to provide an interval for antenna calibration.

## Aspects of U-Plane operation

#### O-RU U-Plane limits

###### O-RU U-Plane message limits

For the O-RUs with per U-Plane message processing limits, the O-RU may advertise its limitations on a per U-Plane message basis. The O-DU may indicate that it adheres to the associated limitations. The defined limit is the maximum number of section headers per downlink U-Plane message. If the O-DU sets **uplane-message-section-header-limit- enabled** to 'true' then the O-DU shall comply to the U-Plane message processing limits. If the O-DU does not set **uplane-message-section-header-limit-enabled** to 'true' then the O-RU shall process the U-Plane message even if the maximum number of section headers per message exceeds the limit indicated by **max-section-headers-per-uplane- message,** however the stated O-RU capacity may be compromised. Refer to clause 15.10 of the M-Plane Specification

[7] for details on usage of this feature.

When O-DU adheres to the per U-Plane message limit max-section-headers-per-uplane-message, the O-DU cannot rely on transport layer fragmentation to ensure that the limitation is not exceeded. The O-DU may use application layer fragmentation to ensure the limit is not exceeded.

# Counters, KPIs and RRM measurements

## Counters

This clause defines recommended O-RAN C/U-Plane specific performance counters for the fronthaul interface.

Table 9.1-1 defines the set of mandatory and optional O-RAN performance counters to be implemented within an O-RU or O-DU. These counters are defined from the perspective of the O-RU's or O-DU's Ethernet interfaces. These counters increment on eCPRI/IEEE1914.3 (see clause 5.1.3) message-based events. A message is defined as a complete eCPRI, or IEEE1914.3 message including header and payload. Unless otherwise noted in Table 9.1-1, these counters may be implemented to count events with a granularity of per O-RU, per Transport Flow, or per eAxC as indicated in the fronthaul M-Plane specification [7]. In addition to counters defined in Table 9.1-1, Cascade O-RU (see clause 13.1) or FHM (see clause 13.1) may implement counters listed in Table 9.1-2, to count events related to combine function with a granularity per processing elements.

NOTE: Higher granularity counters provide more detailed information and can simplify managing and troubleshooting the front haul network.

The counters defined in Table 9.1-1 and Table 9.1-2 should only increment if the message is contained in a valid (error free) layer 2 or layer 3 packet. For example, if the packet has no layer 2 CRC or no layer 3 checksum errors it may be counted. All counters defined in the present document are wrap-around counters. Wrap-around counters are counters that automatically go from their maximum/final value to zero and continue to operate. These are unsigned counters.

These counters shall provide explicit means to return them to their minimum/zero state, i.e. reset during normal operation. Due to their nature, wrap-around counters should be read frequently enough to avoid loss of information.

Only the transport related counters are listed in Table 9.1-1; other O-RU counters may also be relayed across the fronthaul interface and these are described in Annex B of the M-Plane Specification [7].

**Table 9.1-1: O-RU and O-DU Performance Counter Definitions**

|  |  |  |  |
| --- | --- | --- | --- |
| **Counter name** | **Size (bits)** | **Mandatory or Optional** | **Counter definition** |
| RX\_TOTAL | 64b | Mandatory | The total number of control/user plane eCPRI or IEEE 1914.3 messages received. This counter is the sum of all valid and errored  messages received. (previously O-RAN-WG4.CUS.0-v02.00 named this Total\_msgs\_rcvd). |
| RX\_ON\_TIME | 64b | Mandatory | The number of inbound user plane (ecpri type 0) messages that arrived within the specified time window (NOTE). Some "on time" messages may have sequence number errors or corruption errors but as long as they arrived within specified window time, this counter should include them. If the received message has been transport-fragmented, the full message shall be reassembled before checking its arrival window.   * Implementation of per O-RU counter is required. * Implementation of per transport counters are optional. * Implementation of per eAxC counters are optional. In the present document this counter is not specified for FHM. |
| RX\_EARLY | 64b | Mandatory | The number of inbound user plane messages which were detected to have arrived before the start of their designated receive window time (NOTE). This counter increments whether the message is subsequently processed or dropped.   * Implementation of per O-RU counter is required. * Implementation of per transport counters are optional. * Implementation of per eAxC counters are optional. In the present document this counter is not specified for FHM. |
| RX\_LATE | 64b | Mandatory | The number of inbound user plane messages which were detected to have arrived after the end of their designated receive window time (NOTE). This counter increments whether the message is subsequently processed or dropped. |

|  |  |  |  |
| --- | --- | --- | --- |
| **Counter name** | **Size (bits)** | **Mandatory or Optional** | **Counter definition** |
|  |  |  | * Implementation of per O-RU counter is required. * Implementation of per transport counters are optional. * Implementation of per eAxC counters are optional. In the present document this counter is not specified for FHM. |
| RX\_SEQID\_ERR | 64b | Optional | The number of inbound on time user plane messages in which a sequence identifier number error is detected. When this counter is implemented with an eAxC granularity, separate uplink and downlink counters shall be implemented.  This error occurs when the ecpriSeqId field does not increment as specified in clause 5.1.3. Both the Sequence ID, and Subsequence ID fields shall be checked if transport fragmentation is supported otherwise only the Sequence ID field may be checked.  In addition to identifying a sending equipment sequencing error, this counter can increment when packets are dropped prior to reception by the O-RU, or when packets reordered by the network exceed the  receiving device's capabilities. |
| RX\_ON\_TIME\_C | 64b | Mandatory | The number of valid inbound control plane (ecpri type 2) messages that arrived within the specified time window. Some "on time" messages may have sequence number errors or corruption errors but as long as they arrived within specified window time, this counter should count them (NOTE).   * Implementation of per O-RU counter is required. * Implementation of per eAxC counters are optional. * Implementation of per transport counters are optional. * Implementation of counters for each combination of eAxC and dataDirection fields are optional.   In the present document this counter is not specified for FHM. |
| RX\_EARLY\_C | 64b | Mandatory | The number of inbound control plane messages which were detected to have arrived before the start of their designated receive window time (NOTE). This counter increments whether the message is subsequently processed or dropped.   * Implementation of per O-RU counter is required. * Implementation of per eAxC counters are optional. * Implementation of per transport counters are optional. * Implementation of counters for each combination of eAxC and dataDirection fields are optional.   In the present document this counter is not specified for FHM. |
| RX\_LATE\_C | 64b | Mandatory | The number of inbound control plane messages which were detected to have arrived after the end of their designated receive window time (NOTE). This counter increments whether the message is subsequently processed or dropped.   * Implementation of per O-RU counter is required. * Implementation of per eAxC counters are optional. * Implementation of per transport counters are optional. * Implementation of counters for each combination of eAxC and dataDirection fields are optional.   In the present document this counter is not specified for FHM. |
| RX\_SEQID\_ERR\_ C | 64b | Optional | The number of inbound on time control messages in which a sequence identifier number error is detected. This counter increments under the same conditions as the rx\_seqid\_num\_err except for control plane messages.   * Implementation of per O-RU counter is optional. * Implementation of eAxC counters is optional. * Implementation of per transport counters are optional. * Implementation of counters for each combination of eAxC and dataDirection fields are optional. |

|  |  |  |  |
| --- | --- | --- | --- |
| **Counter name** | **Size (bits)** | **Mandatory or Optional** | **Counter definition** |
| RX\_CORRUPT | 64b | Optional | The number of inbound on time messages with a correct ecpriSeqId (no sequence number error) which are dropped by the terminating entity due to the message containing one or more eCPRI/IEEE 1914.3 or O- RAN protocol errors. This counter's granularity is limited to per O-RU or per transport flow implementations.  Protocol errors are defined as when eCPRI/IEEE 1914.3/O-RAN defined fields contain invalid values or indicate unsupported capabilities. Some examples of this are:   1. PcId or section Id number which has not been configured. 2. Unexpected use of C bit, 3. Unconfigured or Unsupported udCompHdr setting. 4. Unsupported Section Extension. 5. Wrong ecpriVersion and/or payloadVersion information 6. ecpriMessage field does not contain 0, 2, or 5. |
| RX\_ERR\_DROP |  | Optional | The total number of inbound messages which are discarded by the receiving O-RAN entity for any reason. |
| RX\_PKT\_DUPL | 64b | Optional | Duplicated packet. This counter is deprecated. |
| TX\_TOTAL | 64b | Mandatory | The number of valid outbound control/user plane messages. |
| TX\_TOTAL\_C | 64b | Mandatory | The number of valid outbound control plane messages. This counter is required on an O-RU only if O-RU supports LAA/LBT capabilities. |
| NOTE: Specified window time or designated receive window time is defined by delay parameters T2amin and T2amax, See table 4.4.2.1-1 .Because the FHM has no reception windows governed by T2amin and T2amax,  the FHM lacks these performance counters. | | | |

**Table 9.1****-2: Combine Function Related Performance Counter Definitions**

|  |  |  |  |
| --- | --- | --- | --- |
| **Counter name** | **Size (bits)** | **Mandatory or Optional** | **Counter definition** |
| RX\_UP\_UL | 64b | Optional | The number of received user plane eCPRI or IEEE 1914.3 messages in UL direction which correspond to configured processing elements and eAxC\_IDs in the shared cell. |
| RX\_UP\_UL\_COMBINED | 64b | Optional | The number of user plane eCPRI or IEEE 1914.3 messages from RX\_UP\_UL which will be processed by the combine functional block to generate the combined messages to northbound, which correspond to configured processing elements and eAxC\_IDs in the shared cell. |

**Reference point for RX\_UP\_UL (**AN**)**

![](../assets/images/8a7aae8c80d9.png)![](../assets/images/f48b926aadbb.png)![](../assets/images/cc0dce09b6ab.png)![](../assets/images/1862cceff095.png)

**FHM/Cascade O-RU**

U-plane Memory

B1 A1

**South Node #1**

**North Node**

Combine

Function

**Packet T**ii**m**ii**ng Check**

(p(paackckeetstscocouuldldbbeeddroroppppeeddif

too eaifrtlyoorlattoeo) late)

Block

U-plane Memory

BN

AN

**South Node #N**

Packet Timing Check

(packets could be dropped if

too early or too late)

![](../assets/images/aa2844ace78e.png)

AN

***...***

***...***

**Reference point for RX\_UP\_UL\_COMBINED (**BN**)**

![](../assets/images/78a4d64def82.png)

BN

**Figure 9.1****-1. Reference Point Model of Performance Counter for UL combining Function**

Optionally FHM/Cascade O-RU may support counters specified in Table 9.1-2. The reference points to count the number of messages for those counters are described in Figure 9.1-1. FHM/Cascade O-RU counts RX\_UP\_UL (An) as the number of u-plane messages per transport flow which have a specific processing-element and specific eAxC\_IDs when messages are received. Combine functional block processes combining IQ payload from eligible messages at a certain time and counts RX\_UP\_UL\_COMBINED (Bn) as the number of messages of which IQ payloads are combined.

The gradually increased difference between An and Bn indicates that messages in a specific transport flow are continuously missed (received but not processed by combine function block) for UL combining.

If every south node sends the same number of U-Plane messages per C-Plane message, there is another way to check if some messages are missed for UL combining. If RX\_UP\_UL\_COMBINED counters B1, ..., Bn are same, this indicates the situation where no message is missed among any transport flow or the same number of message(s) in all transport flows are missed during the interval. If these counters B1, ..., Bn are different, some messages are missed at a certain time while other messages arrived in time and their IQ payload are combined.

## RRM measurements

#### Overview

Section Type 10 C-Plane message is used to send Radio Resource Management (RRM) measurement reports from the O-RU to the O-DU. The main purpose is for DMRS-BF, see clause 12.6. Measurements based on DMRS (UE timing advance error, UE layer signal power, UE frequency offset, interference plus noise for allocated PRBs, and DMRS SNR per antenna) can only be supported by O-RUs supporting SE 24, which describes the DMRS configuration and triggers DMRS-based measurements. Measurement of interference plus noise for unallocated PRBs is an exception since it does not require knowledge of DMRS and can thus be used without SE 24 (and without DMRS-BF). Section Type 10 supports Section Extensions and has a flexible structure that can be extended with new RRM measurement types. Using Section Extensions is optional but at least one measurement report shall be included in each ST 10. Measurement reports come after any Section Extensions and have a format resembling Section Extensions.

The O-RU declares support for different RRM measurements, and the O-DU enables desired measurements as described in clause 9.2.3. Certain measurements are mandatory to support depending on DMRS-BF type, see also clause 10.2. O-RU support for a measurement means ability to receive and process a C-Plane message requesting the measurement (where applicable), performing the measurement, and sending an ST 10 measurement report to the O-DU. O-DU support for a measurement means that the O-DU may request a measurement (where applicable) and can receive ST 10 messages containing the measurement. There is no specific requirement governing how an O-DU uses a supported measurement or if it uses a supported measurement at all.

The measurement types are listed in Table 9.2.1-1 and described in more detail in clause 9.2.2. All configured RRM measurements for DMRS-BF that are triggered by Section Extension 24 shall, unless explicitly stated, be provided in every slot that uses DMRS-BF (in any PRBs). In general, the measurement reports follow a Type, Length, Value scheme.

**Table 9.2.1****-1: RRM measurement types**

|  |  |  |
| --- | --- | --- |
| **measTypeId = integer value** | **Triggering method** | **Measurement description** |
| MEAS\_UE\_TAE = 1 | Presence of SE 24 | **UE Timing Advance Error per UE, per slot**  Measurement report with one value per UE may be sent with eAxC\_ID and ueId of any layer of the UE. |
| MEAS\_UE\_LAYER\_POWER = 2 | Presence of SE 24 | **UE layer signal power per layer, per slot**  Measurement report with a list of one value per layer for a UE may be sent with eAxC\_ID and ueId of any layer of the UE. |
| MEAS\_UE\_FREQ\_OFFSET = 3 | Presence of SE 24 | **UE Frequency offset per UE, per slot** Measurement report with one value per UE may be sent with eAxC\_ID and ueId of any layer of the UE. |
| MEAS\_IPN\_ALLOC = 4 | Presence of SE 24, with additional measurement control by SE 24 'aIpnPerSym' parameter | **Interference plus Noise for allocated PRBs, per slot or per DMRS symbol group**  Measurement with one value per allocated PRB, averaged over all DMRS symbols, or per DMRS symbol group is controlled by aIpnPerSym with related O-RU declared capabilities as described in clause 9.2.2.4.  Measurement report is sent with the M-Plane configured RX endpoint (a single eAxC\_ID per rx-array- carrier) as described in clause 9.2.2.4. Here, ueId in ST  10 has no meaning and shall be set to 0x7FFF (non- scheduled ueId). |
| MEAS\_IPN\_UNALLOC = 5 | Section Type 11 command with measTypeId MEAS\_IPN\_UNALLO C | **Interference plus Noise for unallocated PRBs, per symbol or per set of symbols in a slot** Measurement report with one value per PRB, for a single symbol or as an average over a set of symbols, restricted by O-RU declared capabilities described in clause 9.2.2.5, is sent with the specific RX endpoint used in the ST 11 measurement request (a single eAxC\_ID per rx-array-carrier). Here, ueId in ST 10 has  no meaning and shall be set to 0x7FFF (non-scheduled ueId). |
| MEAS\_ANT\_DMRS\_SNR = 6 | SE 24 'antDmrsSnr' parameter | **DMRS Signal to Noise Ratio per antenna, per layer** Antenna refers to array element or element after any DMRS dimension reduction, per layer (assigned a DMRS port), and per slot. Measurement report with one value per antenna for a layer is sent with the eAxC\_ID  and ueId of respective layer. |

Each RRM measurement type has an implicit measurement profile specifying how reporting is done. More details about the measurements are described in clause 9.2.2. The UE-specific measurement reports MEAS\_UE\_TAE, MEAS\_UE\_LAYER\_POWER, and MEAS\_UE\_FREQ\_OFFSET for one UE shall be sent in same ST 10 section. Also, layer-specific measurement reports (MEAS\_ANT\_DMRS\_SNR) may be sent in same ST 10 section as UE-specific reports if eAxC\_ID and ueId match.

For UE- and layer-specific reports, measurements for different UEs and different layers shall be sent using eAxC\_ID and ueId as described in the respective subclauses of clause 9.2.2. The O-RU may send reports for UEs in different (SU-

/MU-MIMO) user groups in same ST 10 C-Plane message (using different sections) if this does not violate reporting constraints (e.g. on eAxC\_ID and ueId) for any of the measurement reports involved.

Coupling between C-Plane measurement request and C-Plane measurement report resembles coupling between C-Plane and U-Plane messages. The value of sectionId in ST 10 shall be copied from the measurement request (ST 5 + SE 24 or ST 11), except for MEAS\_IPN\_ALLOC when it is reported with the eAxC\_ID of a dedicated IpN endpoint (see clause

9.2.2.4). If a UE is scheduled using multiple section descriptions (with multiple sectionId values), per-UE and per-layer reports for that UE (or layer) may be sent using any one of the sectionId values used to convey scheduling information for the UE. The O-DU can use other parameters than sectionId to identify messages: for UE-specific and per-layer measurements, ueId can be used. For IpN measurements, PRB range together with symbolMask in measurement report is sufficient.

The rb bit and parameter reMask in ST 10 shall be copied from the measurement request. For all measurement reports except IpN for unallocated PRBs, startPrbc and numPrbc shall be copied from the ST5 + SE 24 measurement trigger section(s). For IpN for unallocated PRBs, startPrbc and numPrbc shall be copied from ST 11. Section Extensions SE 6, SE 12, and SE 20 are applicable to both ST 10 and ST 11, to describe contiguous or non-contiguous ranges of PRBs and symbols. A use case for such Section Extension is for IpN for unallocated PRBs, which can contain multiple non- contiguous PRB ranges:

* Handling non-contiguous PRB ranges: If the O-RU supports any of SE 6, SE 12, or SE 20, and if the O-DU uses any one of the supported Section Extensions in the measurement request, the O-RU shall copy the used Section Extension to the ST 10 report. In this case, measurements for non-contiguous PRB ranges can be reported within same section, supporting efficient reporting of multiple non-contiguous time and frequency resources.
* Handling contiguous PRB ranges: per-PRB reports shall be sent with one contiguous PRB range per ST 10 section, described by startPrbc and numPrbc.
* The O-RU shall not use any Section Extension with ST 10 unless the O-DU used the same Section Extension in the measurement request.
* No bit shall be set to one in the symbolMask of any ST 11 measurement command or in the symbolMask of any ST 10 measurement report if the corresponding symbol is not referred to by the respective ST 10 or ST 11 section description (including any Section Extensions).

For ST 10, startSymbolId shall be set to 0 and numSymbol shall be set to 14. This means that all ST 10 messages for a slot are transmitted in a single transmission window defined by Ta3\_min\_2g and Ta3\_max\_2g. The RRM measurements for the transmissions of different UEs using the same range of PRBs but different sets of symbols are identified by the ueId value in the section description of ST 10.

For ST 11, startSymbolId is used in the same way as for ST 1/3/5 and may be set to zero. Other values may be used but any Section Extensions or measurement commands for ST 11 containing a symbol mask shall have all bits in the mask before startSymbolId set to zero. See clause 7.5.2.7.

#### RRM measurement types

###### MEAS\_UE\_TAE (UE Timing Advance Error)

UE Timing Advance Error (UE-TAE) is measured on PUSCH DMRS and is reported with one UE-TAE value per UE per slot. The UE-TAE is defined at the antenna reference point and represents the average UE-TAE over all array elements and all used PRBs. It is defined relative to the UL frame timing at the antenna reference point, indicating by how much the UE should advance transmit timing to ensure that the signal is received at desired time instant. A positive UE-TAE means that the signal from the UE arrives late while a negative UE-TAE means that the signal arrives early.

NOTE 1: Since UE-TAE is defined at the antenna reference point, the O-RU is expected to, when necessary, compensate the measurement result to mitigate impact of any processing (e.g. O-RU internal dimension reduction) between the antenna reference point and the point where the O-RU performs the measurement. When O-DU controlled dimensionality reduction with SE 27 is used then the O-RU reports RRM measurement as affected by the dimensionality reduction (without compensation) and the O-DU accommodates effects of the dimensionality reduction if necessary.

The reported UE-TAE from the O-RU may be used by the O-DU for UE transmit timing adjustment, following 3GPP TS 38.213 [i.5], clause 4.2. In general, equalization alters timing of the received signal so that the residual UE-TAE at

equalizer output is zero or close to zero. Beamforming can also alter the timing, which means that UE-TAE can in general not be measured by the O-DU for DMRS-BF. However, A DMRS-BF-NEQ O-RU may declare support for feature **DMRS-BF-NEQ-UNALTERED-TAE**, which means that the O-RU shall ensure that DMRS-BF-NEQ beamforming does not change UE-TAE, hence it can be measured by the O-DU.

The ueId in the Section Type 10 header indicates which UE the measurement refers to. The measurement report may be sent with the eAxC\_ID and ueId associated with any layer of the UE (any value of layer-number part of the ueId). The report will contain a single measurement value even if the UE has multiple scheduled layers or if the UE is scheduled in multiple user groups (in different PRB or symbol ranges).

The reported UE-TAE is mapped to a signed 16-bit integer where one integer step represents a time resolution of (30 kHz / SCS) x Tc , where Tc = (480 kHz x 4096)-1 ? 0.509 ns is defined in 3GPP TS 38.211 [4] clause 4.1. Measurement range: +- 0.5 OFDM symbol (excluding cyclic prefix) for the used subcarrier spacing. See parameter ueTae in clause 7.5.3.60 for more information on the data format.

NOTE 2: The UE-TAE measurement value reported has larger range and higher resolution than the TA command value defined in 3GPP TS 38.213 [i.5] clause 4.2.

###### MEAS\_UE\_LAYER\_POWER (UE layer signal power)

UE layer signal power measurement is measured on PUSCH DMRS and is reported with one power value per DMRS port (associated with a UE layer) per slot. The layer signal power is defined at the antenna reference point and represents the linear average of signal power over all PRBs received per DMRS port of a UE, i.e. the received signal power per layer of a UE summed over all array elements and averages all used PRBs.

NOTE: Since layer signal power is defined at the antenna reference point, the O-RU is expected to, when necessary, compensate the measurement result to mitigate impact of any processing (e.g. O-RU internal dimension reduction) between the antenna reference point and the point where the O-RU performs the measurement. When O-DU controlled dimensionality reduction with SE 27 is used then the O-RU reports RRM measurement as affected by the dimensionality reduction (without compensation) and the O-DU accommodates effects of the dimensionality reduction if necessary.

The reported value may be used by the O-DU for PUSCH closed loop power control, see 3GPP TS 38.213 [i.5], clause

7.1. When a UE has more than one layer, the O-DU can add the reported layer signal power values (after converting to linear power) of the UE to obtain total UE signal power for determining the TPC command.

The ueId in the Section Type 10 header indicates which UE the measurement refers to. The measurement report may be sent with the eAxC\_ID and ueId associated with any layer of the UE (any value of layer-number part of the ueId).

Each layer power value is reported in unit dBm/PRB, with resolution 0.1 dB, and mapped to a 16-bit integer. See parameter ueLayerPower in clause 7.5.3.61 for more information on the data format.

###### MEAS\_UE\_FREQ\_OFFSET (UE Frequency offset)

UE frequency offset is measured on PUSCH DMRS for each UE and is reported with one value per UE per slot. The UE frequency offset is defined at the antenna reference point and represents the average frequency offset over all array elements and all used PRBs. A positive frequency offset means that the signal from the UE has higher frequency than expected while a negative frequency offset means that the signal has lower frequency than expected.

NOTE: Since frequency offset is defined at the antenna reference point, the O-RU is expected to, when necessary, compensate the measurement result to mitigate impact of any processing (e.g. O-RU internal dimension reduction) between the antenna reference point and the point where the O-RU performs the measurement. When O-DU controlled dimensionality reduction with SE 27 is used then the O-RU reports RRM measurement as affected by the dimensionality reduction (without compensation) and the O-DU accommodates effects of the dimensionality reduction if necessary.

In addition to, or instead of, its own measurement, the O-RU may receive an O-DU-reported frequency offset in SE 26, which it may use at its discretion. However, the O-RU frequency offset measurement report to the O-DU shall contain whatever frequency offset it used for compensation of the user data.

In general, equalization alters frequency offset of the received signal so that the residual frequency offset at equalizer output is zero or close to zero. Beamforming can also alter the frequency offset, which means that frequency offset can in general not be measured by the O-DU for DMRS-BF. However, A DMRS-BF-NEQ O-RU may declare support for feature **DMRS-BF-NEQ-UNALTERED-FREQ-OFFSET**, which means that the O-RU shall ensure that DMRS-BF- NEQ beamforming does not change frequency offset, hence it can be measured by the O-DU.

The ueId in the Section Type 10 header indicates which UE the measurement refers to. The measurement report may be sent with the eAxC\_ID and ueId associated with any layer of the UE (any value of layer-number part of the ueId). The report will contain a single measurement value even if the UE has multiple scheduled layers or if the UE is scheduled in multiple user groups (in different PRB or symbol ranges).

The frequency offset is reported in unit Hz. The measurement value is mapped to a signed 16-bit integer where one integer step represents a frequency resolution proportional to SCS (e.g. 0.5 Hz resolution for SCS = 30 kHz) and the supported range is +-  1/2  subcarrier. If the O-RU is unable to measure frequency offset, it shall report the special value for invalid measurement result. See parameter ueFreqOffset in clause 7.5.3.62 for more information on the data format.

###### MEAS\_IPN\_ALLOC (Interference plus Noise for allocated PRBs)

Interference plus noise for allocated PRBs (MEAS\_IPN\_ALLOC) is measured on PUSCH DMRS and is reported with one value per PRB, either for one symbol, or as an average over multiple symbols. It is defined at the antenna reference point and represents the per-PRB linear sum of inter-cell interference and noise power over all array elements. It is measured on DMRS REs, after subtraction of all useful signals (contribution from all DMRS data from all layers to a particular RE), and on any unused REs in same PRB as the DMRS REs (to reduce measurement variance), but without subtraction.

NOTE 1: Since IpN for allocated PRBs is defined at the antenna reference point, the O-RU is expected to, when necessary, compensate the measurement result to mitigate impact of any processing (e.g. O-RU internal dimension reduction) between the antenna reference point and the point where the O-RU performs the measurement. When O-DU controlled dimensionality reduction with SE 27 is used then the O-RU reports RRM measurement as affected by the dimensionality reduction (without compensation) and the O-DU accommodates effects of the dimensionality reduction if necessary.

The IpN measurement for allocated PRBs is useful for the scheduler in the O-DU to optimize scheduling decisions. This measurement relates to the PRB and symbol range of a user group, but not to the UEs of the user group, hence it is not related to any specific UE and thus the ueId in the section header shall be set to 0x7FFF by the O-RU and ignored by the O-DU.

If the O-RU supports measurement of Interference plus Noise (IpN) for allocated PRBs, it shall have RX endpoints declaring support for MEAS\_IPN\_ALLOC and ST 10, among other capabilities. Those endpoints may also support DMRS-BF. For an O-RU also supporting MEAS\_IPN\_UNALLOC, any endpoint that supports MEAS\_IPN\_ALLOC shall either support DMRS-BF or MEAS\_IPN\_UNALLOC, or both.

NOTE 2: The O-RU is permitted to declare support for MEAS\_IPN\_ALLOC on RX endpoints supporting DMRS- BF, or on dedicated endpoints for IpN (also supporting MEAS\_IPN\_UNALLOC when applicable), or both.

For each rx-array-carrier using DMRS-BF and where the O-DU will request IpN for allocated PRBs, the O-DU shall configure exactly one RX endpoint that supports MEAS\_IPN\_ALLOC to convey the MEAS\_IPN\_ALLOC measurement reports. This is done by enabling the measurement in list **rrm-meas-enabled** for one endpoint per rx- array-carrier only. The endpoint configured for MEAS\_IPN\_ALLOC shall either be an endpoint configured for DMRS- BF, or a non-beamforming endpoint dedicated for IpN. When a dedicated IpN endpoint is used, it shall be the same endpoint as configured for MEAS\_IPN\_UNALLOC when MEAS\_IPN\_UNALLOC is supported and enabled. The measurement report shall be sent with the associated eAxC\_ID of the configured endpoint. Depending on O-RU

implementation, this may be an endpoint also used for IpN for unallocated PRBs, or a dedicated endpoint if IpN for unallocated PRBs is not supported, or a DMRS-BF endpoint.

NOTE 3: MEAS\_IPN\_ALLOC reports from all user groups in same rx-array-carrier are sent with eAxC\_ID of same endpoint. This endpoint need not be in any SE 10 member-list or port-list for the C-Plane message with providing DMRS information with ST 5 + SE 24.

The measurement report contains a symbolMask field indicating over which DMRS symbols the IpN was averaged. An O-RU supporting MEAS\_IPN\_ALLOC shall be able to measure IpN for allocated PRBs on any DMRS symbol pattern indicated by an allowed dmrsSymbolMask as described in clause 7.7.24.11. This can require measuring IpN on up to four DMRS symbols per slot and PRB (PRB range), if the O-RU supports four-symbol DMRS patterns. No bit in the symbolMask shall be set to one for symbols not carrying DMRS. The symbolMask represents symbols in natural order, as received on the air interface. The measurement request can, subject to O-RU capability, be controlled by the 'aIpnPerSym' parameter (see clause 7.7.24.4) in SE 24. The O-RU declares via M-Plane which values of aIpnPerSym it supports: **alloc-ipn-per-dmrs-sym-grp-supported** = {0, 1, or '0 and 1'}. The O-DU shall only use supported values of aIpnPerSym.

* When aIpnPerSym = 0, the O-RU shall report one value per PRB, calculated as a linear average over all DMRS symbols. The bits in the symbolMask shall be set to one for all symbols carrying DMRS for the user group's PRB range.
* When aIpnPerSym = 1, the O-RU shall provide one measurement report per DMRS symbol group, each with one value per PRB, calculated as a linear average over the symbols within the respective DMRS symbol group. A DMRS symbol group is defined as a group of DMRS symbols with adjacent symbol numbers. The bits in the symbolMask in the measurement report for a specific DMRS symbol group shall be set to one for all DMRS symbols in that DMRS symbol group. All other bits in the symbolMask of that report shall be set to zero. Reporting per DMRS symbol group instead of per DMRS symbol is a trade-off between measurement density and C-Plane bitrate while limiting the number of reporting options. For example, with the aIpnPerSym

= 1 in SE 24 and a DMRS configuration of either 1+1 or 2+2, the O-RU will in both cases send two MEAS\_IPN\_ALLOC reports for each PRB range.

The maximum number of measurement reports per PRB range and slot is an O-RU declared capability (**max-ipn-alloc- reports-supported**) and shall be at least one. An O-RU declaring aIpnPerSym-supported = 1 shall declare max-ipn- alloc-reports-supported equal to, or larger than, the number of DMRS symbol groups that it supports for DMRS-BF. Thus, IpN for each DMRS symbol group can be reported. If the O-RU declares aIpnPerSym-supported = '0 and 1', it may declare max-ipn-alloc-reports-supported to a lower value than the supported number of DMRS symbol groups. The rules for which DMRS symbol groups to report when aIpnPerSym = 1 and aIpnPerSym-supported = '0 and 1' are shown in Table 9.2.2.4-1 and depends on the smallest value of max-ipn-alloc-reports-supported and the number of DMRS symbol groups. When max-ipn-alloc-reports-supported is equal to or larger than the number of DMRS symbol groups, there will be one measurement report for each DMRS symbol group. Otherwise, the selection order (highest priority first) is, as shown in the table: first DMRS symbol group, last DMRS symbol group, second DMRS symbol group, second to last DMRS symbol group. This selection order shall be maintained if, in the future, more than 4 DMRS symbol groups would be supported by 3GPP.

**Table 9.2.2.4-1: Rules for reporting MEAS\_IPN\_ALLOC per DMRS symbol group when SE 24 parameter aIpnPerSym = 1 and alloc-ipn-per-dmrs-sym-grp-supported = '0' and '1'.**

|  |  |
| --- | --- |
| **min(max-ipn-alloc-reports-supported, Number of DMRS symbol groups)** | **DMRS symbol group(s) to report** |
| 1 | first |
| 2 | first, last |
| 3 | first, second, last |
| 4 (NOTE) | first, second, second to last, last |
| NOTE: 5G NR as of Release 17 supports a maximum of 4 DMRS symbol groups (DMRS configuration 1+1+1+1 according to 3GPP TS 38.211 [4] Release 17, clause 7.4.1.1. | |

IpN for allocated PRBs is reported in unit dBm/PRB with resolution 0.1 dB, and is mapped to a 16-bit integer per PRB (and for multiple symbols indicated by symbolMask unless average IpN is requested). See parameter ipnPower in clause 7.5.3.63 for more information on data format.

###### MEAS\_IPN\_UNALLOC (Interference plus Noise for unallocated PRBs)

Interference plus Noise for unallocated PRBs (MEAS\_IPN\_UNALLOC) is measured on uplink PRBs where no UE is scheduled and is reported with one value per PRB, either for one symbol, or as an average over multiple symbols. It is defined at the antenna reference point and represents the per-PRB linear sum of inter-cell interference and noise power over all array elements.

NOTE: Since IpN for unallocated PRBs is defined at the antenna reference point, the O-RU is expected to, when necessary, compensate the measurement result to mitigate impact of any processing (e.g. O-RU internal dimension reduction) between the antenna reference point and the point where the O-RU performs the measurement. When O-DU controlled dimensionality reduction with SE 27 is used then the O-RU reports RRM measurement as affected by the dimensionality reduction (without compensation) and the O-DU accommodates effects of the dimensionality reduction if necessary.

The IpN measurement for unallocated PRBs complements the measurement of IpN for allocated PRBs and is useful for the scheduler in the O-DU to optimize scheduling decisions. Together, the two measurements give the scheduler information about interference plus noise over the whole PRB range. MEAS\_IPN\_UNALLOC is requested using Section Type 11 with a dedicated eAxC. Section ID from ST 11 shall be copied to the ST 10 measurement report. This measurement relates to a PRB and symbol range where no user group is scheduled, hence it is not related to any specific UE and thus the ueId in the section header shall be set to 0x7FFF by the O-RU and ignored by the O-DU.

If the O-RU supports measurement of IpN for unallocated PRBs, it shall have RX endpoints declaring support for MEAS\_IPN\_UNALLOC, ST 10, and ST 11, among other capabilities. For each rx-array carrier where the O-DU will request IpN for unallocated PRBs, the O-DU shall configure exactly one RX endpoint that supports MEAS\_IPN\_UNALLOC as a dedicated MEAS\_IPN\_UNALLOC endpoint to convey the measurement reports. This is done by enabling the measurement in list **rrm-meas-enabled** for one endpoint per rx-array-carrier only. The eAxC\_ID of the configured endpoint shall be used with the ST 11 measurement command triggering MEAS\_IPN\_UNALLOC and the ST 10 measurement report shall be sent with same eAxC\_ID. If MEAS\_IPN\_ALLOC is used and supported by the O-RU, the dedicated endpoint used for MEAS\_IPN\_UNALLOC may also be used for IpN for allocated PRBs, see clause 9.2.2.4 for details.

The reMask in ST 11 and ST 10 header shall be ignored by MEAS\_IPN\_UNALLOC and irrespective of the actual value of reMask, IpN shall be measured on all REs in the specified PRBs. The ST 11 measurement command contains a symbolMask field specifying over which symbols IpN shall be averaged and the ST 10 measurement report contains a corresponding symbolMask field indicating over which symbols IpN was averaged for this report. A symbolMask with a single bit set means that measurement is requested (ST 11) and reported (ST 10) for that specific symbol, without averaging. These symbolMasks represent symbols in natural order, as received on the air interface. No bit shall be set to one in the symbolMask of an ST 10 report or ST 11 command if the corresponding symbol is not referred to by the respective ST 10 or ST 11 section description (including any Section Extensions). If SE 20 is used to puncture one or more symbols for a subset of the PRB range, the symbolMask in ST 10 report and ST 11 command shall be interpreted as set to zero for punctured symbols in the PRB ranges where puncturing applies. There shall be no reported value for a PRB range where all symbols in ST 10 / 11 symbolMask are punctured. Puncturing by SE 20 may allow using fewer measurement reports and fewer sections by excluding symbols for a subset of the PRB range specified by the ST 10 or ST 11 section description.

Each measurement request requires one ST 11 measurement command from the O-DU and shall result in one ST 10 measurement report by the O-RU. The maximum number of measurement reports per PRB (PRB range) and slot is limited by the O-RU declared capability **max-ipn-unalloc-reports-supported**. An average over all symbols, using a measurement command with all bits in symbolMask set to 1, counts as one report. A value for a single symbol, using a measurement command with the corresponding bit set, also counts as one report. Multiple commands, each with a

non-overlapping symbolMask, may be used to request multiple averages (or multiple single-symbol values). The measurement report shall support any symbolMask with at least one bit set, i.e. averaging over any combination of one or more symbols, if the total number of measured symbols of all measurement reports for a PRB (PRB range) in the slot

does not exceed the O-RU declared capability **max-ipn-unalloc-symbols-supported**. To get consistent IpN results over the whole PRB range for the scheduler, an O-RU supporting MEAS\_IPN\_UNALLOC should at least support measurement over same number of symbols, and with same averaging (same number of measurement reports), as MEAS\_IPN\_ALLOC.

The unallocated PRBs to measure on are explicitly specified using parameters of Section Type 11, in combination with some optional Section Extension describing PRB and symbol range (SE 6, SE 12, or SE 20), that shall be copied to ST 10 if included with ST 11. Measurement of IpN for unallocated PRBs shall not be requested for frequency-time resources (PRB, symbol pair) that are scheduled by ST 1/3/5.

IpN for unallocated PRBs is reported in unit dBm/PRB, with resolution 0.1 dB, and mapped to a 16-bit integer per PRB (and per symbol in the symbol mask unless average IpN is requested). See parameter ipnPower in clause 7.5.3.63 for more information on data format.

###### MEAS\_ANT\_DMRS\_SNR (Measurement of DMRS SNR per antenna)

Antenna DMRS SNR is measured on PUSCH DMRS and is reported with one value per layer (assigned DMRS-port) per antenna per slot. Here, antenna can either refer to an array element or an element after any O-RU internal dimension reduction. The measurement is defined at the antenna reference point and represents, for each O-RU antenna (or O-RU dimension reduced antenna), the ratio between DMRS signal power per layer and the power of inter-cell interference plus noise. The reported value is a linear average over all DMRS REs of the assigned DMRS port in the PRB range(s) where the layer (ueId) is scheduled.

The ueId in the Section Type 10 header indicates which layer the measurement refers to. The antenna DMRS SNR report shall be sent with eAxC\_ID and ueId of the respective layer and will contain a list of SNR values (one per antenna or dimension-reduced antenna) for the layer. If multiple layers are scheduled in a user group, there will be multiple C-Plane messages.

The measurement request is controlled via parameter 'antDmrsSnr' in SE 24. Setting antDmrsSnr = 1 requests the MEAS\_ANT\_DMRS\_SNR measurement (when enabled via M-Plane). See also clause 7.7.24.5.

Antenna DMRS SNR is reported in unit dB with resolution 0.1 dB, mapped to signed 16-bit integer values. See parameter antDmrsSnrVal in clause 7.5.3.64 for more information on data format.

When O-DU controlled dimension reduction (using SE 27) or O-RU controlled dimension reduction is applied, the field numElements reflects the number of ports after the dimension reduction and DMRS SNR values reflect the channel properties after the dimension reduction. In O-RU controlled dimension reduction, since the O-RU dimension reduction is done in an unspecified manner it may impact the DMRS SNR values.

#### RRM measurement support declaration and enablement via M- Plane

The O-RU declares supported RRM measurements via M-Plane capability reporting and the O-DU will configure which RRM measurements to use via M-Plane configuration. Capabilities are declared per endpoint-type while configuration is made per endpoint, see also respective subclauses of clause 9.2.2 regarding additional restrictions as well as any measurement-specific capabilities and configurations. Mandatory RRM measurements shall be supported by all applicable endpoints.

* M-Plane capability reporting of supported RRM measurements per endpoint-type: list **rrm-meas-supported**
* M-Plane configuration to enable RRM measurements per RX endpoint: list **rrm-meas-enabled**

The following capability and enablement configuration restrictions are applicable for the different RRM measurements:

* MEAS\_UE\_TAE (M-Plane list value: MEAS-UE-TAE)
  + Shall be supported by all RX endpoints supporting DMRS-BF-EQ.
  + Shall be supported by all RX endpoints supporting DMRS-BF-NEQ unless O-RU declares support for feature DMRS-BF-NEQ-UNALTERED-TAE.
* MEAS\_UE\_LAYER\_POWER (M-Plane list value: MEAS-UE-LAYER-POWER)
  + Shall be supported by all RX endpoints supporting DMRS-BF-EQ.
  + Shall be supported by all RX endpoints supporting DMRS-BF-NEQ if any of those endpoints supports the RRM measurement.
* MEAS\_UE\_FREQ\_OFFSET (M-Plane list value: MEAS-UE-TAE-FREQ-OFFSET)
  + Shall be supported by all RX endpoints supporting DMRS-BF-EQ.
  + Shall be supported by all RX endpoints supporting DMRS-BF-NEQ unless O-RU declares support for feature DMRS-BF-NEQ-UNALTERED-FREQ-OFFSET.
* MEAS\_IPN\_ALLOC (M-Plane list value: MEAS-IPN-ALLOC)
  + Shall be supported within an O-RU supporting DMRS-BF-EQ by one or more RX endpoints within that O-RU. Those endpoints supporting MEAS\_IPN\_ALLOC may, but need not, support DMRS-BF-EQ.
  + May be supported within an O-RU supporting DMRS-BF-NEQ by one or more RX endpoints within that O-RU. Those endpoints supporting MEAS\_IPN\_ALLOC may, but need not, support DMRS-BF-NEQ.
  + When enabled, it shall be enabled on exactly one RX endpoint (associated with an eAxC\_ID) per rx- array-carrier, either on a dedicated RX endpoint for IpN (same as used for MEAS\_IPN\_UNALLOC if supported and enabled) or on an endpoint configured to use DMRS-BF-EQ or DMRS-BF-NEQ.
* MEAS\_IPN\_UNALLOC (M-Plane list value: MEAS-IPN-UNALLOC)
  + Shall be supported within an O-RU supporting DMRS-BF-EQ by one or more RX endpoints within that O-RU. Those endpoints supporting MEAS\_IPN\_UNALLOC may, but need not support DMRS-BF-EQ.
  + May be supported within an O-RU supporting DMRS-BF-NEQ by one or more RX endpoints within that O-RU. Those endpoints supporting MEAS\_IPN\_UNALLOC may, but need not, support DMRS-BF- NEQ.
  + May be supported by some RX endpoints within an O-RU not supporting DMRS-BF, including non- beamforming O-RUs.
  + When enabled, it shall be enabled on exactly one RX endpoint (associated with an eAxC\_ID) per rx- array-carrier, which is a dedicated endpoint for IpN (see also description for MEAS\_IPN\_ALLOC).
* MEAS\_ANT\_DMRS\_SNR (M-Plane list value: MEAS-ANT-DMRS-SNR)
  + May be supported by some RX endpoints supporting DMRS-BF-EQ or DMRS-BF-NEQ.

# Specification mandatory and optional capabilities

## General

Table 10.1-1 lists the general system capabilities supported by the present document.

**Table 10.1-1: Supported LTE/NR channels and system capabilities**

|  |  |
| --- | --- |
| **Feature** | **Supported system capabilities** |
| LTE DL Channels | PDSCH, PBCH, PCFICH, PDCCH, ePDCCH, MPDCCH, PHICH, CRS, MBSFN RS, UE-RS, DMRS for ePDCCH/MPDCCH, PRS, CSI-RS, PSS, SSS, Discovery RS |
| LTE UL Channels | PUSCH, PUCCH, DMRS-PUSCH, DMRS-PUCCH, SRS, PRACH (incl. eMTC) |
| Narrow band IoT DL Channels | NB-DMRS, NB-PDSCH, NB-PBCH, NB-PDCCH, NB-RS, NB-PRS, NB-PSS, NB-SSS |
| Narrow band IoT UL Channels | NB-PUSCH, NB-PRACH |
| NR DL Channels | PDSCH, PDCCH, DMRS-PDSCH, PTRS-PDSCH, DMRS-PDCCH, DMRS-PBCH, CSI- RS, PSS, SSS, SS Block/PBCH |
| NR UL Channels | PUSCH, PUCCH, PRACH, DMRS-PUSCH, PTRS-PUSCH, DMRS-PUCCH, SRS |
| Technologies | LTE TDD, FDD (normal and extended CP) NR TDD, FDD |
| Channel Bandwidth | LTE: 1.4, 3, 5, 10, 15, 20 MHz |
| NR: up to 400 MHz |
| Subcarrier Spacing | LTE: 15 kHz, 7.5 kHz, 1.25 kHz  LTE PRACH: 1.25 kHz, 7.5 kHz NB-IoT PRACH: 3.75 kHz |
| NR: 15, 30, 60, 120, 240 kHz |
| NR Multi Numerology |
| NR PRACH: 1.25, 5, 15, 30, 60, 120 kHz |
| LTE Specific Features | DL Transmission Modes: TM1 - TM10 |
| UL Transmission Modes: TM1, TM2 |
| Carrier Aggregation |
| eMBMS |
| TTI-Bundling |
| Semi-Persistent Scheduling (SPS) |
| MIMO (SU/MU-MIMO) |
| UE TAS (Tx Antenna Selection) |
| FeICIC (ABS) |
| CoMP (DL/UL), Joint Transmission |
| Short TTI |
| eMTC |
| NB-IOT (in band/guard band/standalone) |
| License Assisted Access (LAA) |
| Sidelink (Proximity Services) |

|  |  |
| --- | --- |
| **Feature** | **Supported system capabilities** |
|  | Dynamic TDD (eIMTA) |
| Mission Critical PS-LTE Features (MCPTT) |
| Positioning (PRS, OTDOA etc) |
| V2X |
| Distributed Antenna System Support |
| CBRS Support |
| NR Specific Features | EN-DC |
| SSBlock |
| BW Part |
| Supplementary UL |
| Mini-slot |
| LTE-NR Co-existence |
| Beamforming | Analog Beamforming |
| Digital Beamforming |
| Hybrid Beamforming |
| O-RU Support for 64 TRX |
| Transport | L2: Ethernet |
| L3: IPv4, IPv6 |
| QoS over Fronthaul |

## Mandatory and optional capabilities

This clause provides details regarding which capabilities within the present document are mandatory and which are optional. The capability requirements of O-DU can be different from the O-RU because in many cases, the O-DU needs to implement multiple options as mandatory to ensure interoperability with O-RUs that have optional capabilities. For example, the ability to support many compression methods may be mandatory in the O-DU while in O-RUs there may be only a single mandatory compression method to allow simplicity in O-RU design (while vendors may enhance their O-RU product offering by implementing some of the optional compression methods).

Table 10.2-1 describes the capabilities required of O-DU and O-RU units. There are three choices:

**Mandatory:** The unit shall support the described capability to be O-RAN compliant.

**Conditional Mandatory:** The unit shall support the described capability to be O-RAN compliant, but the additional information column describes the conditions under which the capability is mandatory.

**Optional:** The unit need not support the capability and still be O-RAN compliant, but if the unit does support the described capability it shall support it in the way described within the present document**.**

**Table 10.2-1: O-RAN mandatory and optional features**

|  |  |  |  |  |
| --- | --- | --- | --- | --- |
| **Category** | **Feature** | **O-DU**  **support** | **O-RU**  **support** | **Additional information** |
| **O-RU**  **Category Support** | **Support for Category-A O-RU (up to 8 spatial streams)** | **Mandatory** | N/A | The O-DU may only support fewer than 8 spatial streams; that number of spatial streams shall however be supported for Category-A O-RUs. |
| Support for Category-A O-RU (> 8 spatial streams) | Optional | N/A |  |
| **Support for Category-B O-RU (precoding in O-RU)** | **Mandatory** | N/A |  |
| **Security** | IEEE 802.1X supplicant functionality [51] | Optional | Mandatory |  |
| Grandmaster Clock Redundancy | Optional | Optional | Principles for Grandmaster Clock Redundancy are provided in Annex  P.2.3.1 of IEEE 1588 [33].  Guidelines are provided in Annex G of O-RAN Synchronization Architecture and Solution  Specification [54]. |
| **Beam- forming** | **Beam index based (PDBF)** | **Mandatory** | **Conditional Mandatory** | Condition applies to UE-specific BF for any O-RU capable of BF; a non- BF O-RU shall be supplied a zero beamId if a C-Plane message  containing a beamId is sent at all. |
| **Real-time BF Weights (WDBF)** | **Conditional Mandatory** | **Conditional Mandatory** | **Condition for O-DU:** Mandatory only for O-DUs designed to support any kind of BF that involves the operation of updating BF weights in real-time, these kinds include CIBF and DMRS-BF  **Condition for O-RU:** mandatory for any O-RU internally calculating BF  weights, these kinds include CIBF and DMRS-BF. |
| Real-time beamforming attributes (ABBF) | Optional | Optional | This is considered to not internally use BF weights. |
| Real-time UE channel Info (CIBF) | Optional | Optional | This is considered to internally use BF weights. |
| Predefined beam tilt for beam index based beamforming | Optional | Optional |  |
| Antenna calibration support | Optional | Optional |  |
| Null-layer Info. for ueId-based beamforming using Section Extension 14 | Optional | Optional |  |
| User port group indication for  beamforming based on UE channel (Section Extension 17) | Optional | Optional |  |
| Multiple beamId tables | Optional | Optional | See clause 7.5.3.9 and 12.4.1 |
| DMRS-based BF (DMRS-BF) | Optional | Optional |  |
| DMRS-based BF with equalization (DMRS-BF-EQ) | **Conditional Mandatory** | Optional | **Condition for O-DU:** If DMRS-BF is supported |
| DMRS-based BF without equalization (DMRS-BF-NEQ) | **Conditional Mandatory** | Optional | **Condition for O-DU:** If DMRS-BF is supported |
| DMRS processing including equalization functionality | **Mandatory** | **Conditional Mandatory** | **Condition for O-RU:** DMRS-BF-EQ is supported. |

|  |  |  |  |  |
| --- | --- | --- | --- | --- |
| **Category** | **Feature** | **O-DU**  **support** | **O-RU**  **support** | **Additional information** |
|  |  |  |  | See clauses 12.6.1.1 and 12.6.3.1 for equalization use details in the O-  RU and O-DU. |
|  | Relevant to DMRS-BF, conveyance of port-reduced DMRS data from O- RU to O-DU | **Conditional Mandatory** | **Conditional Mandatory** | **Condition for O-DU:** DMRS-BF is supported.  **Condition for O-RU:** DMRS-BF is supported. |
| **Bandwidth Saving** | **IQ Data Formats** |  |  |  |
| **Fixed point** (no compression) | **Conditional Mandatory** | **Conditional Mandatory** | **16-bit mandatory** (others optional)  **Condition for O-RU and O-DU**: applicable when DMRS-BF is not used. |
| **Fixed point** (no compression) For UL SINR data transmission | Optional | Optional | **16-bit mandatory if this data**  **format is supported** (other bit widths optional). |
| **Block floating point compression when not using DMRS-BF** | **Conditional Mandatory** | **Conditional Mandatory** | **9, 12 & 14-bit mantissa mandatory if this compression method is supported** (others optional)**.**  **Condition:** if an O-DU or O-RU  supports any IQ compression it shall support this one. |
| **Block floating point compression,**  for use of DMRS-BF-EQ | **Conditional Mandatory** | **Conditional Mandatory** | **8, 9-bit mantissa mandatory**  (others optional)  **Condition for O-RU**: endpoints using DMRS-BF-EQ  **Condition for O-DU**: O-DU using DMRS-BF-EQ |
| **Block floating point compression,**  for use of DMRS-BF-NEQ | **Conditional Mandatory** | **Conditional Mandatory** | **9-bit mantissa mandatory** (others optional)  **Condition for O-RU**: endpoints using DMRS-BF-NEQ  **Condition for O-DU**: O-DU using DMRS-BF-NEQ |
| **Block floating point compression,**  for UL SINR data transmission | **Mandatory** | **Mandatory** | **8-bit mantissa mandatory** (others optional) |
| Block scaling compression | Optional | Optional | **9 & 14-bit scaler mandatory if this compression method is**  **supported** (others optional). |
| ?-law compression | Optional | Optional | **9 & 14-bit width mandatory if this compression method is supported** (others optional). |
| Modulation compression | Optional | Optional | **4-bit width mandatory if this compression method is supported** (others optional). |
| Block floating point compression + selective RE sending | Optional | Optional | **9, 12 & 14-bit mantissa mandatory if this compression method is supported** (others optional). |
| Modulation compression + selective RE sending | Optional | Optional | **4-bit width mandatory if this compression method is supported** (others optional). |
| Block floating point compression + selective RE sending with sReSMask1 and sReSMask2 in U- Plane section header | Optional | Optional | **9, 12 & 14-bit mantissa mandatory if this compression method is supported** (others optional). |

|  |  |  |  |  |
| --- | --- | --- | --- | --- |
| **Category** | **Feature** | **O-DU**  **support** | **O-RU**  **support** | **Additional information** |
|  | Modulation compression + selective RE sending with sReSMask1 and sReSMask2 in U-Plane section header | Optional | Optional | **4-bit width mandatory if this compression method is supported** (others optional). |
| **Presence of udCompLen** | **Conditional Mandatory** | Optional | If the O-RU declares support of udCompLen then it shall be used, otherwise it shall be omitted (in DL and UL U-Plane messages); this is only relevant for block floating point with selective RE sending or modulation compression, with  selective RE sending. |
| Real-time variable bit-width | Optional | Optional | IQ data format is determined by value of udCompHdr. This implies presence of udCompHdr in U-Plane  messages. |
| Real-time variable bit-width per Channel (per data section) | Optional | Optional | IQ data format is determined by value of udCompHdr. This implies presence of udCompHdr in U-Plane messages. Values of udCompHdr can be different in different sections  in the U-Plane messages. |
| **Static configuration of U-Plane IQ format and compression header** | **Conditional Mandatory** | **Conditional Mandatory** | IQ data format is determined by M- Plane configuration. This implies absence of udCompHdr in U-Plane messages.  **Mandatory for supported IQ formats listed in first 7 rows under "IQ Data Formats" in this table.** |
| Beamspace compression | Optional | Optional | This compression algorithm is specific to beamforming weights. |
| Channel information compression | Optional | Optional |  |
| * No compression / Fixed point | Conditional Mandatory | Conditional Mandatory | **16-bit width for ciIsample and ciQsample mandatory if the channel information based BF feature is supported** (other  bitwidth optional). |
| * Block Floating Point | Optional | Optional |  |
| * Block Scaling | Optional | Optional |  |
| * ?-law | Optional | Optional |  |
| Use of "symInc" flag to allow multiple symbols in a C-Plane section | Optional | Optional |  |
| **Coupling via sectionId Value** | **Mandatory** | **Mandatory** |  |
| **Coupling via Frequency and Time** | **Conditional Mandatory** | **Conditional Mandatory** | If O-RU or O-DU supports "Coupling via Frequency and Time with Priorities" it shall also support this  one. |
| Coupling via Frequency and Time with Priorities | Optional | Optional |  |
| Coupling via Frequency and Time with Priorities (Optimized) | Optional | Optional | Refer to clause 7.8.1.5 and clause 7.9.8 |
| PRACH data transfer without C- Plane | Optional | Optional |  |
| SRS data transfer without C-Plane | Optional | Optional |  |

|  |  |  |  |  |
| --- | --- | --- | --- | --- |
| **Category** | **Feature** | **O-DU**  **support** | **O-RU**  **support** | **Additional information** |
| **Energy Savings** | Transmission blanking | Optional | Optional |  |
| Defined-duration sleep | Optional | Optional | Separately for TRX\_CONTROL and ASM, see clause 16.4 |
| Undefined-duration sleep | Optional | Optional | Separately for TRX\_CONTROL and ASM, see clause 16.5 |
| Sleep extension | Optional | Optional | Separately for TRX\_CONTROL and ASM; only applies if defined-  duration sleep is supported, see clause 16.9 |
| Sleep modes | Optional | Optional | Any of the four possible sleep modes may be supported, separately for TRX\_CONTROL and ASM; see clause 16.1 |
| Section Type 8 "ready" message (see 16.6.2) | Optional | Optional | Only applies if Section Type 8 is supported, see clause 7.5.3.56 and 16.6.2 |
| M-Plane emergency wake-up | Optional | Optional | See clause 16.12 |
| **O-DU - O-RU**  **Timing** | **Defined Transport Method** | **Mandatory** | **Mandatory** |  |
| Measured Transport Method (eCPRI Msg 5) | Optional | Optional | If O-RU supports Measured Transport Method it shall support both 1-Step and 2-step version of T12 measurement and at least one of 1-Step or 2-Step version of T34 measurement.  If the O-DU supports T34 measurement it shall support both 1-Step and 2-Step version.  See clause 4.4.4.4 for more detailed information. |
| External Antenna Delay handling using Minimal O-DU Impact Method | Optional | Optional | Using Tda and Tau parameters as defined in clause 4.7.2. |
| Beamforming delay profile | **Conditional Mandatory** | **Conditional Mandatory** | M-Plane feature BF-DELAY- PROFILE  **Condition for O-DU and O-RU**: support for DMRS-BF. |
| **Synchroni- zation** | **G.8275.1** [31**]** | **Conditional Mandatory** | **Conditional Mandatory** | When the G.8275.1 [31] profile is used:  In LLS-C1/C2/C3, the O-RU shall be synchronized from a PTP source using this profile and may optionally use PLFS assistance as well  In LLS-C1/C2/C3/C4, the O-DU may optionally be synchronized from a PTP source using this profile and may optionally use PLFS assistance as well.  In LLS-C1, the O-DU shall synchronize the O-RU using this PTP profile on the fronthaul interface. The O-DU shall synchronize the O-RU using PLFS as well only if the O-RU requires it (otherwise it is optional).  In LLS-C2, the O-DU shall synchronize the fronthaul network elements using this PTP profile and PLFS on the fronthaul interface. |

|  |  |  |  |  |
| --- | --- | --- | --- | --- |
| **Category** | **Feature** | **O-DU**  **support** | **O-RU**  **support** | **Additional information** |
|  |  |  |  | In LLS-C3/C4, the O-DU does not transmit synchronization signals to the O-RU.  In LLS-C2 and LLS-C3 topologies supporting Shared cell, the network elements in the Fronthaul synchronization chain (FHM or cascaded O-Rus) that are on the path to other network elements in the synchronization chain shall synchronize them using this PTP  profile and PLFS on the fronthaul interface. |
| G.8275.2 [32] | Optional | Optional | When the G.8275.2 [32] profile is used:  O-DU (in LLS-C1/C2/C3/C4) or O-  RU (in LLS-C1/C2/C3) may optionally be synchronized from a PTP source using this PTP profile. In LLS-C1/C2, O-DU may optionally synchronize the O-RU using this PTP profile on the fronthaul  interface. |
| Local PRTC | Optional | Optional | O-DU (in LLS-C1/C2/C3/C4) or O-  RU (in LLS-C4) may optionally be synchronized from a local time source, for example GNSS-based. |
| **Transport Features** | **L2: Ethernet** | **Mandatory** | **Mandatory** |  |
| L3: IPv4, IPv6 (CUS Plane) | Optional | Optional |  |
| **QoS over Fronthaul** | **Mandatory** | **Mandatory** |  |
| Prioritization of different U-Plane traffic types | Optional | Optional |  |
| Support of Jumbo Ethernet frames | Optional | Optional |  |
| **eCPRI** | **Mandatory** | **Mandatory** |  |
| support of eCPRI concatenation | Optional | Optional |  |
| IEEE 1914.3 transport header | Optional | Optional | See clause 5.1.3.3. |
| **Application layer fragmentation** | **Mandatory** | **Mandatory** | C-Plane and U-Plane. |
| Radio Transport layer fragmentation | Optional | Optional | U-Plane (see clause 5.1.3.2.8). |
| **Section Types and Section Extensions** | **Section Type 0** | Optional | **Mandatory** | O-RU may ignore message if  blanking or other Section Type 0 utility is not supported. |
| **Section Type 1** | **Mandatory** | **Mandatory** |  |
| **Section Type 3** | **Mandatory** | **Mandatory** |  |
| Section Type 4 | Optional | Optional | Specific for slot-level configuration control |
| Section Type 5 | **Conditional Mandatory** | **Conditional Mandatory** | **Condition**: mandatory if O-RU or O- DU supports CIBF and/or DMRS- BF. |
| Section Type 6 | **Conditional Mandatory** | **Conditional Mandatory** | **Condition**: mandatory if O-RU or O- DU supports CIBF. |
| Section Type 7 | **Conditional Mandatory** | **Conditional Mandatory** | Condition: mandatory if O-RU or O- DU supports LAA. |

|  |  |  |  |  |
| --- | --- | --- | --- | --- |
| **Category** | **Feature** | **O-DU**  **support** | **O-RU**  **support** | **Additional information** |
|  | Section Type 8 | **Conditional Mandatory** | **Conditional Mandatory** | **Condition:** Mandatory if SE 22 for ACK/NACK request is supported. Specific to ACK/NACK reporting for section descriptions in C-Plane  messages |
| Section Type 9 | Optional | **Conditional Mandatory** | **Condition for O-RU:** mandatory if DMRS-BF-EQ is supported |
| **Section Type 10** | **Conditional Mandatory** | **Conditional Mandatory** | **Condition for O-DU:** DMRS-BF is supported (EQ and NEQ) **Condition for O-RU:** DMRS-BF-EQ is supported, or when DMRS-BF- NEQ is supported and the O-RU could alter the time or frequency  offset of a UE-layer |
| **Section Type 11** | Optional | **Conditional Mandatory** | **Condition for O-RU**: DMRS-BF-EQ is supported |
| **Beamforming weight transfer using Section Extension 1** | **Conditional Mandatory** | **Conditional Mandatory** | **Condition for O-DU:** Mandatory only for O-DUs designed to support any kind of BF that involves the operation of updating BF weights in real-time;  **Condition for O-RU:** for any O-RU internally using BF weights, the ability to update the weights in real- time via C-Plane messages (using "Real-time BF Weights") shall be  mandatory. |
| Beamforming attribute transfer using Section Extension 2 | Optional | Optional | Attribute-based beamforming is optional. |
| DL precoding configuration using Section Extension 3 | Optional | Optional | While Category B is mandatory, it is possible to precode using beamforming so use of this extension is optional. |
| * **First Data Layer and Non-first data layer association** | **Conditional Mandatory** | **Conditional Mandatory** | **Condition:** DL precoding configuration using Section Extension 3 is supported by O-DU  and O-RU. |
| **Modulation compr. Parameters using Section Extension 4** | **Conditional Mandatory** | **Conditional Mandatory** | **Condition for O-DU**: If modulation compression is supported then it is mandatory for O-DU to support Section Extension 4  **Condition for O-RU**: If modulation compression is supported and the O-RU does not support Section Extension 5 then it is mandatory for O-RU to support Section Extension  4 |
| **Modulation compr. Parameters using Section Extension 5** | **Conditional Mandatory** | **Conditional Mandatory** | **Condition for O-DU**: If modulation compression is supported then it is mandatory for O-DU to support Section Extension 5  **Condition for O-RU**: If modulation compression is supported and the O-RU does not support Section Extension 4 then it is mandatory for O-RU to support Section Extension  5 |

|  |  |  |  |  |
| --- | --- | --- | --- | --- |
| **Category** | **Feature** | **O-DU**  **support** | **O-RU**  **support** | **Additional information** |
|  | Non-contiguous PRB allocation using Section Extension 6 | Optional | Optional | Use of non-contiguous PRBs is optional. |
| eAxC masking using Section Extension 7 | Optional | Optional | Use of eAxC masking is optional. |
| **Provide MMSE parameters using Section Extension 8** | **Conditional Mandatory** | **Conditional Mandatory** | Specific to Channel-Info beamforming;  **O-DU condition:** if O-RU and O-DU both support Channel-Info BF, then the O-DU shall use Section Extension 8 to convey MMSE parameters;  **O-RU condition:** if the O-RU supports Channel-Info BF, then the O-RU shall accept Section Extension 8 MMSE parameters from  the O-DU. |
| LTE/NR DSS using Section Extension 9 | Optional | Optional | DSS using overlapping carriers is possible; DSS using this Section  Extension is optional. |
| Group configuring of multiple ports using Section Extension 10 | Optional | Optional | Use of multiple port (multiple eAxC) grouping is optional. |
| Support 'USER-GROUP- OPTIMIZATION' with Section Extension 10 | Optional | Optional | Send all layer information for UEs belonging to a user group using single description |
| Support of beamGroupType = 10b and 11b with SE 10 | Optional | **Conditional Mandatory** | **Condition for O-RU**: mandatory if DMRS-BF is supported. |
| Flexible Beamforming Weights using Section Extension 11 | Optional | Optional | Use of flexible beamforming weights Section Extension is optional. |
| contInd flag in SE 11 | Optional | Optional | See clause 7.7.11.9 |
| bundleOffset in SE 11 | Optional | Optional | See clause 7.7.11.10 |
| Non-contiguous PRB allocation with frequency ranges using Section Extension 12 | Optional | Optional |  |
| PRB allocation with frequency hopping using Section Extension 13 | Optional | Optional |  |
| Nulling-layer Info. for ueId-based beamforming using Section  Extension 14 | Optional | Optional |  |
| Mixed-numerology Info. for ueId- based beamforming using Section  Extension 15 | Optional | Optional |  |
| Antenna mapping in UE channel information based UL beamforming  using Section Extension 16 | Optional | Optional | Use of antenna mapping in UE channel information based UL  beamforming is optional. |
| Indication of user port group using Section Extension 17 | Optional | Optional |  |
| **Uplink traffic management using Section Extension 18** | **Conditional Mandatory** | **Conditional Mandatory** | Mandatory if uplink traffic management using C-Plane is supported. Not permitted if uplink traffic management using C-Plane is  not supported. |
| Compact beamforming information for multiple port using Section Extension 19 | Optional | Optional | See clause 7.7.19 and 7.9.11. |
| Dedicated puncturing using Section Extension 20 | Optional | Optional | See clause 7.7.20 and 7.9.12. |

|  |  |  |  |  |
| --- | --- | --- | --- | --- |
| **Category** | **Feature** | **O-DU**  **support** | **O-RU**  **support** | **Additional information** |
|  | Variable PRB group size for Channel Information using Section Extension 21 | Optional | Optional |  |
| Sending PRG size using Section Extension 21 with Section Type 6 | Optional | Optional | See clause 7.7.21.1 and 7.7.21.3 |
| Sending PRG size using Section Extension 21 with Section Type 5 | Optional | Optional | See clause 7.7.21.1 and 7.7.21.3 |
| ACK/NACK request using Section Extension 22 | Optional | Optional | See clause 7.7.22 and 7.2.8 for more details. |
| Multiple symbol mcScaleOffset using Section Extension=23. (PRB-MASK mode) | Optional | Optional | Multiple symbol mcScaleOffset using Section Extension=23 |
| PRB-BLOCK mode of Section Extension 23 | Optional | Optional | The default mode is PRB-MASK mode. O-RU can indicate support for PRB-BLOCK mode of Section Extension 23 using M-Plane  advertised capability. Refer to clause 7.7.23.1 for more details. |
| SE 24 PUSCH DMRS Configuration | **Conditional Mandatory** | **Conditional Mandatory** | **Condition**: mandatory if DMRS-BF is supported |
| SE 25 symbol reordering pattern | Optional | Optional |  |
| SE 26 frequency offset reporting | Optional | Optional |  |
| O-DU controlled dimensionality reduction for DMRS-based beamforming using Section Extension 27 | Optional | Optional | See clause 7.7.27.1 |
| O-DU controlled frequency resolution for SINR reporting using Section Extension 28 | Optional | Optional | See clause 7.7.28 |
| Support for different SINR frequency resolution for different users in a user group | Optional | Optional | See clause 7.7.28.1 and M-Plane parameter  diff-freq-resolutions-supported. |
| **Section Type 4 commands** | Time-domain beamforming configuration using st4CmdType(1) TIME\_DOMAIN\_BEAM\_CONFIG | Optional | Optional | See clause 7.5.3.38 and clause  7.2.9.2.1 for more details |
| TDD pattern configuration using  st4CmdType(2) TDD\_PATTERN\_CONFIG | Optional | Optional | Refer to clause 7.5.3.38 and clause  7.2.9.2.2 for more details |
| Array-element-specific energy  saving using st4CmdType(3) TRX\_CONTROL | Optional | Optional | See clause 7.4.6 and 16 for more details |
| O-RU energy saving using st4CmdType(4) Advanced Sleep  Mode (ASM) | Optional | Optional | See clause 7.4.6 and 16 for more details |
| Measuremen ts | ST 10 RRM measurement MEAS\_UE\_TAE(1) | **Conditional Mandatory** | **Conditional Mandatory** | **Condition for O-DU**: DMRS-BF is supported (EQ and NEQ) **Condition for O-RU**:  DMRS-BF-EQ is supported, or when DMRS-BF-NEQ is supported and O-RU does not declare feature **DMRS-BF-NEQ-UNALTERED- TAE**.  See clause 9.2.2.1 for more details. |
| ST 10 RRM measurement MEAS\_UE\_LAYER\_POWER(2) | **Conditional Mandatory** | **Conditional Mandatory** | **Condition for O-DU**: DMRS-BF is supported (EQ and NEQ) **Condition for O-RU**: DMRS-BF-EQ is supported.  See clause 9.2.2.2 for more details. |

|  |  |  |  |  |
| --- | --- | --- | --- | --- |
| **Category** | **Feature** | **O-DU**  **support** | **O-RU**  **support** | **Additional information** |
|  | ST 10 RRM measurement MEAS\_UE\_FREQ\_OFFSET(3) | **Conditional Mandatory** | **Conditional Mandatory** | **Condition for O-DU**: DMRS-BF is supported (EQ and NEQ) **Condition for O-RU**:  DMRS-BF-EQ is supported, or when DMRS-BF-NEQ is supported and O-RU does not declare feature **DMRS-BF-NEQ-UNALTERED- FREQ-OFFSET**.  See clause 9.2.2.3 for more details. |
| ST 10 RRM measurement MEAS\_IPN\_ALLOC(4) | Optional | **Conditional Mandatory** | **Condition for O-RU**: DMRS-BF-EQ is supported.  See clause 9.2.2.4 for more details. |
| ST 10 RRM measurement MEAS\_IPN\_UNALLOC(5) | Optional | **Conditional Mandatory** | **Condition for O-RU**: DMRS-BF-EQ is supported.  See clause 9.2.2.5 for more details. |
| ST 10 RRM measurement MEAS\_ANT\_DMRS(6) | Optional | Optional | Specific for DMRS-BF.  See clause 9.2.2.6 for more details. |
| ST 11 RRM measurement command for MEAS\_IPN\_UNALLOC(5) | Optional | **Conditional Mandatory** | **Condition for O-RU**: DMRS-BF-EQ is supported.  See clause 9.2.2.5 for more details. |
| **Other features** | **LAA LBT O-DU congestion window mgmt** | **Conditional Mandatory** | **Conditional Mandatory** | Mandatory only for O-DUs and O- RUS supporting LAA. |
| LAA LBT O-RU congestion window mgmt | Optional | Optional |  |
| UL gain correction per eAxC | Optional | Optional | See clause 8.1.3.2.3. |
| DL reference level adjustment | Optional | Optional | See Reference\_Level in clause 8.1.3.3. |
| FS adjustment | Optional | Optional | See FS\_Offset in clause 8.1.3. |
| Ordered transmission | Optional | Optional | See clause 4.6.3. |
| Uplink traffic management using M- Plane | Optional | Optional | See clause 4.6.4. |
| Uplink traffic management using C- Plane | Optional | Optional | See clause 4.6.4. |
| Uniformly distributed transmission | Optional | Optional | In accordance with clause 4.6.2. Requires support of uplink traffic management (using M-Plane or C-  Plane). |
| Independent U-Plane transmission window control | Optional | Optional | According to clause 4.6.4. Requires support of uplink traffic management (using M-Plane or C-  Plane). |
| C-Plane Message processing O-RU limits | Optional | Optional | As specified in clause 7.8.2 and M- Plane specification [7], clause 15.8. |
| O-RU U-Plane message limits | Optional | Optional | As specified in clause 8.5.1.1 and M-Plane specification [7], clause 15.10 |
| beam-update-contention-control | Optional | Optional | See clause 12.4.3 |
| Provision of beam-context-gap- period | N/A | Optional | See clause 12.4.3 |
| UPLANE-ONLY-DL-MODE | Optional | Optional | See clause 8.2.2 |
| Shared Cell | Optional | Optional | For O-DU: support for configuring an FHM and/or cascaded O-RUs is optional.  For O-RU: support for the shared- cell copy/combine function is optional. |

|  |  |  |  |  |
| --- | --- | --- | --- | --- |
| **Category** | **Feature** | **O-DU**  **support** | **O-RU**  **support** | **Additional information** |
|  | Disable sequence number checking | Optional | Optional | Refer to feature SEQ-ID- CHECKING-CONFIGURABLE in  clause 5.1.3.2.7 and Table 5.1.3.2.7-1. |
| Per-window symbol reordering When sending of port reduced DMRS data is enabled | **Conditional Mandatory** | **Conditional Mandatory** | **Condition for O-DU and O-RU:** any reordering method is supported. This is relevant to DMRS-BF. |
| Per-window symbol reordering When sending of port reduced DMRS data is disabled | Optional | Optional | This is relevant to DMRS-BF. |
| Per-section tx-window reassignment | Optional | Optional | This is relevant to DMRS-BF. |
| U-Plane symbolId interpretation as on-air symbol number for symbol  reordering | Optional | Optional | This is relevant to DMRS-BF. |
| U-Plane symbolId interpretation as transmission window number for symbol reordering | Optional | Optional | This is relevant to DMRS-BF. |
| User group self assembly with user group ID | Optional | Optional | This is relevant to DMRS-BF. |
| User group self assembly without user group ID | Optional | Optional | This is relevant to DMRS-BF |
| O-RU controlled time resolution for SINR reporting | Optional | Optional | This is relevant to DMRS-BF-EQ. See clause 7.2.11. |
| NB-IoT | NB-IoT support | Optional | Optional | See clause 15 |
| **Extended PRB grid method for NB-IoT in DL** | **Conditional Mandatory** | **Conditional Mandatory** | Condition: O-DU / O-RU supports guard-band NB-IoT in DL.  See clause 15.2.1 for the description of the method |
| Extended PRB grid method for NB- IoT UL | Optional | Optional | See clause 15.4.3 for the description of the method |
| **SSSC method for NB-IoT in UL using ST 3** | **Conditional Mandatory** | **Conditional Mandatory** | Condition: O-DU / O-RU supports guard-band or in-band NB-IoT. See clause 15.4.1 for the  description of the SSSC method |
| SSMC method for NB-IoT in UL using ST 3 | Optional | Optional | See clause 15.4.2 for the description of the SSMC method |
| Extended PRACH configuration for PRACH data transfer without C- Plane for NPRACH | Optional | Optional | See feature EXTENDED-PRACH- CONFIGURATION in M-Plane. |
| NOTE 1: When a capability that is "per endpoint" is cited as mandatory in the O-RU, it means at least one endpoint shall support it (a minimum number meaningful for the functionality of the O-RU), not that ALL endpoints shall support it.  NOTE 2: For some mandatory capabilities, only a subset of the full set of parameter values is mandatory, this is marked in the "Additional information" column. If an optional capability is supported, the "additional information" column lists  the parameter values that shall be supported; support for other parameter values of the optional capability remains optional. | | | | |

# S-Plane Protocol

## General

#### Overview

Time and frequency synchronization can be distributed to the O-DU and O-RU from the same source using different methods. However, synchronization accuracy is mostly impacted by implementation (e.g. timestamping near the interfaces, number of hops) than by the technology itself. The following synchronization options are available over an Ethernet network:

* Frequency synchronization where clocks are aligned in frequency.
* Phase synchronization where clocks are aligned in phase.
* Time synchronization where clocks are aligned to a common base time.

Together the above parameters define a profile for the network, requiring a set of features and option selections for bridges and end stations operation. Further, the profile also states the conformance requirements for supporting equipment and user applications.

The present document considers frequency, phase and time synchronization of all the network elements (O-DUs, intermediate switches and O-RUs) for TDD and FDD features requiring specific TAE(Time Alignment Error). Frequency-only configurations (like LTE FDD or 5G FDD) are currently outside the scope of the present document. The present document considers a configuration where the O-DU and the O-RU are separated by a fronthaul link or network, and not configurations that have both O-DU and O-RU functions in the same piece of equipment.

## Synchronization baseline

#### List of reference documents

See clause 2.

#### Clock model and synchronization topology

###### Introduction

Different synchronization topologies are necessary to address different deployment market needs. The following four topology configurations are considered by as compliant topologies for supporting the O-RU synchronization needs. A configuration label is used for easier reference through the present document:

* Configuration LLS-C1: with this topology, the O-DU is part of the synchronization chain towards the O-RU. Network timing is distributed from O-DU to O-RU via direct connection between O-DU site and O-RU site.
* Configuration LLS-C2: with this topology, the O-DU is part of the synchronization chain towards the O-RU. Network timing is distributed from O-DU to O-RU between O-DU sites and O-RU sites. One or more Ethernet switches are allowed in the fronthaul network. Interconnection among switches and fabric topology (for example mesh, ring, tree, spur etc.) are deployment decisions which are out of the scope of the present document.
* Configuration LLS-C3: with this topology, the O-DU is not part of the synchronization chain towards the O- RU. Network timing is distributed from PRTC/T-GM to O-RU typically between central sites (or aggregation

sites) and O-RU sites. One or more Ethernet switches are allowed in the fronthaul network. Interconnection among switches and fabric topology (for example mesh, ring, tree, spur etc.) are deployment decisions which are out of the scope of the present document.

* Configuration LLS-C4: This topology concerns the case where the synchronization reference is provided to the O-RU with no involvement of the transport network (typically with a local GNSS receiver).

NOTE 1: For all LLS-C1 to LLS-C4 configurations, with exception of the O-DU and O-RU, the only clock types and classes (PRTC/T-GM, ePRTC/T-GM T-BC, T-TC) as defined in Recommendations ITU-T G.8272 [25], ITU-T G.8272.1 [26], ITU-T G.8273.2 [28] and ITU-T G.8273.3 [29] respectively, and considered for the network limits in Recommendation ITU-T G.8271.1 [23] are covered by the present document.

NOTE 2: Also applying to all LLS configurations, how an O-DU is synchronized is not in the scope of this classification of the synchronization topologies. O-DU may be synchronized from either a local or remote PRTC.

###### Topology configuration LLS-C1 and LLS-C2 synchronization

Configuration LLS-C1 is based on point-to-point connection between O-DU and O-RU using network timing option. As shown in the top portion of Figure 11.2.2.2-1 below, it is basically the simplest topology for network timing option, where O-DU directly synchronizes O-RU.

Configuration LLS-C2 is similar to LLS-C1 with O-DU distributing network timing toward O-RU. One or more Ethernet switches are allowed between the central site (hosting O-DUs) and the remote sites (hosting O-RUs). The allowed number of switches in the synchronization path is limited by frequency and time error contributions by all clocks in the chain.

With Full Timing Support, the allowed network noise limit in the budget can be met by a certain number (refer to Annex H for more details) of Class B or class C T-BC switches as shown in Figure 11.2.2.2-1 below. Additional T-BC switches may be allowed if total noise limit can be met. The synchronization is distributed by the O-DU. Further, all Ethernet switches in the fronthaul function as T-BC as specified by Recommendation ITU-T G.8273.2 [28]. T-TC as specified by Recommendation ITU-T G.8273.3 [29] shall be also allowed as T-BC replacement with the same expectation based on Recommendation ITU-T G.8271.1 [23].

With Partial Timing Support, which network limits are specified in Recommendation ITU-T G.8271.2 [24], non-T-BC switches may also be deployed. However, the present document does not specify appropriate frequency and timing budgets and network configuration with Partial Timing Support to meet 4G and NR TAE requirements as described in Table 11.3.2.1-1 and 3GPP frequency accuracy requirements.

Interconnection among switches and fabric topology (for example mesh, ring, tree, spur etc.) are deployment decisions which are out of the scope of the present document.

Config LLS-C1

central site

O-DU

remote site

O-RU

local or remote

PRTC

time source

PTP/PLFS path

T-TSC\*

Additional noise filtering to meet 3GPP

PLFS source +

PTP

timeTransmitter

![](../assets/images/32d835923b0b.png)

Config LLS-C2

central site

remote site

O-RU

T-TSC\*

Additional noise filtering to meet 3GPP

local or remote

PRTC

time source

O-DU

PLFS source +

PTP

timeTransmitter

switch

O-DU

PLFS source +

PTP

timeTransmitter

PTP/ PLFS

path

1 or more switches in a fabric topology

cascaded O-RU remote site

(May include FHM if Front Haul

is supporting Clause 13)

O-RU Additional noise

T-TSC\* filtering to meet

3GPP

local or remote

PRTC

time source

local or remote

PRTC

time source

O-DU

PLFS source +

PTP

timeTransmitter

PTP/ PLFS

path

O-RU Additional noise

T-TSC\* filtering to meet

3GPP

O-RAN fronthaul

Air interface

central site

O-RU

T-TSC\* Additional

and/or T-BC noise filtering or T-TC to meet 3GPP

NOTE: This is for illustrative purposes and does not provide specific deployment guidance (for example the number of switches in a clock chain and fabric topology).

**Figure 11.2.2.2-1: Configurations LLS-C1 and LLS-C2 synchronization (see considerations below for additional information on O-DU, O-RU, switch functionality).**

**Considerations for O-DU:** O-DU distributes PLFS + PTP synchronization towards the fronthaul interface, but there are different possible sub-configurations based on the O-DU sync source. Two main cases are possible: O-DU is itself distributing PLFS + PTP at the top of the synchronization chain (e.g. PRTC directly connected to the O-DU) or it gets synchronization from the network. In particular:

1. If O-DU synchronization source is from a local PRTC (typically a GNSS receiver), it may act as a T-GM, or as a specific PLL (Phase Locked Loop) with higher jitter and wander filtering capability.
2. If O-DU synchronization source is from a remote PRTC through a network (typically PTP, with or without PLFS, which grandmaster can be located anywhere in the network), O-DU shall act as the receiver of synchronization toward the upstream network. Two sub- configurations are possible:
   * If the PTP profile used in the upstream network is different (typically Recommendation ITU-T G.8275.2 [32]) from the fronthaul one (which is typically Recommendation ITU-T G.8275.1 [31], annex A), then the O-DU shall act as an Inter-Working Function (IFW) clock to bridge between the profiles, as described in Recommendation ITU-T G.8271.2 [24], Appendix I (but no clock specification exists for such IWF). Informative guidelines are provided in Recommendation ITU-T G.8275 [30] Appendix III.
   * If the PTP profile used in the upstream network is same as the fronthaul one (typically Recommendation ITU-T G.8275.1 [31], annex A), then the O-DU may act as a combined receiver and transmitter of PTP synchronization with higher jitter and wander filtering capability. NOTE: O-DU

acting as a Recommendation ITU-T G.8273.2 [28] T-BC clock does not provide enough wander cleaning to guarantee the 15 ppb limit and is therefore outside the scope of LLS-C1/LLS-C2.

1. When multiple O-DUs are directly connected to the central site aggregation switch supporting T-BC in configuration LLS-C2, only one active timeTransmitter will be in the clock chain as determined by BTCA. One O-DU is on the synchronization path towards the O-RUs, including the ones controlled by other O-DUs over the M-Plane. If timeTransmitter redundancy is present, the synchronization path via another O-DU will serve as a backup synchronization reference.

Considerations for Switches:

1. ITU-T "Full Timing Support" Clock: Recommendation ITU-T G.8273.2 [28] T-BC (or Recommendation ITU- T G.8273.3 [29] T-TC).
2. In the case of FHM or cascaded O-RU used in Shared cell topologies described in clause 13, this equipment also behaves as an ITU-T "Full Timing Support" Clock from its synchronization timeReceiver to timeTransmitter port from S-Plane point of view.
3. Partial timing support using non-T-BC switches may be used. The PTP profile defined in

Recommendation ITU-T G.8275.2 annex A shall apply for partial timing support. The present document does not specify performance aspects and budgets associated with this mode.

Considerations for O-RU:

1. As an end application, the O-RU includes an application-specific PTP T-TSC\* clock that may be compliant to Recommendation ITU-T G.8273.2 [28], T-TSC. The combination of the T-TSC\* and the local RF end application clock needs to fulfil additional requirements to ensure 3GPP air interface compliance on the RF interface. T-TSC shall be per IEEE 802.1CM [11], [12] interface condition Case 1 in clause 6.
2. In the case of Shared cell using Cascade mode with direct chaining of the O-RUs, the O-RU also implements either Recommendation ITU-T G.8273.2 [28], T-BC or Recommendation ITU-T G.8273.3 [29], T-TC on the path between the S-Plane synchronization timeReceiver and S-Plane timeTransmitter ports (as per above Considerations for Switches).

If the O-RU is not on the synchronization path to other O-RUs, the O-RU need not support T-BC or T-TC functions. These may be supported by a collocated switch. Figure 11.2.2.2-2 presents an example not applicable to LLS-C1 where the O-RUs from the U-Plane perspective can be cascaded, but from the S-Plane perspective the synchronization chain is arranged over the external switches implementing T-BC or T-TC. Other examples are possible where one switch is directly connected to the O-RUs implemented in other remote sites. This would further minimize the relative Time Error between O-RUs implemented in different sites. The topology discovery procedure (Management Plane Specification [7], clause 17.6.2) in this case would need to take into consideration that intermediate switches are deployed between O-RUs.

1. An end application connected to an external T-TSC per IEEE 802.1CM [11], [12] clause 6.4 interface condition Case 2. This case need not be considered since the O-RU generally does not provide a separate PPS/ToD interface for external T-TSC connection, and there can be performance concerns about the 1pps distribution interface compared to PTP over Ethernet.

PTP/PLFS

![](../assets/images/96d14b2acade.png)![](../assets/images/11a339386c2e.png)![](../assets/images/11a339386c2e.png)

Shared cell cascaded O-RU remote site

O-RU

Shared cell cascaded O-RU remote site

O-RU

Shared cell cascaded O-RU remote site

O-RU

O-RU

T-TSC\*

Additional noise filtering to meet 3GPP

switch

T-TSC\*

Additional noise filtering to meet 3GPP

T-TSC\*

switch

Additional noise filtering to meet 3GPP

T-TSC\*

switch

Additional noise filtering to meet 3GPP

path

![](../assets/images/96d14b2acade.png)![](../assets/images/96d14b2acade.png)

NOTE: The lines between the switches and the O-RUs are logical connections, and for the User Plane they would involve a pair of physical links, implementing the northbound and southbound connections in the cascaded O-RUs. For some O-RU implementations this set up might not be feasible.

**Figure 11.2.2.2-2: Configuration LLS-C2 synchronization: example on Shared Cell Cascade O-RU remote site configuration alternative options**

###### Topology configuration LLS-C3 synchronization

Configuration LLS-C3 is similar to LLS-C2 except frequency and time distribution is made by the fronthaul network itself (not by the O-DU). That means that one or more PRTC/T-GM are implemented in the fronthaul network to distribute network timing toward O-DU and O-RU. One or more Ethernet switches are allowed between the central site (hosting O-DUs) and the remote sites (hosting O-RUs). The permitted number switches in the synchronization path is limited by frequency and time error contributions by all clocks in the chain. Figure 11.2.2.3-1 shows a diagram of an LLS-C3 topology.

With Full Timing Support, all Ethernet switches in the fronthaul function as either T-BC (specified by Recommendation ITU-T G.8273.2 [28]) or a T-TC (specified by Recommendation ITU-T G.8273.3 [29]). The synchronization performance expectation is the same as described in Recommendation ITU-T G.8271.1 [23].

Partial Timing Support using non-T-BC switches may also be allowed. The PTP profile specified in Recommendation ITU-T G.8275.2 [32] shall be required for Partial Timing Support. The present document does not specify performance aspects and budgets associated with this mode.

Interconnection among switches and fabric topology (for example mesh, ring, tree, spur etc.) are deployment decisions which are out of the scope of the present document.

![](../assets/images/1e9fcba175d6.png)

Config LLS-C3

central site

remote site

PRTC/T-GM

O-RU

T-TSC\*

O-DU

Additional noise filtering to meet 3GPP

T-TSC PTP/PLFS

path

local or remote switch

PRTC

time source

O-RU

T-TSC\*

O-DU

Additional noise filtering to meet 3GPP

T-TSC

local or remote PRTC

time source

Network of switches

PTP/ PLFS

path

(May include FHM if Front Haul

is supporting Clause 13)

cascaded O-RU remote site

O-RU

central site T-TSC\*

O-DU and/or T-BC

or T-TC

T-TSC

local or remote PRTC

time source

PTP/ PLFS

path

Additional noise filtering to meet 3GPP

O-RU

T-TSC\*

O-RAN fronthaul

Air interface

Additional noise filtering to meet 3GPP

NOTE: This is for illustrative purpose and does not provide deployment guidance (for example the number of switches in network)

**Figure 11.2.2.3-1: Configuration LLS-C3 synchronization (see below for additional information on O- DU, O-RU, switch functionality).**

**Considerations for O-DU:** Unlike LLS-C1 & LLS-C2, O-DU does not distribute synchronization towards the fronthaul interface. It can select its own synchronization from local or remote PRTC like in LLS-C1/LLS-C2 but can also select the same synchronization timeTransmitter from the fronthaul as the O-RU and act as a

Recommendation ITU-T G.8273.2 [28] T-TSC.

1. One possible LLS-C3 implementation consists of having one of the Recommendation ITU-T G.8273.2- compatible [28] T-BC of the chain being embedded in or co-located with the O-DU.

NOTE: An O-DU acting as a Recommendation ITU-T G.8273.2 [28] T-BC clock does not provide enough wander cleaning to guarantee the 15 ppb limit and thus is instead considered part of an LLS-C3 configuration.

1. Whatever synchronization configuration is used, the O-DU shall meet the time error limit for latency management as specified in clause 4.4.

**Considerations for Switches:** These are the same as for LLS-C2 in clause 11.2.2.2.

**Considerations for O-RU:** These are the same as for LLS-C1 and LLS-C2 in clause 11.2.2.2.

**Considerations for PRTC/T-GM:** Depending on the operator choice in deployment are the following:

1. The PRTC (typically a GNSS receiver) can be embedded either in an external T-GM connected to any T-BC, or an embedded function inside any T-BC in the network.
2. Multiple PRTC/T-GMs can offer redundancy. Recommendation ITU-T G.8275.1 BTCA shall be used to optimize the time distribution through the clock chain.

###### Topology configuration LLS-C4 synchronization

The network timing distribution is the preferred approach within the fronthaul network, however, there can be some deployment use cases that prevent the fronthaul network (or only a section of the network) from being upgraded to Recommendation ITU-T G.8271.1 [23] compliance and meeting the target performance at the O-RU. To cover these use cases, the synchronization strategy shall allow a local PRTC (typically GNSS, and typically meeting Recommendation ITU-T G.8272 clause 6 [25]) timing option at the O-RU. Figure 11.2.2.4-1 shows a diagram of an LLS-C4 topology.

Providing this type of timing support at O-RU requires extra timing interface or embedded timing function. Examples of implementation include:

* a local PRTC that provides time synchronization to the O-RU via a 1PPS/ToD interface.
* a local PRTC/T-GM that provides synchronization to the O-RU via a local PTP interface.
* a local PRTC embedded in the O-RU.

local or remote

PRTC

time source

###### Config LLS-C4

central site O-DU

Fronthaul (any allowed configuration)

NO PTP and SyncE

support required

remote site O-RU

local PRTC

time source

O-RAN fronthaul Air interface

Additional noise filtering to meet 3GPP

NOTE: For the O-RU shown above additional noise filtering is needed to filter sync source dynamic noise to meet 3GPP frequency accuracy requirement and satisfy target maxTAE.

**Figure 11.2.2.4-1: Configuration LLS-C4 synchronization**

**Considerations for O-DU:** Unlike within LLS-C1 & LLS-C2 configurations, O-DU does not distribute synchronization towards the fronthaul interface. It can select its own synchronization from local or remote PRTC like in LLS-C1/LLS-C2 but can also select the same synchronization timeTransmitter from the fronthaul.

The O-DU shall meet the time error limit for latency management as specified in clause 4.4.

#### Clock Synchronization

The following requirements are provided for clock synchronization:

* For Full Timing Support networks (either upstream O-DU or fronthaul between O-DU and O-RU), PLFS (typically SyncE) shall be used within the fronthaul network distribution per Recommendation ITU-T G.8271.1 [23], G.8275.1 [31] and G.8273.2 [28]. In an LLS-C1 configuration, the O-DU shall drive the PLFS regardless of its own selected time source. A derogation applies under the operator's responsibility in the specific case where O-RU does not make use of PLFS, in which case PLFS emission shall be optional for the O-DU. In an LLS-C2 configuration, the O-DU shall drive the PLFS regardless of its own selected time source. In an LLS-C3 configuration, the network shall deliver the PLFS to all switches and O-RUs. However, an O- DU or O-RU end application is not required to use a PLFS to achieve clock (frequency) synchronization. They can use PTP alone to achieve both frequency and phase/time synchronization. The ITU recommendations listed above refer to any PLFS and not just SyncE (for example SDH). However only SyncE has been fully studied for the T-BC so far (Recommendation ITU-T G.8273.2 [28]), and SyncE is the most common implementation as it is in-band over Ethernet.
* For Partial Timing Support networks (either upstream of the O-DU or via the fronthaul between the O-DU and O-RU), PLFS may be used, as per Recommendation ITU-T G.8271.2 [24] and G.8275.2 [32]
* When used for clock synchronization, SyncE shall comply with the following ITU-T specifications:
  + Definitions: Recommendation ITU-T G.8260 [17].
  + Architecture: Recommendation ITU-T G.8261 [18].
  + SSM transport channel and format: Recommendation ITU-T G.8264 [21].
  + Clock specifications: Recommendation ITU-T G.8262 [19] (EEC) for the original, non-enhanced synchronous Ethernet.
  + Clock specifications: Recommendation ITU-T G.8262.1 [21] (eEEC) for the enhanced synchronous Ethernet.
  + Functional model and SSM processing: Recommendation ITU-T G.781 [15].
* PLFS implementations other than SyncE are currently outside the scope of the present document.

All network elements in the fronthaul network should use the same PLFS method for optimal interoperability and performance.

* Recommendation ITU-T G.8271.1 [23] shall be consulted for guidance on balancing the need to meet a target air interface performance at the O-RU with the maximum number of hops allowed. The network operator shall plan for specific fronthaul network deployment based on this guidance.
* The use of eEECs is recommended as they generate less noise (Time error, FFO) in normal operation and during network rearrangements than EECs, allowing a larger number of hops while meeting a given time error budget.

#### Profiles

###### Physical layer frequency signals (PLFS)

An implementation providing SyncE shall:

* Support Recommendation ITU-T G.781 [15] Option 1 Quality Level (per clause 5.4 Quality Code of Recommendation ITU-T G.781 [15]).
  + Support Recommendation ITU-T G.781 [15] other options, are currently out of the scope of the present document. Recommendation ITU-T G.8271.1 [23] analysis has only been done with a synchronous Ethernet network based on option 1 EECs or eEECs.
* Support Recommendation ITU-T G.8264 [21] message types, format, transmission, and reception (per Table 11.3 of Recommendation ITU-T G.8264 [21]) if SyncE is used.
  + Support of extended SSM TLV (per of Recommendation ITU-T G.8264 [21]) is optional.

Alternate PLFS implementations are out of scope of the present document.

NOTE: The accepted Quality Level may be limited to PRC or better value for optimal operation, while other values may be used under at the operator's discretion considering the HOLDOVER capability of the SyncE source and the way the end applications use SyncE.

###### PTP

* + - * 1. Full timing support

Use of IEEE 1588 [3], [33] or PTP for time/phase synchronization shall be according to its clauses referred by Recommendation ITU-T G.8275.1 [31] (Full Timing Support).

* The T-TSC inside the O-RU and O-DU are considered as T-TSC inside 3GPP end application modules. Such T-TSC are not required to provide a 1PPS measurement interface, and Recommendation ITU-T G.8273.2 [28] Appendix IV applies: the combined performance within each module may not behave as a stand-alone T-TSC described in the normative section of the recommendation.
* PLFS and PTP distribution shall be supported (with derogations described in the "Additional information" column of the Synchronization Category in Table 10.2-1), either using congruent or non-congruent topologies, as per Recommendation ITU-T G.8271.1 [23].
* O-RUs shall support L2 (Ethernet) and multicast communication when acting as a Recommendation ITU-T G.8275.1 [31] PTP synchronization/timing receiver in a fronthaul network.
* O-RUs and O-DUs supporting LLS-C1, LLS-C2, and LLS-C3 shall follow Recommendation ITU-T G.8275.1

[31] clause 6, including requirements related to one-step and two-step clock mode.

* For configurations LLS-C1 and LLS-C2, the O-DU shall support L2 (Ethernet) and multicast communication when acting as a Recommendation ITU-T G.8275.1 [31] PTP timeTransmitter in a fronthaul network to synchronize the O-RUs.
* For all configurations, O-DU shall support L2 (Ethernet) and multicast communication when acting as a Recommendation ITU-T G.8275.1 [31] synchronization timeReceiver in a fronthaul or other network is optional.
  + - * 1. Partial timing support

Support of Partial Timing Support (PTS) using Recommendation ITU-T G.8275.2 [32] Telecom Profile is permissible but requires additional considerations:

* Partial Timing Support allows switches with no T-BC or T-TC, hence there is no guarantee of synchronization performance based on ITU-T standard specifications such as Recommendation ITU-T G.8273.2 [28]. As a result, the system operator shall ensure the network components will have adequate performance to meet frequency and phase error budgets to allow an accurate detection of frequency accuracy and phase for proper network operation.
* When implementing PTS, the relevant specifications are Recommendation ITU-T G.8273.4 for PTP aware clocks and Recommendation ITU-T G.8271.2 for network limits.
* O-RUs may support L3 (UDP/IP) and unicast communication when acting as a Recommendation ITU-T G.8275.2 [32] PTP synchronization timeReceiver in a fronthaul network. This is considered "optional" in the present document.
* O-RUs and O-DUs supporting LLS-C1, LLS-C2, and LLS-C3 shall follow Recommendation ITU-T G.8275.2

[32] clause 6, including requirements related to one-step and two-step clock mode.

* For configurations LLS-C1 and LLS-C2, the O-DU may support L3 (UDP/IP) and unicast communication when acting as a Recommendation ITU-T G.8275.2 [32] PTP timeTransmitter in a fronthaul network to synchronize the O-RUs. This is considered "optional" in the present document.
* For all configurations, the O-DU may support L3 (UDP/IP) and unicast communication when acting as a Recommendation ITU-T G.8275.2 [32] PTP synchronization/timing receiver. This is considered "optional" in the present document.

Partial Timing Support has currently been defined only for relatively coarse timing accuracy (1.5 ?s). Using Partial Timing Support for S-Plane fronthaul distribution to the O-RU to satisfy tighter requirements than levels of accuracy 4 and 4A (as per Recommendation ITU-T G.8271 [22] Table 1) is currently out of scope of the present document.

#### Synchronization accuracy

###### Introduction

The parameters Time Error and other derived parameters are used in the subsequent clauses of this document. The definition of Time Error function, TE(t) is given in clause 3.1. For a synchronized clock or timing signal, the Time Error function is composed of several different error components which contribute to the total, and these individual components of time error have limits which are specified in subsequent clauses. To clarify the specification tables later in this clause, definitions of these additional time error parameters are provided here.

* **|TE(t)|:** Absolute value of the Time Error with respect to an ideal time reference (recognized time standard).The limit of the time error, **max|TE|** (i.e. the furthest point away from zero, either positive or negative) is defined in Recommendation ITU-T G.8260 [17], clause 3.1.20.
* **Constant Time Error, cTE:** The mean value of the time error function, TE(t), over a measurement period. See Recommendation ITU-T G.8260 [17], clause 3.1.20.
* **Dynamic Time Error, dTE(t):** The change in the time error function, TE(t), over a measurement period. See Recommendation ITU-T G.8260 [17], clause 3.1.20.

The limits on dTE(t) in the present document are based on peak-to-peak values. dTE(t) is by definition an unfiltered quantity.

When setting the limits, a filtered version of this signal may be considered. In particular dTE(t) may also be divided into high and low frequency components by filtering:

* + **dTEL(t):** The dynamic time error after low-pass filtering.

For packet timing signals (e.g. PTP), the measurement filter bandwidth is typically 0.1 Hz, and all limits on dTEL(t) in the present document are defined in terms of MTIE ( Maximum Time Interval Error, which is specified in ITU-T G.810 [16] and based on peak-to-peak values).

* + **dTEH(t):** The dynamic time error after high-pass filtering.

For packet timing signals (e.g. PTP), the measurement bandwidth is typically 0.1 Hz; all limits on dTEH(t) in the present document are defined in terms of peak-to-peak value.

* **TEL(t):** The slow changes in time error after low-pass filtering.

For packet timing signals (e.g. PTP), the measurement bandwidth is typically 0.1 Hz. The maximum absolute value of the low pass filtered time error function is denoted **max|TEL|**.

Further information about the accumulation of time error through a synchronization network can be found in Appendix IV of Recommendation ITU-T G.8271.1 [23].

The above defined time error parameters and their limit can be applied between different reference points. These two parameters listed below define time error with respect to an ideal time reference.

* **|TE|antenna:** Absolute value of the Time Error as measured at the antenna of the O-RU with respect to an ideal time reference (recognized time standard).
* **|TE|PRTC:** Absolute value of the Time Error contributed by a PRTC as measured with respect to an ideal time reference (recognized time standard).

These three parameters listed below define the time error between two different branches of the front haul network.

* **|TER|:** Absolute value of the Relative Time Error between two network elements or between two timeTransmitter ports of a network element.
* **|TERL|:** Absolute value of the first order low pass filtered Relative Time Error between two network elements or between two timeTransmitter ports of a network element.
* **TAE:** Time Alignment Error defined as largest timing difference between any two different antenna connectors.

These four parameters listed below define time errors contributed from input to output of equipment or network.

* **|TE|O-RU:** Absolute value of the Time Error contributed by the O-RU (measured from its network input to its antenna).
* **|TEL|network:** Absolute value of the first order low pass filtered Time Error generated by the network (measured from its input to its output).
* **|TE|network:** Absolute value of the Time Error contributed by the front haul network (measured from its input to its output).
* **|TEL|O-DU:** Absolute value of the |TEL| contributed by the O-DU (measured from its network input to output).

###### PLFS Requirements

Within the O-RAN fronthaul network, all network equipment (NE) implementing SyncE PLFS shall comply with:

* Jitter requirements specified in Recommendation ITU-T G.8262 [19] clauses 8.3, 9.2 (for EEC) or Recommendation ITU-T G.8262.1 [20] clauses 8.3, 9.3 (for eEEC)
* Wander generation, wander tolerance, noise transfer, transient response and holdover requirements specified in Recommendation ITU-T G.8262 [19] clauses 8.1, 9.1,10, 11 (for EEC) or Recommendation ITU-T G.8262.1

[20] clauses 8.1, 9.1, 9.2, 10, 11 (for eEEC).

NE supporting enhanced SyncE shall tolerate either the input wander requirements as specified by ITU-T G.8262.1 [20] level 1 (clause 9.1) or level 2 (clause 9.2) depending on its capabilities and the expected characteristics of the network.

Alternate PLFS implementations are out of scope of the present document.

###### Void

Contents related to wander are moved to clause 11.2.5.2.

###### Air interface frequency error

The O-RAN fronthaul network shall ensure O-RU meeting the 3GPP air interface frequency error requirement (i.e. 3GPP TS 36.104 clause 6.5.1 [9] for LTE and 3GPP TS 38.104 [8] clauses 6.5.1 and 9.6.1 for 5G) specifying the short- term average frequency error in 1 ms duration.

NOTE: The present document derives the subsequent limits specified in clause 11 and in Annex H assuming the

+-50 ppb strictest limit from 3GPP (i.e. +-50 ppb Wide Area Base Station limit).

Refer to clause 11.3.2 for more detailed information.

###### Air interface maximum time error

The O-RAN fronthaul network shall ensure O-RU meets the following air interface time alignment error (|TAE| absolute or relative) requirements based on different features in LTE and 5G technologies. For features covered by 3GPP, they are specified in 3GPP TS 36.104 clause 6.5.3 [9] for LTE and 3GPP TS 38.104 clauses 6.5.3 and 9.6.3 [8] for 5G.

Figure 11.2.5.5-1 shows the reference points to define the network time error |TE| vs air interface time alignment error (TAE) and the concept of relative vs absolute.

![](../assets/images/eea04debdb45.png)![](../assets/images/eea04debdb45.png)![](../assets/images/760dbebcc9d4.png)

O-RAN Fronthaul Network

Antenna

Antenna

|TE|O-RU

|TE|O-RU

UNI

PRTC

UNI

|TE|

|TE|

|TER|

Measured against a recognized time standard

|TE|antenna

|TE|antenna

TAE

O-RU

O-RU

![](../assets/images/3fbac4f68678.png)

PRTC

UNI

UNI

O-RAN Fronthaul Network

O-RU

|TE|

Measured against a recognized time standard

|TE|network

O-DU

**Figure 11.2.5.5-1: Definition of |TE| and TAE and UNI**

Definitions for the timing parameters shown in Figure 11.2.5.5-1, are described in clause 11.2.5.1. Table 11.2.5.5-1 shows the TAE requirements for LTE features:

**Table 11.2.5.5-1: LTE features with time alignment error requirement at the air interface**

|  |  |  |
| --- | --- | --- |
| **LTE Features** | **TAE** | **Corresponding Timing Category in 802.1CM [11], [12] and eCPRI [2]**  **standards (Informative)** |
| TDD | maxTAE <= 3 us (cell radius < 3 km) TAE <= 10 us (cell radius > 3 km) (NOTE 1)  3GPP TS 36.133 [38] clause 7.4 | Timing Category C |
| Dual connectivity | maxTAE <= 3 us (NOTE 2)  3GPP TS 36-133 [38] clause 7.4,7.13.2 and  7.15 | Timing Category C |
| MIMO or Tx Diversity | maxTAE <= 65 ns (NOTE 3, NOTE 5)  3GPP TS 36.104 [9] clause 6.5.3 |  |
| CA (intraband contiguous) | maxTAE <= 130 ns (NOTE 3, NOTE 6)  3GPP TS 36.104 [9] clause 6.5.3 | Timing Category A (NOTE 4) |
| CA (interband or intraband non-contiguous) | maxTAE <= 260 ns (NOTE 3)  3GPP TS 36.104 [9] clause 6.5.3 | Timing Category B (NOTE 4) |
| OTDOA | maxTEantenna at O-RU antenna << 1.5us,  ~100-200 ns (not defined by 3GPP) | Not covered since it is not defined by 3GPP |
| NOTE 1: For TDD the maxTAE requirement is applied to any pair of O-RUs that have overlapping coverage areas including when operated by different network operators. Hence maxTAE specification indirectly leads to a per O-RU requirement of maxTEantenna <= 1.5 us.  NOTE 2: In the case of Dual connectivity 3GPP has specified requirements in terms of MRTD at the input of the UEs.  When specifying these requirements, it has been assumed a limit of 3 us for maxTAE.  NOTE 3: When these features are supported within 1 O-RU, TAE is impacted by O-RU internal |TE| only.  NOTE 4: When these features are supported by multiple cooperating O-RUs, TAE is also impacted by |TER|network where 802.1CM [11], [12] clause 6.4 Timing Category is applicable to limit the network error contribution.  NOTE 5: In the present document, it is assumed that "MIMO or Tx Diversity" is applicable within a single O-RU. MIMO or Tx Diversity with multiple cooperating O-RUs is currently out of scope of the present document.  NOTE 6: Applicable when the aggregated carriers are generated by co-located O-RUs (i.e, where the distance between the O-RUs does not create significant differential delay between the O-RUs and the UE, when compared with the timing requirement). | | |

Table 11.2.5.5-2 shows the TAE requirements for 5G features:

**Table 11.2.5.5-2: 5G features with time alignment error requirement**

|  |  |  |
| --- | --- | --- |
| **5G Features** | **TAE** | **Corresponding Timing Category in 802.1CM** [11,12] **and eCPRI [2]**  **standards (Informative)** |
| TDD | maxTAE <= 3 us (NOTE 1)  3GPP TS 38.133 [37] clause 7.4 | Timing Category C |
| Dual connectivity | maxTAE <= 3 us (NOTE 2)  3GPP TS 38.133 [37] clause 7.6 | Timing Category C |
| MIMO and Tx Diversity | maxTAE <= 65 ns (NOTE 3, NOTE 5)  3GPP TS 38.104 [8] clause 6.5.3 |  |
| CA (intraband contiguous in FR2) | maxTAE <= 130 ns (NOTE 3, NOTE 6) 3GPP  TS 38.104 [8] clause 9.6.3. | Timing Category A (NOTE 4) |
| CA (intraband contiguous in FR1) | maxTAE <= 260 ns (NOTE 3, NOTE 6) 3GPP  TS 38.104 [8] clause 6.5.3, 9.6.3 | Timing Category B (NOTE 4) |
| CA (intraband non-contiguous in FR2) | maxTAE <= 260 ns (NOTE 3, NOTE 6)  3GPP TS 38.104 [8] clause 9.6.3 | Timing Category B (NOTE 4) |
| CA (intraband non-contiguous in FR1) | maxTAE <= 3 us (NOTE 3)  3GPP TS 38.104 [8] clause 6.5.3, 9.6.3 | Timing Category C (NOTE 4) |
| CA (interband) | maxTAE <= 3 us (NOTE 3)  3GPP TS 38.104 [8] clause 6.5.3, 9.6.3 | Timing Category C (NOTE 4) |
| OTDOA | max|TE|antenna << 1.5 us (not defined by 3GPP) | Not covered since it is not defined by 3GPP |
| NOTE 1: For TDD the maxTAE requirement is applied to any pair of O-RUs that have overlapping coverage areas including when operated by different network operators. Hence maxTAE specification indirectly leads to a per O-RU requirement of max|TE|antenna = 1.5 us.  NOTE 2: In the case of Dual connectivity 3GPP has specified requirements in terms of MRTD at the input of the UEs.  When specifying these requirements, it has been assumed a limit of 3 us for maxTAE.  NOTE 3: When these features are supported within 1 O-RU, maxTAE is impacted by O-RU internal |TE| only.  NOTE 4: When these features are supported by multiple cooperating O-RUs, maxTAE is also impacted by |TER|network where 802.1CM [11], [12] clause 6.4 Timing Category is applicable to limit the network error contribution.  NOTE 5: In the present document, it is assumed that "MIMO or Tx Diversity" is applicable within a single O-RU. MIMO or Tx Diversity with multiple cooperating O-RUs is out of scope of the present document.  NOTE 6: Applicable when the aggregated carriers are generated by co-located O-RUs (i.e, where the distance between the O-RUs does not create significant differential delay between the O-RUs and the UE, when compared with the timing requirement). | | |

## Time and frequency synchronization requirements

#### Allowed PTP and PLFS clock types and clock classes

###### Overview

A Network Element (NE) may use the following clock types and classes to support PTP and PLFS and can be used among other such NEs to build an O-RAN-compliant fronthaul network meeting end-to-end frequency synchronization requirements as well as time synchronization requirements at the air interface.

* EEC (per Recommendation ITU-T G.8262 [19]).
* eEEC (per Recommendation ITU-T G.8262.1 [20]).
* PRC (per Recommendation ITU-T G.811 [34]).
* PRTC (per Recommendation ITU-T G.8272 [25] and G.8272.1 [26])). NOTE 1
* T-BC (per Recommendation ITU-T G.8273.2 [28]).
* T-TSC (per Recommendation ITU-T G.8273.2 [28]).
* T-TC (per Recommendation ITU-T G.8273.3 [29]). NOTE 2

NOTE 1: Recommendation ITU-T G.8272 [25] specifies 2 types of PRTC: PRTC-A and PRTC-B. The time output of a PRTC-B is more accurate than that of a PRTC-A. PRTC-B is suitable for locations where it is possible to guarantee optimized environmental conditions (e.g. controlled temperature variation in indoor deployments). Typical examples are central location and large aggregation sites. This means that PRTC-B may be challenging and impractical for LLS-C4 deployments (e.g. due to generally outdoor deployments). Recommendation ITU-T G.8272.1 [26] specifies 2 types of ePRTC, ePRTC-A and

ePRTC-B. The main difference between the PRTCs and the ePRTCs is the input from an external autonomous primary reference clock (e.g. caesium clock) required in case of ePRTCs. This means that ePRTCs are only suitable for deployment in centralized location (therefore not applicable as a solution for LLS-C4).

NOTE 2: According to Recommendation ITU-T G.8271.1 [23] and IEEE 802.1CM [11, 12], T-TC is allowed as T- BC replacement and T-TC/T-BC accuracy performance is equivalent. T-TC as accepted clock type is allowed. However, using T-TC has potential issue with broadcast storms in a bridging network as stated in Recommendation ITU-T G.8271.1 [23] and hence guidance by Appendix I in Recommendation ITU-T G.8275.1 [31] is applicable.

The time error analysis in Annex H only covers T-BC deployments, and not the T-TC deployments.

O-DU and O-RU are considered end points in an O-RAN-compliant fronthaul network. O-DU and O-RU can support specific PTP clock and specific classes based on O-DU and O-RU synchronization capability options.

Alternate PLFS implementations are out of scope of the present document.

###### O-DU synchronization capability options:

For configurations LLS-C1 and LLS-C2: PLFS and PTP timeTransmitter.

* In case of local PRC/PRTC (typically a local GNSS receiver) used as frequency and time source: O-DU acts a PLFS source and PTP timeTransmitter. The performance requirements are specified in clause 11.3.2.
* In case of a remote PRC/PRTC used as frequency and time source via a Full Timing Support packet network (defined by Recommendation ITU-T G.8271.1 [23]): O-DU shall act as an embedded end application with better wander and jitter filtering capability, as per Appendix IV of Recommendation ITU-T G.8273.2 [28]. Acting as a true Recommendation ITU-T G.8273.2 [28] T-BC does not guarantee the frequency accuracy required in clause 11.3.2 and should be considered analogous to the LLS-C3 configuration.
* In the case of a remote PRC/PRTC used as frequency and time source via a Partial Timing Support packet network (defined by Recommendation ITU-T G.8271.2 [24]): O-DU may act as an IWF P-F Inter Working Function to drive Full Timing Support (defined by Recommendation ITU-T G.8271.1 [23]) to the Fronthaul.

For both Full Timing Support and Partial Timing support, the remote PRC/PRTC used as frequency and time source can be located anywhere in the network.

For configuration LLS-C3 and LLS-C4:

* O-DU can be synchronized from any possible time source (either local or remote PRC/PRTC-traceable one, like for LLS-C1 and LLS-C2).
* O-DU does not need to meet the 3GPP frequency and TAE target specification as required in the O-RU. However, a more relaxed phase alignment between the O-DU and the O-RU timing should be kept to avoid data buffer overflow/underflow (impact to delay management topic and irrespective of the O-RU synchronization configuration). The O-DU shall meet the time error limit for latency management as specified in clause 4.4.

###### O-RU synchronization capability options:

* For configuration LLS-C1, LLS-C2 and LLS-C3 with full timing support, the T-TSC may be either embedded or external, as per Recommendation ITU-T G.8271.1 [23] and IEEE 802.1 CM [11,12]. In the case where an O-RU includes a T-TSC, this one is "embedded in end application" as specified in Recommendation ITU-T G.8273.2 [28] Appendix IV and shall include additional necessary filtering function to ensure 3GPP air interface compliance. The requirements for Partial Timing Support are currently out of scope for the present document because there is not yet any available ITU recommendation.
* For configuration LLS-C4, the O-RU is simply synchronized from the local PRC/PRTC which may be using proprietary timing interface.

O-RU shall support network timing as mandatory synchronization capability to cover configuration LLS-C1, LLS-C2 and LLS-C3. Local PRC/PRTC (typically a GNSS receiver) may be a synchronization capability to cover configuration LLS-C4.

#### Frequency and time synchronization requirements across fronthaul network elements

###### Configurations LLS-C1 and LLS-C2

Based on IEEE 802.1CM [11], [12] and Recommendation ITU-T G.8271.1 [23] guidance, the following table summarizes the frequency and time error budgets across different elements of an O-RAN-compliant fronthaul network.

* O-DU: shall not exceed allocated frequency error budget and time error budget (for chosen air interface target)
* O-RU: shall not exceed allocated frequency error budget and time error budget (for chosen air interface target). The two O-RU classes described by IEEE 802.1CM [11], [12] clause 6 are deployment examples. The requirement shall be met only for O-RUs compliant with the limits of these classes.
* O-RAN fronthaul network: shall not exceed network limit to satisfy both frequency error budget and time error budget (for chosen air interface target). Allowed number of switches in a deployment can be derived based on allowed network limit vs chosen switch specification. Annex H shows the analysis of number of switches based on T-BC Class B and C switches.

Table 11.3.2.1-1 shows the budget allocation for configuration LLS-C1 and LLS-C2 (Refer to Figure 11.2.5.5-1 for reference point definition). The required specification limits in Table 11.3.2.1-1 are in **BOLD text.**

**Table 11.3.2.1-1: Frequency and time error budget allocation (for topology configuration LLS-C1 and LLS-C2)**

|  |  |  |  |
| --- | --- | --- | --- |
| **Frequency error budget allocation** | | | |
| **Timing Reference** | **O-RAN fronthaul network contribution limit** | **O-RU** | **Air interface target** |
| **O-DU PTP/PLFS**  **timeTransmitter class A, with max|freq error|**  <= **15 ppb**   * @ O-DU UNI (see NOTES 1,   8, 9) | **max(dTE) <= 90ns (NOTE 13)**   * Between O-DU UNI and O- RU UNI * For LLS-C2: Allowed number of hops (see NOTE 2) * For LLS-C1: single hop by definition | **O-RU max|freq error|** <= **35 ppb**  including both   * FFO after O-RU filtering of dTE @ O-RU UNI * O-RU internal additive frequency error (see NOTE 3) | max|frequency error| <= 50 ppb (NOTE 11) |
| **O-DU PTP/PLFS**  **timeTransmitter class B, with max|freq error|**  <= **5 ppb**   * @ O-DU UNI (see NOTES 1,   8, 9) | **max(dTE) <= 114ns**   * Between O-DU UNI and O- RU UNI * For LLS-C2: Allowed number of hops (see NOTE 2) * For LLS-C1: single hop by definition | **O-RU max|freq error|** <= **45 ppb**  including both   * FFO after O-RU filtering of dTE @ O-RU UNI * O-RU internal additive frequency error (see NOTE 3) | max|frequency error| <=50 ppb (NOTE 11) |
| **Time error budget allocation** | | | |
| **Timing Reference** | **O-RAN fronthaul network contribution limit** | **O-RU**  **(All allowed class options are shown) (see NOTE 6)** | **Air interface target** |
| No max|TERL| contribution by O-DU since O-DU is common PTP and PLFS timeTransmitter to all co- operated O-RU  (NOTE 1) | **max|TER**L**|** <= **60 ns**   * Between 2 O-RUs UNI * per IEEE 802.1CM [11] * For LLS-C2: Allowed number of hops (see NOTE 4) * For LLS-C1: single hop by definition | **max|TE|O-RU** includes as per IEEE 802.1CM [11] (see NOTE 5)**:**   * **(enhanced O-RU can be used)**   **max|TE|O-RU <= 35 ns** | maxTAE <= 130ns Category A (NOTE 12) |
| **max|TER**L**|** <= **100 ns (using regular O-RU) max|TER**L**|** <= **190 ns (using enhanced O-RU)**   * Between 2 O-RUs UNI * per IEEE 802.1CM [11] * For LLS-C2: Allowed number of hops (see NOTE 4) * For LLS-C1: single hop by definition | **max|TE|O-RU** includes as per IEEE 802.1CM [11] (see NOTE 5)**:**   * **Either regular O-RU max|TE|O-RU <= 80 ns** * **Or enhanced O-RU** * **max|TE|O-RU <= 35 ns** | maxTAE <= 260ns Category B (NOTE 12, 15) |
| **For LLS-C2: max|TE**L**|** <=  **1.325 us**  **For LLS-C1: max|TE**L**|** <=  **1.420 us**   * @ O-DU UNI * includes HOLDOVER   budget   * see NOTES 8, 9, 10 | **max|TE**L**|network** <= **95 ns (using regular O-RU) max|TE**L**|network** <= **140 ns (using enhanced O-RU)**   * Between O-DU UNI and O- RU UNI * For LLS-C2: Allowed number of hops (see NOTE 4) * For LLS-C1: single hop by definition | **max|TE|O-RU** includes as per IEEE 802.1CM [11] (see NOTE 5 and  7)**:**   * **Either regular max|TE|O-RU <= 80 ns** * **Or enhanced max** * **|TE|O-RU <= 35 ns** | max|TE|antenna <=  1.5 us Category C (NOTE 12) |

|  |
| --- |
| NOTE 1: O-DU implements PTP and PLFS timeTransmitter function in this use case.  Two frequency error limits are defined in the present document, conservative class A with 15 ppb, and more advanced class B with 5 ppb.  Both frequency error limits and max|TEL| time error limits are measured on the O-DU UNI after applying a first- order measurement low-pass filter bandwidth of 0.1 Hz to the time samples.  Measurement condition shall be applicable when O-DU Clock is either in locked state or HOLDOVER but excluding rare and temporary transients:   * Resynchronization to recovered source after HOLDOVER. * Resynchronization to newly selected source after failure of the previous one, in case of redundancy.   It is considered that all timeTransmitter ports of the O-DU are fully synchronized together, and there is no port-to- port time error (see Annex H). |
| NOTE 2: dTE is the accumulated dynamic time error of a T-BC clock chain (excluding O-DU contribution) based on Recommendation ITU-T G.8271.1 [23] Appendix IV calculation method and considering the noise to be centred.  As per clause 11.2.5.1 of the present document this is peak-to-peak value. Refer to Annex H for detailed analysis for maximum number of T-BC Class B and C switches. |
| NOTE 3: The O-RU requirement is not specified in IEEE 802.1CM [11,12] or Recommendation ITU-T G.8271.1 [23]. Only the total O-RU frequency error budget is specified to allow design flexibility by different solution vendors. The O- RU solution vendor can make a tradeoff between FFO (Fractional Frequency Offset after applying O-RU filtering) and internal additive frequency error as long as the total frequency error budget with network total max(dTE) limit is met. Refer to Annex H for analysis.  NOTE 4: Refer to Annex H for analysis of the number of switches to satisfy the allowed network limit. For the Time Error budget (both network and relative time errors) it is considered that the O-RU attenuates the dTEH part of the  noise present at its input, and therefore the budget uses max|TEL| using a 0.1 Hz low-pass filter as described in Recommendation ITU-T G.8271.1 [23]. |
| NOTE 5: The T-TSC are considered T-TSC embedded in end application as specified in Recommendation ITU-T G.8273.2 [28], Appendix IV and the performance may not behave as a standalone T-TSC described in the normative part of the Recommendation ITU-T G.8273.2 [28].  However, to ensure interoperability among O-RAN O-RU vendors, the agreed performance shall be based for O- RUs compliant with the classes defined in eCPRI and 802.1CM [11, 12] recommendation: under eCPRI Transport Network Requirements Specification [39] clause 4 and IEEE 802.1CM [11] clause 6, a regular O-RU  with max|TE|= 80 ns and an enhanced O-RU with max|TE| = 35 ns. The O-RU time error accumulates linearly with the other contributors in the network. |
| NOTE 6: max|TE|O-RU is the total budget proposed in IEEE 802.1CM [11] clause 6 for two examples of O-RU classes. O- RU internal split as shown in the table is recommended based on eCPRI and 802.1CM guidance. It is also  acceptable for RAN solution vendor to use a different O-RU internal split to meet the same max|TE|O-RU total budget. |
| NOTE 7: Meeting the specified budget split between O-DU and max|TE|O-RU across all categories is recommended based on eCPRI [2] clause 6.2 and 802.1CM [11] clause 6 guidance. A different budget split than what is recommended may meet the overall radio interface requirements but shall be considered under the operator's responsibility.  Typically, configuration LLS-C1 and LLS-C2 with category C target may allow more flexibility in max|TEL|O-DU, max|TEL|network and max|TE|O-RU budget split as long as the network limit (max|TEL|network for time error and dTE for frequency error) is still respected. For example, if an operator can guarantee the max|TEL|network < 75 ns which is below the 95 ns limit set in the present document, 20 ns (95 ns-75 ns) can be moved into the max|TEL|O-DU  and/or max|TE|O-RU budget. Inter-operability can be guaranteed by the network operator when all participating O- DU and O-RU vendors design to meet the operator-chosen budget split. |
| NOTE 8: In case the O-DU is synchronized using a local PRTC (typically a GNSS receiver or local T-GM), the time error limit at the input of the O-DU is specified as being Reference point A (or B) defined by Recommendation ITU-T G.8271 [22], Recommendation ITU-T G.8271.1 [23] and G.8271.2 [24]. The O-DU acting as a T-GM in normal operating mode may meet Time Error limits slightly larger than what is specified in Recommendation ITU-T  G.8272 [25] and is expected to be significantly lower than 1420 ns or 1325 ns. |
| NOTE 9: In case the O-DU is synchronized using network distribution (typically PTP and PLFS), the network time error limit at the input of the O-DU is specified as being Reference point C defined by Recommendation ITU-T G.8271 [22], Recommendation ITU-T G.8271.1 [23] for Full Timing Support or Recommendation ITU-T G.8271.2 [24] for Partial Timing Support. Similar to NOTE 4, the relevant limit of the O-DU is the 0.1 Hz low-pass filtered max|TEL|, which implies that the O-DU low-pass filtering bandwidth is lower than 0.1 Hz (per clause 11.2.2.2 of the present  document). |
| NOTE 10: The maximum relative time error of the S-Plane measurement signals between any two O-DUs shall be twice the maximum absolute time error requirement for an O-DU at O-DU UNI provided they share same timescale (i.e.  PTP) to meet the requirements of clause 11.7 of the present document. |
| NOTE 11: Observed over 1 ms as per 3GPP Spec TS 36.104 [9] clause 6.5.1, and 38.104 [8] clauses 6.5.1 and 9.6.1, Wide Area BS class |

|  |
| --- |
| NOTE 12: As per IEEE 802.1CM [11] clause 6.4.  NOTE 13: For the lower frequency range, which depends on O-RU vendor-specific low pass filtering characteristics, a higher limit can be allowed. This requirement does not need to be measured in isolation, as a network performance measurement and clock tolerance should also include the contribution of the O-DU output noise. As an example, MTIE limits as per Table H.2.4-3 and H.2.4-4 can be used to verify network performance and O-RU tolerance.  NOTE 14: Category A requirements are applicable to co-located O-RUs as per clause 7.6 in 3GPP TS 38.133 [37].  NOTE 15: Category B requirements for NR are applicable to co-located O-RUs as per clause 7.6 in 3GPP TS 38.133 [37]. |

The synchronization accuracy for the OTDOA feature is not defined by 3GPP. Hence max|TE|antenna and the corresponding max|TEL|network are out of scope of this edition of the present document and are not covered in this analysis. The two O-RU max|TE| classes indicated earlier may be considered also for this use case. In a deployed network, an operator can choose a target max|TAE|antenna and then derive the corresponding max|TEL|network and the allowed number of hops and required types of T-BC(s)/T-TC(s) based on Recommendation ITU-T G.8271.1 [23] guidance.

The present document does not specify network contribution limit when using non-T-BC switches with Partial Timing Support.

###### Configuration LLS-C3

Based on IEEE 802.1CM [11, 12] and Recommendation ITU-T G.8271.1 [23] guidance, the following table summarizes the frequency and time error budgets across different elements of an O-RAN-compliant fronthaul network.

* PRTC/T-GM: shall not exceed allocated frequency error budget and time error budget (for chosen air interface target).
* O-RU: shall not exceed allocated frequency error budget and time error budget (for chosen air interface target). The two O-RU classes described by IEEE 802.1CM [11, 12] clause 6.4 are deployment examples. The requirement shall be met only for O-RUs compliant with the limits of these classes.
* O-RAN fronthaul network: It shall not exceed network limit to satisfy both frequency error budget and time error budget (for chosen air interface target). The network limits for time error, applicable at the input of the O-RU, are those defined in clause 7.3.1, 7.3.2 and 7.3.3 of Recommendation ITU-T G.8271.1 [23] (Regular network limits at reference point C, enhanced network limits at reference point C and network limits for accurate time transfer with the PRTC deployed in the access network; only one of these would be applicable depending on the specific deployment), where the O-RU corresponds to the End Application with integrated PTP clock (Deployment Case 1, see Figure 7-1 in Recommendation ITU-T G.8271.1 [23]). The limits in Recommendation ITU-T G.8271.1 [23] are expressed in terms of MTIE, max |TEL| and peak-to-peak max(dTEH). Applicability of Recommendation ITU-T G.8271.1 [23] peak-to-peak max(dTEH) limit is defined in the present document for limits specified in ITU-T G.8271.1 [23] clause 7.3.2 and 7.3.3. Further details and

references are provided in Annex H. The requirements provided in this clause are aligned with IEEE 802.1CM [11]. Depending on the ITU-T G.8271.1 [23] reference network and related network limits considered, different assumptions apply on the network conditions. In particular, the ITU-T G.8271.1 [23] clause 7.3.1 and

7.3.2 network limits assume they are met under all operating conditions (except during PTP rearrangements and long holdover conditions in the network and during both PTP and the physical layer (PHY) frequency rearrangements conditions), while ITU-T G.8271.1 [23] clause 7.3.3 network limits exclude transients due to synchronization re-arrangements and holdover scenarios.

* O-DU output measurement signal (1PPS): There is no such allocated frequency error budget as for LLS- C1/C2. Only max|TE| shall be within 1500 ns limits as specified in clause 4.3 of the present document. O-DU and O-RU can be traceable to a different PRTCs, as long as they share the same timescale.

In case the O-DU is synchronized using a local PRTC (typically a GNSS receiver or local T-GM), the time error limit at the input of the O-DU max|TEL|O-DU shall be specified as being the limit at Reference point A (or B) defined by Recommendation ITU-T G.8271.1 [23] clause 7 and Recommendation ITU-T G.8271.2. [24] clause 7.

In case the O-DU is synchronized using network distribution (typically PTP and PLFS), the network time error limit max|TEL|network at the input of the O-DU shall be specified as being the limit at Reference point C defined

by Recommendation ITU-T G.8271.1 [23] clause 7 for Full Timing Support or Recommendation ITU-T G.8271.2 [24] clause 7 for Partial Timing Support.

* O-DU: shall not exceed allocated time error budget required by latency management as specified in clause 4.3 of the present document.

Table 11.3.2.2-1 shows the budget allocation for configuration LLS-C3 (Refer to Figure 11.2.5.5-1 for reference point definition). The required specification limits in Table 11.3.2.2-1 are in **BOLD text.**

**Table 11.3.2.2-1: Frequency and time error budget allocation (for topology configuration LLS-C3)**

|  |  |  |  |
| --- | --- | --- | --- |
| **Frequency error budget allocation** | | | |
| **Timing Reference** | **O-RAN fronthaul network contribution limit** | **O-RU** | **Air interface target** |
| **PRTC/T-GM max|freq error|**<= **2 ppb**   * @ PRTC/T-GM UNI * (see NOTE 1) | **max(dTE) <= 126ns** (see NOTE 4)   * Between PRTC output and O-RU UNI * Include PRTC/T-GM MTIE contribution * Allowed number of hops (see NOTE 2) | **O-RU max|freq error|** <=**48 ppb**  including both   * FFO after O-RU filtering of dTE @ O-RU UNI * O-RU internal additive frequency error * (see NOTE 3) | max|frequency error| <=50 ppb (NOTE 12) |
| **Time error budget allocation** | | | |
| **Timing Reference** | **O-RAN fronthaul network contribution limit** | **O-RU**  **(All allowed class options are shown)**  **(see NOTE 6)**  **O-DU (see NOTE 8)** | **Air interface target** |
| No |TERL| contribution by PRTC/T-GM as long as PRTC/T-GM is common PTP and PLFS timeTransmitter to all co-operating O-RU  (see NOTE 1) | **max|TER**L**|** <=**60 ns**   * Between 2 O-RUs UNI * per IEEE 802.1CM   [11] clause 6.4   * Allowed number of hops (see NOTE 5) | **max|TE|O-RU** includes as per IEEE 802.1CM [11] clause 6.4**:**  **(Enhanced O-RU can be used)**   * **max|TE|O-RU <= 35 ns** | maxTAE <= 130ns Category A (NOTE 13) |
| **max|TER**L**|** <=**100 ns (for regular O-RU) max|TER**L**|** <=**190 ns (for enhanced O-RU)**   * Between 2 O-RUs UNI * per IEEE 802.1CM   [11] clause 6.4   * Allowed number of hops (see NOTE 5) | **max|TE|O-RU** includes as per IEEE 802.1CM [11] clause 6.4 (see  NOTE 6)**:**   * **Either regular O-RU: max|TE|O-RU <= 80 ns** * **Or enhanced O-RU: max|TE|O-RU <= 35 ns** | maxTAE <= 260ns Category B (NOTE 13, 16) |

|  |  |  |  |
| --- | --- | --- | --- |
| **max|TE|PRTC** <= **100 ns or 40 ns (see NOTE 9)**   * @ PRTC/T-GM UNI * PRTC/T-GM spec per Recommendation ITU- T G.8272 (see NOTE 1) * Not including HOLDOVER budget | * **max|TEL|network <= 1100 ns at the O-RU UNI** (see NOTE 7, NOTE 10, NOTE 14) * **max|TEL|network** <= **600 ns at the O-RU UNI** for a Clock chain based on enhanced synchronous Ethernet and ITU-T G.8273.2   [28] class C clocks (NOTE 7, NOTE 10)   * **Short Clock Chain max|TEL|network <= 100 ns at the O-RU UNI** (see NOTE 10, NOTE 11) * Allowed number of hops (see NOTE 5) | **max|TE|O-RU** includes as per IEEE 802.1CM [11] clause 6.4 (see  NOTE 6)**:**   * **Either regular O-RU: max|TE|O-RU <= 80 ns** * **Or enhanced O-RU: max|TE|O-RU <= 35 ns** | max|TE|antenna <=  1.5 us Category C (NOTE 13) |
| **max|TE|PRTC <= 100 ns or 40 ns (see NOTE 9)**   * @ PRTC/T-GM UNI * PRTC/T-GM spec per Recommendation ITU- T G.8272 (see NOTE 1) * Not including holdover budget | **max|TE|network** is **out of scope**   * O-DU may get its synchronization from either local or remote PRTC | **max|TE|O-DU**  at O-DU UNI  **< 1.5 us** (see NOTE 8) | max|TE|antenna <=  1.5 us Category C (NOTE 13) |

|  |
| --- |
| NOTE 1: PRTC/T-GM follows Recommendation ITU-T G.8272 [25] specification for PRTC-A and PRTC-B, or Recommendation ITU-T G.8272.1 [26] for ePRTC. MTIE specification considers dynamic error during lock condition and its contribution is covered under dTE in NOTE 2. However, there is possible semi-static frequency error which is not part of MTIE specification. Therefore, it is included here.  Both Recommendation ITU-T G.8272 [25] and G.8272.1 [26] specify that for the combined PRTC and T-GM function, time error samples are measured through a moving-average low-pass filter of at least 100 consecutive time error samples. Assuming a message rate of 16 PTP messages per second as described in Recommendation ITU-T G.8275.1, the low-pass filtering bandwidth is 0.05 Hz, which is not same as a 0.1 Hz low-pass-filtered max|TEL|. (The frequency response of a moving average filter is approximately similar to a first- order linear filter of bandwidth 1/(?T), where T is the width of the moving average window).  In case the PRTC/T-GM is a multiple-port device, it is considered that all timeTransmitter ports are fully synchronized together, and there is no port-to-port time error.  Refer to Annex H for detailed analysis. |
| NOTE 2: dTE is the accumulated dynamic time error of a T-BC clock chain, including PRTC/T-GM contribution, to O-RU UNI (or O-DU UNI) based on Recommendation ITU-T G.8271.1 [23] Appendix IV calculation method, and considering the noise to be centred. As per clause 11.2.5.1 of the present document this is peak-to-peak value. Refer to Annex H for analysis for maximum number of T-BC Class B and C switches. |
| NOTE 3: The O-RU requirement is not specified in IEEE 802.1CM [11] or Recommendation ITU-T G.8271.1 [23]. Only the total O-RU frequency error budget is specified to allow design flexibility by different solution vendors. The O-RU solution vendor can make a tradeoff between FFO (Fractional Frequency Offset after applying O-RU filtering) and O-RU internal additive frequency error as long as the total frequency error budget with network total  max(dTE) limit shall be met. Refer to Annex H for analysis. |
| NOTE 4: The O-RAN fronthaul network contribution limits are stricter and therefore not consistent with peak-to-peak max(dTEH) limits defined in Recommendation ITU-T G.8271.1 [23] for long synchronization chain using regular synchronous Ethernet (see Recommendation ITU-T G.8271.1 [23], as specified in clause 7.3.1). In order to tolerate the higher Recommendation ITU-T G.8271.1 [23] limits (as per clause 7.3.1) the O-RU would be required to provide higher filtering capabilities. This option is not further described in the present document. This requirement assumes shorter clock chains (e.g. network limits as per ITU-T G.8271.1 [23] clause 7.3.3) or the use of enhanced synchronous Ethernet (e.g. network limits as per ITU-T G.8271.1 [23] clause 7.3.2). However, for the lower frequency range, which depends on O-RU vendor-specific low pass filtering characteristics, a higher dTE limit can be allowed (still within the limits specified by Recommendation ITU-T G.8271.1 [23]). Specifically, the limits defined in ITU-T G.8271.1 [23] clauses 7.3.2 and 7.3.3 are consistent with this dTE requirement relaxation. This requirement does not need to be measured in isolation, as in practice, network measurement would include all sources of noise, i.e. contribution from the network plus contribution from the PRTC. As per  NOTE 1, 2 ppb semi-static frequency errors that could happen during short holdover periods of the PRTC, should also be taken into account in defining the noise tolerance of the O-RU. |
| NOTE 5: Refer to Annex H for analysis of the number of switches to satisfy the allowed network limit. |
| NOTE 6: The T-TSC are considered T-TSC embedded in end application as specified in Recommendation ITU-T G.8273.2 [28], Appendix IV and the performance may not behave as a standalone T-TSC described in the normative section of the Recommendation ITU-T G.8273.2 [28]..  However, to ensure interoperability among O-RAN O-RU vendors, the agreed performance shall be based for O- RUs compliant with the classes defined in eCPRI [2] and 802.1CM [11, 12] recommendation: under eCPRI Transport Network Requirements Specification [39] and IEEE 802.1CM [11], a regular O-RU with max|TE|= 80 ns and an enhanced O-RU with max|TE| = 35 ns. The O-RU time error accumulates linearly with the other  contributors in the network. |
| NOTE 7: max|TEL|network <= 1100 ns is specified by Recommendation ITU-T G.8271.1 [23] in clause 7.3.1 for the max|TEL|, and max|TEL|network <= 600 ns is specified by Recommendation ITU-T G.8271.1 [23] in clause 7.3.2 for the max|TEL|. An O-RU may consume only 35 ns (enhanced O-RU) or 80 ns (regular O-RU). max|TEL| <= 1100 ns or max|TEL| <= 600 ns may leave extra budget that could be allocated for instance to holdover that could be especially relevant in case of TDD applications. This additional budget would be added on top of the 35 ns (enhanced O-RU) or 80 ns (regular O-RU), This implies that during sync failure conditions, O-RU TAE  requirements for Category B may exceed. It is a network operator decision whether this extra budget can be allocated or not. |
| NOTE 8: max|TER| between O-DU and O-RU limit (as specified in clause 4.4.1) translates into max|TE| for both O-DU and O-RU with half the budget. This shall be measured at any available O-DU output signal (either 1PPS or O-DU  UNI). |
| NOTE 9: PRTC-B (max|TE| = 40 ns) is assumed in case of short clock chains by Recommendation ITU-T G.8271.1 [23]. |
| NOTE 10: The contribution from the network includes the noise generated by the PRTC/T-GM. |
| NOTE 11: The network limits for short clock chain networks are specified in clause 7.5 of Recommendation ITU-T G.8271.1 [23]. |
| NOTE 12 Observed over 1 ms as per 3GPP Spec TS 36.104 [9] clause 6.5.1, and 38.104 [8] clauses 6.5.1 and 9.6.1, Wide Area BS class |

|  |
| --- |
| NOTE 13 As per IEEE 802.1CM [11] clause 6.4.  NOTE 14: max|TEL|network <= 1100 ns at the input of the O-RU is based on assumptions made by Recommendation ITU-T G.8271.1 [23] and IEEE802.1CM [11] in terms of clock types and maximum number of cascaded clocks. This limit and the dimensioning rules are common to the networks delivering time to O-DU in all LLS configurations and to the O-RU in LLS-C3. As a comparison, in LLS-C2, due to the additional time error budget allocated to the O-DU and the fronthaul network clocks between the O-DU and O-RU, the network limit at the input of the O-RU is specified as max|TEL|network <= 1420 ns as indicated in Table 11.3.2.1-1 of clause 11.3.2.1. In principle even in LLS-C3 configuration, a network delivering max|TEL|network > 1100 ns and up to 1420 ns at the O-RU input could still meet Category C and Category B requirements (assuming no extra budget to address failure conditions is required as part of the O-RU). This option is outside the scope of the present document.  NOTE 15: Category A requirements are applicable to co-located O-RUs as per clause 7.6 in 3GPP TS 38.133 [37].  NOTE 16: Category B requirements for NR are applicable to co-located O-RUs as per clause 7.6 in 3GPP TS 38.133 [37]. |

The synchronization accuracy for the OTDOA feature is not defined by 3GPP. Hence max|TE| at O-RU antenna and the corresponding max|TEL|network are out of scope of the present document and therefore not covered in this analysis. The two max|TE|O-RU classes indicated earlier may be considered also for this use case. In a deployed network, operator can choose a target max|TE| and then derive the corresponding max|TEL|network and the allowed number of hops and required types of T-BC(s)/T-TC(s) based on Recommendation ITU-T G.8271.1 [23] guidance.

The present document does not specify network contribution limit when using non-T-BC switches with Partial Timing Support.

###### Configuration LLS-C4

Table 11.3.2.3-1 shows the frequency and time error budgets across different elements for LLS-C4.

* O-DU output measurement signal (1PPS): there is no such allocated frequency error budget as there is for LLS-C1/C2. Only time error shall be within +-1500 ns limits as specified in clause 4.3.

In case the O-DU is synchronized using a local PRTC (typically a GNSS receiver or local T-GM), the time error limit max|TEL| at the input of the O-DU shall be specified as being the limit at Reference point A (or B) defined by Recommendation ITU-T G.8271.1 [23] clause 7 and G.8271.2 [24] clause 7.

In case the O-DU is synchronized using network distribution (typically PTP and PLFS), the network time error limit max|TEL|network at the input of the O-DU shall be specified as being Reference point C defined by Recommendation ITU-T G.8271.1 [23] for Full Timing Support or Recommendation ITU-T G.8271.2 [24] for Partial Timing Support.

* O-RU: shall not exceed allocated frequency error budget and time error budget (for chosen air interface target) The two O-RU classes described by IEEE 802.1CM [11, 12] clause 6.4 are deployment examples. The requirement shall be met only for O-RUs compliant with the limits of these classes.

Table 11.3.2.3-1 shows the budget allocation for configuration LLS-C4. The required specification limits in Table 11.3.2.3-1 are in **BOLD text.**

**Table 11.3.2.3-1: Frequency and time error budget allocation (for topology configuration LLS-C4)**

|  |  |  |  |
| --- | --- | --- | --- |
| **Frequency error budget allocation** | | | |
| **Timing Reference in network or O-DU** | **O-RAN fronthaul network** | **O-RU** | **Air interface target** |
| No dependency | No dependency | **O-RU max|freq error| <= 50 ppb**  including both   * O-RU filtering on local PRTC noise * O-RU internal additive frequency error   (NOTE 3, 4) | max|frequency error| <= 50 ppb (NOTE 6) |
| **Time error budget allocation** | | | |
| **Timing Reference in network or O-DU** | **O-RAN fronthaul network** | **O-RU (See NOTE 1,2, 3, 4) O-DU (see NOTE 5)** | **Air interface target** |
| No dependency | No dependency | Local time source:  max|TE| <= 100 ns (PRTC-A), max|TE| <= 40 ns (PRTC-B)  max|TE|O-RU <= 30 ns | maxTAE <= 260ns Category B (NOTE 7) |
| local time source: max|TE| <= 100 ns  max|TE|O-RU <= 1.4 us including any holdover budget | max|TE|antenna <= 1.5 us Category C (NOTE 7) |
| **max|TE|PRTC <= 100 ns or 40 ns** (see NOTE 1)   * @ PRTC/T-GM UNI * PRTC/T-GM spec per Recommendation ITU- T G.8272   Not including holdover budget | **max|TE|network** is **out of scope**   * O-DU may get its synchronization from either local or remote PRTC | **max|TE|O-DU**  at O-DU UNI  **< 1.5 us** (NOTE 5) | max|TE|antenna <= 1.5 us  Category C (NOTE 7) |
| NOTE 1: Local PRTC (typically GNSS receiver) to O-RU. Therefore, budget shall be based on Recommendation ITU-T G.8272 [25] (PRTC class A, with max |TE| = 100 ns, or PRTC class B, with max |TE| = 40 ns) on each GNSS receiver. Because there is no requirement in Recommendation ITU-T G.8272 [25] on the relative time error between two neighbouring local PRTCs (GNSS receivers), it is not possible to remove any common time error  in the budget at the O-RUs side. | | | |
| NOTE 2: When there is a need for low TAE, LLS-C4 configuration shall include 2x local PRTC-A max|TE| = 200 ns total, or 2x local PRTC-B max|TE| = 80 ns total. This disadvantage automatically prevents LLS-C4 configuration from meeting certain demanding maxTAE feature (as target by 802.1CM [11] clause 6.4 Category A). Hence, only  802.1CM [11] clause 6.4 Category B/C are shown. | | | |
| NOTE 3: max|TE|O-RU is not governed by eCPRI [2], 802.1CM [11] or ITU-T standards since LLS-C4 configuration is not based on network timing solution. max|TE|O-RU budget is basically the remaining budget to satisfy target feature  TAE after excluding the local max|TE|PRTC contribution. max|TE|O-RU includes the O-RU clock recovery (i.e. deriving a clean clock from local time source) error and any O-RU internal error. | | | |
| NOTE 4: This O-RU option requires extra interface and extra hardware support including local PRTC (typically GNSS receiver and antenna) and likely a more expensive oscillator for noise filtering. Standard O-RU with network timing support (target for configuration LLS-C1, LLS-C2 and LLS-C3) cannot offer this option in general. A  specific O-RU design is needed. | | | |
| NOTE 5: max|TER| between O-DU and O-RU limit (as recommended in clause 4.4.1) translates into max|TE| for both O- DU and O-RU with half the budget. This is measured at any available O-DU output signal (either 1PPS or O-DU  UNI). | | | |
| NOTE 6: Observed over 1 ms as per 3GPP Spec TS 36.104 [9] clause 6.5.1, and 38.104 [8] clauses 6.5.1 and 9.6.1,  Wide Area BS class | | | |
| NOTE 7: As per IEEE 802.1CM [11] clause 6.4. | | | |

The synchronization accuracy for the OTDOA feature is not defined by 3GPP. Hence max|TE|antenna at O-RU antenna and the corresponding max|TE|O-RU are out of scope in the present document and is therefore not covered in this analysis. In a deployed network, operator can choose a target max|TE|antenna and then derive the corresponding max|TE|O-RU.

## Node synchronization state behaviour

#### Configurations LLS-C1 and LLS-C2

###### Overview

Clause 11.4.1 defines the synchronization state interactions between O-DU, O-RU, and SMO for O-RAN topology configurations LLS-C1 and LLS-C2 where the O-DU acts as PLFS source and PTP timeTransmitter.

The operation of O-DU and O-RU during HOLDOVER and other related states is described in Table 11.4.1.1-1. O-RU HOLDOVER and O-DU HOLDOVER are independent events. Likewise, O-RU HOLDOVER behaviour is optional (not mandatory to be supported by HW or SW).

In addition to synchronization state, the O-DU also considers estimated synchronization accuracy, because synchronization state alone does not necessarily reflect synchronization status - a node in the LOCKED or HOLDOVER mode may have synchronization accuracy outside of a required limit.

**Table 11.4.1.1-1: Node behaviour during HOLDOVER and FREERUN**

|  |  |  |  |  |
| --- | --- | --- | --- | --- |
| **O-DU State** | **Synch accuracy** | **O-RU State** | **M-Plane State** | **Action** |
| - | - | - | Disconnected | Clause 11.4.1.2 |
| - | N/A | FREERUN | Connected | Clause 11.4.1.3 |
| FREERUN | - | - | Connected | Clause 11.4.1.4 |
| LOCKED/ HOLDOVER | In a limit | LOCKED/ HOLDOVER | Connected | Clause 11.4.1.5 |
| LOCKED/ HOLDOVER | Out of a limit | LOCKED/ HOLDOVER | Connected | Clause 11.4.1.5 |

###### M-Plane disconnected

O-RAN allows hybrid M-Plane model with M-Plane communication between

* O-RU and O-DU.
* O-RU and Service Management and Orchestration (SMO) function. As a result, the following M-Plane disconnected events shall be considered:
* O-DU detects loss communication to O-RU.
* SMO detects loss communication to O-RU.
* O-RU detects loss communication to O-DU.
* O-RU detects loss communication to SMO.
* O-RU detects loss communication to both O-DU and SMO.

NOTE: The following behaviour is an assumption and is described in M-Plane specification clause 15.3.3 [7].

* O-DU behaviour:
  + If the O-DU detects a loss of M-Plane communication to an O-RU, the O-DU shall stop sending any IQ data towards the O-RU. The O-DU shall also send an explicit command to the O-RU to disable RF transmission.
  + The O-DU shall keep RF transmission on the O-RU off, and shall not turn it on, if M-Plane communication to the O-RU is broken.
  + The requirement for the O-DU to send an explicit command is intended to prevent unsupervised radio operation, if M-Plane communication broken in one direction only, and the fault stays undetected on the O-RU. On the other hand, if the O-RU detects the fault, it disables RF transmission autonomously (see below), and the O-DU shall stop IQ transmission accordingly.
* O-RU behaviour:
  + If the O-RU detects a loss of M-Plane communication to the O-DU or both O-DU and SMO, the O-RU stops RF transmission. The O-RU shall keep RF transmission off, and shall not turn it on, if M-Plane communication to the O-DU or SMO is broken.
  + If the O-RU detects a loss of M-Plane communication to the SMO only, the O-RU action shall continue RF transmission. It is expected SMO can eventually detect a loss of M-Plane communication to the O- RU based on some round-trip sanity check mechanism.
* SMO behaviour:
  + If the SMO detects a loss of M-Plane communication to an O-DU or an O-RU, the SMO action is out of scope of the present document.

###### O-RU in the FREERUN state

* O-DU behaviour:
  + If synchronization state on a connected O-RU transits to the FREERUN state, the O-DU shall stop sending C-Plane and U-Plane related data to the O-RU unless otherwise specified. When O-RU transits to LOCKED state, O-DU shall request carriers to be switched to ACTIVE to re-enable transmission.
  + The O-DU receives a notification that the O-RU switched to the FREERUN state and, as consequence, all configured carriers on the O-RU were disabled. The O-DU shall disable carriers to be aligned on the carrier configuration. After O-RU re-establish synchronization, the O-RU notifies the O-DU that the O- RU switched to the LOCKED state and then if the O-DU intends to re-enable transmission, the O-DU shall set carriers to active.
  + For carrier activation procedure and notifications related to carriers and synchronization state, refer to the M-Plane specification [7], clause 15.3.3.
* O-RU behaviour:
  + If synchronization state on an O-RU transits to the FREERUN state, the O-RU shall autonomously stop RF transmission and switch all carriers to INACTIVE state. As specified in the O-RAN M-Plane specification [7] clause 10, and 15.3.3, when configured to do so The O-RU shall send a notification to the O-DU about synchronization and carriers state change. The O-RU shall re-enable RF transmission only when the O-DU requests it.
  + The O-RU is obliged to stop RF transmission as soon as the accuracy of the signal can no longer be guaranteed. The O-RU shall send notification to the O-DU about any changes in its states. The O-RU shall not activate carriers by itself as it is not guaranteed that the O-DU is providing valid U-Plane and C- Plane related data to the O-RU.

###### O-DU in the FREERUN state

* O-DU behaviour:
  + If an O-DU transits to the FREERUN state, the O-DU shall disable RF transmission on all connected O- RUs, and keep it turned off until synchronization is reacquired.
  + The O-DU shall support configuration option that allows O-DU to operate outside of the required synchronization limits, or without any synchronization at all.
* O-RU behaviour:
  + The O-RU shall only react on a change of Quality Level, received in PLFS SSMs, and Clock Class, received in PTP Announce messages:
    - If the received Quality Level and Clock Class are acceptable the O-RU shall continue using the reference signal.
    - If the received Quality Level or Clock Class becomes unacceptable the O-RU shall stop using the reference and transit to either the FREERUN state or a HOLDOVER state.
    - Otherwise, the O-RU shall rely on O-DU to take care of the changed synchronization state. The O- RU need not react on the FREERUN state at the O-DU in any distinct way.

###### Operation in LOCKED/HOLDOVER state

Whether in LOCKED or HOLDOVER state, the O-DU shall continuously monitor the LOCKED/HOLDOVER status of the O-RUs under its management.

* O-DU behaviour:
  + In configuration LLS-C1 and LLS-C2: by collecting the O-RUs' LOCKED or HOLDOVER state, as well as the received PLFS and PTP quality status, O-DU in LOCKED or "HOLDOVER state is able to detect any self-estimated frequency and/or time accuracy degradation by the O-RUs.
  + All O-RUs in the LOCKED state and directly connected to the same upstream clock (typically the O-DU in LLS-C1, and the nearest T-BC in LLS-C2) preserve optimal relative time error between them, regardless the O-DU's status. As a result, intra-site features may remain enabled using different criteria compared to inter-site ones.
  + The port-to-port constant and dynamic time errors between two timeTransmitter ports of the same module (either the O-DU in configuration LLS-C1, and the T-BC ones in LLS-C2) may also contribute to the total error.
* O-RU behaviour:
  + The O-RU shall only react on a change of Quality Level received in PLFS SSMs, and Clock Class received in PTP Announce messages:
    - If received Quality Level and Clock Class are acceptable, the O-RU shall keep on using the reference signal.
    - If received Quality Level or Clock Class become unacceptable, the O-RU shall stop using the reference and transit to either the FREERUN state or a HOLDOVER state.
  + Recommendation ITU-T G.8275.1 [31] clause 6.4 define the notion of "within HOLDOVER specification" (clock class values 7 and 135), and "exceeding the HOLDOVER specification" (clock class values 140, 150, 160, 165).
  + Recommendation ITU-TG.8271.1 [23] Appendix V describes an example of HOLDOVER budget as 400 ns in the context of category C (as per IEEE 802.1CM [11] clause 6.4.1.4). This value is however too high and useless for categories A/B, highlighting that the notion of "acceptable" is dependent on the category of each feature.
  + Consequently, it shall be mandatory that each O-RU reports to O-DU the received Quality Level and Clock Class, allowing O-DU to enable and disable accordingly the various RF features.
  + Besides, the value for the HOLDOVER specification may be configurable, thus allowing each network operator to tune it to its own needs.

#### Configurations LLS-C3

###### Overview

Clause 11.4.2 defines the synchronization state interactions between O-DU, O-RU, and SMO for O-RAN topology configuration LLS-C3 based on IEEE 802.1CM [11] clause 7. PRTC/GM is provided by the fronthaul network.

The operation of the Fronthaul network elements, O-DU and O-RU during HOLDOVER and other related states is described in Table 11.4.2.1-1. O-RU HOLDOVER and O-DU HOLDOVER are independent events. Likewise, O-RU HOLDOVER behaviour is optional (not mandatory to be supported by HW or SW).

More than one PRTC/GM may be considered as a deployment option to improve redundancy. Should a PRTC/GM fail, then another should be available as a backup time source and the PTP network tree would automatically re-arrange.

Only a short HOLDOVER shall be supported inside the various network elements (as well as O-DU and O-RU) to provide a safe operation during this rearrangement scenario.

NOTE 1: The duration for short HOLDOVER needs to be defined from Recommendation ITU-T G.8271.1 [23] NOTE 2: The O-DU can also be configured to provide backup PLFS+PTP like in LLS-C2.

In addition to synchronization state, the O-DU also considers estimated synchronization accuracy because the synchronization state alone does not necessarily reflect synchronization status; a node in the LOCKED or HOLDOVER mode may have synchronization accuracy outside of a required limit.

**Table 11.4.2.1-1: Node behaviour during HOLDOVER and FREERUN**

|  |  |  |  |  |
| --- | --- | --- | --- | --- |
| **Network State** | **Sync Accuracy** | **O-DU and O- RU State** | **M-Plane State** | **Action** |
| - | - | - | Disconnected | Clause 11.4.2.2 |
| - | N/A | FREERUN | Connected | Clause 11.4.2.3  and 11.4.2.4 |
| LOCKED/ HOLDOVER | In limit | LOCKED/ HOLDOVER | Connected | Clause 11. 4.2.5 |
| LOCKED/ HOLDOVER | Out of limit | LOCKED/ HOLDOVER | Connected | Clause 11. 4.2.5 |

###### M-Plane disconnected

This clause is same as 11.4.1.2

###### O-RU in the FREERUN State

This clause is same as 11.4.1.3

###### O-DU in the FREERUN state

If an O-DU and O-RU are synchronized from the same fronthaul network and are connected to neighbour nodes in this network, it is most probable that the event leading to O-RU transiting to the FREERUN state will also lead to the same transition at the O-DU.

If O-DU has backup frequency and time source, such as local or remote PRTC, it can become a backup timeTransmitter like in configuration LLS-C2.

O-DU

* O-DU behaviour:
  + If an O-DU transits to the FREERUN state because the synchronizing network delivers unacceptable synchronization quality, the O-DU shall disable RF transmission on all connected O-RUs, and keep it turned off until synchronization is reacquired again.
  + The O-DU may support a configuration option that allows O-DU to operate outside of the required synchronization limits, or without any synchronization at all.

O-RU

* O-RU behaviour:

- The O-RU is not synchronized from the O-DU. It may have no indication of the O-DU synchronization status, and therefore shall rely on the O-DU to take care of the changed synchronization state. The O-RU need not react to the FREERUN state at the O-DU in any distinct way.

###### Operation in LOCKED/HOLDOVER state

Whether in LOCKED or HOLDOVER state, the O-DU shall monitor the LOCKED or HOLDOVER state, as well as the received PLFS and PTP quality status of the O-RU. The behaviours of the O-DU and O-RU shall be the same as LLS-C1 and LLS-C2 configurations described in clause 11.4.1.5.

#### Configurations LLS-C4

###### Overview

Clause 11.4.3 defines the synchronization state interactions between O-DU, O-RU, and SMO for O-RAN topology configurations LLS-C4 where the O-RU is synchronized by local PRTC (typically a GNSS receiver).

The operation of O-DU and O-RU during HOLDOVER and other related states is described in Table 11.4.3.1-1.O-RU HOLDOVER and O-DU HOLDOVER are independent events. Likewise, O-RU HOLDOVER behaviour is optional (not mandatory to be supported by HW or SW).

In addition to the synchronization state, the O-DU also considers estimated synchronization accuracy because the synchronization state alone does not necessarily reflect synchronization status; a node in the LOCKED or HOLDOVER mode may have synchronization accuracy outside of a required limit.

**Table 11.4.3.1-1: Node behaviour during HOLDOVER and FREERUN**

|  |  |  |  |  |
| --- | --- | --- | --- | --- |
| **O-DU State** | **Sync Accuracy** | **O-RU State** | **M-Plane State** | **Action** |
| - | - | - | Disconnected | Clause 11.4.3.2 |
| - | N/A | FREERUN | Connected | Clause 11.4.3.3 |
| FREERUN | - | - | Connected | Clause 11.4.3.4 |
| LOCKED/ HOLDOVER | In limit | LOCKED/ HOLDOVER | Connected | Clause 11.4.3.5 |
| LOCKED/  HOLDOVER | Out of limit | LOCKED/  HOLDOVER | Connected | Clause 11.4.3.5 |

###### M-Plane disconnected

This clause is same as 11.4.1.2.

###### O-RU in the FREERUN state

This clause is same as 11.4.1.3

###### O-DU in the FREERUN state

* O-DU behaviour:
  + If an O-DU transits to the FREERUN state, the O-DU shall disable RF transmission on all connected O- RUs and keep it turned off until synchronization is reacquired again.
  + The O-DU may support a configuration option that allows O-DU to operate outside of the required synchronization limits, or without any synchronization at all.
* O-RU behaviour:
  + If the O-RU is not synchronized from the O-DU, it may have no indication of the O-DU synchronization status, and therefore shall only rely on O-DU to take care of the changed synchronization state. The

O-RU need not react to the FREERUN state at the O-DU in any distinct way.

###### Operation in LOCKED/HOLDOVER state

Whether in LOCKED or HOLDOVER state, the O-DU shall monitor the LOCKED or HOLDOVER state. The behaviours of the O-DU and O-RU shall be the same as for LLS-C1 and LLS-C2 configurations described in clause 11.4.1.5.

## S-Plane handling in multiple link scenarios

Behaviour of S-Plane in scenarios with multiple links shall be based on the following principles:

O-DU - grandmaster/synchronization transmitter (configurations LLS-C1 & LLS-C2): There shall be an input sync reference signal on at least one link to an O-RU. Likewise, it is permitted to have input reference signal on multiple or all links to a given O-RU.

O-RU (all configurations) - synchronization receiver: O-RU shall be able to adapt at startup to the reception of a sync reference signal on any port from the upstream clock. How the ingress signal is detected (usually SSM for SyncE and Announce for PTP), and how the active port is selected (e.g. via round-robin, Recommendation ITU-T G.8275.1 [31] BTCA, etc.) are implementation-specific.

If the input reference is present on multiple links, the O-RU may implement redundancy for the input reference signal if only capacity links are present on the module.

## Announce messages

O-RU shall check the following advertised parameters against a list of acceptable values based on its own design These parameters are M-Plane configurable.

* Domain Number: Default: 24 (for Full Timing Support per Recommendation ITU-T G.8275.1 [31] clause 6.2.1) or 44 (for Partial Timing Support per Recommendation ITU-T G.8275.2 [32] clause 6.2.1).
* PTP Acceptable Clock Classes:

- Default: 6, 7.

- Operator configurable: 6, 7, 135, 140, 150, 160, 248.

## Elementary procedures

#### PTP time synchronization procedure

All procedures used to exchange time related information between a time synchronization timeTransmitter and subordinate shall be compliant to the Recommendation ITU-T G.8275.1 [31] or G.8275.2 [32] telecom profile, which provides necessary details on utilization of the IEEE 1588 [3], [33] protocol in telecom applications.

#### System frame number calculation from GPS time

The general framework for System Frame Number (SFN) calculation from GPS time is based on the following premises:

* PTP time on the fronthaul interface shall use PTP timescale.
* The PTP epoch is 1 January 1970 00:00:00 TAI, which is 31 December 1969 23:59:51.999918 UTC.
* PTP time on the fronthaul interface shall be traceable to a PRTC if a network wide synchronization of O-RUs at the air interface is required (as in TDD 5G).
* From PTP time, the GPS seconds elapsed since GPS epoch (midnight January 6th, 1980) can be calculated, since the difference between PTP and GPS epoch is a constant. The GPS seconds are expressed as a real number.
* GPS seconds shall be used to calculate the frame number according to:

GPSseconds - ? ? 0.01 - ?

FrameNumber = floor (

1.2288 ? 109) mod(maxFrameNumber + 1) framePeriodinSeconds

where:

* FrameNumber expressed in seconds.
* framePeriodinSeconds = 0.01 s.
* maxFrameNumber = 1023.
* ? and ? are defined as shown in Table 11.7.2-1:

**Table 11.7.2-1 ?** **?** **and ?** **parameter exchange**

|  |  |  |  |
| --- | --- | --- | --- |
| **Direction** | **Parameter** | **Range** | **Resolution** |
| O-DU to O-RU | Offset ? (NR) of radio frame timing (NOTE) | ?: 0~1.2288e7  ? \* (1/1.2288 ns) : 0.00 s~0.01 s | 1/1.2288 ns |
| O-DU to O-RU | Offset ? (NR) of radio frame timing (NOTE) | ?: -32768~32767  ? \* (10 ms) : -327680 ms~327670 ms | 10 ms |
| NOTE: Parameter data types and values for ? and ? are provided by the O-RAN M-Plane specification [7]. Epoch for ? and ? (i.e. SFN=0) is set to 1980.1.6 00:00 (UTC) | | | |

Figure 11.7.2-1 below shows examples when ? and ? are set to different values. The frame number at the antenna reference point is shown in relation to the GPSseconds time. For simplicity the GPS-time around 10 seconds is shown.

![](../assets/images/f08cbc9579e0.png)

**Figure 11.7.2-1: ?** **and ?** **parameter example Table 11.7.2-2: Void**

NOTE: Refer to clause 4.8 for the timing relation between UL radio frame and DL radio frame.

# Beamforming functionality

## General

The following clauses describe terminologies, rules, properties and uses cases related to beamforming and its functionalities. It is the baseline to follow by the O-DU, O-RU and modelling in M-Plane.

## Hierarchy of radiation structure in O-RU

The hierarchy of radiation structure in O-RU is depicted in Figure 12.2-1 and described below:

![](../assets/images/be4f6843be57.png)

O-RU

**rx-array and/or tx-array**

**Figure 12.2-1. Hierarchy of Radiation Structure**

* **O-RU:** each O-RU can have 1 or several panels
* **panel:** each panel can have 1 or several tx-array and/or rx-array
* **tx-array** and **rx-array:**
  + tx-array and rx-array are logical constructs used for data routing; there is a relationship to physical antennas as defined by the O-RU construction, and eAxC\_ID values may be assigned to tx-arrays and rx- arrays:
    - Multiple eAxC\_ID values may be assigned to a single tx-array or rx-array
    - An eAxC\_ID value for a given direction (DL or UL) shall not be assigned to more than one tx- array or rx-array
  + Each tx-array and rx-array has only one polarization for Category A O-RUs.
  + Each tx-array and rx-array may include both polarizations for Category B O-RUs.
  + Category B O-RU shall provide one or more single-polarization rx-arrays for each polarization.
  + Each tx-array and rx-array may be configured to terminate one or several RU\_port\_IDs.
  + Each tx-array and rx-array can have one or several array elements (one use case being antenna technologies wherein a single "array element" can support a high degree of beamforming, another use case being the need to address a single element in the array).
  + Each physical array element may be a member of one or multiple tx-arrays, multiple rx-arrays or both tx- arrays and rx-arrays.
  + Amplitude and phase of each array element inside one tx-array and rx-array can be controlled via the weights pointed to by the beamIds which are received via the terminated RU\_port\_ID(s). Alternatively, the beamIds may indicate the "state" of an antenna array not explicitly comprising separate radiating elements.
  + It is assumed that when executing beamforming, array elements within an array are combined in phase to form directed energy, therefore the array elements belonging to a tx-array and rx-array are calibrated together as a group (although such a calibration operation can be hidden from the interface e.g. executed once upon O-RU manufacturing).
* **array element:** each array element can have 1 or several radiators (where amplitude and phase relation between the radiators cannot be changed dynamically during real-time)
* **radiator:** radiating element - see clause 4 in [50] for the definition of "radiating element".

## Calibration

Calibration is the functionality of eliminating or minimizing relative amplitude and phase differences over frequency domain or time delay over the time domain between the array elements belonging to same tx-array or rx-array (including effect of front-end analog filters).

Calibration can also be applied between two or many tx-arrays or rx-arrays if those tx-arrays or rx-arrays belong to the same calibration group which is part of the O-RU capabilities.

## beamId use for various beamforming methods

#### Overview

There are two main domains in which beamforming is executed, frequency-domain and time-domain; it is also possible to combine both (called "hybrid beamforming"). Frequency-domain beamforming is done between the RE mapping and FFT/iFFT processing stages (in UL and DL respectively) so is inherently a digital operation. Time-domain beamforming may be executed digitally or in the analog domain.

A characteristic of frequency-domain beamforming when used with OFDM is that different users may use the same time slot yet use different beams. In contrast, with time-domain beamforming all the users and signals in a time slot use the same beam. Hybrid beamforming allows different users in the same time slot to use different beams (the frequency- domain part) at the same time as all the users using a shared time-domain beam. An example is the case where the time- domain beam provides directivity in the elevation plane (so all users use the same elevation beam) while the frequency- domain beams provide directivity in the azimuth plane (so different users may use different azimuth beams).

The following beamforming methods (see also Annex J for more details) are supported:

1. Predefined-beam beamforming: In this case, an index called "beamId" indicates the specific beam pre-defined in the O-RU to use. The beamId can indicate a frequency-domain beam or a time-domain beam or a combination of both ("hybrid" beam) and the O-DU needs to know it to ensure the beamId is properly applied

e.g. the O-DU cannot apply different time-domain beams to the different PRBs in the same OFDM symbol. The method the O-RU uses to generate the beam is otherwise not relevant, it could use the application of gain and phase controls on separate antenna elements, or use multiple shaped-energy antennas, or any other technology. The O-RU should convey to the O-DU via the M-Plane on startup beam characteristics but the O-

DU may remain ignorant regarding how the beam is actually created by the O-RU. If the multiple beamId tables feature is configured via the M-Plane as specified in clause 15.4.6 of the M-Plane specification [7], then the beamId value (and the associated pre-defined beam) is specific to the beamId table configured (via M- Plane parameter configured-tx-beamId-table-index) for the array carrier associated with the eAxC receiving the beamId value. Otherwise, the association of the beamId value and the pre-defined beam is global per O-RU (see also clause 7.5.3.9).

1. Weight-based dynamic beamforming (based on real-time-updated weights): Here the O-DU is meant to generate weights that create the beam, so the O-DU needs to know the specific antenna characteristics of the O-RU including how many antenna elements are present in the vertical and horizontal directions and the antenna element spacing, among other properties. The weight vector associated with each beam has a beamId value and the interpretation of this beamId value is addressed in clause 12.4.3. If the multiple beamId tables feature is configured via the M-Plane as specified in clause 15.4.6 of the M-Plane specification [7], then the beamId value (and the associated weigh vector) is specific to the beamId table configured (via M-Plane parameter configured-tx-beamId-table-index) for the array carrier associated with the eAxC receiving the beamId value. Otherwise, the association of the beamId value and the weigh vector is global per O-RU (see also clause 7.5.3.9).
2. Attribute-based dynamic beamforming (based on real-time-updated beam attributes): Like predefined-beam beamforming, attribute-based beamforming allows the O-DU to tell the O-RU to use a specific beamId but in this case that beamId is associated with certain beam attributes as described in clause 7.7.2. How the O-RU achieves the implementation of the beams is not specified, however the O-DU needs to know whether the beam identified by the beamId is generated as a frequency-domain beam or a time-domain beam to ensure the beamId is properly applied e.g. the O-DU cannot apply different time-domain beams to the different PRBs in the same OFDM symbol. When the attribute-based beamforming method is used for at least one layer (or spatial stream), then O-DU shall use same beamforming method for all layers (or spatial streams) of the specific time-frequency resource element(s). If the multiple beamId tables feature is configured via the M- Plane as specified in clause 15.4.6 of the M-Plane specification [7], then the beamId value (and the associated set of attributes) is specific to the beamId table configured (via M-Plane parameter configured-tx-beamId- table-index) to be used for the array carrier associated with the eAxC receiving the beamId value. Otherwise, the association of the beamId value and the set of attributes is global per O-RU (see also clause 7.5.3.9).
3. Channel-information-based beamforming: In this case the O-DU provides channel information per UE periodically (generally less often than every slot) and then on a slot-by-slot basis the O-DU provides scheduling information which the O-RU uses along with the channel information to calculate the proper beamforming weights for the specific slot with its co-scheduled UEs. Here there is no beamId value associated with the beamforming, instead the ueId is associated with each data section. Therefore, this clause regarding beamId usage is not relevant for this beamforming method. When the channel-information-based beamforming method is used for at least one layer (or spatial stream), then O-DU shall use same beamforming method for all layers (or spatial streams) of the specific time-frequency resource element(s). The multiple beamId tables feature is not applicable for channel-information-based beamforming.
4. DMRS-based beamforming: In this case the O-DU provides a description of the DMRS configuration for PUSCH, and the O-RU uses that description to perform channel estimation and compute beamforming weights with or without an equalization function from the DMRS data and applies the weights to the PUSCH data and optionally DMRS data. Because there is no use of beamId in this method, therefore, this clause regarding beamId usage is not relevant for this beamforming method. See clause 12.6 for a full description of DMRS- BF.

#### Predefined-beam beamforming (PDBF)

###### Overview

When implementing predefined-beam beamforming, the O-RU shall convey to the O-DU whether the beamforming type is frequency-domain, time-domain, or a mixture of the two ("hybrid beamforming"). In the case of frequency- domain-only or time-domain-only, the beamId is simply an index to the desired beamforming weight vector or other

beamforming method. In the case of hybrid beamforming, there are present in the O-RU pre-loaded frequency-domain weight vectors and time-domain weight vectors (these are applied separately). The beamId points to a single combined frequency-domain and time-domain weight vector. However, in reality there will be the application of a frequency- domain beamforming weight vector and the separate application of multiple time-domain beamforming weight vectors, one per frequency-domain weight value.

For this case, O-RU shall convey via the M-Plane to the O-DU upon start-up as part of the O-RU self-description:

* The list of available beamIds and their characteristics, see clause 12.4.2.2 below.

NOTE: There is no requirement that beamIds be in sequential order or that there are no gaps between beamId values.

The beamId value of zero is reserved for no beamforming, so shall not be used for any other frequency-domain, time- domain or hybrid beam.

###### Beam characteristics

In order to use predefined-beam beamforming in a standardized way, the present document considers beamforming to be defined such that energy (in the DL) or sensitivity (in the UL) is focused into either a "coarse" or "fine" granularity with possible overlaps. In this way "broadcast" beams may be used to cover a wider area with less power or sensitivity, while higher-power or higher-sensitivity beams may be used in e.g. a per-UE fashion. Figure 12.4.2.2-1 shows an example of the assumed beam arrangement.

*beamID*

**beam group 3** ? **beam group 1** ? **beam group 4** ?

**elevation**

**9 10 11 12 13 14 15 16**

**1 2 3 4**

**17 18 19 20 21 22 23 24**

**beam group 5** ? **beam group 2** ? **beam group 6** ?

**-60?**

**25 26 27 28 29 30 31 32**

**5 6 7 8**

**33 34 35 36 37 38 39 40**

**+60?**

**azimuth**

#### **Note**: ovals represent beams, numbers in ovals represent beamId

**Figure 12.4.2.2-1: Example of updatable-weight frequency-domain plus fixed time-domain beamforming**

Figure 12.4.2.2-1 introduces the concept of "beam-group". A "beam-group" is the set of beamIds that may be used simultaneously for some reason. In Figure 12.4.2.2-1 an assumption can be made that the elevation direction is time- domain while the azimuth direction is frequency-domain; the frequency-domain beams in the same time-domain group may be used at the same time but different time-domain groups shall be separated in time.

Figure 12.4.2.2-1 also shows the need to describe beam overlap and beam adjacency. It is necessary, for example, to convey that beamId=1 is a coarse beam overlapping with fine beamIds={9,10,17,18} and that beamId=18 is a fine beam overlapping with coarse beamId=1. It is also necessary to convey that beamId=1 has as neighbours beamId={2,5,11,19,25,26} and that beamId=18 has as neighbours beamIds={2,5,10,17,19,26}. Overlapping beams

shall not be scheduled together to avoid interference, and neighbouring beams should not be scheduled together to avoid interference where possible.

The specific beam characteristics are therefore as follows, all per beamId:

1. **beam-type** for the subject beamId enumerated as COARSE-BEAM or FINE-BEAM;

- there is no attempt to quantify "coarse" and fine" in terms of beamwidth, this is just a relative relationship

1. **beam-group-id** for the subject beamId as an integer;
2. **coarse-fine-beam-relation** as a list: if the subject beamId is coarse, this is a list of the associated fine beams, and if the subject beamId is fine, this is a list of the associated coarse beams;
3. **neighbor-beam** as a list: a list of all beams that may interfere with the subject beamId

An O-RU which supports predefined beamforming may also support shifting the coverage area upon M-Plane command, referred to as the 'predefined-beam-tilt-offset' feature. The O-RU shall convey its capability and associated parameters for the 'predefined-beam-tilt-offset' feature if supported. This feature allows an operator to adjust the coverage of the O-RU in elevation and/or azimuth angle. Figure 12.4.2.2-2 shows an example of the predefined beam- tilt-offset operation. As a default, a predefined beam has its own steering angle denoted by (elevation angle: "theta", azimuth angle: "phi"). If the O-RU controller configures the elevation-tilt-offset-angle as "+A" degrees and azimuth-tilt- offset-angle as "+B" degrees, then the O-RU shall regenerate the beams to change its steering angles to be elevation angle value: "theta + A", azimuth angle value: "phi + B". An M-Plane command delivers the elevation and azimuth predefined beam-tilt-offset angles. To regenerate beams, O-RU can load one of the pre-stored multiple beamforming weight vectors corresponding to all supported predefined-beam tilt values or can regenerate beamforming weights upon receiving the M-Plane command; this is up to the O-RU implementation.

The elevation-tilt-offset-angle values smaller than 0 represents an up-shift of the default service area towards the zenith (i.e. corresponding to a decrease in zenith angle) and values larger than 0 represent a down-shift of the default service area away from the zenith (i.e. corresponding to an increase in zenith angle).

![](../assets/images/31d488d15a96.png)

**Figure 12.4.2.2-2: Example of shifting a grid of predefined beams with tilt-offset**

#### Weight-based dynamic beamforming (WDBF)

###### Overview

Weight-based dynamic beamforming operates the same as predefined-beam beamforming, except that the O-DU shall convey beamforming weights to the O-RU. The following rules apply for the provision of new beamforming weights associated with a beamId, these apply for frequency-domain, time-domain, and hybrid beamforming cases; these are consistent with the principle that weights associated with a beamId when applied to applicable symbols in a slot shall be the same:

1. If beamforming weights are to be updated for a slot, then the O-DU shall provide the new weights for the first occurrence of the given beamId in the slot.
2. Weight updates (sending the same weights for a beamId is not considered a "weight update") shall not be provided more than once for a beamId in the slot. Where new beamforming weights are required in a single slot, a new beamId value shall be employed instead.
3. For PRACH a "slot duration" as considered here is considered to be a PRACH sequence duration (see Figure 7.2.3.4-1).

###### Optional restriction on sending of beamforming weights

To allow an optimization of O-RU processing, an optional restriction regarding the sending of beamforming weights is provided: for messages having the same startSymbolId within the same "context" (meaning with same numerology and array-carrier and direction (UL/DL), see also 3 paragraphs further down) within a slot, if beamforming weights are sent associated with a beamId in one C-Plane message, then any invocation of that same beamId in a subsequent C-Plane message having the same startSymbolId within the same slot shall also include the set of beamforming weights. For sections within the same C-Plane message, when beamIds are used in multiple data section descriptions the first such section shall contain the beamforming weights and the subsequent sections using the same beamId may omit the beamforming weights. Because this restriction applies to the sending of beamforming weights, this restriction applies only to Section Types 1 and 3.

An exception exists: for high-priority data sections with a repetition bit, only the data section with repetition bit = 0 shall contain the set of beamforming weights; where the repetition bit =1 for the same high-priority data section the set of beamforming weights shall not be sent, just the beamId value shall be sent.

This optional restriction is intended to enable the proper association of beamforming weights with beamId even if

C-Plane messages within a given reception window are received out of order, which for some O-RU optimized designs may result in ambiguous results (i.e. uncertainty regarding when new beamforming weights will be applied). To support this optional restriction, O-RU shall report the M-Plane O-RU capability "beam-update-contention-control-limits- required" (an O-RU feature called "BEAM-UPDATE-CONTENTION-CONTROL"). The O-DU may enable or disable this feature at an endpoint granularity using Boolean flag "beam-update-contention-control-enabled"; if set to FALSE (default) the above restriction shall not apply but if TRUE then the above restriction shall apply. If the "BEAM- UPDATE-CONTENTION-CONTROL" feature is supported by the O-RU, then the O-RU shall report "max-beams-per- symbol-with-beam-contention-control" and "max-beam-updates-per-symbol-with-beam-contention" which are limits that apply when the O-DU will comply with the restriction that O-RU requests (presumably higher limits when the restrictions will be obeyed). The O-DU may consider the relevant limits as being without "with-beam-contention" when the restriction will not be obeyed, and the O-DU may consider the relevant limits as being with "with-beam-contention" when the restriction will be obeyed. Though O-DU may set this flag "per-endpoint" the O-DU shall ensure all endpoints have the same "beam-update-contention-control-enabled" value, either TRUE or FALSE for all applicable endpoints (endpoints in use that may use the same beamId). In the case the O-DU chooses not to comply with the restriction when it has configured the value "TRUE", it is expected that either old or new beamforming weights will be applied to the subsequent C-Plane message.

A complication arises when updating beamforming weights for one data stream (eAxC) then applying those updated weights for a different data stream (eAxC). When the contexts of the two data streams are different there can be uncertainty when the new weights uploaded for the first data stream may be applied to second data stream in a different context. The uncertainty arises due to differences in the reception windows for C-Plane messages in different "contexts". The relevant contexts are:

1. DL vs UL: there can be several symbols' worth of time difference between these.
2. eAxC flows of different SCS: symbols are of different time-length hence reception windows likely are also offset between them.
3. Different array-carriers: reception windows are likely to be different length, and YANG model allows different reception windows to be defined.

To prevent uncertainty in the application of updated beamforming weights between contexts, an optional "beam- context-gap-period" (M-Plane parameter reported by the O-RU to the O-DU) defining the time between when beamforming weights are provided in a C-Plane message and the time the same beamId may be cited in a subsequent C- Plane message without weights. More precisely, after a beamId is updated with new weights by a specific C-Plane message "A", any subsequent C-Plane message "B" that cites that beamId without weights and whose reception window ends after the beam-context-gap-period starting from the end of the reception window for message "A" will use the updated weights. If the beam-context-gap-period is not honored then old or new weights (uncertain which ones) may be used by the second C-Plane message "B". See Figure 12.4.3.2-1 and Figure 12.4. 3.2-2 for examples of how the beam- context-gap-period is applied for two C-Plane messages "A" and "B" in different contexts.

![](../assets/images/0a69e3fd77f3.jpg)

**Figure 12.4.3.2-1: BFW Update Example #1 using beam-context-gap-period**

![](../assets/images/7e11377685c7.jpg)

**Figure 12.4. 3.2-2: BFW Update Example #2 using beam-context-gap-period**

If beam-context-gap-period is reported by the O-RU, the O-RU shall provide the beam-context-gap-period in microseconds as a 16-bit number, with the special value 0xFFFF meaning "infinite". Infinite means that for that O-RU, a beamId may not be reused at all in a different context (applicable only to weight-based dynamic beamforming). A zero value indicates the end of the message "A" and message "B" reception windows are perfectly aligned which should allow the second C-Plane message to use the new beamforming weights with a zero microsecond beam-context-gap-

period. In order to ensure consistent operation across all SCS and carrier bandwidths, the beam-context-gap-period shall be set by the O-RU to be the same value across the entire O-RU. The value of beam-context-gap-period shall be provided by the O-RU for use by the O-DU to avoid a beamforming weight update race condition; this is independent of the "BEAM-UPDATE-CONTENTION-CONTROL" feature.

An O-DU not recognizing the beam-context-gap-period function (possible for an O-DU conforming to an earlier version of the present document), or an O-RU not providing a beam-context-gap-period (possible for an O-RU conforming to an earlier version of the present document), will operate in the same manner as prior to the introduction of the beam-context-gap-period, with an unpredictable result if a beamId has new weights loaded in one context and is reused in a different context.

###### Weight-based dynamic frequency-domain or time-domain beamforming (not hybrid)

In the case of either frequency-domain or time-domain beamforming wherein the beamforming weights can be updated in real-time and have a beamId value associated with the weights, the beamId is treated the same: it points to a set of weights that control the array elements' gain and phase and the number of weights equals the number of array elements. In many cases, the magnitude of each complex weight value will equal unity but this is not required; in particular "tapering" may require less-than-unity weight magnitudes for some array elements. The weight values prior to any compression will be fractional hence no I or Q value may exceed positive or negative unity.

The following list describes the information that the M-Plane shall carry from the O-RU to the O-DU upon start-up as part of the O-RU self-description, the information listed is per array (so per tx-array or per rx-array):

1. Beamforming type, possible choices are "frequency", "time" or "hybrid" , - here will be "frequency" or "time"
2. Maximum number of weight-based beamId values supported (could be zero): "numBeams"

- O-RUs may have memory limitations that mean the number of beams is limited; zero means no weight- based beamforming is supported by this tx-array or rx-array

1. Initial value of weight-based beamId supported: "initBeamId"
   * Different ranges of beamId may support weight-based beamforming versus e.g. predefined beamforming
2. Frequency granularity of time-domain beamforming, enumerated as "per component carrier" or "per band".
   * Value is only present for time-domain beamforming
3. Time granularity of time-domain beamforming, enumerated as "per-OFDM-symbol" or "per-slot".
   * Value is only present for time-domain beamforming

Because the beams are to be generated by the O-DU, the O-RU cannot know the beam characteristics, so they are not reported.

The actual number of weights K in the frequency-domain or time-domain weight vectors will be clear from the O-RU antenna model, see the clause 12.5 on that topic.

###### Weight-based dynamic hybrid beamforming

* + - * 1. Overview

Two sub-cases of weight-based dynamic hybrid beamforming are considered, wherein for one sub-case both the frequency-domain and time-domain weights may be updated in real-time (see clause 12.4.3.4.2), and for the second sub-case the frequency-domain weights may be updated in real-time but the time-domain beams are fixed (see clause 12.4.3.4.3).

* + - * 1. Hybrid beamforming with updatable frequency-domain and time-domain weights

For this sub-case the beamforming weight vector is a composite of the frequency-domain weights and the time-domain weights so can be considered as simply a longer weight vector. Where a block-based beamforming weight compression is employed (block floating point, block scaling or ?-law compression), the block size is a single beamforming weight

vector (both frequency-domain and time-domain parts). The actual number of weights in the composite frequency- domain plus time-domain weight vectors (K' + K) will be clear from the O-RU antenna model, see the Clause 12.5 on that topic.

The following list describes the information that the M-Plane shall carry from the O-RU to the O-DU upon start-up as part of the O-RU self-description, the information listed is per array (so per tx-array or per rx-array):

1. Beamforming type, possible choices are "frequency", "time" or "hybrid" - here will be "hybrid"
2. Maximum number of weight-based beamId values supported (could be zero): "numBeams"
   * O-RUs may have memory limitations that mean the number of beams is limited; zero means no weight-based beamforming is supported by this tx-array or rx-array
3. Initial value of weight-based beamId supported: "initBeamId"
   * Different ranges of beamId may support weight-based beamforming versus e.g. predefined beamforming
4. Frequency granularity of time-domain beamforming, enumerated as "per component carrier" or "per band".
5. Time granularity of time-domain beamforming, enumerated as "per-OFDM-symbol" or "per-slot".

The number of time-domain beamforming weights associated with a given beamId is the same as the number of array elements which is K, but the number of frequency-domain weights is less, being K'. p' represents the dimensionality of the time-domain beamforming operation, so that K = K' \* p'. The total length of the beamforming weight vector, including both the K' frequency-domain weights and the K time-domain weights, is K' + K = K' + (K' \* p') = K' \* (p'+1). Figure 12.4.3.4.2-1 shows an example where K = 16, K' = 4 and p' = 4, and the length of the beamforming weight vector (frequency-domain and time-domain combined) is 20 complex weights.

When different hybrid beams are used in the same symbol, here using beamId values 0x13 and 0x25, the time-domain weights shall be the same (here indicated by ? values) and the number of time-domain weights equals the number of array elements K (here, 16). The frequency-domain weights may differ (shown as two different sets of ? values) and there are fewer of those, specifically there are K' (here, 4) frequency- domain weight values.

![](../assets/images/8d3a095fdc0b.png)![](../assets/images/f8e0ac0af090.png)![](../assets/images/d2d2bc9b1f36.png)![](../assets/images/580d03a20c7b.png)

Analog beam shapes defined by ? values

![](../assets/images/1deee7829d1d.png)![](../assets/images/1deee7829d1d.png)![](../assets/images/389fe5c030ee.png)

|  |
| --- |
| ?1,0 Analog  ?1,1  ?1,2 beam  ?1,3 #3 |
| ?2,0 Analog  ?2,1  ?2,2 beam  ?2,3 #3 |
| ?3,0 Analog  ?3,1  ?3,2 beam  ?3,3 #5 |
| ?4,0 Analog  ?4,1  ?4,2 beam  ?4,3 #5 |

beam id

0x13

0x25

frequency-domain beamforming

weights time-domain beamforming weights

![](../assets/images/3d128883689b.png)![](../assets/images/e18582f84a04.png)

|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| ? 1,0 ![](../assets/images/2c3f97cbad40.png)![](../assets/images/5576bb738fd5.png)![](../assets/images/5576bb738fd5.png)![](../assets/images/134aa677ff59.png)![](../assets/images/5576bb738fd5.png)![](../assets/images/d91909eaed40.png)![](../assets/images/2c3f97cbad40.png)![](../assets/images/d91909eaed40.png)![](../assets/images/2c3f97cbad40.png)![](../assets/images/2c3f97cbad40.png)![](../assets/images/2c3f97cbad40.png)![](../assets/images/d91909eaed40.png)![](../assets/images/2c3f97cbad40.png)![](../assets/images/2c3f97cbad40.png)![](../assets/images/97b705688038.png)![](../assets/images/2c3f97cbad40.png)![](../assets/images/2c3f97cbad40.png)![](../assets/images/2c3f97cbad40.png)![](../assets/images/d91909eaed40.png)![](../assets/images/97b705688038.png) | ? 1,1 | ? 1,2 | ? 1,3 | ? 1,0 | ? 1,1 | ? 1,2 | ? 1,3 | ? 2,0 | ? 2,1 | ? 2,2 | ? 2,3 | ? 3,0 | ? 3,1 | ? 3,2 | ? 3,3 | ? 4,0 | ? 4,1 | ? 4,2 | ? 4,3 |

|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| ? 2,0 ![](../assets/images/4de62d805eb6.png)![](../assets/images/5576bb738fd5.png)![](../assets/images/4de62d805eb6.png)![](../assets/images/5576bb738fd5.png)![](../assets/images/2c3f97cbad40.png)![](../assets/images/d91909eaed40.png)![](../assets/images/2c3f97cbad40.png)![](../assets/images/d91909eaed40.png)![](../assets/images/2c3f97cbad40.png)![](../assets/images/2c3f97cbad40.png)![](../assets/images/2c3f97cbad40.png)![](../assets/images/d91909eaed40.png)![](../assets/images/2c3f97cbad40.png)![](../assets/images/2c3f97cbad40.png)![](../assets/images/97b705688038.png)![](../assets/images/2c3f97cbad40.png)![](../assets/images/2c3f97cbad40.png)![](../assets/images/2c3f97cbad40.png)![](../assets/images/d91909eaed40.png)![](../assets/images/97b705688038.png) | ? 2,1 | ? 2,2 | ? 2,3 | ? 1,0 | ? 1,1 | ? 1,2 | ? 1,3 | ? 2,0 | ? 2,1 | ? 2,2 | ? 2,3 | ? 3,0 | ? 3,1 | ? 3,2 | ? 3,3 | ? 4,0 | ? 4,1 | ? 4,2 | ? 4,3 |

**Figure 12.4.3.4.2-1: Example of updatable-weight frequency-domain and time-domain beamforming**

* + - * 1. Hybrid beamforming with updatable frequency-domain weights and fixed time- domain beams

For this sub-case the beamforming weight vector is a composite of the frequency-domain weights and the time-domain beam numbers with the frequency-domain weights in the first half of the vector and the time-domain beam numbers in the second half of the vector. This vector shall not be considered as simply a longer weight vector because the frequency-domain weights may be compressed but the time-domain beam numbers shall not be compressed. Where a block-based beamforming weight compression is employed (block floating point, block scaling or ?-law compression), the block size is a single beamforming weight vector but only that half of the weight vector containing the frequency- domain weights. The remaining half of the vector containing the time-domain beam numbers may not be compressed and contains the integer time-domain beam numbers.

The actual number of weights in the composite frequency-domain weights plus time-domain beam-number vectors (K' and K) will be clear from the O-RU antenna model (see the Clause 12.5 on that topic) with the number of frequency- domain weights K' indicating which elements in the vector are subject to compression (the first K' complex values in the vector).

The following list describes the information that the M-Plane shall carry from the O-RU to the O-DU upon start-up as part of the O-RU self-description, the information listed is per array (so per tx-array or per rx-array):

1. Beamforming type, possible choices are "frequency", "time" or "hybrid" - here will be "hybrid"
2. Maximum number of weight-based beamId values supported (could be zero): "numBeams"
   * O-RUs may have memory limitations that mean the number of beams is limited; zero means no weight- based beamforming is supported by this tx-array or rx-array
3. Initial value of weight-based beamId supported: "initBeamId"
   * Different ranges of beamId may support weight-based beamforming versus e.g. predefined beamforming
4. Frequency granularity of time-domain beamforming, enumerated as "per component carrier" or "per band".
   * Value is only present for time-domain beamforming
5. Time granularity of time-domain beamforming, enumerated as "per-OFDM-symbol" or "per-slot".
   * Value is only present for time-domain beamforming
6. For each of the time-domain beams (the number is known from the O-RU antenna model), beam attributes (see 12.4.2.2)

The number of time-domain beam numbers associated with a given beamId (K') will be the same as the number of frequency-domain beamforming weights for that beamId; this is because each frequency-domain beamforming weight is applied to a data stream that is subsequently time-domain beamformed using a specific beam number, so if there are

e.g. K' = 4 frequency-domain weights associated with a given beamId there will be four time-domain beam numbers also associated with that same beamId. See Figure 12.4.3.4.3-1 for an example wherein four frequency-domain weights

?x,y are applied with four time-domain beam numbers (#3 and #5). Here the number of frequency-domain weights K' indicated by the antenna model would be "four" so the first four values in each vector would be complex fractional values and would be compressed, while the second four values would be real integers and not compressed.

beamId

0x13

![](../assets/images/5c8d5aac346b.png)![](../assets/images/f301c4d57297.png)![](../assets/images/f301c4d57297.png)![](../assets/images/e098455cb32e.png)![](../assets/images/cb519be4488a.png)![](../assets/images/dc735f414a8c.png)![](../assets/images/4cb53ca16780.png)![](../assets/images/4c156da73c30.png)

|  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- |
| ? 1,0 | ? 1,1 | ? 1,2 | ? 1,3 | 5 | 5 | 3 | 3 |

0x25

![](../assets/images/e098455cb32e.png)![](../assets/images/e098455cb32e.png)![](../assets/images/e098455cb32e.png)![](../assets/images/f301c4d57297.png)![](../assets/images/cb519be4488a.png)![](../assets/images/dc735f414a8c.png)![](../assets/images/cb519be4488a.png)![](../assets/images/cb519be4488a.png)![](../assets/images/7c32dc215d15.png)

#5

![](../assets/images/d4267559b9ab.png)

|  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- |
| ? 2,0 | ? 2,1 | ? 2,2 | ? 2,3 | 5 | 5 | 3 | 3 |

frequency-domain beamforming weights

time-domain beam #

![](../assets/images/ea4666d08715.png)

#3

![](../assets/images/a7c9301ef7ec.png)![](../assets/images/0a992830abfe.png)

Analog beam "shape"

defined by properties

#3

![](../assets/images/c4ab46be42e9.png)![](../assets/images/c54852dec185.png)![](../assets/images/50aba291e449.png)

**Figure 12.4.3.4.3-1: Example of updatable-weight frequency-domain plus fixed time-domain beamforming**

![](../assets/images/d2d6ee6d3e6f.png)

#5

![](../assets/images/1d5c32c392f4.png)

In single user MIMO we might need to use 2 different TD beams for one symbol (and want to use all antenna elements so do not want to use zero-value FD weights) and a single eAxC\_ID ? we need multiple TD beams, in particular one per ADC/DAC.

This is generally only useful for Category B O-RU (precoding within the O-RU)

|  |
| --- |
| ?1,0 Analog  ?1,1  ?1,2 beam  ?1,3 #3 |
| ?2,0 Analog  ?2,1  ?2,2 beam  ?2,3 #3 |
| ?3,0 Analog  ?3,1  ?3,2 beam  ?3,3 #5 |
| ?4,0 Analog  ?4,1  ?4,2 beam  ?4,3 #5 |

* + - * 1. Hybrid beamforming with Section Type 4 'TIME\_DOMAIN\_BEAM\_CONFIG'

As described in clause 12.4.3.4.2 and clause 12.4.3.4.3, use of a common hybrid beamId to update two sets of beam information that have different update frequency (i.e. frequency-domain beamforming weights are expected to change per PRB and per spatial layer, however, the time-domain beamforming weights are expected to have a common value for all PRBs within a carrier and same for all spatial layers) results in repeating duplicate time-domain beamforming information per frequency-domain beamforming update resulting in redundant fronthaul usage. Also, analog beamforming information applies to the entire carrier or all carriers in a given band and hence is not subject to single endpoint processing.

Figure 12.4.3.4.4-1 and Figure 12.4.3.4.4-2 emphasize on the redundancy in each case as described in clause 12.4.3.4.2 and clause 12.4.3.4.3:

![](../assets/images/5996f0464d3e.png)

**Figure 12.4.3.4.4****-1: Example of repetition of time-domain beam number vector of size K' for every frequency-domain beamforming update**

![](../assets/images/b65700cf1bc6.png)

**Figure 12.4.3.4.4****-2: Example of repetition of time-domain beamforming weight vector of size K' \* numAntElements for every frequency-domain beamforming update (per prb per layer)**

The redundancy of repeating time-domain beamforming information as described in both the examples above may be avoided by decoupling time-domain and frequency-domain beamforming information using Section Type 4 with TIME\_DOMAIN\_BEAM\_CONFIG command, see Figure 12.4.3.4.4-3. Using this Section Type 4 command, time- domain beamforming information may be sent separately.

![](../assets/images/537c562c2f0c.jpg)

**Figure 12.4.3.4****.4-3: Example of decoupled frequency-domain and time-domain beamforming information using Section Type 4 'TIME\_DOMAIN\_BEAM\_CONFIG' command**

When the O-DU configures the O-RU using the M-Plane parameter 'st4-for-time-domain-beamforming-weights- enabled', to use Section Type 4 to specify time-domain beamforming information for time-domain beamforming and/or hybrid beamforming, all other extensions i.e. SE 1, 3, 10, 11 used for specifying beamforming information shall contain frequency-domain beamforming information only. Also as defined in M-Plane, hybrid beamId space, time-domain beam-id space, and frequency domain beamId space are independently defined in M-Plane. Below requirements shall apply for specifying hybrid beams using Section Type 4 'TIME\_DOMAIN\_BEAM\_CONFIG' command:

* M-Plane defined frequency-domain beam-id space shall be used to specify the frequency-domain portion of hybrid beam-id.
* M-Plane defined time-domain beamId space shall be used for each time-domain beam number specified in the'TIME\_DOMAIN\_BEAM\_CONFIG' command.
* Each time-domain beam number 'tdBeamNum' vector is identified by a 'tdBeamGrp'. This association is done by the O-RU as it receives a unique vector of 'tdBeamNum' associated with the unique 'tdBeamGrp' value. The total number of time-domain beam numbers per 'tdBeamGrp' shall be equal to the number of frequency- domain weights K'.
* Size of each time-domain beamforming vector is the number of antenna elements per frequency-domain beamforming port which is equal to p'. Value of p' shall be advertised by the O-RU as an M-Plane parameter 'p\_dash'.

NOTE: K'= K is a special case when p'=1.

#### Attribute-based dynamic beamforming (ABBF)

Attribute-based dynamic beamforming operates similarly to weight-based dynamic beamforming except that it is inherently a time-domain beamforming operation (both are "dynamic" meaning the definition of a beam as indicated by a beamId value may be changed via a C-Plane message). Also, instead of beamforming weights associated with a specific beamId being sent from O-DU to O-RU in Section Extension 1, beam attributes associated with a specific beamId are sent instead from the O-DU to the O-RU in Section Extension 2.

The following list describes the information that the O-RU shall report via the M-Plane to the O-DU upon start-up as part of the O-RU self-description:

1. Beamforming type, possible choices are "frequency", "time" or "hybrid"- here will be "time".
2. Maximum number of beamId values supported (could be zero): "numBeams"
   * O-RUs may have memory limitations that mean the number of beams is limited; zero means no weight- based dynamic beamforming is supported by this tx-array or rx-array
3. Initial value of beamId supported: "initBeamId"
   * Different ranges of beamId may support generated beam beamforming versus e.g. predefined beamforming
4. Valid range of bfAzPt (see clause 7.7.2.3)
5. Valid range of bfZePt (see clause 7.7.2.4)
6. Valid range of bfAz3dd (see clause 7.7.2.5)
7. Valid range of bfZe3dd (see clause 7.7.2.6)
8. Valid range of bfAzSl (see clause 7.7.2.6)
9. Valid range of bfZeSl (see clause 7.7.2.7)

#### Channel-information-based beamforming (CIBF)

As stated in clause 12.4.1, beamId is irrelevant and unused in the case of channel-information-based beamforming.

#### DMRS based beamforming (DMRS-BF)

As stated in clause 12.4.1, beamId is irrelevant and unused in the case of DMRS based beamforming.

## O-RU antenna model

#### Overview

Knowledge of O-RU antenna model is critical for certain types of beamforming. The following model is applicable for O-RU with one or more antennas, where each antenna has array of elements that are

* uniform (all elements have same properties) and
* organized into rectangular array (with rows and columns) that is planar (flat).

O-RU shall expose via M-Plane logical model of O-RU consisting of one or more arrays composed of one or more array elements. Array element represents independently controllable entity including one or more radiating elements and related RF processing elements (here, RF processing element is an entity that processes RF signal and is not related to processing element defined in M-Plane). RX and TX are in general independently controllable for that in the model tx-arrays and rx-arrays are described as separate entities. If O-RU supports beamforming, then beamforming is realized within each array separately i.e. beamforming weight vector is applicable within one array. One or more arrays can occupy same physical location e.g. rx-array and tx-array that use same set of radiators.

Beamforming methods that use dynamic beamforming with beamforming weights conveyed in C-Plane message (in contrast to predefined beams) require the O-DU to know antenna properties. Different beamforming methods require knowledge of different subsets of antenna properties.

#### Coordinate systems

Some of parameters describing model of antenna are related to coordinate system that defines three axes and three angles.

There are two coordinate systems defined:

* array coordinate system
* O-RU coordinate system

The **array coordinate system** is centred on the centre of the leftmost, bottom element of an array as presented in Figure 12.5.2-1. The array coordinate system is applicable within one array.

*z*

Antenna array

Array element

*y*

*x*

View assumes observation of the antenna array from the front (from UE).

*z*

Antenna array

Array element

*y*

*x*

View assumes observation of the antenna array from the front (from UE).

**Figure 12.5.2-1: Array Coordinate System**

The diagram presents view from the front of array-panel (from UE). Arrows indicate increasing values of coordinates.

1. points towards broad-side
2. increases to right, with antenna-array's columns
3. points towards zenith

**?** (phi) is azimuth angle, counter-clockwise rotation around z-axis, 0? points to broad-side, 90? points to y-axis

**?** (theta) is zenith angle, counter-clockwise rotation around y-axis, 0? points to zenith, 90? points to horizon

**?** (psi) is angle, counter-clockwise rotation around x-axis, 0? points to horizon, 90? points to zenith

The **O-RU coordinate system** is identical to the array coordinate system of one of arrays in the O-RU. The selection of the array used for the basis of the O-RU coordinate system shall be fixed by the O-RU design. The O-RU coordinate system is applicable within one O-RU.

The array coordinate system (the coordinate system specific for the array) is relative to the array. It is used to express spatial relations between elements of one array (see dy and dz in clause 12.5.3). The O-RU coordinate system is specific for the O-RU and is used to express spatial relations between the O-RU and arrays in the O-RU (see x, y, z in clause 12.5.3) which allows to determine spatial relations between arrays.

#### O-RU antenna model parameters

The O-RU antenna model is described with the following parameters:

* ***K*** - number of array elements in array (*K* = *M x N x P x Q*)
* ***M*** - number of rows of array elements in array. *M* > 0; value 0 is reserved for future use.
* ***N*** - number of columns of array elements in array. *N* > 0; value 0 is reserved for future use.
* ***P*** - number of polarizations in array. *P* > 0, value 0 is reserved for future use.
* ***Q*** - number of overlapping array elements (array-layers) in array. Each array-layer has M rows, N columns and P polarizations. Q>0; value 0 is reserved for future use. See Annex K for more information on array-layers.
* **x, y,** z - position of centre of the leftmost, bottom element of array in O-RU coordinate system
* **?, ?** direction of normal vector perpendicular to array's surface in O-RU coordinate system (array's normal vector corresponds to x axis in array's coordinate system)
* **dy** - mean distance between centres of nearby array elements in y direction in array coordinate system (distance between columns); value 0 is reserved for future use.
* **dz** - mean distance between centres of nearby array elements in z direction in array coordinate system (distance between rows); value 0 is reserved for future use.
* **list of polarizations in array** (this list has P elements, each representing p-th polarization); values ordered in ascending order of angle. Example: cross-polarized array having elements of one of two linear polarizations can be described by list: (-45?, +45?) indicating that array element with polarization index p=0 has linear polarization -45?, and array element with polarization index p=1 has linear polarization +45?.
* **independent power budget per layer** - in case of an array with multiple layers, corresponding elements (located in same row and column and same polarization) of different layers may have a shared power budget or have independent power budgets.

For an array supporting hybrid beamforming (see clause 12.4.2.2), additional parameters apply:

* ***K*'** - number of frequency domain beamforming weights ?k' that can be applied within the array. 0<*K*'<=*K*; value 0 is reserved for array not supporting hybrid beamforming.
* **h**(k) - mapping of array element k to frequency domain beamforming weight ?k' where k'=h(k).

The mapping is represented as a list of lists: for every 0<k'<*K*' a list of *K*/*K*' numbers identifying array elements where frequency domain beamforming weight ?k' is applied. k'=h(k) if number k is in the list corresponding to k'.

Clause 12.5.4 describes how numbers are assigned to array elements.

The model assumes the number of array elements corresponding to frequency domain beamforming weight ?k' is the same for every k' (0<k'<*K*') and the elements corresponding to beamforming weights form a rectangular shape without overlapping i.e. every array element is linked with exactly one frequency domain beamforming weight ?k'.

In addition, the O-RU antenna model provides parameters describing key capabilities of array elements. The model assumes the array is uniform and all elements have the same properties. Each single value is applicable to all elements within the array.

Parameters describing array elements applicable to tx-array and rx-array:

* horizonal plane half power (-3 dB) beam width of array element's radiation pattern
* vertical plane half power (-3 dB) beam width of array element's radiation pattern
* horizonal plane quarter power (-6 dB) beam width of array element's radiation pattern
* vertical plane quarter power (-6 dB) beam width of array element's radiation pattern

Beam widths above are angles (expressed in degrees) between half-power (-3 dB) points or quarter-power (-6 dB) points respectively of the main lobe with reference to peak radiated power of main lobe. Horizontal and vertical plane correspond to the xy-plane and xz-plane respectively of the array in the array coordinate system.

The parameter describing array elements specific for tx-array:

* ***ma,k*** - max rms power rating of array element of the array. Usage of max rms power rating is described in clause 8.1.3.3.

#### Identification and ordering of array elements

In many applications there is a need to assign to array element a number k such that 0 <= k < *K* (see K in clause 12.5.3). One example is mapping position (represented by k, such that 0 <= k < *K*) of a beamforming weight in beamforming vector to an array element. Other example is identification of an array elements in the antenna model.

For purpose of identification and ordering a number k is assigned to each element of array by the function *f*(*m,n,p,q*):

f(m, n, p, q) = q ? P ? M ? N + p ? M ? N + m ? N + n

where:

*m* - row (bottom to top), 0 <= m < *M*

*n* - column (left to right, view from the front of array), 0 <= *n* < *N*

*p* - polarization index, 0 <= p < *P*; polarization value of polarization index p is ?p (see ? in clause 12.5.2)

*q* - array-layer, 0 <= q < *Q*

*N, M, P, Q* are defined in clause 12.5.3

NOTE: For a rectangular array, the function f(m,n,p,q) can be inverted allowing to determine a "tuple" (m,n,p,q) of k-th element.

#### Relations between array elements

Beamforming methods that use dynamic beamforming with beamforming weights conveyed in C-Plane messages (in contrast to predefined beams) require the O-DU to know that specific elements of one array is co-located with elements of another array e.g. rx-array and tx-array that use same set of radiators. In addition, one or more tx-arrays may share elements and parts of RF processing paths (e.g. a power amplifier) resulting in a shared power budget described by a maximum rms power rating.

If element ka of array A and element kb of array B are in same position (same physical row and column) then ka and kb are co-located.

If element ka of array A and element kb of array B are co-located and share a power budget, then ka and kb are shared. Relation of co-location is symmetric: ka and kb are co-located if and only if kb and ka are co-located.

Relation of co-location is transitive: if ka and kb are co-located and kb and kc are co-located then ka and kc are co-located. Relation of sharing implies co-location: if ka and kb are shared then ka and kb are co-located.

O-RU shall report via M-Plane relations between array elements. O-RU shall avoid reporting redundant relations that can be derived from other relations by symmetric and transitive properties and implication of co-location relation by sharing relation. In addition, the O-RU shall provide a concise representation of the common case of two arrays that have all elements in relation (e.g. rx-array of -45? polarization and corresponding rx-array of +45? polarization).

#### Model usage

The O-RU antenna model reported by the O-RU consists of rx-arrays and tx-arrays. rx-arrays and tx-arrays represent a capability for transmitting/receiving RF signal related to an eAxC and -- if beamforming is supported by O-RU on given array -- beamforming capability. In this clause examples are presented: red and green bars represent array elements of different polarizations, grey box represents physical device, white rectangles represent arrays reported by O-RU.

tx-array "-45"

rx-array "+45"

rx-array "-45"

physical array

**Figure 12.5.6-1: Examples of Model Usage - TX as two single-polarization arrays or one cross- polarized array**

![](../assets/images/fa9b8d72bacc.png)![](../assets/images/847670705ae8.png)

tx-array "+45"

tx-array "all"

rx-array "+45"

rx-array "-45"

physical array

As an example Figure 12.5.6-1 presents two O-RU designs: an O-RU with two tx-arrays each of one polarization and an O-RU with one tx-array of two polarizations. An O-RU that combines both above designs is possible as presented in Figure 12.5.6-2.

![](../assets/images/d5f9fbe5ee10.png)

rx-array "+45"

rx-array "-45"

physical array

**Figure 12.5.6-2: Examples of Model Usage - TX as two single-polarization arrays and one cross- polarized array**

tx-array "all"

tx-array "+45"

tx-array "-45"

Similarly, in RX - if an O-RU does not support collecting the raw SRS by use of beams designed to mute signal from all elements except one then that O-RU - in addition to full rx-array - may expose rx-arrays with single elements as presented in Figure 12.5.6-3.

![](../assets/images/fb48fa9818e3.png)

physical array

**Figure 12.5.6-3: Example of Model Usage - RX with multi-element and multiple single-element arrays**

rx-array "-45"

An O-RU that does not support beamforming can be represented with arrays having one element each. Note that a category B O-RU could be represented with an array with two elements to accommodate two polarizations while a category A O-RU would generally be represented with a tx-array with only one polarization (P=1). Figure 12.5.6-4 presents the two design examples of a non-beamforming O-RU: an O-RU with two tx-arrays each of one polarization and an O-RU with one tx-array of two polarizations. An O-RU that combines both designs is also possible.

![](../assets/images/94c7c6a77794.png)![](../assets/images/cb8858f267e8.png)

**Figure 12.5.6-4: Examples of Model Usage - Non-beamforming O-RU with TX as two single-polarization arrays or one cross-polarized array**

## DMRS based beamforming (DMRS-BF)

#### DMRS-BF common aspects

###### DMRS-BF common aspects introduction

DMRS based beamforming (DMRS-BF) is a beamforming method wherein the O-RU computes UE channel estimates based on the received UE UL DMRS symbols, then computes "weights" based on those channel estimates and applies the weights to the UE UL data. This beamforming method is applicable only to the NR PUSCH. There are two types of DMRS-BF: **DMRS-BF-NEQ** where the "weights" are beamforming weights that do not include an equalization function, and **DMRS-BF-EQ** where the "weights" are beamforming weights that include an equalization function.

Figure 12.6.1.1-1 shows block diagrams of both DMRS-BF types.

O RU supporting DMRS ithout equali ation (DMRS NE )

Antennas

O RU supporting DMRS ith equali ation (DMRS E )

in O DU in O RU

**n**

Hdmrs

**n**

**n**

ydmrs

**nn**

**s n**

**n**

comb

yeq

**n**

ycomb

**n**

data layer (non equali ed)

ybf

**n**

**n**

dmrs

**n**

**n**

H dmrs

**nn**

**s n**

dmrs

**n**

eq

**n**

**n**

yrx

I

**3**

RRM measurements (NOTE 2)

**s n s**

Antennas

Added in U PI proposal

**n**

Hdmrs

**n**

**n**

ydmrs

**nn**

**s n**

**n**

yeq

**n**

ycomb

**n**

SINR **n**

**n**

eq

H dmrs

**nn**

**s n**

dmrs

**n**

eq

**n**

**n**

comb

**n**

data layer

ybf

**n**

**n**

yrx

I

**3**

SINR

RRM measurements (NOTE 2)

**s n s**

7 2x unchanged

NOTE 1: The above figure illustrates some of the high-level functionalities inside the O-RU and O-DU, and does not bind the internal design of either of the O-RU and O-DU.

NOTE 2: RRM measurements are derived from received UL signals using specific reference points in the UL path. NOTE 3: This functionality is mandatory to support, but optional to use when connected to an O-RU using DMRS-BF-

EQ

**Figure 12.6.1.1-1: DMRS-BF block diagrams, DMRS-BF-NEQ and DMRS-BF-EQ**

The DMRS-BF method, like WDBF and CIBF, is of value in Massive MIMO configurations, typically supported in CAT-B O-RUs. Generally, the operation is carried out on user groups, (see clause 3.1 for the definition of "user group"); each of which may include one or more UEs each supporting one or more data layers.

At a high level, DMRS-BF operates as follows:

1. An O-DU supporting DMRS-BF shall support both types of DMRS-BF, i.e. DMRS-BF-EQ and DMRS-BF- NEQ. The O-DU shall support the DMRS processing, inclusive of equalization functionality. Equalization functionality is a functionality that is implemented for the purpose of compensating the amplitude and phase changes of each layer signal caused by the radio propagation channel and removing the co-channel

interferences of other layers to each signal layer. The O-DU shall use DMRS processing when interworking with an O-RU configured to use no beamforming or use beamforming methods other than DMRS-BF-EQ. Using or not using DMRS processing when interworking with an O-RU configured to use DMRS-BF-EQ is a choice of the O-DU.

1. The O-RU shall declare support for delay profiles associated with specific BF methods including DMRS-BF- EQ or DMRS-BF-NEQ (see clause 12.6.1.2.1).

NOTE: "delay profile" refers to the M-Plane parameter delay-profile-id which consists of parameter settings for different combination of SCS and carrier bandwidth - with no variation based on DMRS configuration.

1. The O-RU shall declare support for DMRS-BF specific capabilities including ueId format (see clause 12.6.1.3.1.2), symbol reordering method, RRM measurement capability and parameter values, and SINR reporting resolution (see clause 12.6.1.2.1).
2. The O-RU shall declare support for various DMRS-BF features including limits on number of UEs, UE layers, user groups, and optional capabilities such as simultaneous symbol reordering and DMRS symbol sending, and use of ueId persistence.
3. The O-DU shall configure endpoints to use a specific delay profile along with its associated beamforming method, in this case DMRS-BF-EQ or DMRS-BF-NEQ; only one of the two beamforming methods may be used at a time in the whole O-RU (see clause 12.6.1.2.2).
4. The O-DU shall configure whether, for all DMRS-BF-EQ endpoints, the required capability of reporting port- reduced DMRS symbols will be used (see clause 12.6.1.2.2).
5. The O-DU shall configure the use of DMRS-BF specific capabilities including ueId format (see clause 12.6.1.3.1.2), U-Plane symbolId meaning (transmission window number or on-air symbol number), symbol reordering method if supported, RRM measurements to be reported with relevant parameter values if supported, and SINR reporting resolution if supported, as well as other DMRS-BF-related configurations (see clause 12.6.1.2.2).
6. For each slot, the O-DU shall issue C-Plane messages using ST 5 describing the scheduling decisions for each user group, which may use SE 10 (e.g. if there is more than one UE layer in the user group), shall use SE 24 (to describe the DMRS configuration(s) for the user group), may use SE 25 (if symbols are to be reordered) and may use SE 26 (if frequency offset data is to be sent from O-DU to O-RU) (see clause 12.6.1.3). Each section description shall span all UE layers within the user group unless configured otherwise (see clause 12.6.1.3.1.2 exceptions #1 and #2).
7. For each slot, the O-RU shall execute UL DMRS-BF (see clauses 12.6.2 and 12.6.3 for a more detailed description of the DMRS-BF operation):
   * The O-RU collects DMRS symbols and may execute on them some manner of dimension reduction controlled by the O-DU using SE 27 or without any explicit control by the O-DU.
   * The O-RU computes a channel estimate for each UE layer based on the received DMRS symbols, this will generally span multiple user groups if the UE spans multiple user groups.
   * The O-RU computes weights to apply to each UE layer. The specific computation will differ for DMRS- BF-EQ compared to DMRS-BF-NEQ. The weights may be calculated for the DMRS symbols too.
   * The O-RU applies the computed weights to each UE layer's PUSCH data. If the O-DU configures the O- RU to compute and send port-reduced DMRS data, then the O-RU shall also apply the weights to the DMRS symbols, thereby creating "port-reduced DMRS symbols".
8. The O-RU shall send each UE layer's U-Plane data to the O-DU, one symbol's tx-window at a time with the appropriate timing (see clause 12.6.1.4), with the symbols optionally being reordered or reassigned according to the method configured by the O-DU (see clause 12.6.1.5).
9. The O-RU shall send RRM measurements one or more times per slot if supported and configured by the O-DU (see clause 12.6.1.6).
10. The O-RU shall send SINR data one or more times per slot if supported by the O-RU and configured by the O- DU (see clause 12.6.1.7).

The O-RU shall be configured via M-Plane whether or not to send port-reduced DMRS symbols to the O-DU, either for DMRS-BF-NEQ for which it is required to be supported and configured, or for DMRS-BF-EQ for which it is required to be supported and may be configured. For DMRS-BF-EQ, this functionality may support certain DMRS-based O-DU receiver operations that require DMRS information, such as a Successive Interference Cancellation (SIC) receiver or some variants of an UL Coordinated Multi-Point (CoMP) receiver. However, DMRS-BF-EQ can support non-DMRS- based advanced receivers and CoMP variants not requiring DMRS information, without needing this functionality (sending port-reduced DMRS symbols to the O-DU).

When using the port-reduced DMRS symbol data, it is important for the O-DU to know the O-RU's DMRS processing continuity in time and frequency. In time, the continuity shall be considered as a full slot or all the allocated portions of a slot. In frequency, the O-RU shall declare the largest frequency range (or ranges) that the O-RU will assure to not have any significant discontinuities introduced due to O-RU processing. The O-DU shall configure the specific frequency range (if more than one is reported) that the O-RU shall use.

The O-DU should describe all MU-MIMO groups for a given ueId in one single C-Plane message to the extent permitted by the packet MTU size.

###### DMRS-BF capabilities and configuration via M-Plane

* + - * 1. DMRS-BF capabilities declaration

In support of DMRS-BF, the O-RU shall declare the following capabilities:

1. Support, for the whole O-RU, of DMRS-BF-NEQ or DMRS-BF-EQ; one or both may be declared.
2. Support, for the whole O-RU and pertaining to all endpoints supporting DMRS-BF, the capability for "user group self assembly with group ID" and for "user group self assembly without group ID" or support for both or support for neither.
   * "user group self assembly with group ID" -allows for a single section description to include only a portion of a user group, with the provision of a "user group ID" and "user group size" to aid the O-RU in assembling the full user group.
   * "user group self assembly without group ID" - allows for a single section description to include only a portion of a user group, with no provision of a "user group ID" and "user group size" meaning the O-RU shall assemble the full user group by analysing the PRB ranges of all UE layers over all section descriptions.
3. Support, per endpoint supporting DMRS-BF, of one or more "beamforming delay profiles", with each beamforming delay profile containing a single delay profile which is associated with one or more beamforming methods including DMRS-BF (EQ, NEQ or both), as well as possibly other beamforming methods that work with the delay profile. When an O-RU supports and activates DMRS-BF, the O-RU should ensure one or more endpoints specifically support a delay profile at a lower latency relative to DMRS-BF, which may be used for PUCCH. It is beneficial for an O-RU to support multiple delay profiles to accommodate low-latency BF methods as well as high-latency BF methods such as DMRS-BF.
4. Support, for the whole O-RU but pertaining only to endpoints supporting DMRS-BF (NEQ, EQ or both), of a maximum number of least-significant ueId bits allocated to enumerate layers per UE, which has the effect of limiting the maximum number of layers per UE that can be processed by the O-RU (for ueId format definition, see clause 12.6.1.3.1.2). This ueId formatting capability only applies to the DMRS-BF operation.
5. Support, for the whole O-RU but pertaining only to endpoints supporting DMRS-BF (NEQ, EQ or both), of zero or more of the two optional symbol ordering methods (the ability to support natural symbol order is mandated so it is not explicitly declared):
   * Per-window symbol reordering
   * Per-section tx-window reassignment

The O-RU shall support per-window symbol reordering under the joint condition that DMRS-BF is enabled, DMRS data is configured to be sent to the O-DU, and any symbol reordering method is supported. The O-RU may support per-window symbol reordering under the joint condition that DMRS-BF is enabled and DMRS data is not configured to be sent to the O-DU.

1. Support, for the whole O-RU but pertaining only to endpoints supporting DMRS-BF (NEQ, EQ or both), of specific RRM measurement reporting for every slot in which DMRS-BF is used, as well as specific parameter values associated with RRM measurements. Endpoint types supporting DMRS-BF may support different sets of RRM measurements. Not all RRM measurements have parameters, see clause 12.6.1.6.
2. Support, for the whole O-RU but pertaining only to endpoints supporting DMRS-BF-EQ, one or more SINR formats including compression methods and possible frequency and time resolution values, and optionally a list of supported SINR reporting compression block sizes (see clause 12.6.1.7). Support (or not) for simultaneous provision of DMRS data and SINR data.
3. Support, for the whole O-RU but pertaining only to endpoints supporting DMRS-BF (NEQ, EQ or both) and configured to compute and send port-reduced DMRS data, processing alignment parameter "B" ("continuity block size" in units of PRBs) which is the largest frequency range that the O-RU will assure to not have any significant discontinuities introduced due to O-RU processing. There can be multiple reported values of "B" if the O-RU is capable of selecting one of multiple continuity block sizes, in which case one shall be declared as the default value. Either the absence of the list of supported continuity block sizes or "B" equalling "zero" means there is continuity across all layers within a user group as determined by O-RU supplier. Blocks are considered to start with the first PRB in the user group; the last block could be truncated in size. If the PRB range is discontinuous, blocks are considered to terminate at a PRB discontinuity and, after a discontinuity, a new block is considered to be started.

NOTE: the O-RU report of "B" is meant to be an indication (a hint) of discontinuities that may be introduced in the DMRS or PUSCH user data due to O-RU processing, that cannot be predicted by the O-DU. O-DU implementation may take advantage of this information by aligning O-DU processing boundaries to "B". See Figure 12.6.1.2.1 for an example of continuity block definitions for the case of non-continuous PRBs.

|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |

|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |

**Figure 12.6.1.2.1-1: continuity block definition for non-continuous PRB allocation example**

1. Support, for the whole O-RU but pertaining only to endpoints supporting DMRS-BF (NEQ, EQ or both) and configured to use either per-window symbol reordering or per-section tx-window reassignment, assignment of U-Plane symbolId to either "transmission window number" or "on-air symbol number".
2. Support, for each endpoint supporting DMRS-BF (NEQ, EQ or both) and configured to use either DMRS-BF method, max-num-ueids, max-num-ues-supported, ueid-max-layer-bits, max-entries-per-slot, and max-user- groups-per-slot; these help an O-RU manage its overall processing load demand.
3. Support for ueId persistence across multiple slots, see use of ueIdReset as described in clause 7.7.24.
4. The maximum number of user groups that a single UE may occupy across the symbol range in a single slot (max-user-groups-per-ue-in-time).
5. Support for UEs having partial overlap in frequency (i.e. one user group having a frequency range partially overlapping the frequency range of a second user group, "ue-freq-partial-overlap-supported") and support for UEs having partial overlap in time (i.e. one user group having a symbol range partially overlapping the symbol range of a second user group, "ue-time-partial-overlap-supported").

O-RU supporting DMRS-BF shall support:

1. Section Type 5.
2. Section Extension 10, beamGroupTypes 10b and 11b.
3. Section Extension 24.
   * + - 1. DMRS-BF configuration

The O-DU shall configure on a per-endpoint basis various aspects of DMRS-BF, including the following:

1. to use a specific beamforming delay profile, one of the declared supported "beamforming delay profiles" (see clause 12.6.1.2.1 item 3) for that endpoint. All endpoints in the O-RU configured to use a type of DMRS-BF shall be configured to use the same beamforming delay profile.
2. to use a specific list of beamforming methods, which shall be a subset of the full list of beamforming methods associated with the configured beamforming delay profile. All endpoints in the O-RU configured to use a type of DMRS-BF shall be configured to use the same type, either DMRS-BF-NEQ or DMRS-BF-EQ.
3. whether or not to compute and send from the O-RU to the O-DU port-reduced DMRS symbols, the same for all endpoints configured to use DMRS-BF-EQ.
4. to allocate a specific number of least-significant ueId bits for UE layer enumeration, the same for all endpoints configured to use any type of DMRS-BF.
5. to use a specific optional symbol reordering method (or no configuration which means use the natural symbol order), which are per-window symbol reordering and per-section tx-window reassignment. All endpoints in the O-RU configured to use a type of DMRS-BF shall be configured to use the same method of symbol reordering (or not configured, in which case all shall use natural symbol ordering).
6. to send from O-RU to O-DU a selected set of RRM Measurements, which if configured to be sent shall be sent for every slot in which DMRS-BF is to be executed; an exception is the unallocated IPN measurement and DMRS SNR which are each sent in response to an explicit C-Plane request and not necessarily every slot that executes DMRS-BF.
7. to use specific parameter values for RRM measurements. Not all RRM measurements have parameters, see clause 9.2.
8. to enable the transfer of SINR data if SINR data transfer is configured, and to use a specific SINR time resolution or a list of SINR time resolutions if O-RU controlled time resolution for SINR reporting is supported by the O-RU and enabled by the O-DU and to use a specific frequency resolution, applicable to all endpoints supporting DMRS-BF-EQ and the same for all the endpoints (see clause 12.6.1.7).
9. to use a specific continuity block size "B", if more than one was reported as supported by the O-RU and the reported default block size is not to be used, pertaining only to endpoints providing port-reduced DMRS symbols to the O-DU. The same value of "B" shall be used across those endpoints. If no "B" values (no list of supported continuity block sizes) are present in the endpoints, then no continuity block size configuration shall be done.
10. To use a specific definition of the U-Plane SymbolId field, conveying either "transmission window number" or "on-air symbol number". Use of "window number" excludes the possibility of using the "per-section tx- window reassignment" method. See clause 12.6.1.4 for more information.

The O-DU shall also configure the O-RU to contain one or more lists of eAxC\_IDs for use by Section Extension 10, each list associated with a representative eAxC\_ID which is also the first eAxC\_ID in the list, to be used for conveying via C-Plane the UE layers contained within a user group. These lists pertain to the whole O-RU, not to any single endpoint.

###### Conveying DMRS configuration via C-Plane

* + - * 1. C-Plane description of DMRS configuration

DMRS configuration, overview

In order to execute DMRS-BF, the O-RU shall be commanded to do it, and then the user groups on which the DMRS- BF operation will be done shall be described. These user groups may comprise one or more UEs, and each UE may be using one or more data layers. A single such data layer is referred to as a "UE layer", and each UE layer is associated with a specific eAxC\_ID. DMRS-BF shall be carried out on all data layers in a user group, which may be many or few UE layers, and even on a single UE layer.

DMRS Configuration, use of Section Type 5

Section Type 5 shall be used to convey information regarding the user groups, along with Section Extension 24 and optionally Section Extensions 10, 25, 26 and 27 as follows. The order of Section Extensions in the context of DMRS- BF shall be first SE 10, then SE 24, then SE 25, SE 26 and SE 27 in any order.

Section Type 5 shall be used to convey the scheduling of user groups, one user group per section description (except see exception #1 and exception #2 below). In this case, a single invocation of Section Extension 24 (see clause 7.7.24), which provides a description of the DMRS configuration of all the UE layers in the user group, shall be present, following SE 10 if it is present. If the user group has more than one UE layer, then Section Extension 10 (see clause 7.7.10) shall be used to convey all UE layers within the user group in a single section description. If the symbols in the user group will be reordered, then Section Extension 25 (see clause 7.7.25), following SE 24, describes the necessary symbol reordering pattern. If frequency offset information is to be provided by the O-DU to the O-RU, Section Extension 26 (clause 7.7.26) is conveyed, following SE 24. Finally, if O-DU-controlled DMRS port reduction is supported and to be executed, SE 27 is conveyed following SE 24

Section Type 5 includes the ueId field, which is a 15-bit unsigned-integer field. When used in the context of DMRS-BF, the 15 bits in ueId are partitioned such that some number of least-significant bits enumerate layers per UE, and the remaining most-significant bits enumerate UEs. The O-RU uses this partitioning to determine which layers belong to which UEs, which is important both because some DMRS-BF signal-processing algorithms may make use of the fact that some UE layers belong to the same physical UE, and also that some RRM measurements are "per-UE" so represent a combining of UE layer measurements. In addition, when used in the context of DMRS-BF, ueId = 0x7FFF is reserved to allow use of SE10 beamGroupType=10b to skip values in the eAxC\_ID list.

EXAMPLE: The O-RU may declare that the maximum number of bits assigned for indicating UE layers is 4. If the O-DU configures to use 4 bits for indicating UE layers, this means no UE may have more than 24 or 16 data layers, and there can be no more than 215-4-1 or 2047 UEs processed by the O-RU at a time (recalling that ueId = 0x7FFF is reserved).

The mapping of a ueId value to a UE layer and to an eAxC\_ID value shall be consistent within a slot. If the O-RU declares the capability by M-Plane feature UEID-PERSISTENCE and the capability is enabled using ueid-persistence- enabled, then the assignment of a ueId value to a UE layer, in the context of DMRS-BF, shall remain consistent until the O-DU indicates a change of UE layer associated with a ueId. In this case, the change of UE associated with a ueId is conveyed via the ueIdReset field in SE 24, or by the value of "entryType" within SE 24 (see clause 7.7.24). If the ueid-

persistence-enabled value is FALSE, then the ueIdReset bit shall be set to one by the O-DU and the O-RU shall ignore the bit.

There is an exception (exception #1) to the requirement that a single ST 5 section description using SE 10 shall contain all layers within a user group. The O-RU may declare a capability to support user group self assembly with group ID using M-Plane parameter "supported-user-group-self-assembly-modes", and if the O-DU enables the capability by setting M-Plane parameter "user-group-mode" to "SELF-ASSEMBLY-WITH-GROUP-ID", then a user group may be described using multiple ST 5 section descriptions. In this case, the "userGroupId " field within SE 24 shall uniquely identify the user group. The value of "userGroupId" is simply a tag carrying no meaning (in particular, it is not permanently associated with any specific UEs), and the same user group may carry different values of "userGroupId" from slot to slot. The use of this parameter is simply to help the O-RU assemble the identity of all section descriptions contributing to each user group when multiple section descriptions are used to describe a single user group.

There is a second exception (exception #2) to the requirement that a single ST 5 section description using SE 10 shall contain all layers within a user group. The O-RU may declare capability to support self assembly without group ID using M-Plane parameter "supported-user-group-self-assembly-modes", and if the O-DU enables the capability by setting M-Plane parameter "user-group-mode" to "SELF-ASSEMBLY-WITHOUT-GROUP-ID", then a user group may be described using multiple ST 5 section descriptions. In this case, the "userGroupId" value is not used, and the O-RU shall assemble the identity of all section descriptions contributing to each user group using PRB ranges, with no help from a user group ID.

DMRS configuration, use of Section Extension 10

Section Extension 10 shall be used to describe all the ports (UE layers) in the section description; only if the section description contains a single UE layer may SE 10 be omitted. For DMRS-BF, the O-RU shall support the use of SE 10 and shall in addition support the use of SE 10 beamGroupType = 11b. When using beamGroupType = 10b, the M- Plane-configured list of eAxC\_IDs shall be used in order; if the feature "non-scheduled-ueId-supported" is declared true by the O-RU and the flag "non-scheduled-ueId-enabled" is set to true by the O-DU, then ueId values of 0x7FFF may be used to indicate no scheduling on that particular eAxC\_ID for that section (see clause 7.9.13). When using beamGroupType = 11b, the field portListIndex allows any arrangement of eAxC\_IDs in the list and avoids the need to populate SE 10 with 0x7FFF ueId values, hence this case is more suitable when the eAxC\_ID M-Plane port-list is very long.

DMRS configuration, use of Section Extension 24

Section Extension 24 conveys the DMRS configuration for all UE layers in the user group and shall be provided for every section description using DMRS-BF. The format of the Section Extension allows a different DMRS configuration to be specified per UE layer, but also allows for optimization (reduce the number of bytes used) when multiple UE layers use the same DMRS configuration. There are fields provided to convey the full PRB range and DMRS symbol location(s) for a UE layer to aid the O-RU in creating the UE's overall DMRS sequence(s) and DMRS-based channel estimates in a slot. SE 24 also provides fields requesting the O-RU to provide DMRS SNR, which unlike other DMRS- BF-related RRM measurements is not provided automatically per slot but upon C-Plane request. See clause 7.7.24 for more information on SE 24.

* + - * 1. Other C-Plane control related to DMRS-BF

C-Plane control of DMRS-BF, overview

In addition to describing the DMRS configuration of each user group, the O-DU may also provide additional information to the O-RU to enable a complete implementation of DMRS-BF, including the desired symbol order for transmission from O-RU to O-DU (using SE 25) and frequency offset information which can be used within the O-RU processing (using SE 26), and information pertaining to O-DU controlled DMRS port reduction (using SE 27).

C-Plane control of DMRS-BF, use of Section Extension 25

Section Extension 25 conveys the symbol reordering sequence when a symbol reordering is to be done (when all endpoints in the user group are configured to use either per-window symbol reordering or per-section tx-window reassignment). If natural symbol order is to be used, this Section Extension may be omitted. When present, this SE shall be within the relevant ST 5 section description following SE 24. See clause 7.7.25 for more information on SE 25.

C-Plane control of DMRS-BF, use of Section Extension 26

In some cases, the O-DU may have frequency offset information to provide the O-RU associated with a specific UE. In such a case, Section Extension 26 may be used to convey the necessary information. See clause 7.7.26 for more information on SE 26. When present, this SE shall be within the relevant ST 5 section description following SE 24.

C-Plane control of DMRS-BF, use of Section Extension 27

In some cases, the O-DU may provide instructions how the O-RU should execute a port reduction on the DMRS data. In such a case, Section Extension 27 may be used to convey the necessary information. See clause 7.7.27 for more information on SE 27. When present, this SE shall be within the relevant ST 5 section description following SE 24.

###### U-Plane timing impacts of DMRS-BF

DMRS-BF naturally takes some time for the O-RU to execute, even beyond that needed for other beamforming methods. The two main contributors to lengthening the O-RU processing time are:

1. The O-RU waiting to receive the DMRS symbols from over-the-air before it can start the process of estimating the channel and computing weights.
2. Once having received the DMRS symbols, the O-RU computing the UE layer's channel estimate and then weights to apply to the UE layer.

UE data is transmitted from O-RU to O-DU one symbol at a time. If the symbols will be sent to the O-DU in natural order (the same as the air-interface order), then symbol #0 will be sent first, followed by symbol #1 and so on until the last symbol in the slot, symbol #13, is sent. Natural symbol order is the specified order for most beamforming methods but DMRS-BF may use natural symbol order or altered symbol ordering.

![](../assets/images/c687fd2f8e90.png)

**Figure 12.6.1.4-1: Comparison of WDBF delay profile versus DMRS-BF delay profile**

Figure 12.6.1.4-1 shows a comparison of the delay profiles that may be expected to be used for a simpler beamforming method, WDBF, versus the more complicated DMRS-BF. For WDBF, the Ta3\_min\_up is the minimum time needed for the O-RU to do all processing related to WDBF including RF processing, ADC operation, FFT, fetching of the correct beamforming weights, applying the weights to the UE data, and preparing the UE data for transmission to the O-DU. The difference between Ta3\_max\_up and Ta3\_min\_up forms a transmission window ("tx-window"), during which a specific UE data symbol will be transmitted from the O-RU to O-DU. Figure 12.6.1.4-1 shows a sequence of colored hexagons representing the sequence of symbols in each UE layer as received over-the-air, as sent from O-RU to O-DU after WDBF, and as sent from O-RU to O-DU after DMRS-BF.

For WDBF, the first symbol's tx-window, being the difference between the shown Ta3\_max\_up and Ta3\_min\_up, comes pretty early, because the O-RU's processing is not very complex. In contrast, for DMRS-BF, transmission of the first symbol from O-RU to O-DU is quite late, because the O-RU needs to wait to receive all the DMRS symbols (shown in dark outlined hexagons) and then do the DMRS processing.

It is possible for all beamforming methods to use the same delay profile, but there is expected to be a performance degradation if UE layers that could be sent from O-RU to O-DU earlier are delayed to wait for the longer DMRS-BF operation. Therefore, when an O-RU supports and activates DMRS-BF, the O-RU should ensure one or more endpoints specifically support a delay profile at a lower latency relative to DMRS-BF, which may be used for PUCCH.

For other beamforming methods, the timing of a packet transmission from the O-RU and intended reception by an O- DU is indicated in the U-Plane by the symbolId field value: the value from 0 to 13 directly indicates the tx-window number or rx-window number, as well as also indicating the over-the-air symbol number. When reordering the symbols (see clause 12.6.1.5), the window number no longer is identical to the symbol number. Therefore, when reordering the symbols, the O-RU indicates via an M-Plane capability report (see clause 7.7.25.1) whether the U-Plane symbolId will convey window number or symbol number.

When symbol number is declared, the U-Plane symbolId carries the identity of the reassigned over-the-air symbol number, not the rx-window number, so cannot be directly used by the O-DU to assess whether the packet arrived within the correct rx-window. Instead, the U-Plane symbolId (received by the O-DU) needs to be translated into the proper rx- window number, using the known symbol reordering pattern, before the packet can be assessed as being within the proper rx-window.

###### U-Plane symbol reordering related to DMRS-BF

* + - * 1. Per-window symbol reordering

Of the two possible symbol reordering methods associated with DMRS-BF, the first is "per-window symbol reordering". The purpose of per-window symbol reordering is to provide UE layer symbols to the O-DU with the DMRS symbols early in the sequence, which allows the O-DU to start its DMRS processing early. Therefore, this symbol reordering method is meant to be used when port-reduced DMRS symbols are sent from O-RU to O-DU, otherwise natural symbol order is expected. However, per-window symbol reordering can, in some cases, also be used to reduce overall UE data latency when not sending DMRS symbols from O-RU to O-DU. Therefore, the O-RU may declare the capability to support per-window symbol reordering without DMRS data sending, in which case the O-DU may issue a SE 25 reordering command even when not having configured the O-RU to send DMRS symbols.

Because all DMRS-BF endpoints will use the same reordering pattern, and because different DMRS configurations locate the DMRS symbols in different time-locations, the DMRS symbols may not be strictly preceding the non-DMRS symbols - but it is intended they be earlier than if no symbol reordering was done.

![](../assets/images/177421b3db1b.png)

**Figure 12.6.1.5.1-1: Per-window symbol reordering example diagram**

Figure 12.6.1.5.1-1 shows how per-window symbol reordering works. Shown are three different UE layers, one destined to be WDBF-processed (e.g. PUCCH) and two that are meant to be DMRS-BF-processed, with the two having a different DMRS configurations (2+2 and 1+1). The WDBF stream is processed with a delay profile allowing a short latency, while the DMRS-BF UE layers have a longer latency to accommodate waiting for the DMRS symbols then

doing the DMRS processing. Both DMRS-processed UE layers are reordered in the same manner, with tx-window #0 carrying the payload of (DMRS) symbol #2, tx-window #1 carrying the payload of symbol #3, and so on as indicated by the colors in the Figure. For DMRS-BF UE layer #1, the first four symbols sent to the O-DU are DMRS symbols (have the dark black outline), while for DMRS-BF UE layer #2, two of the first four symbols sent to the O-DU are DMRS symbols, but not the other two. This is because all UE layers undergoing DMRS-BF need to use the same symbol reordering pattern, and it is not possible to optimize for all cases. Even so, the symbol reordering has produced a "nearly-optimal" symbol order that allows the O-DU to start DMRS processing much earlier than if it had to wait for symbol #11.

Section Extension 25 conveys the symbol reordering pattern for each symbol, and shall be identical for all UE layers in the slot that are undergoing DMRS-BF. See clause 7.7.25 for the specific formatting of SE 25.

* + - * 1. Per-section tx-window reassignment

Of the two possible symbol reordering methods associated with DMRS-BF, the second is "per-section tx-window reassignment". The purpose of per-section tx-window reassignment is two-fold: (1) like per-window symbol reordering, the purpose is to provide DMRS symbols to the O-DU for processing earlier than if they arrived in natural symbol order, and (2) to reassign tx-windows to allow higher-priority UE layers to be sent earlier, and in the case of less than 100% PRB utilization, to send PRB ranges earlier than they would otherwise have been sent. In other words, data is packed into the earlier partially-empty tx-symbol windows to minimize overall latency, leaving later symbol tx- windows empty, rather than having partially-empty (unused PRB ranges) in each tx-window.

![](../assets/images/600ca7a287ba.png)

**Figure 12.6.1.5.2-1: Per-section tx-window reassignment example diagram**

Two cases are shown in Figure 12.6.1.5.2-1: "A" shows full PRB utilization with a prioritization of DMRS-BF #1 data over DMRS-BF #2 data. DMRS-BF #1 data fully populates the first seven symbol tx-windows, and DMRS-BF #2 data fully populates the second seven symbol tx-windows. "B" shows less than full PRB utilization, with the first seven symbol tx-windows fully-populated and later seven symbol tx-windows unpopulated. In this way overall system latency may be reduced. The O-DU shall take necessary steps to assure that no more than the expected number of PRBs is transmitted in any tx-window to avoid overflowing the fronthaul interface capacity.

Section Extension 25 conveys the symbol reordering pattern for each symbol, and may be different for the UE layers in the slot that are undergoing DMRS-BF. See clause 7.7.25 for the specific formatting of SE 25.

###### RRM Measurements

A variety of RRM measurements are associated with DMRS-BF. Many are mandatory for DMRS-BF-EQ, and whether mandatory or optional, their transfer is explicitly enabled via M-Plane configuration. Some are sent every slot, implicitly requested by the sending of SE 24, while others (typically those involving large data sets such as unallocated IpN and DMRS-SNR) are explicitly requested via C-Plane (see clause 9.2.1). For O-RUs supporting DMRS-BF-NEQ, the UE-TAE and Frequency Offset RRM measurements are conditional mandatory, with the condition being that the O- RU might alter a UE layer's time offset or frequency offset due to its beamforming operation, in which case the O-RU shall reflect that as part of its capability declaration that those aspects are unaltered by O-RU processing. Otherwise, for O-RUs supporting DMRS-BF-NEQ, all DMRS-BF related RRM measurements are optional, but may be provided by

O-RUs having declared that capability.

The conveyance of RRM measurements from O-RU to O-DU is via C-Plane messages, on a slot by slot basis, for every slot using DMRS-BF for which RRM measurements are to be conveyed. Section Type 10 carries the RRM measurements, and is designed in a modular fashion to allow more RRM measurements to be added in future. See clause 7.4.12 for the format of Section Type 10, and see clause 4.4.3 for the timing of Section Type 10 O-RU to O-DU C-Plane messages.

Unallocated IPN is a special RRM measurement because it is not truly related to DMRS-BF. It does not require information about DMRS and is requested by a measurement command in Section Type 11, optionally including e.g. SE 6 or SE 12 to describe discontinuous PRB ranges. See clause 9.2.2.5 for more details.

###### SINR reporting

To support DMRS-BF-EQ without further equalization in the O-DU, the O-DU shall configure, via the M-Plane, SINR data to be conveyed from O-RU to O-DU carried by the C-Plane Section Type 9 using selected uplink symbol tx- windows from the set used by the user plane data. See clause 12.6.3.4 for the specific SINR calculation.

SINR data shall be conveyed according to:

1. the frequency-resolution configured via M-Plane or optionally via SE 28 (see clause 7.4.11 and clause 7.7.28) and,
2. the time resolution configured via M-Plane or determined by the O-RU and indicated in each ST 9 message if O-RU controlled time resolution for SINR reporting is supported by the O-RU and enabled by the O-DU (see clause 7.2.11 and clause 7.4.11).

SINR data may be compressed. The format of Section Type 9 used to convey SINR data is described in clause 7.4.11. The timing of the conveyance of Section Type 9 from O-RU to O-DU is described in clause 4.4.3.

#### DMRS-BF-NEQ description

###### DMRS-BF-NEQ introduction

DMRS based beamforming without equalization (DMRS-BF-NEQ) is a beamforming method wherein the O-RU computes UE channel estimates based on the received UE UL DMRS symbols, then computes beamforming weights based on those channel estimates which do not include an equalization function, and applies the weights to the UE UL data. It is one of the two types of DMRS-BF: the other is **DMRS-BF-EQ** where the weights do include an equalization function. Figure 12.6.2.1 shows a block diagram of DMRS-BF-NEQ.

![](../assets/images/ff1abcd79507.png)

NOTE 1: The above figure illustrates some of the high-level functionalities inside the O-RU and O-DU, and does not bind the internal design of either of the O-RU and O-DU.

NOTE 2: RRM measurements are potentially derived from several sources representing specified reference point(s)

**Figure 12.6.2.1-1: DMRS-BF-NEQ (one of two types of DMRS-BF)**

As indicated in Figure 12.6.2.1-1, the O-RU shall carry out functions equivalent to DMRS symbol extraction, DMRS channel estimation, beamforming weight calculation, and then application of weights to the PUSCH user data, including the DMRS symbols themselves. All the port-reduced (beamformed) user data, including port-reduced DMRS symbols, are transferred to the O-DU whereupon the port-reduced DMRS symbols are extracted and used in the O-DU to compute channel estimates and equalization weights, which are then applied to the user data (similar to other beamforming methods).

###### DMRS-BF-NEQ specific signal processing aspects

As indicated in Figure 12.6.2.1-1, the following operations shall be executed on the O-RU:

* **DMRS Extraction**: here the DMRS REs shall be extracted from the frequency-domain data flows from each receive antenna. While the most straightforward method would simply extract every relevant RE in every DMRS symbol for every antenna element, it is not excluded that an O-RU implementation may optimize this step in some manner. In addition, the O-DU may enable an O-DU-controlled DMRS port reduction using beamIds conveyed using SE 27.
* **DMRS Channel Estimation**: here the DMRS data shall be processed to calculate an estimate of the effective RF channel between each UE and each O-RU's receive antenna. No specific algorithm is specified.
* **Beamforming Weight Calculation**: here DMRS-based channel estimates shall be used to calculate weights, used to reduce the data dimensionality from number of O-RU antennas to number of UE data layers. This operation is done as a port reduction without equalization on the PUSCH data symbols and on the DMRS symbols in the same way; the port-reduced DMRS symbols will be requested by the O-DU in the same ST 5 plus SE 24 C-Plane messages as used for requesting PUSCH data. To allow estimation of beamformed UE signal power by the O-DU, the weights calculated by the O-RU shall have a vector magnitude (L2 norm) of unity.

NOTE: L2 norm equation is ??n|wn|2 = 1 where *wn* are weights.

###### DMRS-BF-NEQ specific operational aspects

DMRS-BF is expected to increase the O-RU's processing complexity relative to other beamforming methods; new functions such as DMRS channel estimation and weight calculation are added. A contributor to O-RU processing complexity is the resolution (per-RB or sub-RB) of the frequency-domain processing, specifically channel estimation and weight calculation. Because the O-DU DMRS channel estimation and equalization is performed on sub-RB resolution, the DMRS-BF-NEQ weights may be computed and applied (as in WDBF) at a relatively coarse (e.g. per- RB) resolution, which can reduce O-RU complexity for O-RUs using DMRS-BF-NEQ, but with a potential impact on UL air interface performance.

As part of the DMRS-BF-NEQ operation RRM measurements may be provided from the O-RU to the O-DU. The O- RU shall declare supported RRM measurements which can then be configured by the O-DU via M-Plane. If the DMRS- BF-NEQ operation could change the timing of the received UE signal (as referenced at the O-RU's antenna reference point) then the O-RU shall be capable of providing the UE Timing Advance Error RRM measurement value. Likewise, if the DMRS-BF-NEQ operation could change the frequency offset of the received UE signal (as referenced at the O- RU's antenna reference point) then the O-RU shall be capable of providing the UE Frequency Offset RRM measurement value. See clause 9.2 for a full description of the RRM measurements associated with DMRS-BF.

Because with DMRS-BF-NEQ it is expected the O-DU will perform a DMRS-based channel estimation, and because the O-RU will already have collected many if not all data symbols in a slot while waiting for DMRS-containing symbols, it will be generally true that after the DMRS-BF-NEQ operation is completed a full slot's worth of data can be ready for transmission to the O-DU. The U-Plane timing shall remain symbol-based, as it is for other beamforming methods, but the O-RU may be configured to rearrange the order of symbols to allow DMRS symbols to be sent early, allowing the O-DU to start its DMRS-based channel estimation processing early. See clause 12.6.1.5 for a description of the types of symbol reordering that are available to be supported and used.

#### DMRS-BF-EQ description

###### DMRS-BF-EQ introduction

DMRS based beamforming with equalization (DMRS-BF-EQ) is a beamforming method wherein as one possible implementation the O-RU computes UE channel estimates based on the received PUSCH DMRS symbols, then computes weights for beamforming with equalization based on those channel estimates and applies the weights to the PUSCH data, see Figures 12.6.3.1-1 and 12.6.3.1-2.

In Clause 12.6.3, port-reduction refers to the operation that applies weights for beamforming with equalization to user data (PUSCH and/or DMRS). Similarly, port-reduced refers to the output of such an operation.

![](../assets/images/9afc09693f5c.png)

NOTE 1: Advanced features possible, including non-DMRS-based advanced receivers and non-DMRS-based CoMP receivers.

NOTE 2: The above figure illustrates some of the high-level functionalities inside the O-RU and O-DU, and do not bind the internal design of each of the O-RU and O-DU.

**Figure 12.6.3.1-1: O-RU supporting DMRS-BF-EQ, excluding port-reduced DMRS; O-DU illustrated without using PUSCH equalizer**

![](../assets/images/355dbcd4fa65.png)

NOTE 1: Advanced features includes DMRS-based advanced receivers and DMRS-based CoMP receivers.

NOTE 2: The above figure illustrates some of the high-level functionalities inside the O-RU and O-DU, and do not bind the internal design of each of the O-RU and O-DU.

**Figure 12.6.3.1-2: O-RU supporting DMRS-BF-EQ, including port-reduced DMRS; O-DU illustrated with equalizer and advanced receiver**

The two Figures 12.6.3.1-1 and 12.6.3.1-2 show the two different usages of an O-RU supporting DMRS-BF-EQ. The first figure shows that case where SINR reports are requested by the O-DU, but port-reduced DMRS are not requested. This case supports non-DMRS-based O-DU algorithms. The second figure shows that case where port-reduced DMRS are requested by the O-DU, but SINR reports are not requested. This case supports DMRS-based O-DU algorithms. An O-RU supporting DMRS-BF-EQ shall support sending port-reduced DMRS data and SINR data to O-DU. It is an optional O-RU capability to support simultaneous provision of port-reduced DMRS data and SINR data.

As shown in Figure 12.6.3.1-1, the O-RU is expected to carry out DMRS symbol extraction, DMRS channel estimation, a calculation of weights for beamforming with equalization and then apply the weights to the user data, excluding DMRS symbols. In addition, the post-equalization SINR data is calculated by the O-RU. Then, the O-RU transfers the equalized PUSCH data and the SINR data to the O-DU. The O-DU performs demodulation and decoding using the equalized PUSCH data and SINR data as input. See clause 12.6.3.5 for specific requirements for processing PUSCH data.

In addition to the O-DU illustrated in Figure 12.6.3.1-1, other O-DU implementations not using port-reduced DMRS are also supported, such as non-DMRS-based advanced receivers and non-DMRS-based CoMP receivers.

Because the O-DU may require certain RRM measurements defined on signals before port-reduction (beamforming and equalization) and/or defined on DMRS channel estimates, both of which are not in general available in the O-DU, it is mandatory for the O-RU using DMRS-BF-EQ to have the capability to perform certain RRM measurements and convey those to the O-DU, see Table 10.2-1.

As shown in Figure 12.6.3.1-2, if the O-RU is configured to convey port-reduced DMRS to the O-DU (O-RU supporting DMRS-BF-EQ shall have the capability of sending port-reduced DMRS symbols), calculation of weights for beamforming with equalization is done for DMRS symbols in addition to PUSCH data. In this case, these port-reduced DMRS symbols (including equalization) are transferred to the O-DU where they can be used by DMRS-based receiver algorithms, e.g. a DMRS-based advanced receiver (a more complex receiver such as a SIC receiver) is implemented in the O-DU. The O-DU performs equalization or advanced DMRS-based features, which may include DMRS extraction, DMRS channel estimation, equalization and combining weight calculation and weight application. Finally, the O-DU will perform demodulation and decoding.

In addition to the O-DU illustrated in Figure 12.6.3.1-2, other O-DU implementations using port-reduced DMRS are also supported, such a DMRS-based CoMP receivers.

For the case with non-DMRS-based algorithms in O-DU, because the O-RU executes DMRS channel estimation and beamforming including equalization, with some impact on O-RU complexity, the O-DU DMRS channel estimation and equalization can be omitted (when not employing equalizers or DMRS-based advanced receivers) and only be performed once in the system, e.g. in a gNB for 5G NR , and the PUSCH processing can be optimized to achieve low PUSCH latency (similar to WDBF). When equalization is not performed in the O-DU, the O-DU only includes

demodulation and decoding L1 functions, which are not performance differentiators, in comparison with the performance of L1 functions such as DMRS channel estimation and beamforming including equalization which are performed in the O-RU and can vary significantly between different implementations.

For the case with DMRS-based algorithms in O-DU, the port-reduced DMRS provides a possibility to share DMRS channel estimation and equalization implementations between DMRS-BF-EQ and DMRS-BF-NEQ in the O-DU. Sending port-reduced DMRS enables O-DU implementations with DMRS channel estimation and equalization to interwork with both, O-RUs supporting DMRS-BF-EQ and O-RUs supporting DMRS-BF-NEQ. However, there are differences in areas such as O-RU configurations and RRM measurements tied to the two beamforming methods that needs to be catered to by the O-DU.

For both the case with non-DMRS-based and the case with DMRS-based algorithms in O-DU, the O-RU's equalized PUSCH IQ data and SINR data are mathematically defined in Clauses 12.6.3.4 and 12.6.3.5, which supports stand- alone testing.

###### DMRS-BF-EQ specific signal processing aspects

* **DMRS Extraction:** here the DMRS REs may be extracted from the frequency-domain data flows from each receive antenna. While the most straightforward method would simply extract every relevant RE in every DMRS symbol for every antenna element, it is not excluded that an O-RU implementation may optimize this step in some manner. In addition, the O-DU may enable an O-DU-controlled DMRS port reduction using beamIds conveyed using SE 27.
* **DMRS Channel Estimation:** in one possible implementation of the O-RU, the DMRS data may be processed to calculate an estimate of the effective RF channels between each UE antenna port and each O-RU's receive antenna. No specific algorithm is specified.
* **Beamforming with Equalization Weight Calculation**: For DMRS-BF-EQ, DMRS-based channel estimates may be used to calculate weights for beamforming with equalization, used to reduce the data dimensionality from number-of-antennas to number of UE data layers. This operation is done as a port-reduction (including equalization) of the PUSCH data. Equalization is performed to support non-DMRS-based O-DU algorithms. If configured, e.g. when equalizer is enabled in O-DU or if an advanced receiver is implemented in the O-DU, the DMRS symbols are beamformed and equalized in the same way as PUSCH data, and the port-reduced DMRS symbols are sent to the O-DU. If configured the O-RU will provide SINR measurements for each UE- layer, which may be used in the O-DU demodulator for log-likelihood ratio (LLR) calculation. The equalized PUSCH data signal can then be processed by the O-DU demodulator.

###### DMRS-BF-EQ specific operational aspects

As part of the DMRS-BF-EQ operation, the O-RU shall report RRM measurements if requested by the O-DU. The O- RU shall declare which RRM measurements it supports, including mandatory RRM measurements, and the O-DU shall configure via M-Plane which RRM measurements it wants delivered, if any. See clause 9.2 for a full description of the RRM measurements associated with DMRS-BF.

As part of the DMRS-BF-EQ operation, the O-RU shall report SINR measurements if requested by the O-DU. The O- RU shall declare which SINR resolutions it supports. The O-DU shall configure the SINR frequency resolution to be used by the O-RU via M-Plane or optionally via SE 28. If O-RU controlled time resolution for SINR reporting is not supported or enabled, then the O-DU shall configure the O-RU via M-Plane which SINR time resolution it wants delivered. If O-RU controlled time resolution for SINR reporting is supported by the O-RU and enabled by the O-DU, the O-DU shall configure a list of time resolutions (via M-Plane parameter **sinr-slot-masks**) that the O-RU can dynamically use. The O-RU will determine and use one of the time resolutions in the configured list for each SINR report. The used time resolution is indicated in each ST 9 message. The configured list of time resolutions if used shall follow the O-RU's capability reported via M-Plane per RX endpoint type in a list **supported-sinr-resolutions**. Any sinr-slot-mask value in the configured list shall be one of the values listed in the list **supported-sinr-resolutions**.

As described earlier, when O-RU controlled time resolution for SINR reporting is not used, the O-RU will send SINR reports for all UEs using one fixed time resolution configured via M-Plane by the O-DU. If O-RU controlled time

resolution for SINR reporting is used, the O-RU may send SINR reports for different UEs using different time resolutions. As a use case example, this feature enables an O-RU that is optimized for both high-mobility and low- mobility UEs to use higher SINR time resolution for high-mobility UEs and lower SINR time resolution for low- mobility UEs. In this example, the O-RU can use the DMRS channel estimation to estimate the UE mobility and thus determine the SINR time resolution to use.

See clause 7.2.11 and clause 7.4.11 for more details of SINR reporting associated with DMRS-BF-EQ.

###### SINR data

To support DMRS-BF-EQ without PUSCH equalizer in the O-DU, it shall be possible for the O-DU to configure the O-RU to convey SINR data for each UE-layer from the O-RU to the O-DU using an O-RU to O-DU C-Plane flow carried by Section Type 9. The SINR data may be used for log-likelihood ratio (LLR) calculation in the O-DU.

Signal-to-Interference-plus-Noise Ratio (*SINR*) is the post-equalization SINR defined as the power of signal of interest

(*S*) divided by the sum of the interference power (*I*) (the inter-cell and SU/MU mutual interferences) plus the power of background noise (*N*).

SINR =

S

I + N

EXAMPLE 1: In the case of MMSE-IRC equalization, the SINR for the i-th layer may be calculated as:

1

SINRMMSE-IRC,i = - 1

1 - G

MMSE-IRC,i

where scalar *GMMSE-IRC,i* is the i-th element in the vector *GMMSE-IRC*, which can be calculated as:

WMMSE-IRC = (I + HHQ-1H)-1HHQ-1

GMMSE-IRC = diag[WMMSE-IRC H]

where the matrix *H* is the channel estimate of size #antennas by #layers and the matrix *Q* is the interference + noise covariance matrix of size #antennas by #antennas. The #antennas refers to the number of O-RU receive antennas and the #layers refers to the number of layers over all users in a MU-MIMO user group. The operator *diag*[X] returns a vector consisting of all diagonal elements of the square matrix X.

NOTE: Due to an optional DMRS port reduction operation, #antennas may be smaller than the actual number of array elements in the O-RU.

SINR data shall be conveyed according to the frequency resolution configured via M-Plane or optionally via SE 28. SINR data shall be conveyed according to the time resolution configured via M-Plane or determined by the O-RU and indicated in each ST 9 message if O-RU controlled time resolution for SINR reporting is supported by the O-RU and enabled by the O-DU. The SINR time and frequency resolution may be different from the resolution for the weight calculation for beamforming with equalization. The O-DU can assume that the SINR data can be used for the specific time-frequency tile that the SINR data report corresponds to.

EXAMPLE 2: In the case with one SINR data report for the whole time slot and PRB, the SINR may be calculated using an average of SINR estimates obtained from DMRS allocated to the UE.

SINR data may be compressed. The format of Section Type 9 used to convey SINR data is described in clause 7.4.11. The timing of the conveyance of Section Type 9 from O-RU to O-DU is described in clause 4.4.3 and clause 7.2.11.

###### Equalized PUSCH IQ-data

As part of the DMRS-BF-EQ operation, the O-RU shall provide equalized PUSCH IQ-data IEQ + jQEQ for the *i*-th layer

i i

of the U-Plane. The equalized PUSCH IQ-data for the i-th layer shall be a variable *Xi* multiplied with the scalar *Gi* plus an unknown error term ?i. The variable *X* shall be:

* the output of the modulation mapper defined in 3GPP TR 38.211 [4] clause 5.1 in case of CP-OFDM,
* the output of the transform precoder defined in 3GPP TR 38.211 [4] clause 6.3.1.4 in case of DFT-s-OFDM (meaning the iDFT operation is carried out in the O-DU).

IEQ + jQEQ = Xi x Gi + ?i

i i

Scalar *Gi* shall either be a function of the i-th UE-layer SINR or unity. Since *SINRi* is supplied to the O-DU as the SINR data, the O-DU can compute the scaling *Gi*.

There are two different functions defined: Scaling function 1:

SINRi

Gi = 1 + SINR

i

With this function, the output from a MMSE-IRC equalizer may be used as equalized PUSCH IQ-data without applying any scaling. Other equalizers may also use this function, but the O-RU is in this case expected to apply a suitable scaling to the output of the equalization function.

Scaling function 2:

Gi = 1

With this function, the output from an equalization operation which for CP-OFDM outputs the constellation points without any bias may be used as equalized PUSCH IQ-data without applying any scaling. Other equalizers may also use this function, but the O-RU is in this case expected to apply a suitable scaling to the output of the equalization function.

O-RU supporting DMRS-BF-EQ shall declare which one of these scaling functions that is being used with the M-Plane parameter equalization-data-scaling. O-DU supporting DMRS-BF-EQ shall support both Scaling function 1 and Scaling function 2.

Further, unlike other beamforming methods, the notion of an O-RU configured gain is not applicable for DMRS-BF-EQ and instead the IQ output level is described in clause 8.1.3.4.

When port-reduced DMRS is provided, the requirements on equalized PUSCH IQ-data shall also be applicable to the equalized port-reduced DMRS IQ-data.

NOTE: Equalization puts requirements on both the amplitude and phase of the equalized PUSCH data, which in particular means that the O-RU is expected to perform frequency offset compensation.

# Shared Cell

## General

"Shared Cell" is defined as the operation for the same cell (the cell can have one or multiple component carrier(s)) by several O-RUs.

There are two approaches for realizing Shared Cell as shown in Figure 13.1-1.

* **FHM mode:** Shared Cell is realized by FHM and several O-RUs. In this case, FHM is placed between the O- DU and multiple O-RUs. FHM is modelled as an O-RU with LLS Fronthaul support (same as normal O-RU) and copy and combine function (additional to normal O-RU), but without radio transmission/reception capability. For the copy and combine function, FHM may support selective transmission and reception function. In the present document, each O-RU under one FHM can be used for either operating the same cell (same cell scenario in Figure 13.1-1) or different cells (multiple cells scenario in Figure 13.1-1) by M-Plane configuration.
* **Cascade mode:** Shared Cell is realized by several O-RUs cascaded in chain. In this case, one or more O- RU(s) are inserted between the O-DU and the O-RU. The O-RUs in the cascaded chain except for the last O- RU shall support Copy and Combine function. The O-RUs which support the Copy and Combine function are named "Cascade O-RU". Note that the last O-RU may also support Copy and Combine function although it is not used (i.e. not only normal O-RU but also Cascade O-RU may work as the last O-RU). In the present document, each Shared Cell O-RU in a physical chain can be used for either operating the same cell or different cells by M-Plane configuration; each cell is served by its own (logical) cascade chain.

![](../assets/images/5d1f5b438111.png)

**Figure 13.1-1: Shared Cell Concept**

For the Cascade mode, the following generic reference to nodes in a cascaded chain is used.

* **north-node**: For a particular O-RU in the chain of cascaded O-RUs, the north-node is the adjacent O-RU which is located closer to the O-DU. In the case of the O-RU which is adjacent to the O-DU, the north-node is the O-DU.
* **south-node**: For the O-DU or a particular O-RU in the chain of cascaded O-RUs, the south-node is the adjacent O-RU which is located farther from the O-DU.

NOTE: For the FHM mode, the nodes are directly referred to as O-DU, FHM or O-RU, and the above terminologies are not used in the present document. The terminologies: north-node and south-node are also used for FHM in the M-Plane specification to maximize commonality for M-Plane modelling.

In this clause, the following notations are used:

***N***: the total number of O-RUs connected to a FHM for FHM mode, or the total number of O-RUs in a cascaded chain (including the last O-RU) for Cascade mode.

***M***: the total number of different cells realized by the total of *N* O-RUs connected to a FHM for FHM mode, or the total number of different cells realized by the total *N* O-RUs in a cascaded chain for Cascade mode. *M* equals 1 for same cell scenario for FHM mode and same cell scenario for Cascade mode. *M* < *N*.

***Nm***: the total number of O-RUs realizing a particular cell *m*. *Nm* equals *N* (and *m*=1) for same cell scenario for FHM mode and same cell scenario for Cascade mode. *M* is equal to *N* scenario in Cascade mode can be realized with Ethernet Forwarding and Boundary Clock capability without any Shared Cell specific configurations or capability.

***n***: used to denote a particular O-RU within a set of O-RUs realizing a particular cell.

## Copy and Combine function

#### DL Copy function

In downlink case, FHM shall retrieve eCPRI messages coming from O-DU as payload of Ethernet frames, copy them (the entire eCPRI message including eCPRI header and eCPRI payload) without any modifications as payload into Ethernet frames and send them towards the O-RUs realizing the Shared Cell. FHM determines these O-RUs from M- Plane configuration. Figure 13.2.1-1 illustrates the same cell scenario where copy is done for O-RU#1 to O-RU#*N*. For the Multiple cells scenario, for a particular cell *m*, copy will be for O-RU#1 to O-RU#*Nm*.

In downlink case, Cascade O-RU shall retrieve eCPRI messages coming from the north-node as payload of Ethernet frames, copy them (the entire eCPRI message including eCPRI header and eCPRI payload) without any modifications as payload into Ethernet frames and send them towards the south-node.

DL Copy function is shown in Figure 13.2.1-1.

![](../assets/images/617d8301f7ce.png)

**Figure 13.2.1-1: Downlink flow for Shared Cell**

#### UL Combine function

FHM shall combine IQ data corresponding to the same radio resource element from the multiple eCPRI messages for UL U-Plane in the Ethernet frames transmitted from each O-RU, where the general principles are listed below;

* The FHM shall identify IQ data corresponding to the same radio resource element from the information elements in eCPRI transport header, application layer common header and application layer section field which are listed in Table 13.2.2-1**.**In case that transport layer fragmentation occurs, the FHM shall re- assemble the fragmented message first.
* The FHM shall retrieve compression information (if present), iSample and qSample from those corresponding eCPRI messages and calculate the combined iSample and qSample by adding iSample and qSample individually, taking compression information into account as below:

If U-Plane data compression is used then:

Combined iSample = *Compress* (*Sum* (*Decompress* (*iSample*\_#1), ... , *Decompress* (*iSample\_*#*N****m***) ) ), Combined qSample = *Compress* (*Sum* (*Decompress* (*qSample*\_#1), ... , *Decompress* (*qSample\_*#*N****m***) ) ),

Else

Combined iSample = *Sum* (*iSample*\_#1, ... , *iSample*\_#*N****m***), Combined qSample = *Sum* (*qSample*\_#1, ... , *qSample*\_#*N****m***),

where

*iSample*\_#n is the iSample received from the O-RU#n and

*qSample*\_#n is the qSample received from the O-RU#n.

* If overflow occurs from the combine operation, iSample and/or qSample should be clamped to the closest value that can be represented in the compression format used for the combined IQ data.
* The compression format for the combined IQ data shall be the same as that in the IQ data received from the O-RUs.
* In the present document, selective combining of UL signals is not supported.

After combining, the FHM shall generate eCPRI header (the ecpriSeqid field generated by the FHM is independent and not a copy of that received from O-RUs; other fields are just copies of those received from the O-RUs.), add combined IQ data as eCPRI message body, construct Ethernet frames carrying eCPRI messages as payload, and forward them to the O-DU.

Cascade O-RU shall combine IQ data corresponding to the same radio resource element from air and from the eCPRI messages for UL U-Plane in the Ethernet frames transmitted from the south-node, where the general principles are listed below:

* The Cascade O-RU shall identify IQ data corresponding to the same radio resource element from the information elements in eCPRI transport header, application layer common header and application layer section field which are listed in Table 13.2.2-1. In case that transport layer fragmentation occurs, the Cascade O-RU shall re-assemble the fragmented message first.
* The Cascade O-RU shall retrieve compression information (if present), iSample and qSample from those corresponding eCPRI messages and calculate the combined iSample and qSample by adding iSample and qSample individually, taking compression information into account as below:

If U-Plane data compression is used then:

Combined iSample = *Compress* (*Sum* (*Decompress* (*iSample\_from\_south-node*) and (*iSample\_from air*))),

Combined qSample = *Compress* (*Sum* (*Decompress* (*qSample\_from\_south-node*) and

*qSample\_from air*)).

Else

where

Combined iSample = *Sum* (*iSample\_from\_south-node* and *iSample\_from air*), Combined qSample = *Sum* (*qSample\_from\_south-node* and *qSample\_from air*).

*iSample*\_ *from\_south-node* is the iSample received from the south-node, *qSample*\_ *from\_south-node* is the qSample received from the south-node, *iSample*\_ *from\_air* is the iSample received from the air, and

*qSample*\_ *from\_air* is the qSample received from the air.

* If overflow occurs from the combine operation, iSample and/or qSample should be clamped to the closest value that can be represented in the compression format used for the combined IQ data.
* The compression format for the combined IQ data shall be the same as that in the IQ data received from the south-node.
* In the present document, selective combining of UL signals is not supported.

After combining, the Cascade O-RU shall generate eCPRI header (the ecpriSeqid field generated by the Cascade O-RU is independent and not a copy of that received from the south-node; other fields are just copies of those received from the south-node.), add combined IQ data as eCPRI message body, construct Ethernet frames carrying eCPRI messages as payload, and forward them to the north-node.

Figure 13.2.2-1 illustrates the same cell scenario where combine operation is done for O-RU#1 to O-RU#*N*. For the Multiple cells scenario, for a particular cell *m*, combine operation is done for O-RU#1 to O-RU#*Nm*.

![](../assets/images/939df6a34e3e.png)

**Figure 13.2.2-1: Uplink flow for Shared cell**

**Table 13.2.2-1: information elements to be checked when FHM/Cascade O-RU combines UL U-Plane messages**

|  |  |
| --- | --- |
| **Field** | **Information element** |
| eCPRI transport header | ecpriPcid |
| Application layer common header | dataDirection, frameId, subframeId, slotId, symbolid |
| Application layer section field | rb, symInc, startPrbu, numPrbu |

## Selective transmission and reception using beamId

#### Introduction

In order to avoid unnecessary interference and noise enhancement, selective transmission and reception function can be useful and it can be realized with minimum implementation impact on both O-DU/O-RU by using beamId.

For the selective transmission and reception function using beamId:

* Predefined-beam beamforming is assumed.
* Applicability for Cascade mode (cascaded O-RUs or cascaded FHMs) is out of scope in the present document.
* Use of the multiple beamId tables feature together with selective transmission is not permitted.

The concept is to utilize the multiple O-RUs involved in a Shared Cell collectively as a single beamforming O-RU, and to realize selective transmission and reception using beamforming operations.

* In normal beamforming operation, a unique SSB and/or CSI-RS are transmitted from each beam so that the O- DU scheduler can understand which beam should be used based on L1-RSRP reports from the UE; where each is further mapped to a unique beamId that the O-DU signals on the fronthaul.
* For Shared Cell with selective transmission and reception using beamId:
  + In the simplest form, all O-RUs involved can be non-beamforming O-RUs, and each of them can be regarded as separate beam of one collective beamforming O-RU. In this case, a unique SSB and/or CSI- RS are transmitted from each non-beamforming O-RU; where each shall be further mapped to a unique beamId that the O-DU signals on the fronthaul. Then the FHM, based on the beamId signalled from the O-DU, shall route the messages to the appropriate non-beamforming O-RU. At this time, the FHM also shall translate the beamId so that the O-RU can transmit/receive using the appropriate beam. This assumes each O-RU handles unique user data meaning the FHM is not executing any copy/combining operation.
  + Other forms can be considered. For example:
    - All O-RUs involved can still be non-beamforming O-RUs, but multiple O-RUs illuminating overlapping/neighbouring areas can be made to transmit a common SSB/CSI-RS (and common user data) and be regarded as a common beam from the O-DU perspective. The FHM, based on the beamId signalled from the O-DU which corresponds to the common beam, shall route the messages to the appropriate set of multiple O-RUs and shall execute a copy/combining operation for this data.
    - Multiple beamforming O-RUs can collectively be considered as a single beamforming O-RU. Each beam of the individual O-RUs may be regarded as a separate beam, or multiple beams illuminating overlapping/neighbouring areas can be made to transmit a common SSB/CSI-RS (and common user data) and be regarded as a common beam from the O-DU perspective. The FHM, based on the beamId signalled from the O-DU, shall route the messages to the appropriate beamforming O-RU and shall execute a copy/combining operation for this data, and also translate the beamId value so that the O-RU can transmit/receive using appropriate beams.

NOTE: For the O-RU beams illuminating overlapping/neighbouring areas that are made to transmit a common SSB/CSI-RS and are regarded as a common beam from the O-DU perspective, coherency between the beams is not required.

From here on, the beamId used by the O-DU and signalled from the O-DU to FHM is referred to as the global beamId; and the beamId signalled from the FHM to O-RU and used by the O-RU is referred to as the local beamId.

Related M-Plane aspects are described below:

* If O-DU receives the capability from FHM via M-Plane which indicates selective transmission and reception support, O-DU can configure the FHM to use selective transmission and reception function.
* The mapping information between each global beamId, O-RU(s) and their local beamId is configured to the FHM during the M-Plane start-up procedure.
* The inter-beam relationship information such as coarse-fine-beam-relation and neighbour-beams are reported from each O-RU via M-Plane. Therefore, although O-DU considers the set of O-RUs as one beamforming

O-RU, coarse-fine-beam-relation and neighbour-beams information across different O-RUs should not be available.

The details of copy combine function with selective transmission and reception function using beamId are described in clause 13.3.2 and clause 13.3.3.

#### Selective transmission function

In downlink case, FHM shall retrieve eCPRI messages coming from O-DU as payload of Ethernet frames, read C/U- Plane message-section field and separate C-Plane message section fields based on beamId and also separate U-Plane message section header fields/PRB fields based on sectionIds corresponding to each beamId. Then FHM shall create new eCPRI messages by adding common header field on each new C/U-Plane message which may include multiple separated section fields for C-Plane and section header fields/PRB fields for U-Plane belonging to the same beam. The FHM shall send them towards appropriate O-RUs according to the mapping table between beamId value and O-RU(s). For C-Plane messages, FHM needs to overwrite beamId field according to the mapping table between global beamId and local beamId.

Figure 13.3.2-1 illustrates the same cell scenario where selective transmission is done for O-RU#1 to O-RU#*N*. For the Multiple cells scenario, for a particular cell *m*, selective transmission will be done for O-RU#1 to O-RU#*Nm*.

![](../assets/images/8140457c2cda.png)

**Figure 13.3.2-1: Downlink flow for selective transmission**

#### Selective reception function

FHM shall send C-Plane messages as a same manner of selective transmission, i.e. the FHM shall send C-Plane messages to RUs selectively based on the beamId value in the C-Plane message received from O-DU and the mapping table between global beamId value and O-RU; and overwrite beamId value according to the mapping table between global beamId value and local beamId value for the O-RU.

Then corresponding O-RU(s) transmits UL U-Plane messages which includes UL signal received by using the beam indicated by the beamId value in the C-Plane message received from FHM.

FHM shall combine IQ data according to clause 13.2. In case UL U-Plane message received from different O-RUs do not include IQ data for the same radio resource element, combined IQ data is equivalent to IQ data received from particular O-RU.

FHM shall reconstruct eCPRI payload carrying UL U-Plane messages to be sent to the O-DU by concatenating combined IQ data and corresponding section header field with one UL U-Plane message common header.

After eCPRI payload reconstruction, the FHM shall generate eCPRI header (the ecpriSeqid field generated by the FHM is independent and not a copy of that received from O-RUs; other fields are just copies of those received from the O- RUs.), construct Ethernet frames carrying eCPRI messages as payload, and forward them to the O-DU.

Figure 13.3.3-1 illustrates the same cell scenario where selective reception is done for O-RU#1 to O-RU#*N*. For the Multiple cells scenario, for a particular cell, selective reception will be done for O-RU#1 to O-RU#*Nm*.

![](../assets/images/1c2d231d2156.png)

**Figure 13.3.3-1: Uplink flow for selective reception**

Beam mapping parameters for selective transmission and reception using beamId are summarized in Table 13.3.3-1.

**Table 13.3.3-1: Beam mapping parameters for selective transmission and reception using beamId**

|  |  |  |
| --- | --- | --- |
| **Parameter** | **Description** | **Requirement** |
| global beamId | This parameter indicates the beam ID to be applied to the U-Plane data on O-DU as same as existing beamId. One global beamId can be mapped to one or multiple local beamId. The mapping information between each global beamId, O-RU(s),  and local beamId is configured to the FHM during M-Plane start-up procedure. | Since FHM and O-RUs are treated as a beamforming O-RU, global-beam-id = 0 shall not be used. Value range is same as that of existing beamId explained in clause 7.5.3.9. |
| local beamId | This parameter indicates the beam ID to be applied to the U-Plane data on O-RU as same as existing beamId. In one O- RU, different beams cannot map to one global beamId. Local beamId shall be  unique within O-RU. |  |

## Multiple Cells Scenario in Cascade mode

#### Introduction

The details of multiple cells scenario in Cascade mode using Ethernet Transparent Bridging is described below.

#### Multiple Cell scenario in downlink

Multiple Cell scenario in downlink is shown in Figure 13.4.2-1.

O-RU shall retrieve eCPRI messages as payload of Ethernet frames, and read MAC address in Ethernet header (see clause 5.1.1). If O-RU receives packet from the north-node with 'destination MAC address' same as its own address, then O-RU shall perform DL copy function and send them towards the first logical node in south direction which shares the same cell as defined in clause 13.2 for Cascade mode. Otherwise, the O-RU shall forward whole of the Ethernet frame to the target MAC address without any modification (Ethernet Transparent Bridging). Delay management for Shared Cell as defined in clause 13.5 shall be applied for the cascade chains serving a single cell.

![](../assets/images/c69f99fd0992.png)

**Figure 13.4.2-1: Downlink flow for Multiple Cell scenario**

#### Multiple Cell scenario in uplink

Multiple Cell scenario in uplink is shown in Figure 13.4.3-1.

O-RU shall send C/U-Plane messages in the same manner as in downlink operation, i.e. if O-RU receives UL packets with "destination MAC address" different as its own address, O-RU shall forward the UL packets to the destination MAC address, otherwise O-RU shall perform UL Combine function for Cascade O-RUs and forward to the first logical node in north direction which shares the same cell as specified in clause 13.2.

![](../assets/images/f005369d9777.png)

**Figure 13.4.3-1: Uplink flow for Multiple Cell scenario**

An O-RU shall indicate whether it can support Multiple Cell scenario in Cascade mode as a capability. The cascaded O- RU supporting this feature can support Shared Cell at the same time. As shown in the Figure 13.4.3-2 and Figure

13.4.3-3, this means that it can support mixed configuration of different cells and Shared Cells by combining the Ethernet forwarding and Shared Cell operation. However, a cascaded O-RU can be configured only for one Shared Cell for a given frequency. That is, a cascaded O-RU cannot simultaneously support cell #0 and cell #1 composed of different O-RU groups in the cascade chain if both cell #0 and cell#1 operate in same frequency. Cell#0 and cell#1 shall follow the delay management as defined in clause 13.5.

![](../assets/images/cf104d9895c6.png)![](../assets/images/cf104d9895c6.png)![](../assets/images/cf104d9895c6.png)![](../assets/images/c669f11f0283.png)![](../assets/images/cf104d9895c6.png)![](../assets/images/b34148bed684.png)![](../assets/images/555c3b9a137f.png)![](../assets/images/c9efc0131036.png)![](../assets/images/f287331c4089.png)![](../assets/images/14c4d9c64ae5.png)![](../assets/images/14c4d9c64ae5.png)![](../assets/images/d5d7ef949884.png)![](../assets/images/246d53eb1f72.png)

O-DU

North = O-DU

South = RU#1

Cell#0

O-RU#0

1. Cell#0 packet: Dst MAC =

RU#0 ? Copy Function

1. Cell#1 packet: MAC !=RU#0

? Ethernet Forwarding to RU#1

North = RU#0

South = none

Cell#0

O-RU#1

1. Cell#0 packet: Dst Mac =

RU#1, No copy function since RU#1 is the last node

1. Cell#1 packet: MAC !=RU#1

? Ethernet Forwarding to RU#2

North = O-DU

South = RU#2

Cell#1

O-RU#2

1. Cell#1 packet: Dst Mac =

RU#2 ? Copy Function

North = RU#2

South = None

Cell#1

O-RU#3

1. Cell#1 packet: Dst Mac =

RU#3, No copy function since RU#3 is the last node (south node = none)

Dst Mac = RU#2 (Cell#1)

Dst Mac = RU#1 (Cell#0)

Dst Mac = RU#2 (Cell#1)

Dst Mac = RU#0 (Cell#0)

Dst Mac = RU#3 (Cell#1)

Dst Mac = RU#2 (Cell#1)

**Figure 13.4.3-2: Example#1 Serving different cells and Shared Cell in a cascade O-RU chain**

![](../assets/images/d4f9f08e141f.png)

Cell#0

![](../assets/images/164e26f5c7a3.png)![](../assets/images/499709b4dda1.png)![](../assets/images/164e26f5c7a3.png)![](../assets/images/1a0b14c7ecf6.png)![](../assets/images/164e26f5c7a3.png)![](../assets/images/267cd041f023.png)![](../assets/images/aa42a17bc3c5.png)![](../assets/images/ed80d553a0ae.png)![](../assets/images/5e78cba0b5e9.png)![](../assets/images/5e78cba0b5e9.png)![](../assets/images/5e78cba0b5e9.png)![](../assets/images/2741440bb7f3.png)

North = RU#0

South = none

O-RU#2

1. Cell#0 packet: MAC= RU#2 ? No copy function since RU#2 is the last node
2. Cell#1 packet: Dst Mac != RU#2

? Ethernet forwarding to RU#3

North = RU#1

South = None

Cell#1

O-RU#3

1. Cell#1 packet: Dst Mac =

RU#3, No copy function since RU#3 is the last node (south node = none)

Dst Mac = RU#1 (Cell#1)

Dst Mac = RU#0 (Cell#0)

Dst Mac = RU#3 (Cell#1)

1. Cell#0 packet: MAC !=RU#1

? Ethernet Forwarding to RU#2

O-RU#1 2. Cell#1 packet: Dst Mac =

RU#1 ? Copy function

Dst Mac = RU#2 (Cell#0)

Cell#1

Dst Mac = RU#1 (Cell#1)

Dst Mac = RU#2 (Cell#0)

1. Cell#0 packet: Dst MAC =

RU#0 ? Copy Function

1. Cell#1 packet: MAC !=RU#0

? Ethernet Forwarding to RU#1

O-RU#0

Cell#0

North = O-DU

South = RU#2

O-DU

Dst Mac = RU#3 (Cell#1)

North = O-DU

South = RU#3

**Figure 13.4.3-3: Example#2 of Serving different cells and Shared cell in a cascade O-RU chain**

## Delay management for Shared cell

#### Introduction

Total fronthaul distance between O-DU and O-RU shall be reduced compared to the case when there are no FHM/Cascade O-RU. This is required in order to keep the same total fronthaul delay between O-DU and O-RU even in the presence of processing time at FHM/Cascade O-RU, and to ensure UL messages arrive at O-DU within O-DU reception window as well as DL messages arrive at O-RU within O-RU reception window. Further the transmission/reception timing of FHM/Cascade O-RU needs to be clarified. So, additional requirements than those in clause 4.3 apply.

#### DL delay management for Shared cell

DL delay model parameters for FHM and Cascade mode are shown in Figure 13.5.2-1 and Figure 13.5.2-2.

![](../assets/images/ec5ebbc6ddd7.png)

**Figure 13.5.2-1: Delay model parameters for FHM mode (2 O-RUs case, i.e. *Nm =* 2, is illustrated as an example)**

![](../assets/images/f684e96d4d83.png)

**Figure 13.5.2-2: Delay model parameters for Cascade mode (3 O-RUs case, i.e. *N*=3, is shown as an example)**

It is assumed that additional delay due to combining in UL case is larger than copying in DL case. Therefore, as long as fronthaul and FHM/Cascade O-RU are configured to satisfy delay management for UL case, nothing additional is needed for DL delay management with Shared cell. i.e. FHM/Cascade O-RU can just perform copying and forwarding as soon as it receives DL messages from O-DU (FHM mode) or north-node (Cascade mode), and this ensures that DL messages are received within O-RU reception window. Although the additional requirement for DL is not needed, if O- DU knows processing delay for copy which is shorter than T\_Comb, it can be beneficial for O-DU transmission window optimization. For this reason, T\_Copy is specified as O-RU capability.

It will need additional consideration for FDD cell (DL only band) formed of one DL carrier.

Delay parameter for Shared cell for DL is summarized in Table 13.5.2-1.

**Table 13.5.2-1: Delay parameters for Shared cell for DL**

|  |  |  |
| --- | --- | --- |
| **Parameter** | **Description** | **Additional information** |
| T\_Copy | Corresponding to the maximum FHM or Cascade O-RU processing delay between receiving an IQ sample over the fronthaul interface from O-DU (FHM mode) or the north-node (Cascade mode), coping it and transmitting it over the fronthaul interface to O-RU (FHM mode) or the south-node (Cascade mode).  In addition to the above, in FHM mode with selective transmission, T\_Copy also includes reconstructing U-Plane  message. | Capability parameter.  FHM or Cascade O-RU reports the value by M-Plane. |

#### UL delay management for Shared cell

![](../assets/images/4d6c17e0d409.png)

**Figure 13.5.3-1: Delay model parameters for FHM mode (2 O-RUs case, i.e. *Nm =*2, is illustrated as an example)**

UL delay model parameters for FHM mode are shown in Figure 13.5.3-1. Since FHM processing delay for combining UL U-Plane messages effectively adds to the total fronthaul delay between O-DU and O-RU, total fronthaul distance between O-DU and O-RU shall be reduced compared to the case when there is no FHM in order to keep the same total fronthaul delay between O-DU and O-RU so as to ensure UL U-Plane messages arrive at O-DU within O-DU reception window. In other words, configuration of fronthaul including FHM shall meet:

T\_FH1\_max + *max* (T\_FH2-1\_max, ... , T\_FH2-*N****m***\_max) <= T34\_max - T\_Comb,

where:

* T\_FH1\_max is the maximum transport delay between FHM and O-DU,
* T\_FH2-*n*\_max is the maximum transport delay between O-RU#*n* and FHM (*n* = 1, ... , *Nm*), and
* T\_Comb is the sum of the transmission duration over the fronthaul interface for messages within a specific time (Tx\_Duration) and FHM processing delay for combining IQ samples for a message (T\_Combine\_net). The FHM reports maximum value as capability via M-Plane.

To ensure that UL U-Plane messages arrive at O-DU within O-DU reception window, the latest time FHM can send combined UL U-Plane messages towards O-DU shall be "Ta4\_max -T\_FH1\_max". Since the value of T\_FH1\_max depends on position of FHM, FHM needs to be told about the latest time. This time is defined as Ta3\_prime\_max and the O-DU shall configure it to FHM via M-Plane [7]. SCS associated with eAxC\_ID should be informed to FHM via M-Plane. Considering T\_Comb, this means that UL U-Plane messages received by "Ta3\_prime\_max - T\_Comb" are subject to UL U-Plane message combining. In other words, even if FHM does not receive all UL U-Plane messages

from O-RUs by "Ta3\_prime\_max - T\_Comb", FHM shall combine whatever received UL U-Plane messages and send it to O-DU by Ta3\_prime\_max. This time "Ta3\_prime\_max (configured) - T\_Comb (FHM capability)" is defined as T\_Waiting and calculated at FHM.

When IQ samples should be sent with multiple messages or jumbo frames, transmission duration for them over fronthaul interface should be considered. While T\_Combine\_net has the small variance upon cases, Tx\_Duration usually has a large variance and more dependent upon cases. When Tx\_Duration is not configured though **enhanced-t- combine-enabled** is configured via M-Plane as 'true', FHM shall calculate the amount of this parameter from the configured U-Plane parameters; herein Tx\_Duration is the maximum transmission duration for messages to be sent within Ta3\_prime\_max over the fronthaul interface to north-node or O-DU. The time "Ta3\_prime\_max (configured) - T\_Combine\_net (FHM capability) - Tx\_Duration (configured or calculated)" is defined as T\_Waiting and calculated at FHM supporting ENHANCED-T-COMBINE when **enhanced-t-combine-enabled** is configured as 'true' via M-Plane.

In addition, in order to combine all UL U-Plane messages from O-RUs, T\_Waiting needs to be larger than or equal to "Ta3\_max + *max* (T\_FH2-1\_max, ... , T\_FH2-*Nm*\_max)". Therefore, O-DU shall configure Ta3\_prime\_max which meets following condition:

Ta3\_max + *max* (T\_FH2-1\_max, ... , T\_FH2-*N****m***\_max) + T\_Comb <= Ta3\_prime\_max <= Ta4\_max - T\_FH1\_max

![](../assets/images/dc58069e1b36.png)

**Figure 13.5.3-2: Delay model parameters for Cascade mode (3 O-RUs case, i.e. *N*=3, is shown as an example)**

UL delay model parameters for Cascade mode are shown in Figure 13.5.3-2. In a similar manner with FHM mode, configuration of fronthaul including Cascade O-RU shall meet:

N N-1

? T\_FHi\_max <= T34\_max - ? T\_Comb (for Cascade O-RU#i)

where:

* T\_FH*n*\_max is:

i=1

i=1

* + the maximum transport delay between O-RU#1 and O-DU (*n*=1),
  + the maximum transport delay between O-RU#n and O-RU#*n-*1 (*n*=2 ... *N*),
* T\_Comb is the sum of the transmission duration over the fronthaul interface for messages within a specific time (Tx\_Duration) and Cascade O-RU processing delay for combining IQ samples for a message (T\_Combine\_net), The Cascasde O-RU reports maximum value as capability via M-Plane.
* T34\_max is the maximum uplink transport delay between O-DU and the last O-RU (as specified in clause 4.3).

In addition, in a similar manner with FHM mode, Ta3\_prime\_max configured to each Cascade O-RU shall meet following condition:

N N-1

Ta3\_max + ? T\_FHi\_max + ? T\_Comb (for Cascade O-RU#i) <= Ta3\_prime\_max (for Cascade O-RU#n), and

i=n+1

i=n

n-1

n

Ta3\_prime\_max (for Cascade O-RU#n) <= Ta4\_max - ? T\_FHi\_max - {? T\_Comb (for Cascade O-RU#i) , n >= 2

i=1

i=1

0, n = 1

Delay parameters for Shared cell for UL are summarized in Table 13.5.3-1.

**Table 13.5.3-1: Delay parameters for Shared cell for UL**

|  |  |  |
| --- | --- | --- |
| **Parameter** | **Description** | **Additional Information** |
| T\_Comb | Corresponding to the maximum FHM or Cascade O-RU processing delay between receiving an IQ sample over the fronthaul interface from all O-RUs (FHM mode) or the south-node (Cascade mode), combining them and transmitting it over the fronthaul interface to O-DU (FHM mode) or the north-node (Cascade  mode). | Capability parameter *t-combine*.  FHM or Cascade O-RU reports the value by M-Plane. |
| Ta3\_prime\_max | The latest time that FHM or Cascade O- RU is allowed to send UL U-Plane message to O-DU (FHM mode) or north- node (Cascade mode) relative to  reception timing at O-RU antenna. | Configuration parameter.  Value configured to FHM or Cascade O-RU by M- Plane. |
| T\_Combine\_net | The maximum FHM or Cascade O-RU processing delay between starting time to combine IQ samples from the received message(s) and starting time to transmit them by a message over the fronthaul  interface to O-DU (FHM mode) or the north-node (Cascade mode). | Capability parameter.  FHM or Cascade O-RU reports the value by M-Plane. |
| Tx\_Duration | The maximum transmission duration time for messages to be sent within Ta3\_prime\_max over the fronthaul interface to O-DU (FHM mode) or the north-node (Cascade mode). | Configured parameter or calculated parameter.  When Tx\_Duration isn't configured though **enhanced- t-combine-enabled** is configured as 'true', FHM or Cascade O-RU calculates from configured **number- of-prb and compression-method** per eAxC\_ID, and the calculated amount doesn't exceed symbol duration without cyclic prefix designated by  Ta3\_prime\_max. |
| T\_Waiting | Time when FHM or Cascade O-RU shall wait UL U-Plane message sent by O-RU (FHM mode) or south-node (Cascade mode). | Calculated parameter.  FHM or Cascade O-RU calculates from configured Ta3\_prime\_max, its T\_Comb, T\_Combine\_net, and Tx\_Duration; i.e. this parameter is not defined in M-  Plane. |

Regarding O-RU delay profile reporting via M-Plane:

* For FHM, only T\_comb and T\_Combine\_net (if FHM supports it) are applicable. Other parameters (T2a and Ta3 related parameters and Tcp\_adv\_dl) are not applicable for FHM since it does not behave as an O-RU
* For Cascade O-RU, T\_comb and T\_Combine\_net (if Cascade O-RU supports it) are applicable. Other parameters (T2a and Ta3 related parameters and Tcp\_adv\_dl) are also applicable and the values are for the case it behaves as a normal O-RU

UL message combining in shared cell is strictly processed based on its reference timing of the message. If the reference timing cannot be identified with U-Plane message only, FHM shall refer to the associated C-Plane message.

#### Section Extension 10 support for Shared Cell

One C-Plane message with Section Extension 10 conveys information for multiple eAxC\_IDs in an O-RU. O-DU may use Section Extension 10 in a shared-cell use case if all the impacted O-RUs and FHMs support Section Extension 10. This relation across multiple eAxC\_IDs shall be configured in all O-RUs in the shared cell by the M-Plane to support the Section Extension 10. The eAxC\_ID group information in UL shall be configured in a FHM to support UL

combining with the Section Extension 10 use case. The **eaxc-id-group-capability** reported by the FHM indicates the FHM can handle U-Plane messages commanded by the C-Plane with Section Extension 10, and the FHM also reports how many rx-exac-id-groups and rx-exac-ids-per-group can be configured.

## S-plane for Shared cell

#### Introduction

The same synchronization framework and requirements specified in clause 11 also apply to the FHM, O-DU and O-RU for Shared cell, where the FHM (in the FHM mode), and the cascaded O-RU(s) (in the Cascade mode), are typically regarded as Ethernet switches on the synchronization chain, meeting the requirements specified for T-BC or T-TC Ethernet clocks in clause 11 from an S-plane point of view. Whenever an O-RU is not on the synchronization path to other O-RUs, the O-RU need not support T-BC or T-TC functions. In any case the existing limits specified in clause 11 between the S-plane input port and RF port apply to all O-RUs.

#### Node behaviour at O-RU in FREERUN state

###### O-DU

If synchronization states on all O-RUs in a Shared cell used for operating the same cell transit to the FREERUN or HOLDOVER state, the O-DU shall stop sending C-Plane and U-Plane related data to these O-RUs. In other words, the O-DU shall continue sending unless all O-RUs in the Shared cell used for operating the same cell transit to the FREERUN or HOLDOVER state.

###### O-RU

If synchronization state on a cascade O-RU transits to the FREERUN state, the cascade O-RU shall autonomously stop RF transmission, switch all carriers to INACTIVE state and send a notification to the O-DU about synchronization and carriers state change. The Cascade O-RU shall enable to continue the function for copy and forward to south-node when the O-RU receives the C-Plane and U-Plane related data from the north-node and shall be enabled to continue forwarding without any combining function when the O-RU receives the U-Plane related data from the south-node.

If synchronization state on an FHM transits to the FREERUN state, the FHM shall send a notification to the O-DU about the synchronization. The FHM shall enable to continue function for copy and forward to south-nodes when the O- RU receives the C-Plane and U-Plane related data from the north-node and shall be enabled to continue the function for combine and forward to the north-node when the FHM receives the U-Plane related data from the south-nodes.

The other O-RUs in a Shared cell used for operating the same cell as cascade O-RU or FHM might be still LOCKED synchronization state. The cascade O-RU or FHM shall be able to continue copy and combine functions for the other O- RUs in chain or star topology which provides valid U-Plane and C-Plane related data from/to the O-RUs. However, it has to be considered that if one of the O-RUs in the cascaded chain or FHM in FHM mode moves to FREERUN or HOLDOVER, the clockClass values advertised by this FHM/O-RU towards south-node(s) might impact the sync plane of all the other RUs which are listening on PRTC clockClass values and might trigger state change on all O-RUs which eventually might move to FREERUN or HOLDOVER based on the sync state of that particular O-RU.

## Cascade-FHM mode

#### General

Following clauses define one hybrid mode Cascade-FHM. The mode is shown in Figure 13.7.1-1.

![](../assets/images/b2fc5fd2be95.png)

**Figure 13.7.1-1: Cascade-FHM mode**

Figure 13.7.1-1 shows two typical scenarios in Cascade-FHM mode: one is same cell scenario, that is O-RU(s) serving cascaded FHMs belong to same cell, and the other is Two cells scenario, that is O-RU(s) serving different FHM belong to different cell. Other different cell scenarios are also possible. The first cascade FHM nearest to O-DU is named FHM#1, the second cascade FHM is named FHM#2. For FHM#1, its north-node is O-DU and south-nodes are O-RUs and FHM#2. For FHM#2, its north-node is FHM#1 and south-nodes are O-RUs.

Cascade-FHM mode is realized by at least two chained FHMs and O-RUs connected to them. Star-like topology where many FHMs would be connected to one FHM is not in scope of the present document. In the present document maximum level of cascaded FHMs is limited to 2.

NOTE: In the present document, the reasons for limited depth of FHM chain are as follows: 1) Noise floor level may have negative impact when deeper chain is constructed. Such impact is not yet analyzed; 2) Delay management may be affected by deeper chain and also requires further analysis. 3) Cascade-FHM mode is suitable to be deployed in Indoor Distribution System, and generally the usage with two cascaded FHMs is typical and sufficient.

#### Copy and Combine function

DL Copy function and UL Combine function for Cascade-FHM mode are actually same with FHM mode with a little attention that FHM#1 regards FHM#2 as its one O-RU from aspect of Copy and Combine. Following figures show downlink and uplink flow for same cell scenario (Figure 13.7.2-1) and two cells scenario (Figure 13.7.2-2).

![](../assets/images/9b55cb6df02d.png)

**Figure 13.7.2-1: Cascade-FHM flow for same cell**

![](../assets/images/f831adbfcaa0.png)

**Figure 13.7.2-2: Cascade-FHM flow for two cells**

#### Delay management

Delay management for Cascade-FHM mode follows the combination of FHM mode and Cascade mode while FHM#2 cannot be treated as one normal O-RU from aspect of delay management since it has own processing delay and transport delay towards its O-RUs.

Figure 13.7.3-1 shows a DL delay model for two Cascaded FHMs, and the case where FHM#1 has one O-RU and FHM#2 has two O-RUs in same cell scenario.

![](../assets/images/f7bb252fbcfa.jpg)

**Figure 13.7.3-1: DL delay model parameters for Cascade-FHM mode**

To ensure DL U-Plane messages arrive at O-RU within O-RU reception window the configuration of fronthaul including two cascaded FHMs shall satisfy the following relationships:

* **T\_FH1\_min + *min* (*min* (T\_FH2\_1\_min, ... , T\_FH2-*N*\_min), T\_FH2\_min + *min* (T\_FH3\_1\_min, ... , T\_FH3-*M*\_min) + T\_Copy) >= (T12\_min - T\_Copy)**

where:

T\_FH1\_min is the minimum transport delay between FHM#1 and O-DU, T\_FH2\_min is the minimum transport delay between FHM#2 and FHM#1,

T\_FH2-*n*\_min is the minimum transport delay between O-RU#*n* and FHM#1 (*n* = 1, ... , *N*),

*N* is the total number of O-RUs realizing a particular cell *m* under FHM#1, and in this case *N*=1, T\_FH3-*m*\_min is the minimum transport delay between O-RU#*m* and FHM#2 (*m* = 1, ... , *M*),

*M* is the total number of O-RUs realizing a particular cell *m* under FHM#2, and in this case *M*=2,

T\_Copy is FHM processing delay for copying which depends on FHM capability and is reported via M-Plane.

* **T\_FH1\_max + *max* (*max* (T\_FH2\_1\_max, ... , T\_FH2-*N*\_max), T\_FH2\_max + *max* (T\_FH3\_1\_max, ... , T\_FH3-*M*\_max) + T\_Copy) <= (T12\_max - T\_Copy)**

where:

T\_FH1\_max is the maximum transport delay between FHM#1 and O-DU, T\_FH2\_max is the maximum transport delay between FHM#2 and FHM#1,

T\_FH2-*n*\_max is the maximum transport delay between O-RU#*n* and FHM#1 (*n* = 1, ... , *N*),

*N* is the total number of O-RUs realizing a particular cell *m* under FHM#1, and in this case *N*=1, T\_FH3-*m*\_max is the maximum transport delay between O-RU#*m* and FHM#2 (*m* = 1, ... , *M*), *M* is the total number of O-RUs realizing a particular cell *m* under FHM#2, and in this case *M*=2,

T\_Copy is FHM processing delay for copying which depends on FHM capability and is reported via M-Plane.

Figure 13.7.3-2 shows an UL delay model for two Cascaded FHMs, and the case where FHM#1 has one O-RU and FHM#2 has two O-RUs in same cell scenario.

![](../assets/images/2e26521bc068.jpg)

**Figure 13.7.3-2: UL delay model parameters for Cascade-FHM mode**

To ensure UL U-Plane messages arrive at O-DU within O-DU reception window the configuration of fronthaul including two cascaded FHMs shall satisfy the following relationships:

* **T\_FH1\_min + *min* (*min* (T\_FH2\_1\_min, ... , T\_FH2-*N*\_min), T\_FH2\_min + *min* (T\_FH3\_1\_min, ... , T\_FH3-*M*\_min) + T\_Comb) >= (T34\_min - T\_Comb)**

where:

T\_FH1\_min is the minimum transport delay between FHM#1 and O-DU, T\_FH2\_min is the minimum transport delay between FHM#2 and FHM#1,

T\_FH2-*n*\_min is the minimum transport delay between O-RU#*n* and FHM#1 (*n* = 1, ... , *N*),

*N* is the total number of O-RUs realizing a particular cell *m* under FHM#1, and in this case *N*=1, T\_FH3-*m*\_min is the minimum transport delay between O-RU#*m* and FHM#2 (*m* = 1, ... , *M*),

*M* is the total number of O-RUs realizing a particular cell *m* under FHM#2, and in this case *M*=2,

T\_Comb is FHM processing delay for combining UL U-Plane messages which depends on FHM capability and is reported via M-Plane.

* **T\_FH1\_max + *max* (*max* (T\_FH2-1\_max, ... , T\_FH2-*N*\_max), T\_FH2\_max + *max* (T\_FH3-1\_max, ... , T\_FH3-*M*\_max) + T\_Comb ) <= (T34\_max - T\_Comb)**

where:

T\_FH1\_max is the maximum transport delay between FHM#1 and O-DU, T\_FH2\_max is the maximum transport delay between FHM#2 and FHM#1,

T\_FH2-*n*\_max is the maximum transport delay between O-RU#*n* and FHM#1 (*n* = 1, ... , *N*),

*N* is the total number of O-RUs realizing a particular cell *m* under FHM#1, and in this case *N*=1, T\_FH3-*m*\_max is the maximum transport delay between O-RU#*m* and FHM#2 (*m* = 1, ... , *M*), *M* is the total number of O-RUs realizing a particular cell *m* under FHM#2, and in this case *M*=2,

T\_Comb is FHM processing delay for combining UL U-Plane messages which depends on FHM capability and is reported via M-Plane.

In addition, in order to combine all UL U-Plane messages from O-RUs, O-DU shall configure Ta3\_prime\_max for two cascaded FHMs which meets following condition:

* (Ta3\_max + *max* (T\_FH3-1\_max, ... , T\_FH3-*M*\_max) + T\_Comb) <= Ta3\_prime\_max\_FHM#2,
* (Ta3\_max + *max* (*max* (T\_FH2-1\_max, ... , T\_FH2-*N*\_max), T\_FH2\_max + *max* (T\_FH3-1\_max, ... , T\_FH3-

*M*\_max) + T\_Comb) + T\_Comb) <= Ta3\_prime\_max#1 <= (Ta4\_max - T\_FH1\_max),

where:

Ta3\_prime\_max\_FHM#1 is Ta3\_prime\_max for FHM#1, Ta3\_prime\_max\_FHM#2 is Ta3\_prime\_max for FHM#2,

T\_FH2-*n*\_max is the maximum transport delay between O-RU#*n* and FHM#1 (*n* = 1, ... , *N*),

*N* is the total number of O-RUs realizing a particular cell *m* under FHM#1, and in this case *N*=1, T\_FH3-*m*\_max is the maximum transport delay between O-RU#*m* and FHM#2 (*m* = 1, ... , *M*), *M* is the total number of O-RUs realizing a particular cell *m* under FHM#2, and in this case *M*=2.

# Shared O-RU

## General

"Shared O-RU" is defined as an O-RU that supports the SHARED-ORU-MULTI-ODU and/or SHARED-ORU- MULTI-OPERATOR. For SHARED-ORU-MULTI-ODU feature, the O-RU shall be configured to operate with multiple O-DUs of same operator. For SHARED-ORU-MULTI-OPERATOR feature, the O-RU may be configured to operate with one or more O-DUs from one or more Shared Resource Operators (SRO). O-DUs of same or different operators shall connect to the Shared O-RU using existing CUS-Plane interface definitions and procedures. C-Plane and U-Plane protocol between multiple O-DUs connected to Shared O-RU is expected to be identical, however transport level parameters which may include Ethernet header parameters, IP/UDP headers shall be configured uniquely for each O-DU and Shared O-RU pair. Value of eAxC\_IDs used per O-DU and Shared O-RU interfaces shall be configured by applicable M-Plane yang models.

Shared O-RU realization shall support single and/or multiple operators use cases where multiple O-DUs connected to the Shared O-RU can belong to a single operator and/or multiple operators. Shared O-RU shall support SHARED- ORU-MULTI-ODU and/or SHARED-ORU-MULTI-OPERATOR feature and based on which of these feature O-RU supports, respective restrictions for resource partitioning of the O-RU shall apply. In Figure 14.1-1, O-DU#1 and O- DU#2 may belong to a single operator or multiple operators. Policies governing partitioning of Shared O-RU resources/capabilities are out of scope of CUS and M-Plane specification.

![](../assets/images/7ec047851413.png)

**Figure 14.1-1 : Shared O-RU Concept**

## Delay management for Shared O-RU

#### General

The Shared O-RU Host is responsible for configuring shared O-RU aspects related to delay management. How the Shared O-RU Host determines the parameters to use in the delay management configuration of the shared O-RU is out of scope of the present document.

## S-Plane for Shared O-RU

#### General

The requirements for S-Plane in the Shared O-RU application are unchanged and requirements in clause 11 shall be met. Shared O-RU Host shall ensure that the Shared O-RU has the appropriate sync source to operate within

specifications. Shared O-RU Host may determine the sync topology based on the deployment scenario for Shared O- RU, e.g. for LLS-C1 and LLS-C2 topologies, Shared O-RU Host O-DU may be used as the sync source, alternatively, Shared O-RU Host can also choose multiple sync sources one from Shared O-RU Host O-DU and another sync source from a SROs O-DU (Prioritization of O-DUs as time sources can be done using BTCA in the used ITU-T profile; see clause 11.2.4.2 for applicable PTP profiles)

# Narrowband-IoT

## Overview (informative)

The term "NB-IoT" stands for Narrowband Internet of Things, which is a 3GPP defined low power wide area network (LPWAN) technology developed to enable extended coverage in e.g. indoor and underground scenarios and to enable support for massive number of IoT devices and services. NB-IoT is also based on Orthogonal Frequency Division Multiplexing (OFDM) like LTE and NR with similar resource grid.

An NB-IoT carrier occupies a bandwidth of 180 kHz and can be deployed as "in-band mode", "guard-band mode" and "stand-alone mode". These NB-IoT modes indicate to NB-IoT devices the channel raster location and resource element allocation in an NB-IoT subframe. For example, an NB-IoT carrier located inside an NR carrier can be operated with "guard-band mode". However, the present document uses NB-IoT carrier deployment mode as the relationship between the NB-IoT carrier and the LTE carrier or the NR carrier.

* For in-band mode, an NB-IoT carrier is located within the transmission bandwidth of an LTE/NR host carrier and utilizes one or more resource blocks of the LTE/NR host carrier.
* For guard-band mode, an NB-IoT carrier is located at the guard-band of an LTE/NR host carrier, which is inside the channel bandwidth but outside the transmission bandwidth of the host carrier.

For stand-alone mode, an NB-IoT carrier is located on channel raster (100 kHz). Support for stand-alone mode is out of scope of the present document. To support a massive number of devices in a cell and to achieve spectrum efficiency, multi-carrier operation is also supported. Two types of carriers are defined in NB-IoT, anchor and non-anchor carrier, and they are not differentiated in the fronthaul interface.

Example of the NB-IoT carrier deployment for the three modes are shown in Figure 15.1-1.

![](../assets/images/53fad70c65ac.jpg)![](../assets/images/d3fc8d5a05f4.jpg)

anchor

![](../assets/images/d85038c60170.jpg)![](../assets/images/d85038c60170.jpg)![](../assets/images/906f6953c40c.png)![](../assets/images/906f6953c40c.png)![](../assets/images/906f6953c40c.png)![](../assets/images/906f6953c40c.png)

LTE Carrier

Transmission Bandwidth

Guardband

carrier

non-anchor

carrier

anchor

carrier

![](../assets/images/d85038c60170.jpg)![](../assets/images/d85038c60170.jpg)![](../assets/images/906f6953c40c.png)

LTE Carrier

Transmission Bandwidth

Guardband

non-anchor

carrier

anchor

carrier

non-anchor

carrier

**In-band mode Guard-band mode Stand-alone mode**

NOTE: Support for stand-alone mode is out of scope of the present document.

**Figure 15.1-1: Example NB-IoT carrier deployment**

Support for host carrier with non-15 kHz SCS is out of scope of the present document. Scope of the present document is limited to a common O-DU for host carriers and NB-IoT carriers, and does not cover host carriers and NB-IoT carriers on different O-DUs.

## NB-IoT Downlink enabling methods

#### Extended PRB Grid

The frequency-time resource for NB-IoT in-band mode is treated as one resource block of the LTE/NR host carrier, but for the guard-band mode, the NB-IoT carriers are located outside the PRBs of the host carrier. In order to have unified processing for in-band and guard-band in DL, the PRB grid of the host carrier is extended to accommodate the NB-IoT carrier in the guard-band, so that the guard-band NB-IoT carrier can also be treated as one resource block of the LTE/NR host carrier. The O-DU shall determine if the O-RU's static-low-level-tx-endpoints support the Extended PRB Grid method by checking if **max-prb-range** exceeds the number of PRBs of the host carrier. Such an endpoint may also report **supported-filter-pass-bandwidth** to inform the O-DU of the size of its transmission passband filters, and if it is reported, the O-DU shall check the NB-IoT carriers can fit within the reported **supported-filter-pass-bandwidth** and shall provide the O-RU with occupied-bandwidth (upper and lower bound) to inform O-RU the part of the frequency spectrum that may be requested to be transmitted.

To extend the PRB grid of the host carrier, the PRB #0 starts from the lower part of the guard-band, so the PRB index of the host carrier is extended by the number of PRBs of the lower part of the guard-band, and the PRB index in the upper part of the guard-band follows the highest host carrier PRB index after extension. The PRB boundaries shall be kept same with and without PRB extension, i.e. in Figure 15.2.1-1, PRB#0 before extension and PRB#2 after extension have same boundaries. The O-RU shall construct Extended PRB Grid of the host carrier by using M-Plane parameters **number-of-prb**, **offset-to-absolute-center** as well as **center-of-channel-bandwidth**, **type** in for the tx-array-carrier. An O-RU supporting extended PRB grid method shall support the symmetrically extended number of PRBs altered from the 3GPP definition for the LTE/NR host carrier within the boundaries of the O-RU capability reported in **filter- pass-bandwidth**. Transmission filter bandwidth also shall be widened to satisfy 3GPP TS 36.141 [40] requirement, which shall be reported by **filter-pass-bandwidth** in endpoint capability. There can be multiple NB-IoT carriers in the guard-band of the LTE/NR host carrier, and they shall be located within **filter-pass-bandwidth**.

An example of the extended PRB grid for a 15 MHz LTE carrier is shown in Figure 15.2.1-1.

***center-of-channel-bandwidth***

![](../assets/images/51d34d6bceaf.png)![](../assets/images/594cc94b6101.png)![](../assets/images/a51233498664.png)![](../assets/images/26882979f2fb.png)![](../assets/images/d9d4901a6480.png)![](../assets/images/53face7b179c.png)![](../assets/images/51d34d6bceaf.png)![](../assets/images/2f69baf9bcdc.png)![](../assets/images/a51233498664.png)![](../assets/images/26882979f2fb.png)![](../assets/images/d9d4901a6480.png)![](../assets/images/53face7b179c.png)

**LTE**

**LTE**

**LTE**

**LTE**

**LTE**

**LTE**

**... ...**

**PRB #0**

**PRB #1**

**PRB #2**

**PRB #72**

**PRB #73 PRB #74**

***number-of-prb***

***PRB Grid of LTE Host Carrier***

***Extended PRB Grid of LTE Host Carrier***

***occupied-bandwidth/lower-bound occupied-bandwidth/upper-bound***

Minimum ***filter-pass-bandwidth***

**LTE**

**LTE**

**LTE**

**LTE**

**LTE**

**LTE**

**... ...**

**PRB #0**

**PRB #1**

**PRB #2**

**PRB #3**

**PRB #4**

**PRB #74**

**PRB #75**

**PRB #76**

**PRB #77**

**PRB #78**

***offset-to-absolute-frequency-center***

***number-of-prb***

***offset-to-absolute-frequency-center***

***center-of-channel-bandwidth***

**Figure 15.2.1-1: Example of extended PRB grid (DL)**

The PRB grid for guard-band NB-IoT carrier need not be aligned with the extended PRB grid of the LTE/NR host carrier. Figure 15.2.1-2 shows an anchor carrier deployed in guard-band of 15 MHz LTE carrier with PRB grid

misalignment. Figure 15.2.1-3 shows an anchor carrier deployed in-band of 15 MHz LTE carrier, PRB grid misalignment for non-anchor carrier does not happen in this example.

***occupied-bandwidth/upper-bound***

Minimum ***filter-pass-bandwidth***

**LTE**

**LTE**

**LTE**

**NB-IoT**

**Guard-Band Anchor**

**PRB #78**

**PRB #77**

**PRB #76**

**PRB #75**

**PRB #74**

**...**

**Figure 15.2.1-2: Example of PRB grid misalignment (DL)**

***occupied-bandwidth/upper-bound***

***filter-pass-bandwidth***

**NB-IoT**

**In-Band Anchor**

**LTE**

**LTE**

**NB-IoT**

**Guard-Band Non-anchor**

**PRB #78**

**PRB #77**

**PRB #76**

**PRB #75**

**PRB #74**

**...**

**Figure 15.2.1-3: Example of PRB grid without misalignment (DL)**

## NB-IoT Downlink use cases

#### Overview

Within the present document, use cases of NB-IoT in-band and guard-band mode deployed with an SCS of 15 kHz LTE/NR host carrier is supported. In case of in-band deployment, the DL enabling method as described in either clause

* + 1. or clause 15.3.3 shall be applied, and in case of guard-band deployment, the DL enabling method as described in clause 15.3.3 shall be applied.

DC subcarrier of iFFT (k0) is important for the proper signal processing between O-DU and O-RU. When either methods defined in clause 15.3.2 or clause 15.3.3 is applied, the O-RU shall follow signal processing of host carrier and O-DU shall perform phase compensation for frequency offset.

#### In-band mode with 15 kHz subcarrier spacing of host carrier

Transparent operation using Section Type 1 in a host carrier is selected as a baseline method for DL in-band mode. With this method, the NB-IoT carrier shares the same **tx-array-carrier** and endpoint as the LTE/NR host carrier, and the C-Plane and U-Plane messages for the NB-IoT carrier are treated same as the C-Plane and U-Plane messages for the LTE/NR host carrier. Phase compensation for the NB-IoT carrier shall be done in the O-DU to compensate for the phase offset caused by the frequency offset of iFFT between the NB-IoT carrier and the LTE/NR host carrier. There may be multiple NB-IoT carriers within one LTE/NR host carrier, and the maximum number of carriers is not limited by the present document.

NOTE: This approach is simple for O-RU implementation, because the existence of the NB-IoT carrier is transparent to the O-RU, and no capability report nor configuration by M-Plane is required. Also, this approach does not need additional dedicated resource for the NB-IoT carrier for signal processing such as iFFT in the O-RU.

An example for the in-band mode operation is shown in Figure 15.3.2-1.

**low-level-tx-endpoint**

**tx-arry-carrier**

**LTE**

|  |
| --- |
| **PRB 99** |
| **PRB 98** |
| **PRB 97** |
| **PRB 96** |
| **PRB 95** |
| **PRB 44** |

**PRBs for NB-IoT**

**...**

|  |
| --- |
| **PRB 5** |
| **PRB 4** |
| **PRB 3** |
| **PRB 2** |
| **PRB 1** |
| **PRB 0** |

**Figure 15.3.2-1: Example of in-band mode operation**

#### Guard-band mode with 15 kHz subcarrier spacing of host carrier

As described in clause 15.2.1, the PRB grid for the host carrier is extended to accommodate the NB-IoT carrier in the guard-band, as a result, like in-band mode, the frequency-time resource in NB-IoT guard-band mode also can be treated as one or more resource blocks of the LTE/NR host carrier. In this use case, Section Type 1 C-Plane and the extended PRB as defined in clause 15.2.1 shall be used. For the same reason as in-band mode, phase compensation for the guard- band mode NB-IoT carrier shall be performed by the O-DU.

An O-RU supporting NB-IoT carriers in guard-band mode shall support the extended PRB grid method as specified in clause 15.2.1.

An example for the guard-band mode operation is shown in Figure 15.3.3-1.

**low-level-tx-endpoint PRBs for NB-IoT**

**tx-arry-carrier LTE**

|  |
| --- |
| **PRB 105** |
| **PRB 104** |
| **PRB 103** |
| **PRB 102** |
| **PRB 101** |
| **PRB 100** |
| **PRB 99** |
| **PRB 98** |
| **PRB 97** |

**PRBs for LTE**

**...**

|  |
| --- |
| **PRB 8** |
| **PRB 7** |
| **PRB 6** |
| **PRB 5** |
| **PRB 4** |
| **PRB 3** |
| **PRB 2** |
| **PRB 1** |
| **PRB 0** |

**PRBs for NB-IoT**

**Figure 15.3.3-1: Example of configuration for guard-band mode operation**

As described in clause 15.2.1, the PRB grid for guard-band NB-IoT carrier need not be aligned with the extended PRB grid of the LTE/NR host carrier. In case of PRB grid misalignment, the frequency-time resource in NB-IoT guard-band mode is treated as two PRBs instead of a single PRB. The O-DU shall populate those non-occupied REs to zero in the U-Plane message, and this operation is transparent to the O-RU. An example for this operation is shown in Figure 15.3.3-2.

Extended PRB grid

|  |  |  |
| --- | --- | --- |
| **PRB 78** | **RE 11** | Zero padding |
| **RE 10** | Zero padding |
| **RE 9** | Zero padding |
| **RE 8** | Zero padding |
| **RE 7** | Zero padding |
| **RE 6** | Zero padding |
| **RE 5** | Zero padding |
| **RE 4** | Zero padding |
| **RE 3** | Zero padding |
| **RE 2** | **RE 11** |
| **RE 1** | **RE 10** |
| **RE 0** | **RE 9** |
| **PRB 77** | **RE 11** | **RE 8** |
| **RE 10** | **RE 7** |
| **RE 9** | **RE 6** |
| **RE 8** | **RE 5** |
| **RE 7** | **RE 4** |
| **RE 6** | **RE 3** |
| **RE 5** | **RE 2** |
| **RE 4** | **RE 1** |
| **RE 3** | **RE 0** |
| **RE 2** | Zero padding |
| **RE 1** | Zero padding |
| **RE 0** | Zero padding |

**REs for NB-IoT carrier**

**Figure 15.3.3-2: Example of 2 PRB utilization for one NB-IoT carrier in case of PRB grid misalignment**

## NB-IoT Uplink enabling methods

#### Single Section Single Carrier (SSSC)

Section Type 3 shall be used for the SSSC method to convey the allocation to the O-RU when the NB-IoT carriers are deployed in guard-band or in-band mode.

The O-DU shall determine if the O-RU's static-low-level-rx-endpoint supports SSSC method by checking if the endpoint has **center-from-freqoffset-supported** = TRUE and a config within a set has **center-from-freqoffset**

= TRUE. The O-DU shall determine the max number of supported time-overlapped sections of a SSSC capable endpoint by checking **max-overlapping-instances**. To activate SSSC, the O-DU shall configure the low-level-rx- endpoints with **center-from-freqoffset-enabled** = TRUE. Such an endpoint may also report **supported-filter-pass- bandwidth** to inform O-DU the size of its reception passband filters, and if it is reported, the O-DU shall configure **occupied-bandwidth** (upper and lower bound) to inform O-RU the part of the frequency spectrum that may be requested to be received.

When using the SSSC method, the O-DU shall use a single data section for an NB IoT carrier with startPrbc limited to value 0 and numPrbc limited to values of 1, 4 or 12 for 15 kHz, 3.75 kHz and 1.25 kHz SCS, respectively. The O-DU shall indicate the DC subcarrier location of FFT (k0) of the requested NB-IoT carrier with a single section whose freqOffset field is set to the centre of the lowest subcarrier of the NB-IoT carrier. The O-RU shall infer the k0 location from the formula in clause 15.4.2 with startPrbc limited to value 0 and numPrbc limited to values of 1, 4 or 12 for 15 kHz, 3.75 kHz and 1.25 kHz SCS, respectively. This will result in the term 'startPrbcx12xSCS + numPrbcx6xSCS' being equal to 90 kHz. This mode of NB-IoT section description is referred to as single-section-single-carrier (SSSC) operation. When an endpoint has **center-from-freqoffset-enabled** configured as TRUE, the same RE or PRB can be addressed multiple times in C-Plane messages or in U-Plane messages as an exception. When using the SSSC method, the O-DU shall use a single data section to describe all the populated PRBs in a NB-IoT carrier for any unique

timeOffset and SCS applicable to the NB-IoT carrier, and freqOffset shall be set to the lowest subcarrier in the NB-IoT carrier.

**EXAMPLE:** While using SCS 3.75 kHz, if the O-DU require NPUSCH PRBs 1, 2, and 3 for one timeOffset value then, freqOffset would be set to RE#0 of PRB#0, startPrbc = 0, numPrbc = 4, and the all PRBs would be sent by the O-RU and the O-DU would discard the PRB#0. Another data section might require only PRB#0 at a different timeOffset (so in a different C-Plane message) e.g.

NPRACH, and would include startPrbc = 0, numPrbc = 4, and all four PRBs would be sent by the O-RU, and the O-DU would keep only PRB#0.

NOTE: The dedicated resource utilization using Section Type 3 C-Plane message is intended to align DC subcarrier (k0) of FFT with the NB-IoT carrier and NB-IoT Carrier frequency for down-conversion, so that the O-DU is not required to perform phase compensation as is required when using the receive method in clause 15.4.3. An example of the DC frequency indication of NB-IoT UL from LTE centre frequency is illustrated in Figure 15.4.1-1.

*NB-IoT UL subcarriers LTE UL subcarriers*

![](../assets/images/fc23078f0ede.png)

***NB-IoT UL carrier frequency***

*same as* ***center-of-channel-bandwidth***

***LTE UL carrier frequency***

*Lowest subcarrier*

*DC subcarrier (k0)*

**3.75kHz**

**3.75/2 kHz**

...

**15kHz**

**7.5kHz**

...

***Frequency***

**90kHz**

*freqOffset*

NOTE: The subcarrier arrows represent centre of subcarrier frequency.

**Figure 15.4.1-1: Example of DC subcarrier frequency indication with NB-IoT UL and LTE**

#### Single Section Multiple Carriers (SSMC)

An O-RU supporting SSMC operation may handle the signal processing for multiple contiguous UL carriers having same SCS simultaneously when a single section in Section Type 3 that covers those carriers is received from the O-DU. This mode of NB-IoT section description is referred to as single-section-multiple-carrier (SSMC) operation. In this method, there may be a phase offset in the IQ data due to the mismatch of DC subcarrier in FFT and carrier frequency conversion, so the O-DU shall compensate the phase offset.

The O-DU shall determine if O-RU's static-low-level-rx-endpoints supports SSMC method by checking if the endpoint has **center-from-freqoffset-supported** = TRUE, and a config within a set has **center-from-freqoffset** = TRUE if the parameter is present and **max-prb-range** is larger than the number of PRBs in one NB-IoT carrier with the corresponding SCS. The O-DU shall determine the max number of supported time-overlapped sections of a SSMC capable endpoint by checking **max-overlapping-instances**.

To activate SSMC, the O-DU shall configure the low-level-rx-endpoints with **center-from-freqoffset-enabled** = TRUE. Such an endpoint may also report **supported-filter-pass-bandwidth** to inform O-DU the size of its reception passband filters, and if it is reported, the O-DU shall provide the O-RU with **occupied-bandwidth** (upper and lower bound) to inform O-RU the part of the frequency spectrum that may be requested to be received. The O-RU shall infer the DC subcarrier location of FFT from the below formula from the SSMC C-Plane.

DC subcarrier (k0) frequency = **center-of-channel-bandwidth** + freqOffsetx0.5xSCS + startPrbcx12xSCS + numPrbcx6xSCS

where **center-of-channel-bandwidth** is the frequency configured via M-Plane in the corresponding **rx-array- carrier**, freqOffset, startPrbc and numPrbc are provided with the Section Type 3 C-Plane section and SCS is the subcarrier spacing provided in frameStructure (see clause 7.5.2.13).

The sum of startPrbc and numPrbc shall not exceed **max-prb-range** in the intended config. The O-DU shall use numPrbc values greater than 1, 4 or 12 for 15 kHz, 3.75 kHz and 1.25 kHz SCS respectively in SSMC method.

When SSMC method is used, every section description shall be counted as SSMC instance which is limited by **max- overlapping-instances**. It is recommended to combine as many NB-IoT carriers as permitted by **max-prb-range** within one section description.

#### Extended PRB Grid

With this method a PRB grid of a host carrier is extended to accommodate guard-band NB-IoT carriers.

The O-DU shall determine if O-RU's static-low-level-rx-endpoints supports the Extended PRB Grid method by checking if **max-prb-range** exceeds the number of PRBs of the host carrier. Such an endpoint may also report **supported-filter-pass-bandwidth** to inform O-DU of the size of its reception passband filters. If O-RU reports **supported-filter-pass-bandwidth**, then the O-DU shall provide O-RU with **occupied-bandwidth** (upper and lower bound) to inform O-RU the part of the frequency spectrum that may be requested to be received.

An example of the extended PRB grid for a 15 MHz LTE carrier is shown in Figure 15.4.3-1.

***center-of-channel-bandwidth***

![](../assets/images/82e6e3e4306b.png)![](../assets/images/693adeb9e662.png)![](../assets/images/52066e4d880e.png)![](../assets/images/7a6ad5f097d4.png)![](../assets/images/052f6377841b.png)![](../assets/images/8f479954da54.png)![](../assets/images/82e6e3e4306b.png)![](../assets/images/c2f108411ee9.png)![](../assets/images/52066e4d880e.png)![](../assets/images/7a6ad5f097d4.png)![](../assets/images/052f6377841b.png)![](../assets/images/8f479954da54.png)

**LTE**

**LTE**

**LTE**

**LTE**

**LTE**

**LTE**

**... ...**

**PRB #0**

**PRB #1**

**PRB #2**

**PRB #72**

**PRB #73 PRB #74**

***number-of-prb***

***PRB Grid of LTE Host Carrier***

***Extended PRB Grid of LTE Host Carrier***

***occupied-bandwidth/lower-bound occupied-bandwidth/upper-bound***

Minimum ***filter-pass-bandwidth***

**LTE**

**LTE**

**LTE**

**LTE**

**LTE**

**LTE**

**... ...**

**PRB #0**

**PRB #1**

**PRB #2**

**PRB #3**

**PRB #4**

**PRB #74**

**PRB #75**

**PRB #76**

**PRB #77**

**PRB #78**

***offset-to-absolute-frequency-center***

***number-of-prb***

***offset-to-absolute-frequency-center***

***center-of-channel-bandwidth***

**Figure 15.4.3-1: Example of extended PRB grid (UL)**

The additional PRBs may be used to receive NB-IoT guard-band carriers. In this case the O-RU shall operate as if the PRB grid of the host carrier was larger; the O-DU may request reception of additional PRBs (as permitted by the extended grid). In addition, the O-DU shall handle any phase shift compensation related to misalignment of NB-IoT carrier transmitter and receiver frequencies. The PRB grid for guard-band NB-IoT carrier may be aligned with the PRB

grid of the host carrier. In this case the O-DU extracts NB-IoT PRBs directly from U-Plane messages. Figure 15.4.3-2 shows an example with NB-IoT PRB grid aligned to the PRB grid of the LTE host carrier.

|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| **... PRB #74** | | | | | | | | | | | **PRB #75** | | | | | | **PRB #76** | | | | | | | | | | | | **PRB #77** | | | | | | **PRB #78** | | | | | | | | | | | |

**Figure 15.4.3-2: Example of aligned PRB grid (UL)**

***occupied-bandwidth/upper-bound***

Minimum ***filter-pass-bandwidth***

**LTE**

**LTE**

**LTE**

**NB-IoT NB-IoT**

**Guard-Band Guard-Band**

The PRB grid for guard-band NB-IoT carrier may not be aligned with the extended PRB grid of the host carrier. In this case the O-RU operation is not changed, but the O-DU shall extract REs from adjacent PRBs in U-Plane messages sent by the O-RU to collect NB-IoT carrier's PRB. An example of PRB grid misalignment is shown in Figure 15.4.3-3.

***occupied-bandwidth/upper-bound***

Minimum ***filter-pass-bandwidth***

**LTE**

**LTE**

**LTE**

**NB-IoT**

**Guard-Band**

**PRB #78**

**PRB #77**

**PRB #76**

**PRB #75**

**PRB #74**

**...**

**Figure 15.4.3-3: Example of not aligned PRB grid (UL)**

## NB-IoT Uplink use cases

#### Overview

An NB-IoT capable O-RU shall support UL NB-IoT carriers with the SCS 3.75 kHz and SCS 15 kHz for NPUSCH and the SCS 3.75 kHz or SCS 1.25 kHz for NPRACH. The following clauses describe use cases of NB-IoT carrier reception. The clause 15.5.2 describes a general solution for in-band and guard-band mode NB-IoT carrier reception for NPUSCH with SCS 15 kHz and 3.75 kHz and NPRACH with SCS 3.75 kHz and 1.25 kHz. Clause 15.5.3 describes special case of in-band and guard-band mode NB-IoT carrier reception for NPUSCH with SCS 15 kHz intended to reduce O-RU resource usage. Clause 15.5.4 describes specialised solution for NPRACH reception without C-Plane.

#### General case for in-band and guard-band mode

The reception of NB-IoT carriers in in-band and guard-band mode with the SCS 3.75 kHz and/or 15 kHz for NPUSCH and the SCS 3.75 and/or 1.25 kHz for NPRACH using the Single Section Single Carrier method (SSSC) is described in clause 15.4.1. The reception of multiple NB-IoT carriers with SCS 3.75 kHz as well as 15 kHz can be handled using individual freqOffset in the Section Type 3 as an example in Figure 15.5.2-1.

![](../assets/images/86e4e765e744.png)

**Figure 15.5.2-1: Example for SSSC method to indicate SCSs 3.75 kHz and 15 kHz of NPUSCH using ST 3**

The reception of the above-mentioned NB-IoT carriers may also be handled by the Single Section Multiple Carrier (SSMC) method described in clause 15.4.2, if both the O-DU and the O-RU support the SSMC method. The reception of multiple contiguous NB-IoT carriers with equivalent SCS may be handled with a single freqOffset in a Section Type 3 message as illustrated in example Figure 15.5.2-2.

![](../assets/images/18c4f6b293a4.png)

**Figure 15.5.2-2: Example for SSMC method to indicate SCSs 3.75 kHz and 15 kHz of NPUSCH using ST 3**

Both SSSC and SSMC methods may require allocation of one or more additional RX endpoints for NB-IoT reception depending on the O-DU and O-RU capabilities.

In order to guarantee that NPUSCH and NPRACH can be scheduled without a limitation, at least 2 channels with symbols overlapping in time should be supported by an O-RU that supports NB-IoT.

#### Special case of in-band mode and guard-band mode NPUSCH with extended PRB Grid

The reception of NB-IoT NPUSCH in in-band mode with the SCS 15 kHz may be handled transparently for O-RU. In this case the O-DU shall configure the low-level-rx-endpoints via M-Plane with appropriate **offset-to-absolute- frequency-center** and SCS, and send Section Type 1 C-Plane message to receive a set of PRBs. The endpoint may be an endpoint used for the host carrier reception or an additional endpoint if the configuration of the endpoints used for the host carrier is not matching the configuration required for the NB-IoT carrier reception. The O-RU shall handle the reception as per the configuration provided by the O-DU. The O-DU shall handle any phase shift compensation related to misalignment of NB-IoT carrier transmitter and receiver frequencies.

Alternatively, reception of NB-IoT NPUSCH in in-band mode can be handled with the extended grid method as below especially if both in-band and guard-band NB-IoT carriers are present.

The reception of NB-IoT NPUSCH in guard-band mode with SCS 15 kHz may be handled with the extended PRB grid method described in clause 15.4.3 (handling of in-band mode is also permitted with this method). In this case, the O-DU shall configure the O-RU with **occupied-bandwidth** (the upper and the lower bound) and shall configure the O-RU's endpoint via M-Plane with appropriate **offset-to-absolute-frequency-center** and SCS and send ST 1 C-Plane message to receive a set of PRBs. The endpoint may be an endpoint used for the host carrier reception or an additional endpoint if the configuration of the endpoints used for the host carrier is not matching the configuration required for the NB-IoT carrier reception. The O-RU shall handle the reception as per the configuration provided by the O-DU. The O-DU handles extraction of NB-IoT PRBs from the extended PRB grid (see clause 15.4.3) and any phase shift compensation related to misalignment of NB-IoT carrier transmitter and receiver frequencies.

#### NPRACH without C-Plane

Optionally, the reception of NPRACH may be handled without C-Plane (see clause 7.9.9). For a subset of NPRACH configurations NPRACH reception without C-Plane cannot be configured unambiguously without O-RU and O-DU supporting M-Plane feature EXTENDED-PRACH-CONFIGURATION. This feature allows O-DU to provide O-RU with sfn-offset that disambiguates NPRACH pattern start.

## subframeId, slotId and symbolId numbering for NB-IoT

#### Overview

In the UL, a NB-IoT carrier may use different SCS than the 15 kHz host LTE or NR carrier driven by the physical channels NPUSCH and NPRACH as described in clauses 15.6.2 and 15.6.3.

#### NPUSCH timing

Symbol numbering in a slot of NPUSCH with SCS 3.75 kHz follows the frame structure defined in 3GPP TS 36.211

[42] clause 10.1.2.3, which shall be from zero to six from an even subframe boundary with a duration of 2 ms. When the SCS value provided by "frameStructure" in the C-Plane messages is less than 15 kHz, startSymbolId shall be based on the frame structure of SCS 15 kHz, specified in clause 7.2.2. The even subframeId is applied in line with clause

7.5.2.5 for C-Plane and U-Plane messages for SCS 3.75 kHz NPUSCH. When Section Type 3 is used for NPUSCH data symbol with SCS 3.75 kHz, symbolId in the U-Plane message for the same data symbol will be based on the startSymbolId in the C-Plane message. Minimum scheduling unit for NPUSCH consists of multiple UL slots. A UL slot with NPUSCH SCS 3.75 kHz shall be commanded by C-Plane message with startSymbolid = "0" and numSymbol = "7" when Section Type 3 is used. An example for these timing parameters is shown in Figure 15.6.2-1.

NOTE: Section Type 1 frame structure for SCS 3.75 kHz is not defined in the present document.

**1**

**0**

**0**

***0 1***

***6***

***5***

***4***

***3***

***2***

***1***

***0***

***6***

***5***

***4***

***3***

***2***

***1***

***0***

***6***

***5***

***4***

***3***

***2***

***1***

***0***

***6***

***5***

***4***

***3***

***2***

***1***

***0***

***6***

***5***

***4***

***3***

***2***

***1***

***0***

**symbolId**

**0**

**0**

**0**

**0**

**0**

**slotId**

**8**

**6**

**4**

**2**

**0**

**subframeId**

**0**

**frameId**

**Figure 15.6.2-1: Timing parameters for SCS 3.75 kHz NPUSCH**

However, data symbol numbering in a slot of NPUSCH with SCS 15 kHz or downlink follows the frame structure of NR SCS 15 kHz. An example is shown in Figure 15.6.2-2.

***0 7 8 3 4***

***1 1 7 8 5 6***

***3 3***

***1 3 4***

***3***

***9 1 2***

***0***

***6***

**Figure 15.6.2-2: Timing parameters for SCS 15 kHz NPUSCH**

#### NPRACH timing

NPRACH preamble consists of multiple symbol groups. Each symbol group has a single cyclic prefix, one or more PRACH Symbols and is consecutive in time domain. When Section Type 3 is used for NPRACH then an entire symbol group shall be commanded by the single section description with cpLength = 0. SCS 3.75 kHz or 1.25 kHz is used for NPRACH, so that the subsequent symbolId in U-Plane messages following startSymbolId and numSymbol can be increased to value more than 13. This is in line with symbolId value definition in clause 8.3.3.7. An example for timing parameters in C-Plane and U-Plane messages which are associated with NPRACH preamble format 0 in FDD frame structure is shown in Figure 15.6.3-1.

![](../assets/images/d2d763944a2b.png)![](../assets/images/21bedc3b6044.png)![](../assets/images/58657ef6c9e6.png)![](../assets/images/d7520309ac06.png)![](../assets/images/adfe9a68c6fd.png)![](../assets/images/4dd4cfadcd0b.png)![](../assets/images/b861ca90ae6e.png)![](../assets/images/3ecbaf6c1de1.png)![](../assets/images/70b2c77b396e.png)![](../assets/images/e9eefd56ac76.png)![](../assets/images/fe25e036fc21.png)![](../assets/images/d7520309ac06.png)![](../assets/images/32d36798a538.png)![](../assets/images/c976563261f3.png)![](../assets/images/b62934608bd2.png)![](../assets/images/c678c92fefe7.png)![](../assets/images/b950aefc86cf.png)![](../assets/images/201f87a6889b.png)![](../assets/images/78874816fd8f.png)![](../assets/images/237cf99ba723.png)![](../assets/images/0a5f9e103e4e.png)![](../assets/images/dac6ddd7881c.png)![](../assets/images/b62934608bd2.png)![](../assets/images/6bc16518d51b.png)![](../assets/images/f28be1ba690c.png)![](../assets/images/ddea995387fb.png)

**0 1 2 3**

**0 1 2 3**

**0 1 2 3 4 5 6 7 8 9 1 1 1 1 0 1 2 3 4 5 6 7 8 9 1 1 1 1 0 1 2 3 4 5 6 7 8 9 1 1 1 1 0 1 2 3 4 5 6 7 8 9 1 1 1 1 0 1 2 3 4 5 6 7 8 9 1 1 1 1 0 1 2 3 4 5 6 7 8 9 1 1 1 1**

**0 1 2 3**

**0 1 2 3**

**0 1 2 3**

*timeOffset*

*timeOffset*

*timeOffset*

*timeOffset*

***Symbol Group***

***Symbol Group***

***Symbol Group***

***Symbol Group***

***c p***

***8192\*Ts 8192\*Ts 8192\*Ts 8192\*Ts 8192\*Ts 8192\*Ts 8192\*Ts 8192\*Ts 8192\*Ts 8192\*Ts 8192\*Ts 8192\*Ts 8192\*Ts 8192\*Ts 8192\*Ts 8192\*Ts 8192\*Ts 8192\*Ts 8192\*Ts 8192\*Ts 8192\*Ts***

***c***

***c***

***c***

***c***

***p p p p***

***NPRACH preamble***

**0 0 0 0 0 1 1 1 1 1 2 2 2 2 2 4 4 4 4 4**

**0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0**

**0 1 2 3 4 6 7 8 9 10 12 13 14 15 16 3 4 5 6 7**

**0 1 2 3**

|  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- |
|  | **subframe #0** | **subframe #1** | **subframe #2** | **subframe #3** | **subframe #4** | **subframe #5** |
| ***slotId for SCS 15kHz*** | **0** | **0** | **0** | **0** | **0** | **0** |

***symbolId for SCS 15kHz***

***C-Planes messages subframeId***

|  |
| --- |
| **1** |
| **0** |
| **6** |
| **5** |

|  |
| --- |
| **2** |
| **0** |
| **12** |
| **5** |

|  |
| --- |
| **4** |
| **0** |
| **3** |
| **5** |

|  |
| --- |
| **0** |
| **0** |
| **0** |
| **5** |

***slotId startSymbolId numSymbol***

***NPRACH***

***Preamble Format 0***

***U-Planes messages***

***subframeId slotId symbolId***

**Figure 15.6.3-1: Example of timing parameters in NPRACH U-Plane messages**

# Energy-saving functionality

## Overview

The C-Plane protocol provides several ways to instruct the O-RU regarding opportunities for entering energy saving modes using Section Type 4 commands. There are two energy-saving Section Type 4 commands: TRX\_CONTROL and Advanced Sleep Mode (ASM).

TRX\_CONTROL (st4CmdType = 3) involves the disabling of some or all antenna array elements for a period of time to save energy.

ASM (st4CmdType = 4) involves the disabling of all antenna array elements for a period of time to save energy.

These commands indicate the interval during which the O-DU intends to stop sending C-Plane and U-Plane commands for specific carriers, antenna arrays or the whole O-RU (ASM) or when the O-DU will reduce the number of antenna array elements / RF channels it expects to use (TRX\_CONTROL). There is no specific requirement for the O-RU to specifically power down anything in response to these commands: depending on the O-RU's design it may or may not be able to save energy given a specific energy-saving command. A command that would save energy in many cases might not save any energy when issued for a very short duration e.g. for one or a few symbols in a slot.

For both commands, when a command is received by the O-RU it will have an eAxC\_ID value in its command header. The command applies to the endpoint assigned to that eAxC\_ID value and any other endpoint sharing the command's scope, see also Table 7.5.2.17-1). For example, if a command is for DL (dataDirection = 1) and has cmdScope

= ARRAY-COMMAND (0000b), then all endpoints using the same tx-array as the endpoint assigned the eAxC\_ID value in the command header will be impacted. If a command is for UL (dataDirection = 0) and has

cmdScope = CARRIER-COMMAND (0001b), then all endpoints using the same array carrier as the endpoint assigned the eAxC\_ID value in the command header will be impacted. If a command has cmdScope = O-RU-COMMAND (0010b), then all endpoints in the correct direction (UL or DL) in the O-RU will be impacted. In some cases, different command scopes will have the same effect, such as when an antenna array is supporting a single array carrier: the scopes ARRAY-COMMAND and CARRIER-COMMAND would be equivalent.

For both commands, startSymbolId shall be set to zero, indicating the expected reception window for the commands is the symbol zero reception window.

For both commands (TRX\_CONTROL and ASM), the period of time to "sleep" may be defined-duration or undefined- duration. Defined-duration means the sleep duration is given as an explicit duration in slots; the duration of a slot is determined by the SCS field of the command as conveyed in the common Section Type 4 header. Undefined-duration means the sleep duration will last until a new C-Plane command is issued from O-DU to O-RU to "wake up" the O-RU.

For each of the two commands (TRX\_CONTROL and ASM), there are four "sleep modes" that may be supported, each with a specific "wake-up duration" as indicated by an M-Plane O-RU capability report. The wake-up duration indicates how long the O-RU will take to "wake up", is specified in microseconds, and shall differ for different sleep modes based on which specific O-RU circuits are put in an energy-saving condition. The wake-up duration is denominated in microseconds, but the defined-duration sleep command is denominated in a number of slots, so the value of the wake- up duration shall be rounded up to the integer number of slots to determine the minimum acceptable sleep duration. A defined-duration sleep command shall have a duration at least as long as the relevant wake-up duration. When an undefined-duration sleep command is terminated by a new TRX\_CONTROL or ASM "wake-up command", the wake- up duration indicates the number of slots the O-DU shall wait before issuing C-Plane and U-Plane commands. The sleep modes are shown in Table 16.1-1.

**Table 16.1-1: Sleep modes**

|  |  |  |  |
| --- | --- | --- | --- |
|  | **TRX\_CONTROL wake-up duration** | **ASM wake-up duration** | **NOTE** |
| sleep mode 0 | TRXC-mode0-wake-up-duration | ASM-mode0-wake-up-duration |  |
| sleep mode 1 | TRXC-mode1-wake-up-duration | ASM-mode1-wake-up-duration | L |
| sleep mode 2 | TRXC-mode2-wake-up-duration | ASM-mode2-wake-up-duration | M |
| sleep mode 3 | TRXC-mode3-wake-up-duration | ASM-mode3-wake-up-duration | N |
| NOTE: within clause 16 the shorter terms L, M, and N are sometimes used for these durations (either command) | | | |

By convention, the wake-up durations shall be arranged such that L < M < N (microseconds). Also, the sleep mode 0 wake-up duration is expected to be consistent with just a few symbols rather than close to or greater than a slot duration, and less than L.

Because RF and other circuits could differ in an O-RU between UL and DL and between different antenna arrays (for O-RUs having multiple antenna arrays), there shall be a separate set of declared supported sleep modes per tx-array and rx-array, and a separate set of declared sleep mode wake-up durations per tx-array and rx-array. These declared aspects shall be reported by the O-RU to the O-DU as an O-RU capability.

The wake-up durations may be "guaranteed" or "minimum". Guaranteed wake-up durations indicate a wake-up duration that is invariant to any O-RU condition. Minimum wake-up durations indicate that an actual wake-up interval may be longer than the minimum due to e.g. O-RU environmental conditions, duration of sleep, need to recalibrate or other factors. When minimum wake-up durations are used, a special Section Type 8 "ready" message is sent from O-RU to O- DU which tells the O-DU the O-RU is ready to process C-Plane and U-Plane commands.

Sleep mode zero is special: the "symbol" wake-up duration is less than the maximum slot duration and guaranteed (see clause 7.5.3.52 regarding the definition of the "symbol" wake-up duration). Also, only sleep mode zero may be used when the symbolMask has a value other than all-zero or all-ones. This is because a mixed symbolMask will feature the O-RU (or parts of it) being put to sleep for just some symbols, hence a time period less than a slot length. All sleep mode wake-up durations for sleep modes != 0 are rounded up to the integer number of slots to determine the minimum acceptable sleep duration, but for sleep mode zero no such rounding is done which supports this use of symbolMask (having a value other than all-zero or all-ones).

There is no "go-to-sleep" value: array elements or other O-RU parts are expected to be unavailable to function (process C-Plane or U-Plane messages) immediately - starting with the slot number indicated in the command. This does not ignore the possibility that some O-RU components may take time to go to sleep, but it expects the deactivation time to be short. Because the deactivation time may not be short, the go-to-sleep interval should be considered part of the wake- up duration. For example, if the go-to-sleep interval was 2 ms and the wake-up duration was 5 ms, then the wake-up duration should be reported as being 7 ms. This assures a sleep command will not be issued for a time period shorter than the go-to-sleep duration plus the wake-up duration.

Because both TRX\_CONTROL and ASM commands may have long-duration impacts, loss of a command during transmission from O-DU to O-RU could have a significant operational impact. Therefore the ACK/NACK capability (ackNackReqId) in the Section Type 4 command common header should be used to assure correct reception of the command.

Some M-Plane activity may impact the operation of a TRX\_CONTROL and/or ASM command. In particular, if an array carrier is deactivated while in an asleep condition, the carrier's asleep condition is "forgotten": it cannot wake up (if put to sleep for a defined duration) and cannot be explicitly woken up (if put to sleep for an undefined duration). Any other array carriers impacted by the command will retain their condition of sleep.

Example: an ARRAY-COMMAND scope command is issued when three array carriers are active and assigned to the relevant tx-array or rx-array, and while those carriers are asleep an M-Plane operation deactivates one of the three array carriers. The remaining two carriers (still using the tx- array or rx-array) retain their asleep condition; this is valid for a defined-duration or undefined- duration sleep command.

Example: an ARRAY-COMMAND scope is issued when two array carriers are active and assigned to the relevant tx-array or rx-array, and while those carriers are asleep an M-Plane operation activates a third carrier using the same tx-array or rx-array. Because the tx-array or rx-array is in an asleep condition, the newly-activated carrier is also in an asleep condition until the tx-array or rx-array is woken up, either due to the expiration of a defined-duration sleep interval or by being explicitly woken up from an undefined-duration sleep interval.

NOTE: Care should be taken when activating or deactivating array carriers when the O-RU is utilizing sleep commands because the sleep commands are by design synchronized to the air interface while M-Plane commands are not, so the M-Plane command will take effect at an unknown slot number hence with an unknowable time relationship to any sleep command.

## TRX\_CONTROL

The Section Type 4 TRX\_CONTROL command allows the O-DU to disable some fraction of the O-RU's antenna array elements to allow the saving of energy. This is done using an antenna mask: the mask has as many bits as there are array elements, and the O-DU puts a "1" in a mask bit for each array element that is to be made or kept active, and a "0" in each array element that is to be made or kept inactive. However, most O-RU designs will not be able to save energy with just any pattern of on/off array elements. Therefore, the O-RU provides to the O-DU in a capability report a list of valid antenna masks. More specifically, every tx-array and rx-array shall have a specific list of valid antenna masks for that array that is reported to the O-DU as an O-RU capability.

**Example**: the O-RU supports a 4x4 antenna panel comprising 16 array elements (single polarization) which can be turned on/off in quadrants. Valid antenna masks could be reported as:

{0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0} : all off

{0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 1} : bottom half active, top half off

{0 0 1 1 0 0 1 1 0 0 1 1 0 0 1 1} : left half active, right half off

{1 1 0 0 1 1 0 0 0 0 0 0 0 0 0 0} : only upper right quadrant active, other quadrants off

In this example it is supposed there is no benefit to allowing e.g. the left half off or the right half off so only one is included. This example assumes O-RAN antenna model ordering, with the least significant mask bit (the rightmost bit) associated with the lower-left array element.

Each TRX\_CONTROL command provided to the O-RU includes an antenna mask which replaces the previous mask, but array elements that were turned off using a specific sleep mode retain that sleep mode if a subsequent command keeps them off, this is described in more detail in clause 16.8.

To simplify beam weight management, the O-DU shall send weights for all array elements even when a TRX\_CONTROL has disabled some array elements. All beam weight management operations are unchanged when using TRX\_CONTROL commands, except that for the disabled array elements, the O-DU shall send zero values (both I and Q). For predefined-beam beamforming, a pre-stored weight vector shall be used that contains zero-value weights for the disabled array elements. This is necessary to expedite memory handling of the beamforming weights.

The TRX\_CONTROL Section Type 4 command has only one valid cmdScope: ARRAY-COMMAND (0000b). In other words, a TRX\_CONTROL always references a specific tx-array or rx-array.

If an antenna array is put into a specific asleep condition (some or all array elements deactivated) and then an M-Plane operation causes an array carrier to be activated on that antenna array, the array carrier will be considered to be using the antenna array in its asleep condition. In other words, the activation of an array carrier does not change the asleep condition of the antenna array that array carrier is assigned to.

## Advanced Sleep Mode (ASM)

The Section Type 4 ASM command allows the O-DU to disable some portion of the O-RU's processing to allow the saving of energy. Unlike the TRX\_CONTROL, all array elements are affected by an ASM command. The scope of an ASM command may be:

* CARRIER-COMMAND : an array-carrier is disabled
* ARRAY-COMMAND : a tx-array or rx-array is disabled;
* O-RU-COMMAND : all tx-arrays or rx-arrays are disabled.

## Defined-duration sleep functionality

Both TRX\_CONTROL and ASM commands can utilize a defined sleep functionality, wherein part or all of an O-RU can be disabled for a defined period of time. The defined period is specified by the sum of the numSlots and numSlotsExt parameters in those commands and is denominated in number of slots greater than zero, with the time duration of a slot indicated by the "scs" field in the common Section Type 4 header.

The defined sleep duration is a promise by the O-DU to the O-RU and cannot be rescinded (except, see clause 16.12). This means that the O-DU should consider that all C-Plane processing in the O-RU may have ceased during the defined sleep duration minus the integer number of slots being the wake-up duration rounded up to an integer number of slots with the slot duration indicated by the "scs" parameter in the command; see clause 16.9 for the use for C-Plane processing in the O-RU during its wake-up duration.

Example: C-Plane processing may be halted when there is no possibility of user traffic, such as when both UL and DL sleep commands have been issued and/or an all-zero antMask has been specified meaning all array elements are asleep.

When C-Plane processing is halted, the C/U-Plane connectivity monitoring check may fail due to lack of C/U-Plane traffic. The O-DU should lengthen or disable the C/U-Plane connectivity monitoring check (see M-Plane Specification [7] clause 7.10) when commanding the O-RU into a sleep condition where C-Plane processing could be turned off.

Under any sleep condition, M-Plane and S-Plane processing as well as delay measurement packets (eCPRI message type 5) shall be maintained by the O-RU.

The O-DU should consider all U-Plane processing in the O-RU has ceased during the defined sleep duration.

NOTE: the O-RU is not required to cease C-Plane and U-Plane processing during the defined sleep duration; there is an opportunity for the O-RU to cease that processing but it is not required.

A wake-up command shall have an undefined time span. It is not true that something can be woken up for just a limited period of time. In particular, for TRX\_CONTROL, array elements that are woken up shall be considered awake indefinitely even if the command has a sleep duration pertaining to other array elements being put to sleep. Once the defined duration indicated in the command expires, the relevant parts of the O-RU shall be active and ready to process C-Plane and U-Plane traffic if the wake-up duration is guaranteed. This means that the O-RU should start that wake-up process prior to the expiration of the defined sleep duration, to ensure the O-RU is ready when the defined sleep duration expires. When the wake-up duration is not guaranteed but "minimum" then it is possible the wake-up duration could take longer than the reported value. See clause 16.6 regarding guaranteed versus minimum wake-up durations.

In all cases, the defined sleep duration shall be greater than or equal to the wake-up duration, otherwise there would be insufficient time for the O-RU to enter a sleep mode and then wake up.

The ability to support defined sleep functionality is reported as an O-RU capability; if the O-RU lacks the capability then the numSlots and numSlotsExt parameters in the defined-duration sleep command shall be set to zero by the O- DU.

## Undefined-duration sleep functionality

Both TRX\_CONTROL and ASM commands can utilize an undefined sleep functionality, wherein part or all of the O- RU is put to sleep for an unspecified period of time. The presence of an undefined sleep duration command is indicated by both numSlots and numSlotsExt being equal to zero.

The asleep condition is ended when the O-DU issues a new TRX\_CONTROL or ASM command that wakes up part or all of the O-RU (a "wake-up command"). Because the O-RU needs to be ready to receive a reactivation C-Plane Section Type 4 command during the sleep interval, C-Plane processing may not be disabled by the O-RU during an undefined- duration sleep interval.

A wake-up command for sleepMode != 0 shall always have symbolMask = 0, indicating all symbols are woken up. However, when in sleepMode = 0, a wake-up command could have a symbolMask value with some ones (but at least one) commanding an immediate transition from all symbols in the slot(s) being asleep to just some symbols in the slot(s) being asleep, recalling that for sleepMode = 0 there is expected to be a short "symbol" wake-up duration.

Once the asleep condition is ended by reception of a wake-up command, the wake-up process is started. When sleepMode = 0, the slot number indicated in the command is available for C-Plane and U-Plane traffic. When sleepMode != 0, then the O-DU shall wait for the number of slots indicated by the wake-up duration for the commanded sleep mode before it sends C-Plane and U-Plane traffic to the woken-up parts of the O-RU, using the correct tx-window for the first awake slot. The sleepMode value for the wake-up command shall match the sleepMode value for the sleep command that is being woken up, except that if a mixture of sleep modes is active (see clause 16.8) the sleep mode with the longest wake-up duration shall be included in the wake-up command.

The ability to support undefined sleep functionality is reported as an O-RU capability; if the O-RU lacks the capability then the numSlots and numSlotsExt parameters shall not both be set to zero by the O-DU in any TRX\_CONTROL or ASM command.

## Guaranteed versus minimum wake-up durations

#### Guaranteed wake-up durations

An O-RU supporting TRX\_CONTROL and/or ASM shall report via M-Plane, the wake-up durations for supported sleep modes 0 to 3 for each of the TRX\_CONTROL and ASM commands and for each tx-array and rx-array that are not sub-arrays of larger antenna arrays. As well, the O-RU shall report whether those values are "guaranteed" or "minimum". Sleep mode zero shall have a guaranteed wake-up duration.

When the wake-up durations are guaranteed, then the O-RU shall be ready to process C-Plane and U-Plane commands when the wake-up duration expires. For example, if wake-up duration= M (microsecond) rounds up to m slots and starts on slot k then the O-RU shall be able to process C-Plane and U-Plane traffic for slot k + m.

#### Minimum wake-up durations

In some cases, the O-RU will not be able to guarantee a wake-up duration, due to a temperature sensitivity that would cause a longer wake-up duration at a temperature extreme, or a situation where a calibration of uncertain duration would be needed as part of activating some O-RU functionality. In such cases the O-RU may declare some wake-up durations as "minimum". This means the wake-up interval will be at least the declared time but could be longer.

When minimum wake-up duration is used, the O-RU shall send a "ready" message to the O-DU to indicate termination of sleep.. The "ready" message is a Section Type 8 command (see clause 7.4.10) with a specific "ready" bit that indicates the O-RU is ready to process traffic, in the slot *after* the slotId value in the Section Type 8 command. The Section Type 8 'ready" message shall have symbolId = 0 which provides a full slot's length of time for the O-DU to react to the ready message and schedule C-Plane and U-Plane traffic. The time-duration of a slot in this context is determined by the "scs" parameter in the Section Type 8 command.

A "ready" message may carry not only the ready bit but also one or more ackId values. If a sleep command (including wake-up command) includes an acknowledge request ("ackNackReqId"), then the command shall be acknowledged as usual, and the ackId shall also be included in the "ready" message resulting from that command (if one is generated). Multiple ackIds would result if multiple commands wake up from their sleep such that the corresponding O-RU parts are ready in the same slot. For example, it is possible two separate tx-arrays happen to wake up from their minimum wake-up durations such that they are both available for use in the same DL slot.

## Calibration during sleep and wake-up

While asleep (after a deactivation command and including a wake-up interval), an O-RU in Advanced Sleep Mode may calibrate RF paths including radiating energy from some or all antenna elements. Such calibration activity may be executed using the calibration procedure (see WG4 M-Plane Specification [7] clause 15.5.2.3), including issuing a calibration request and possibly executing self-calibration if that request is not granted by the O-DU.

As part of the wake-up interval an O-RU may need to recalibrate RF paths which could include radiating energy out of antenna array elements. As well, an O-RU may calibrate RF paths even while asleep to ensure RF paths are ready to be woken up quickly, at least for some sleep modes.

## Mixed sleep modes and overlapping commands

#### ASM overlapping commands

ASM commands may have different command scopes: CARRIER-COMMAND, ARRAY-COMMAND and O-RU- COMMAND. Only one command at a time can be active in any command scope and direction. This means that for any array carrier, only one CARRIER-COMMAND can be active, but if there are multiple array carriers each is subject to its own ASM command. Likewise, for any tx-array or rx-array, only one ARRAY-COMMAND can be active, but if there are multiple tx-arrays or rx-arrays each is subject to its own ASM command. A new ASM command shall override an existing ASM command in the same or different scope (CARRIER-COMMAND, ARRAY-COMMAND or O-RU- COMMAND. When changing sleep modes, the new sleep mode shall have a longer wake-up duration compared to the command it is replacing, this is to ensure that a long wake-up duration is not violated by being replaced by a short

wake-up duration.

If the scope is the same, then the new command takes the place of the old command. For example, when in undefined sleep duration, a new ASM command shall not wake up the O-RU but place it into a different sleep mode or change from undefined to defined sleep duration; this new command shall replace the old command.

If the scope is different and the new scope is broader, then the new scope shall replace the previous scope. For example, if there is a CARRIER-COMMAND active for a specific array carrier and then an ARRAY-COMMAND is issued that includes that carrier, then the CARRIER-COMMAND shall be superseded by the ARRAY-COMMAND; the CARRIER-COMMAND shall be forgotten and when the ARRAY-COMMAND expires that array carrier shall not revert to the status under the CARRIER-COMMAND.

Making the scope narrower shall not be done, due to complexities that could be introduced if the broad-scope command is not explicitly cancelled.

Further, only one ASM command may be issued in a specific slot for the specific array(s) impacted by the command. This rule prevents the ambiguity that may result if multiple commands with overlapping areas of action are sent for the same slot, the result could depend on the order of command reception which cannot be perfectly predicted (which command would be the overriding command).

A series of ASM commands may result in complete shutdown of traffic and a possible disabling of C-Plane and U- Plane processing. For example, if an O-RU supports two array carriers, one is put to sleep using CARRIER- COMMAND (both directions) and later the other is put to sleep using CARRIER-COMMAND (both directions), then there would be no C-Plane or U-Plane traffic possible and the O-RU could terminate C-Plane and U-Plane processing for the (defined) duration of those commands. Therefore, the following principle should be observed:

If sleep command(s) result in no possible C-Plane and U-Plane traffic for a defined duration, the O-DU should assume O-RU C-Plane and U-Plane processing are disabled for that duration.

Scope ranking: O-RU-COMMAND broader than ARRAY-COMMAND broader than CARRIER-COMMAND.

#### TRX\_CONTROL overlapping sleep modes

Only one TRX\_CONTROL command may be issued in a specific slot for the specific array impacted by the command. This means that for any tx-array or rx-array, only one TRX\_CONTROL command can be active, but if there are multiple tx-arrays or rx-arrays each is subject to its own TRX\_CONTROL command.

TRX\_CONTROL commands follow the principle that a new TRX\_CONTROL command's antenna mask overrides a previous TRX\_CONTROL command's antenna mask. However, sleep modes for asleep array elements are not overridden. Figure 16.8.2-1 provides an example of overlapping sleep modes using TRX\_CONTROL commands.

![](../assets/images/0e67ea58ffc4.png)![](../assets/images/0e67ea58ffc4.png)

![](../assets/images/4c9cb79e7eb9.png)![](../assets/images/4c9cb79e7eb9.png)

|  |  |
| --- | --- |
|  |  |
|  |  |
|  |  |
|  |  |

![](../assets/images/4c9cb79e7eb9.png)![](../assets/images/0e67ea58ffc4.png)![](../assets/images/4c9cb79e7eb9.png)![](../assets/images/4c9cb79e7eb9.png)![](../assets/images/0e67ea58ffc4.png)

**Figure 16.8.2-1: Example of overlapping TRX\_CONTROL sleep modes**

The example in Figure 16.8.2-1 shows a sequence of TRX\_CONTROL operations with overlapping modes. Two implications:

* each array element (or set of array elements) needs to keep track of its sleep mode. Remember that antenna masks are regulated by the O-RU, in this example the O-RU may have only allowed masks:

{whole panel, top, bottom, left, right, top left quad, top right quad, bottom left quad, bottom right quad}.

* An array element that was asleep and stays asleep keeps its previous sleep mode. Interval A: whole panel is awake.

Interval B: top half put to sleep, sleep mode 3

Interval C: top half kept asleep (still sleep mode 3), bottom half put to sleep, sleep mode 0 Interval D: top half kept asleep (still sleep mode 3), bottom half made awake

Interval E: top half kept asleep (still sleep mode 3), bottom left quad put to sleep, sleep mode 1

Interval F: top left quad kept asleep (still sleep mode 3), top right quad made active, bottom half kept as-is. Interval G: left side kept as-is, right side put to sleep, sleep mode 2

Interval H: top half kept as-is, bottom half made active.

Interval I: top half kept as-is, bottom half put to sleep, sleep mode 1

Interval J: whole array made active (worst-case wake-up duration shall be observed).

In the example shown in Figure 16.8.2-1, "Interval C" shows a mixed sleep mode, the upper half of the panel in sleep mode 3 (perhaps a deep sleep mode) while the lower half is in sleep mode 0 (perhaps a shallow sleep mode). The upper half of the panel can stay in a deep sleep for an extended period while the lower half can be deactivated and activated

quickly based on traffic conditions, even using symbolMask to deactivate for just a few symbols. Waking up from mixed-mode sleep, such as shown from I to J, the wake-up command should use the sleep mode value corresponding to the longest wake-up duration of those array elements that are being reactivated, even when that delays the waking up of other array elements that have a shorter wake-up duration.

It may be possible for a new TRX\_CONTROL command to be issued while some array elements are in the process of waking up. This is permitted for defined-duration sleep commands (see clause 16.9 on sleep extension) but for undefined-duration sleep commands, it is only permitted if the array elements in the process of waking up are not interrupted: the new TRX\_CONTROL antenna mask needs to repeat the wake-up instruction for the array elements in the process of waking up. For undefined-duration sleep commands, it is not permitted for the new TRX\_CONTROL to include an antenna mask that would interrupt the wake-up process for any array elements, forcing them to stop waking up and go back to sleep.

Example: the whole antenna panel is put to sleep using an undefined-duration command then the top half is commanded to wake up. During the top half's wakeup interval, the bottom half may be commanded to also wake up. This is permitted.

Example: the top half of the antenna panel is put to sleep using an undefined-duration command and the bottom half is awake, then the top half is commanded to wake up. During the wake-up interval the traffic load drops and the O-DU commands the top half to go back to sleep. This interrupts the wake-up process of the undefined-duration sleep command for the top half so is prohibited because sleep extension (interrupting a wake-up process) is only permitted for defined-duration sleep commands. Only after the top half's wake-up is completed may the O-DU command the top half to go back to sleep.

While a TRX\_CONTROL command with all-zero mask may look like an ASM command with command scope of ARRAY-COMMAND, it is treated as a TRX\_CONTROL command. However, the O-RU may utilize whatever power savings it chooses to, including taking advantage of all array elements being deactivated.

A TRX\_CONTROL command with all-ones antenna mask is used to wake up after an undefined sleep command of some array elements.

A TRX\_CONTROL command that simultaneously wakes up some array elements and puts others to sleep could be problematic for sleep modes other than sleepMode = 0: the array elements being deactivated would be deactivated immediately while the array elements being activated would have a one-or-more-slot wake-up interval, leaving a period of time when both sets of array elements are inactive.

#### Overlapping ASM and TRX\_CONTROL commands

It is possible for an O-DU to issue overlapping TRX\_CONTROL and ASM commands, but with restrictions:

1. ASM commands may be issued "on top of" an undefined-duration TRX\_CONTROL command.

EXAMPLE: O-DU turns off half an antenna array for an extended period, then issues ASM commands to turn off the whole array (or whole O-RU) for a shorter period; after that period ends the O-RU is still using half the antenna array until the TRX\_CONTROL command is terminated with a new TRX\_CONTROL command.

NOTE: A new TRX\_CONTROL command may not be issued to the O-RU during an ASM command's duration (see #3 below)

1. ASM commands may NOT be issued "on top of" a definite-duration TRX\_CONTROL command, because if a definite-duration TRX\_CONTROL command was to expire in the middle of an ASM command, processing needs to be "awake" to detect that, but the ASM command may put that processing to sleep.
2. TRX\_CONTROL commands may NOT be issued "on top of" any ASM command, because certain processing may be halted during an ASM command, so a TRX\_CONTROL command may not be able to be processed.

## Sleep extension

A beneficial operation is to extend a defined duration sleep interval without the O-RU (all or part of it) having to wake up. To allow this, the O-RU's C-Plane functionality shall be active for the slot in which the wake-up interval will start. If the O-DU issues a new TRX\_CONTROL or ASM command at the start of the wake-up interval's slot, it is expected the O-RU will enter a new energy-saving condition based on the new command, without starting the wake-up process.

It is also possible for the O-DU to issue a new command sometime during the wake-up interval. This is less optimum because the wake-up process will have started but it could still save more energy than allowing the O-RU to complete the wake-up process.

A TRX\_CONTROL sleep extension command may command any number of array elements to deactivate. Hence it may occur that some array elements will "wake up" while others will have their sleep extended and yet others will be newly deactivated:

* array elements that will wake up will do so on their original schedule;
* array elements that will remain asleep will sleep for an interval starting with the slot on which the sleep extension command was received;
* array elements newly deactivated will immediately be deactivated using the commanded sleep mode;
* A sleep extension command shall use the same sleepMode value as the original sleep command or a different sleep mode with an equal or longer wake-up duration.

Sleep extension only applies to defined-duration sleep commands and for sleep modes != 0; undefined-duration commands require an explicit command to wake up and hence need no sleep extension command. A sleep extension command may itself be a defined-duration or an undefined-duration command. If it is an undefined-duration command, the parts of the O-RU that are put to sleep by the command (or kept asleep by the command) will be converted into undefined sleep.

## Impact of Shared O-RU

Because any energy-saving command may impact multiple O-RU resources, when those resources are shared among multiple O-DUs it is important that one O-DU is not impacted by sleep commands issued by a different O-DU. To minimize this problem, only the O-DU fulfilling the role of Shared O-RU Host may issue energy-saving commands (TRX\_CONTROL or ASM) that could impact other O-DUs. It is expected that the Shared O-RU Host will coordinate with other Shared Resource Operator O-DUs to ensure the impact of entering any energy-saving mode is accommodated.

If a Shared Resource Operator O-DU (not host) is assigned dedicated O-RU resources such as one or more array carriers or tx-arrays or rx-arrays, that O-DU may issue energy-saving commands (TRX\_CONTROL or ASM) that impact its exclusive resources and not impacting the resources used by any other O-DU.

## Command timing examples (informative)

Here are provided some examples of command timing. Figures 16.11-1 and 16.11-2 show cases with sleepMode = 0. Figures 16.11-3 and 16.11-4 show cases with defined sleep intervals. Figures 16.11-5 and 16.11-6 show cases with undefined sleep intervals.

Figure 16.11-1 shows a case with a defined sleep interval of 8 slots, sleepMode = 0; the bottom figure includes a second command involving a mixed symbolMask (not all zeros or all ones).

|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
|  |  | | | | | | | |  | | | | | | |

|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
|  |  | | | | | | | |  | | | | |  | |

**Figure 16.11-1: Timing diagram showing defined sleep intervals, sleepMode = 0**

Figure 16.11-2 shows a case with an undefined sleep interval (ends up being 8 slots, sleepMode = 0; the bottom figure includes a second command involving a mixed symbolMask (not all zeros or all ones).

|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
|  |  | | | | | | | |  | | | | | | |

|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
|  |  | | | | | | | |  | | | | |  | |

**Figure 16.11-2: Timing diagram showing undefined sleep intervals, sleepMode = 0**

Figure 16.11-3 shows a case with a defined sleep interval of 8 slots, sleepMode = 1, guaranteed wake-up duration of 5 slots; the bottom figure includes a second sleep extension command extending the sleep for 5 additional slots.

|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
|  |  | | |  | | | | |  | | | | | | |

|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
|  |  | | |  | | | | |  | | | | |  | |

NOTE: for sleepMode!=0, symbolMask is either 0 or 0x3FFF

**Figure 16.11-3: Timing diagram showing defined sleep intervals, guaranteed wake-up durations**

Figure 16.11-4 shows a case with a defined sleep interval of 8 slots, sleepMode = 1, minimum wake-up duration of 5 slots and the sleep time is not lengthened; the bottom figure includes a second sleep extension command extending the sleep for 5 additional slots but the extension takes two slots longer.

|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
|  |  | | |  | | | | |  | | | | | | |

|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
|  |  | | |  | | | | |  | | | | |  | |
|  | | | | | | | | |  | | | | | | |

NOTE: for sleepMode!=0, symbolMask is either 0 or 0x3FFF

**Figure 16.11-4: Timing diagram showing defined sleep intervals, minimum wake-up durations**

Figure 16.11-5 shows a case with an undefined sleep interval (ends up being 12 slots), sleepMode = 1, guaranteed wake-up duration of 5 slots; the bottom figure includes a second sleep command at slot #3 with a new sleep mode having a longer wake-up duration of 8 slots.

|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
|  |  | | | | | | |  | | | | |  | | |

|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
|  |  | |  | | |  | | | | | | | |  | |

NOTE: for sleepMode!=0, symbolMask is either 0 or 0x3FFF

**Figure 16.11-5: Timing diagram showing undefined sleep intervals, guaranteed wake-up durations**

Figure 16.11-6 shows a case with an undefined sleep interval (ends up being 12 slots), sleepMode = 1, minimum wake- up duration of 5 slots which is not lengthened; the bottom figure shows the same situation but with the wake-up duration lengthened by 3 extra slots, perhaps because the O-RU took longer than usual to warm up after being asleep.

|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
|  |  | | | | | | |  | | | | |  | | |

|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
|  |  | | | | | | |  | | | | |  | | |
|  | | | | | | | |  | | | | | | | |

NOTE: for sleepMode!=0, symbolMask is either 0 or 0x3FFF

**Figure 16.11-6: Timing diagram showing undefined sleep intervals, minimum wake-up durations**

## Emergency wake-up

For defined-duration sleep, the O-DU has made a promise to the O-RU that it may be able to sleep for a defined period of time. It may be necessary for the O-DU to break that promise in certain conditions.

Therefore, an M-Plane command may be issued by the O-DU to abort the current sleep mode and put the O-RU in fully-active condition, with all TRXs active. Even with this "emergency wake-up" M-Plane command, the O-RU will still need some period of time to wake up and operate properly. Therefore, an M-Plane notification shall be issued by the O-RU to the O-DU when it is fully operational, after which the O-DU may activate new carriers (if needed) and then operate the C-Plane and U-Plane to support user traffic. Prior to that M-Plane notification the O-DU should not be using the C-Plane or U-Plane so synchronization of the M-Plane notification with U/C-Plane operations is not a problem.

In the case of Shared O-RU, only the Shared O-RU Host is able to issue the emergency wake-up M-Plane command. However, all O-DUs will receive the O-RU's M-Plane notification that it is fully operational.

## Energy-saving functionality error handling

This clause addresses the handling of a few common error conditions that may arise when using the energy-saving Section Type 4 commands TRX\_CONTROL and ASM.

When some O-RU resource has been disabled (put to sleep) it is possible the O-DU may issue a C-Plane or U-Plane command pertaining to the put-to-sleep resource. The O-RU's reaction to that unexpected C-Plane command is not defined, but it is recommended that such a C-Plane command be discarded by the O-RU. In such a case, if ACK/NACK is used then NACK shall be issued.

NOTE: C-Plane commands pertaining to a put-to-sleep resource may be processed during the slots associated with that resource's wake-up interval e.g. a sleep extension command; such commands are not "unexpected" so should be processed properly.

During slots included in a defined-duration sleep interval, excluding slots that include any part of the wake-up interval, C-Plane message processing may be halted in the O-RU to save energy. If the O-DU issues a C-Plane command at a time when C-Plane message processing in the O-RU may be halted, the O-RU's reaction to that unexpected C-Plane command is not defined, but it is recommended that such a C-Plane command be discarded by the O-RU. If ACK/NACK is used then NACK may be issued, or it would not be issued if the O-RU's C-Plane processing is turned off so that the command is not even detected.

During any sleep interval, it is possible the O-DU could issue an unexpected U-Plane message to the O-RU. If this happens, the O-RU's reaction to that unexpected U-Plane command is not defined, but it is recommended that such a U- Plane command be discarded by the O-RU.

NOTE: U-Plane messages involving active antenna array elements are considered to be "expected" U-Plane messages hence not an error condition.

It is possible a TRX\_CONTROL command would include an antenna mask that has not been reported by the O-RU as a valid antenna mask. In such a case, the TRX\_CONTROL command shall be discarded and if ACK/NACK is used then NACK shall be issued.

It is possible that a TRX\_CONTROL or ASM command may change the sleep mode from a long wake-up duration to a shorter wake-up duration, which is prohibited because it could "cheat" the wake-up duration by implying a shorter wake-up duration could be possible than is actually possible. In this case, the O-RU's reaction to that unexpected C- Plane command is not defined, but it is recommended that such a C-Plane command be discarded by the O-RU. If ACK/NACK is used then NACK shall be issued.

It is possible an O-RU could issue a "ready" message prior to the minimum wake-up duration, which would be erroneous. If this happens, the O-DU's reaction is not defined but it is recommended the O-DU wait until the minimum wake-up duration expires and then consider the O-RU as "woken up", ready to process C-Plane and U-Plane commands.

It is possible that a TRX\_CONTROL or ASM command would include a sleep duration less than the wake-up duration associated with the commanded sleep mode. Alternatively, the command may invoke an unsupported sleep mode or other unsupported capability. Alternatively, the command may be invalid due to being issued while a different sleep command is in force and not able to be overridden. In such cases, if ACK/NACK is used then NACK shall be issued; in any case the TRX\_CONTROL or ASM command shall be discarded.

It is possible that a ST 8 "ready" message could be dropped between the O-RU and O-DU, meaning the O-DU could not receive the "ready" message hence not know the O-RU has achieved an awake condition. The O-DU is aware when a wake-up command is subject to a "minimum" wake-up time meaning the O-DU is aware a "ready" message is expected. Whenever an expected message could be dropped, the O-DU should employ a timeout mechanism to ensure a dropped message does not result in a long-term compromised operation. The O-DU's reaction to a timeout waiting for a "ready" message is not defined.

In cases where a command is discarded, the appropriate PM counter(s) shall be incremented.

# Annex A (normative):

Compression methods

## Block floating point compression

#### Overview

The compressed data representation shall be as follows. For each PRB, In-phase (I) and Quadrature (Q) samples shall be converted to floating point format. The samples shall be represented as signed mantissa and a shared exponent (see Figure A.1.1-1). The compression procedure receives 12 subcarriers with 24 uncompressed I and Q samples. The I and Q samples shall be subsequently compressed to a signed, fixed bitwidth integer mantissa and 4-bit unsigned integer exponent. Further, the exponent shall be included for each compression block to be sent per PRB (see Figure A.1.1-2).

NOTE: Mantissa bitwidths are specified in the compHdr field of the relevant U-Plane or C-Plane message (range 1-16 bitwidth). O-RU support for particular mantissa bitwidths is to be defined on individual basis, see Table 10.2-1.

![compression](../assets/images/253bfceb3b53.jpg)

**Figure A.1.1-1: Block Floating Point Compression data representation**

![compression 2](../assets/images/746de518fa67.jpg)

**Figure A.1.1-2: Block Floating Point Compression process overview**

#### Block floating point compression algorithm

The following pseudo code depicts an example implementation of the compression algorithm. Inputs:

* fPRB - Original physical resource block (PRB), 12 complex resource elements with "native" word length of the implementation e.g. 24 bits (UL should use as accurate value as possible from FFT & beamforming).
* iqWidth - Word length after compression (includes sign bit). Outputs:
* cPRB - Compressed PRB, 12 complex resource elements with word length iqWidth.
* exponent - Common exponent for compressed PRB.

// Find max and min

*maxV* = max(Re(fPRB), Im(fPRB)), *minV* = min(Re(fPRB), Im(fPRB))

// Determine max absolute value

*maxValue* = max(*maxV*, |*minV|*-1) /\* msb of negative value can be one higher \*/

// Calculate exponent

*rawExp* = [floor(log2(*maxValue*) +1)] /\* msb of *maxValue* \*/

// Calculate shift value and limit to positive

*exponent* = max(*rawExp* - iqWidth + 1, 0)

// Determine right shift value

*scaler* = 2-exponent

For iRe = 1:length(fPRB)

// Scale and round, mult. may be bit-shift, Quantize may be or-round

*Re(*cPRB(iRE)) = Quantize (*scaler* x Re(fPRB(iRE)))

*Im(*cPRB(iRE)) = Quantize (*scaler* x Im(fPRB(iRE)))

End

#### Block floating point decompression algorithm

The following pseudo code depicts an example implementation of the decompression algorithm. Inputs:

* cPRB - Compressed PRB, 12 complex resource elements with word length WL.
* exponent - Common exponent for compressed PRB. Outputs:
* fPRB - Decompressed physical resource block (PRB), 12 complex resource elements with "native" word length for further processing. For example, 24 bits or 32 bits.

//Determine scaler

*scaler* = 2exponent

For iRe = 1:length(cPRB)

//Scale, this may be replaced with a bit-shift operation

*Re(*fPRB(iRE)) = *scaler* x Re(cPRB(iRE))

*Im(*fPRB(iRE)) = *scaler* x Im(cPRB(iRE)) End

## Block scaling compression

#### Overview

A block scaling algorithm is specified, which is similar in concept to the block floating point representation, except that instead of data being represented by mantissa values and exponent shared within the block, data is instead represented by post-scaled values and a multiplicative scale value shared within the block. The data block size for block scaling compression shall be a single PRB, same as for the block floating point representation. Figure A.2.1-1 shows the algorithm in principle (assuming an 8-bit scaler value).

![A screenshot of a cell phone  Description automatically generated](../assets/images/5a27cbaba67e.png)

**Figure A.2.1-1: Block scaling compression process diagram**

#### Block scaling compression algorithm

The following pseudo code depicts an example implementation of the compression algorithm. Inputs:

* fPRB - Original physical resource block (PRB), 12 complex resource elements with "native" word length of the implementation e.g. 16-bits I + 16-bits Q is assumed in this definition.
* iqWidth - Word length after compression (includes sign bit). Outputs:
* cPRB - Compressed PRB, 12 complex resource elements with word length iqWidth
* sblockScaler - Common scaler for compressed PRB.

// Find max and min of resource element real and imaginary parts maxV = max(max(real(fPRB)), max(imag(fPRB)));

minV = min(min(real(fPRB)), min(imag(fPRB)));

// Determine maximum absolute value, which will be 15-bits

maxValue = max(maxV, abs(minV)-1); // Negative values offset by 1 to fit 15-bits

// Map sBlockScaler to 8-bits

sblockScaler = ceil(maxValue/2^8); // Q1.7, 0->128 represents 0->1.000

// Calculate inverse of sBlockScaler - this can be implemented as a look-up table if(sblockScaler==0)

sBlockScaler = 1; // Trap divide by zero end

inverseBlockScaler = 2^7/sblockScaler; // Scaled 128->1

// Max output value, used for saturating compressed samples to iqWidth qs = 2^(iqWidth-1);

// Scale each RE. Scaling assumes 16-bit uncompressed data width. for iRe =1:length(fPRB)

cRe\_re = round(inverseBlockScaler \* real(fPRB(iRe)) / 2^(16-iqWidth)); // Scale real part cRe\_re = min(max(cRe\_re, -qs), qs-1); // Saturate

cRe\_im = round(inverseBlockScaler \* imag(fPRB(iRe)) / 2^(16-iqWidth)); // Scale imaginary part cRe\_im = min(max(cRe\_im, -qs), qs-1); // Saturate

cPRB(iRe) = complex(cRe\_re, cRe\_im); // Complex output value end

#### Block scaling decompression algorithm

The following pseudo-code depicts an example implementation of the block scaling decompression algorithm. Inputs:

* cPRB - Compressed PRB, 12 complex resource elements with word length iqWidth.
* blockScaler - Common scaler for compressed PRB. Outputs:
* fPRB - Decompressed physical resource block (PRB), 12 complex resource elements with "native" word length for further processing. For example, 16-bits I + 16-bits Q is assumed in this definition.

// Re-scale each resource element back to 16-bit uncompressed width for iRe = 1:length(cPRB)

fRe\_re = round(sblockScaler \* real(cPRB(iRe)) / 2^(iqWidth-9)); fRe\_im = round(sblockScaler \* imag(cPRB(iRe)) / 2^(iqWidth-9));

fPRB(iRe) = complex(fRe\_re, fRe\_im); // Complex output value end

## ?-Law compression

#### ?-Law compression algorithm

Inputs:

* prbI & prbQ - Original physical resource block (PRB), 12 complex resource elements with a word length of 16-bits I and 16-bits Q. The input bit width is fixed to 16-bits.
* compBitWidth - the length of I bits and the length of Q bits after compression over the entire PRB. Outputs:
* compI & compQ - compressed PRB, 12 complex resource elements with word length compBitWidth, including sign, exponent and mantissa.
* compShift - the shift applied to the entire PRB.

The ?-law compression is a "block" compression and the block size shall be one PRB (same as for block floating point compression and block scaling compression). The O-RAN u-law compression method combines a bit shift operation (for dynamic range) with a nonlinear piece wise approximation of u-law compression. Parameters values shall be u = 8, 1 bit sign, and 2-bit mantissa. These values have been chosen for implementation efficiency.

Computations of the of u-law compression algorithm are shown in Figure A.3.1-1.

compI

absI

15

1

LUT

compShift 4

shl(absQ,compShift)

16

prbI

abs(prbI)

max(absI,absQ)

compShift

4

compBitWidth

16

sign(prbQ)

sign(prbI)

Sign recover

1

Compand

shl(absI,compShift)

Sign recover

abs(prbQ)

Compand

15

asbsQ

compQ

compBitWidth

prbQ

**Figure A.3.1-1: ?-Law compression algorithm**

The following pseudo-code depicts an example implementation of the u-law compression algorithm.

// extract the sign bit and absolute value for the PRB signI=sign(prbI), signQ=sign(prbQ), absI=abs(prbI), absQ=abs(prbQ)

// Find the maximum in absI and absQ maxVal=max(absI, absQ)

// Determine compShift, the shift to be applied to the entire PRB if maxVal>=2^14 then compShift=0

if maxVal<2^14 then compShift=1 if maxVal<2^13 then compShift=2 if maxVal<2^12 then compShift=3 if maxVal<2^11 then compShift=4 if maxVal<2^10 then compShift=5 if maxVal<2^9 then compShift=6 if maxVal<2^8 then compShift=7

// Apply round and shift left (shl - make greater) absI = shl(absI, compShift)

absQ = shl(absQ, compShift)

// compand each sample, absBitWidth=15

if absI(i) > (2^absBitWidth-1) then absI(i) = (2^absBitWidth-1) // saturate if absI(i) <= 2^(absBitWidth-2) then

compI(i) = absI(i)/2^(absBitWidth- compBitWidth ) elseif absI(i) <= 2^(absBitWidth-1) then

compI(i) = absI(i)/2^(absBitWidth- compBitWidth +1) + 2^(compBitWidth-3) else

compI(i) = absI(i)/2^(absBitWidth- compBitWidth +2) + 2^(compBitWidth-2) end

if absQ(i) > (2^absBitWidth-1) then absQ (i) = (2^absBitWidth-1) if absQ(i) <= 2^(absBitWidth-2) then

compQ(i) = absQ(i)/2^(absBitWidth- compBitWidth ) elseif absQ(i) <= 2^(absBitWidth-1) then

compQ(i) = absQ(i)/2^(absBitWidth- compBitWidth +1) + 2^(compBitWidth-3) else

compQ(i) = absQ(i)/2^(absBitWidth- compBitWidth +2) + 2^(compBitWidth-2) end

// re-apply sign

compI = round(signI .\* compI); compQ = round(signQ .\* compQ);

#### ?-Law decompression algorithm

Inputs:

* compI & compQ - compressed physical resource block (PRB), 12 complex resource elements with a word length of compBitWidth bits I and compBitWidth bits Q.
* compShift - the shift applied to the entire PRB. Outputs:
* decompI & decompQ - the decompressed PRB, 12 complex resource elements with word length fixed to 16- bits I and 16-bits Q, including sign, exponent and mantissa.

The following pseudo code provides an example implementation of ?-law decompression algorithm.

// extract the sign bit and absolute value for the PRB signI=sign(compI), signQ=sign(compQ), absI=abs(compI), absQ=abs(compQ)

// decompand each sample, absBitWidth=15

if absI(i) > (2^(compBitWidth -1)-1) then absI(i) = (2^(compBitWidth -1)-1) if absI(i) <= 2^(compBitWidth -2) then

decompI(i) = absI (i)\*2^(absBitWidth- compBitWidth)

elseif absI(i) <= (2^(compBitWidth -2) + 2^(compBitWidth -3)) then decompI(i) = absI(i)\*2^(absBitWidth- compBitWidth +1) - 2^13

else

decompI(i) = absI(i)\*2^(absBitWidth- compBitWidth +2) - 2^15 end

if absQ(i) > (2^(compBitWidth -1)-1) then absQ(i) = (2^(compBitWidth -1)-1)

if absQ(i) <= 2^(compBitWidth -2) then

decompQ(i) = absQ(i) \* 2^(absBitWidth- compBitWidth)

elseif absQ(i) <= (2^(compBitWidth -2) + 2^(compBitWidth -3)) then decompQ(i) = absQ(i) \* 2^(absBitWidth- compBitWidth +1) - 2^13

else

decompQ(i) = absQ(i) \* 2^(absBitWidth- compBitWidth +2) - 2^15 end;

// Apply sign and shift decompI = signI .\* decompI decompQ = signQ .\* decompQ decompI = decompI/2^compShift decompQ = decompQ/2^compShift

#### ?-law udCompParam and IQ data format

PRB fields (see clause 8.3.3) are populated as follows:

* udCompParam (8 bits)
  + compBitWidth, 4 bits, (MSB)
  + compShift, 4-bits, (LSB)
* IQ samples, total bits = 12x 2x compBitWidth
  + 1st sample I, compBitWidth-bits
  + 1st sample Q, compBitWidth-bits
  + 2nd sample I, compBitWidth-bits
  + 2nd sample Q, compBitWidth-bits

- ...

* + 12th sample I, compBitWidth-bits
  + 12th sample Q, compBitWidth-bits

## Beamspace compression type I and type II

#### Overview

Two types of beamspace compression methods, i.e. beamspace compression type I and beamspace compression type II are specified. The beamspace compression methods are specific to beamforming weights and are not suitable for user or control IQ data. Hence these compression methods are only used as part of the bfwCompMeth in the C-Plane. Table A.4.1-1 lists the basic characteristics of the two methods.

**Table A.4.1-1: Beamspace compression type I and II**

|  |  |  |
| --- | --- | --- |
|  | **Transformation** | **IQ value compression** |
| Beamspace compression type I | Only use 1D-DFT-based transformation | Block scaling |
| Beamspace compression type II | Linear antenna array uses 1D-DFT- based transformation and rectangular antenna array uses 2D-DFT-based transformation, according to the  antenna array configuration | Block floating point |

The pseudo codes for beamspace compression type I and beamspace compression type II are provided in clauses A.4.2 and A.4.3, respectively, as example implementations.

#### Beamspace compression type I

###### Overview

In beamspace compression type I, only 1D-DFT-based transformation is used for the transformation between antenna- space and beamspace, while block scaling compression is used to represent the IQ values of beamforming weights. In the following, the pseudo codes of the compression and decompression algorithms for beamspace compression type I are provided in following subclauses.

###### Beamspace compression algorithm

The following pseudo code depicts an example implementation of the beamspace compression type I algorithm. Inputs:

* + - * + fBV - Original beamforming vector of K complex elements. K is the number of digital antenna ports supported by the O-RU (see clause 12.5.3 and Annex J) and is communicated to the DU during startup by the OAM subsystem. Each element is a complex number with a native bitwidth, e.g. 16-bit I, and 16-bit Q. Element fBV(n) of this vector corresponds to beamforming vector element k = n-1 (see clause 12.5.4).
        + iqWidth - Word length of each I and Q value after compression (includes sign bit) Outputs:
        + cBV - Compressed beamforming coefficients
        + blockScaler - Common scaler for compressed beamforming coefficients
        + activeBeamspaceCoefficientMask - Vector of bits activeBeamspaceCoefficientMask(n) for 1 <= n <= K. Bit value activeBeamspaceCoefficientMask(n)=1 indicates presence of beamspace coefficient associated with the beamforming vector element k) n-1 (see clause 12.5.4) in the compressed beamforming vector. The bit activeBeamspaceCoefficientMask(1) is conveyed in the most significant bit of the first octet of the field bfwCompParam.

In the following example implementation, if the absolute value of a beamspace coefficient is less than 'threshold', it is deemed inactive, i.e. the activeBeamspaceCoefficientMask shall be '0' at that coefficient index and this index shall not be sent across the fronthaul. The decompression algorithm shall assume a value of 0 for that coefficient. The value of threshold may be chosen by the implementer. Other methods to determine active or inactive beamspace coefficients may also be used.

// Generate DFT basis matrix for k = 1 to K

for l = 1 to K

W(k,l) = 1/sqrt(K)\*exp(i\*2\*pi\*(k-1)\*(l-1)/(K)) // W is a KxK complex matrix end for

end for

// Transform into beamspace

cBV = W\*fBV // multiplication of a KxK complex matrix with a Kx1 complex vector yields another

//complex vector.

/\* The algorithm is initialized to assume that all Beamspace Coefficients are transmitted across the fronthaul link. \*/

for k = 1 to K activeBeamspaceCoefficientMask(k) = 1

end for

/\* At this stage some of the beamspace coefficients may be removed from the vector of coefficients to transmit across the fronthaul. \*/

t = 0

for k = 1 to K

if abs(cBV(k)) < threshold activeIndex(k) = 0

cBV(k) = null // remove the element from the vector else

activeIndex(k) = 1 t = t + 1

end if end for

T = t

// Calculate scaler

maxValue = max(abs(Re(cBV)), abs(Im(cBV)))

*blockScaler* = *maxValue /\* scaler can be chosen to be larger than maxValue. \*/*

For iRe = 1 to T

//Scale and round.

//Quantize may be truncate or round

//Inverse may be implemented via look up table or other methods *Re(*cBV(iRE)) = Quantize (Inverse(*blockScaler*) x Re(cBV(iRE))) *Im(*cBV(iRE)) = Quantize (Inverse(*blockScaler*) x Im(cBV(iRE)))

End

###### Beamspace decompression algorithm

The following pseudo-code depicts an example implementation of the block scaling decompression algorithm of beamspace compression type I.

Inputs:

* + - * + cBV - Compressed beamforming coefficients
        + blockScaler - Common scaler for compressed beamforming coefficients
        + activeBeamspaceCoefficientMask - see definition in clause A.4.2.2 Outputs:
        + fBV - Decompressed beamforming vector of K (see K in clause 12.5.3) complex elements. Element fBV(n) of this vector corresponds to beamforming vector element k = n-1 (see clause 12.5.4)

m = 0

for k = 1 to K

if activeBeamspaceCoefficientMask (k) = 1

//Scale

fBSC(k) = *blockScaler* x cBV(m) m = m + 1

else

fBSC(k) = 0

end if end for

// Generate DFT basis matrix for k = 1 to K

for l = 1 to K

W (k,l) = 1/sqrt(K)\*exp(-i\*2\*pi\*(k-1)\*(l-1)/(K)) // W is a KxK complex matrix end for

end for

fBV = W \* fBSC

#### Beamspace compression type II

###### Overview

Beamspace compression type II uses 1D-DFT or 2D-DFT based transformation configuration, depending on array configuration. In this case, different beamspace transformation configurations are used for different antenna array configurations, i.e. the number of polarization *P*, the number of rows *M,* and the number of columns *N*. The total number of antenna ports *K* = *P* x *M* x *N*. Table A.4.3.1-1 shows how transformation is configured in O-RU and O-DU based on the antenna array configuration. Further, the block floating point compression shall be used to represent the IQ values of beamforming weights. More details are provided in the pseudo codes of the compression and decompression algorithms for beamspace compression type II in following subclauses.

**Table A.4.3.1-1: type II beamspace transformation configuration**

|  |  |
| --- | --- |
| Antenna array | Transformation configuration |
| Single-polarized linear array  (*P* = 1, *M* > 1, *N* = 1 or *P* = 1, *M =* 1, *N >* 1) | Transformation based on size *K* 1D-DFT |
| Dual-polarized linear array  (*P* = 2, *M* > 1, *N* = 1 or *P* = 2, *M =* 1, *N >* 1) | Transformation based on size *K*/2 1D-DFT per polarization |
| Single-polarized rectangular planar array (*P* = 1, *M* > 1, *N >* 1) | Transformation based on size *M*x*N* 2D-DFT |
| Dual-polarized rectangular planar array (*P* = 2, *M* > 1, *N >* 1) | Transformation based on size *M*x*N* 2D-DFT per polarization |

###### Beamspace compression algorithm

The following pseudo code depicts an example reference implementation of the compression algorithm of beamspace compression type II.

Inputs:

* + - * + fBV - Original beamforming vector of K complex elements. K = P x M x N is the number of digital antenna ports comprising P polarizations, M rows of antenna ports and N columns of antenna ports in the antenna array supported by the O-RU (see clause 12.5.3 and Annex J) and is communicated to the DU during startup by the OAM subsystem. Each element is a complex number with a native bitwidth e.g. 16-bit I, and 16-bit Q. Element fBV(n) of this vector corresponds to beamforming vector element k = n-1 (see clause 12.5.4).
        + bfwIqWidth - Word length of each I and Q value after compression (includes sign bit). Outputs:
        + cBV - Compressed beamforming coefficients.
        + exponent- Exponent for compressed beamforming coefficients.
        + activeBeamspaceCoefficientMask - Vector of bits activeBeamspaceCoefficientMask(n) for 1 <= n <= K. Bit value activeBeamspaceCoefficientMask(n)=1 indicates presence of beamspace coefficient associated with the beamforming vector element k = n-1 (see clause 12.5.4) in the compressed beamforming vector. The bit activeBeamspaceCoefficientMask(1) is conveyed in the most significant bit of the first octet of the field bfwCompParam.

In the following example implementation, if the absolute value of a beamspace coefficient is less than 'threshold', it is deemed inactive, i.e. the activeBeamspaceCoefficientMask shall be '0' at that coefficient index and this index shall not be sent across the fronthaul. The decompression algorithm shall assume a value of 0 for that coefficient. The value of threshold may be chosen by the implementer. Other methods to determine active or inactive beamspace coefficients may also be used.

For details of Kronecker product of matrices see clause A.4.3.4.

// Generate two DFT basis matrices and one identity matrix according to antenna array parameters of

//P, M and N. for k = 1 to M

for l = 1 to M

Dm (k,l) = 1/sqrt(M)\*exp(i\*2\*pi\*(k-1)\*(l-1)/M) // Dm is an MxM complex matrix end for

end for

for k = 1 to N

for l = 1 to N

Dn (k,l) = 1/sqrt(N)\*exp(i\*2\*pi\*(k-1)\*(l-1)/N) // Dn is an NxN complex matrix end for

end for

for k = 1 to P

for l = 1 to P if k==l

Ip(k,l) = 1 // Ip is a PxP identity matrix else

Ip(k,l) = 0 end if

end for end for

// W is a KxK complex matrix, generated by Kronecker product of matrices Ip, Dn and Dm W = kron(kron(Ip, Dn), Dm)

// Transform from antenna-space to beamspace

cBV = W\*fBV // multiplication of a KxK complex matrix with a Kx1 complex vector yields another

//complex vector.

/\* The algorithm is initialized to assume that all Beamspace Coefficients are transmitted across the fronthaul link. \*/

for k = 1 to K activeBeamspaceCoefficientMask(k) = 1

end for

/\* At this stage some of the beamspace coefficients may be removed from the vector of coefficients to transmit across the fronthaul. \*/

t = 0

for k = 1 to K

if abs(cBV(k)) < threshold activeIndex(k) = 0

cBV(k) = null // remove the element from the vector else

end if end for T = t

activeIndex(k) = 1 t = t + 1

// Block floating point compression of beamspace coefficients

// Calculate scaler. To simplify expressions, it is assumed that abs(cBV) < 1 (equality to be

//handled by some exception)

maxValue = max(abs(Re(cBV)), abs(Im(cBV)))

// Calculate exponent and limit

raw\_exp = 1 + floor(log2(maxValue)) // less or equal to zero since maxValue < 1 MAXEXPBFW = 15 // The largest exponent, 2^4 - 1. This is a constant.

minExpBfw = 0 /\* Limit dynamic range to correspond to (MAXEXPBFW - minExpBfw) + bfwIqWidth bits of fixed-point. This could be configurable, e.g. to match 12-bit or 16-bit fixed point\*/

exponent = max(rawExp + MAXEXPBFW, minExpBfw) /\* Exponent can be chosen to be larger than this value (but not larger than maxExp), e.g. to avoid mantissa overflow after rounding \*/

// Calculate shift value and inverse scaler shiftValue = exponent - MAXEXPBFW - bfwIqWidth + 1 invScaler = 2^(-shiftValue)

for iRe = 1 to T

// Scale and round: Quantize could be truncate or round, also ensuring that mantissa values are

//within bounds, multiplication by invScaler could be bit-shift with the shiftValue. Re(cBV(iRE)) = Quantize (invScaler \* Re(cBV(iRE)))

Im(cBV(iRE)) = Quantize (invScaler \* Im(cBV(iRE))) end for

###### Beamspace decompression algorithm

The following pseudo code depicts an example implementation of the decompression algorithm of beamspace compression type II.

Inputs:

* + - * + cBV - Compressed beamforming coefficients
        + exponent - exponent for compressed beamforming coefficients
        + activeBeamspaceCoefficientMask -- see definition in clause A.4.3.2
        + bfwIqWidth - Word length of each I and Q value after compression (includes sign bit) Outputs:
        + fBV -- Decompressed beamforming vector of K (see K in clause 12.5.3) complex elements. K = P x M x N is the number of digital antenna ports comprising P polarizations, M rows of antenna ports and N columns of antenna ports. Element fBV(n) of this vector corresponds to beamforming vector element k = n-1 (see clause 12.5.4).

*MAXEXPBFW* = 15 // The largest exponent, 2^4 - 1. This is a constant.

*shiftValue* = *exponent* - *MAXEXPBFW* - *bfwIqWidth* + 1

*scaler* = 2^shiftValue *//* scale back compressed values to the proper beamforming weight range

m = 0

for k = 1 to K

if activeBeamspaceCoefficientMask (k) = 1

// Block floating point decompression of beamforming coefficients

fBSC(k) = *scaler* x cBV(m) m = m + 1

else

fBSC(k) = 0

end if end for

// Generate two DFT basis matrices and one identity matrix according to antenna array parameters of

// P, M and N. for k = 1 to M

for l = 1 to M

Dm (k,l) = 1/sqrt(M)\*exp(-i\*2\*pi\*(k-1)\*(l-1)/M) // Dm is an MxM complex matrix end for

end for

for k = 1 to N

for l = 1 to N

Dn (k,l) = 1/sqrt(N)\*exp(-i\*2\*pi\*(k-1)\*(l-1)/N) // Dn is an NxN complex matrix end for

end for

for k = 1 to P

for l = 1 to P if k==l

Ip(k,l) = 1 // Ip is a PxP identity matrix else

Ip(k,l) = 0 end if

end for end for

// W is a KxK complex matrix, generated by Kronecker product of matrices Ip, Dn and Dm. W = kron(kron(Ip, Dn), Dm)

// Transform from beamspace back to antenna-space fBV = W \* fBSC

###### Kronecker product algorithm

The Kronecker product of an L x M matrix A and an N x P matrix B is denoted as C = A ? B, where C is an (L x N) x (M x P) matrix:

C = A?B = [

a1,1B ? a1,MB

? ? ? ]

a1,LB ? aL,MB

The following pseudo code gives an example of the Kronecker product function C = kron(A, B): Inputs:

* A - an L x M matrix
* B - an N x P matrix Output:
* C - Kronecker product of matrices A and B

function C = kron(A, B) for l = 1 to L

for m = 1 to M for n = 1 to N

for p = 1 to P

C((l-1)\*N+n, (m-1)\*P+p) = A(l, m)\*B(n, p) end for

end for end for

end for

## Modulation compression

Modulation compression is an IQ data compression method that may be applied to DL data only and depends on the observation that modulated data symbols are represented by a very limited number of I and Q bits. For example, a QPSK modulated symbol has only two potential states of I and two potential states of Q, so such a symbol is representable with no loss of information with a single bit of I and a single bit of Q. Likewise, a 64QAM constellation point (8x8 constellation) is representable by at most 3 bits of I and 3 bits of Q. This allows for a reduction in DL throughput. See the two figures below for a description of this concept (Figure A.5-1 and Figure A.5-2 assume a single modulation type, MCS, is used for the data section).

**BPSK (normal, ?/4, ?/2)**

**encodes 1 user bit**

X

-1/2

X

1/2

I is represented by 2 bit

Q is represented by 2 bits

(-1/2, 0, and 1/2 are needed)

modulation-compression: from 32 bits (16I and 16Q) to 4 bits (2I and 2Q)

**QPSK**

**encodes 2 user bits**

X

X

-1/2

1/2

X

X

I is represented by 1 bit

Q is represented by 1 bit

modulation-compression: from 32 bits (16I and 16Q) to 2 bits (1I and 1Q)

**16-QAM**

**encodes 4 user bits**

X

X

X

X

X

X

X

X

-3/4 -1/4 1/4 3/4

X X X X

X

X

X

X

I is represented by 2 bits

Q is represented by 2 bits

modulation-compression: from 32 bits (16I and 16Q) to 4 bits (2I and 2Q)

**64-QAM**

|  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- |
| X | X | X | X | X | X | X | X |
| X | X | X | X | X | X | X | X |
| X | X | X | X | X | X | X | X |
| X | X | X | X | X | X | X | X |
| X | X | X | X | X | X | X | X |
| X | X | X | X | X | X | X | X |
| X | X | X | X | X | X | X | X |
| X | X | X | X | X | X | X | X |

I is represented by 3 bits

**encodes 6 user bits**

Q is represented by 3 bits

modulation-compression: from 32 bits (16I and 16Q) to 6 bits (3I and 3Q)

**Figure A.5-1: Example constellation types**

To represent the constellation points as I and Q values that also overlap allowing multiple constellation sizes to be represented by a single word-width, the constellations shall be "shifted" to allow a two's-complement I and Q value to represent any constellation point. Figure A.5-2 shows the same constellations after shifting.

![](../assets/images/e1772a483513.png)

**Figure A.5-2: Shifted constellation points**

Once the constellations are shifted, the I and Q values shall be encoded in a limited number of bits, being the larger number needed to represent the largest constellation possible in the compression block (the data section). This means that if some data in the section use 64QAM and others use QPSK (e.g. a reference RE) all REs would use the largest needed representation which in this example is 3 bits for I and 3 bits for Q (for 64QAM). This spoils the compression efficiency a little bit but because reference REs are a small fraction of the total number of REs, the efficiency degradation is small (there is further clarification below regarding mixing MCS in a data section). In general, every user has its own data section (and own beamforming index), so users with high-order modulation need and use more bits of I and Q while users with lower-order modulation need and use fewer bits of I and Q.

Some constellations need not be shifted. For example, BPSK needs I and Q data to take the values -1/2, zero, and +1/2 (different varieties of BPSK rotate these as with ?/4 BPSK and ?/2 BPSK). For this reason, BPSK would use two bits for I and 2 bits for Q; while this seems counterintuitive (BPSK using more bits than QPSK) this is a small penalty given the rarity of BPSK as a modulation type. Here, BPSK shall not be shifted. Likewise, PHICH constellations encode 3 states for each I and Q: -1, zero and 1. For this constellation the representation shall be -1/2, 0 and 1/2 with no constellation shift needed. However, constellations of all QAM modulations shall be shifted (except in mixed-MCS cases). Applied constellation shift shall be indicated by the "csf" field, where for every bit set (=1) in the reMask "csf" indicates whether to shift (csf=1) or not (csf=0) the associated RE.

Mixed-MCS cases represent another example when constellations shall not be shifted. This occurs when user data REs (at high MCS) and signalling data REs (at low MCS) are in the same PRB - hence in the same data section. The reMask discriminates the REs at high MCS from the REs at the lower MCS (and provides different modCompScaler or mcScaleOffset values for the different-MCS data), but all the REs in the PRB shall use the same number of I and Q bit- widths. In this case only the high-MCS constellation shall be shifted, the lower-MCS constellation shall not be shifted, because its data points already overlap with the shifted high-MCS data points. Figure A.5-3 shows an example of 16QAM data overlain with 64QAM data.

![NOK-2020.10.19-WG4-I-modComp-mixed-MCS-clarification-v1.pptx - PowerPoint](../assets/images/70c3a61a5be0.jpg)

**Figure A.5-3: Multiple-MCS example for modulation compression**

In the Figure A.5-3 example, for overlain 16QAM (green) and 64QAM (red), the high-MCS (red) points are shifted by 1/2 the high-MCS resolution (here, -1/8) to allow all points to share the same "grid", as shown in the middle subfigure, wherein the red and green points overlay. All I and Q values in the given example are represented by 3 bits each on the fronthaul interface.

The O-DU shall use the constellation shift flag (csf) to tell the O-RU which data (red points) to "unshift" by adding 1/8 to them, thereby restoring the original constellation values. After that, modCompScaler (or mcScaleOffset) shall be applied to set the data to the correct power levels (separate modCompScaler or mcScaleOffset values may be used for the differing MCS data).

When decompressing, the O-RU shall "unshift" the constellation depending on "csf" value and apply a scale factor for the constellation types represented in the section. There shall be either one or two modulation types in one section. The modulation type shall be inferred from the reMask bits, where each "one" bit indicates the shift command ("csf") and scale factor ("modCompScaler" when using Section Extension 4, and "mcScaleOffset" when using Section Extension 5) for the REs in the subject PRB. The scale factor allows not only for correcting for different constellation scaling (e.g. for multiplexed channel data in a PRB including QPSK and 16QAM, QPSK involves a 2/?2 factor while 16QAM involves a 4/?10 factor), but also allows for different channel power scaling which is permitted as a 3GPP option.

NOTE: Modulation compression method is essentially lossless, except that the scale factors, being 15 bits, impose a limit on the accuracy of representation. 15 bits is considered sufficient for all LTE and NR data representations.

When compressing, constellation points shall be shifted by the shift value defined in Table 7.7.4.2-1, and the I and Q values shall be represented as signed two's complement fractional notation and included in the U-Plane message as udIqWidth bit vectors, where udIqWidth is dependent on the modulation constellation type and is defined in Table 7.7.4.2-1.

The following pseudo code depicts an example implementation of the modulation decompression algorithm:

1. Read iqSample as an udIqWidth bit vector in the U-Plane message [this is all the IQ data in the data section]
2. Map iqSample [0,2udIqWidth - 1] to iqSampleFx [-1,1) assuming that the udIqWidth bits are represented as Q1.(udIqWidth-1) [this is the normal twos-complement representation of the I and Q samples represented in fractional notation].
3. For each RE in the PRB (applicable if Section Extension 4 is used):
   1. fetch the *"csf"* and *"modCompScaler"* values for which this RE has a "1" in the reMask
   2. If "csf" == 1 then iqSampleFx = iqSampleFx + 2-udIqWidth [this is "unshifting" the constellation point].
   3. iqSampleScaled = "modCompScaler" x iqSampleFx x ?2 [this scales the constellation point]
4. For each RE in the PRB (applicable if Section Extension 5 is used):
   1. fetch the *"csf"* and *"mcScaleOffset"* values for which this RE has a "1" in the relevant mcScaleReMask
   2. If "csf" == 1 then iqSampleFx = iqSampleFx + 2-udIqWidth [this is "unshifting" the constellation point].
   3. iqSampleScaled = "mcScaleOffset" x iqSampleFx x ?2 [this scales the constellation point] After decompression, | *iqSampleScaled* | shall be <= 1 and a value of | *iqSampleScaled* | = 1.0 matches 0 dBFS.

## Selective RE sending

Selective RE sending may be used together with either block floating point compression (see clause A.1) or modulation compression (see clause A.5). The compression algorithm shall be performed on all 12 IQ-samples in the PRB, including any possible zero valued IQ-samples.

For each uncompressed IQ-sample where both the I- and the Q-value are 0, corresponding bit shall be set to 0b in the Selective RE sending bitmask (sReSMask) and the corresponding compressed IQ-sample shall not be transmitted over the interface in the U-Plane message. Remaining bits in sReSMask shall be set to 1b, see clause 8.3.3.18.

If the total number of bits for the transmitted IQ-samples is not a multiple of 8 (1 byte), then bit-padding shall be performed per PRB after the last part of the last IQ-samples of the corresponding PRB so that each set of U-Plane PRB data or new U-Plane data section shall be byte aligned. When Selective RE method 1000b "Mod-compr + selective RE sending with masks in section header" (see Table 8.3.3.13-3) is used the bit-padding shall not be performed between PRBs within the section but it shall be applied after the last PRB in the section (i.e. before the next section) if needed to ensure that each U-Plane data section is byte aligned.

Figure A.6-1 illustrates an example where 9 out of the 12 IQ-samples in a PRB are zero and thus not sent in the corresponding U-Plane message.

Uncompressed bit-width signed

![](../assets/images/7f9f837dc5be.png)

|  |  |
| --- | --- |
| I1 | Q1 |
| I2 | Q2 |
| I3 | Q3 |
| I4 | Q4 |
| I5 | Q5 |
| I6 | Q6 |
| I7 | Q7 |
| I8 | Q8 |
| I9 | Q9 |
| I10 | Q10 |
| I11 | Q11 |
| I12 | Q12 |

One of:

12 Samples

* ![](../assets/images/59a64490758f.png)Block Floating Point
* Modulation compression

12 Samples

Compressed samples

|  |  |  |
| --- | --- | --- |
| I1 | Q1 |  |
| I2 | Q2 |
| I3 | Q3 |
| I4 | Q4 |
| I5 | Q5 |
| I6 | Q6 |
| I7 | Q7 |
| I8 | Q8 |
| I9 | Q9 |
| I10 | Q10 |
| I11 | Q11 |
| I12 | Q12 | udCompParam |

![](../assets/images/ddce1edb5f2d.png)Zero valued IQ samples removed

3 Samples

udCompParam

Q10

I10

Selective RE Sending Mask

Q6

I6

Q2

I2

**Figure A.6-1: Example of selective RE sending**

# Annex B (informative):

Delay management use cases

## Introduction

Intra-PHY lower layer fronthaul split has characteristic of a stringent bandwidth and tight latency requirement. This implies use of a special "Fronthaul Service Profile" to be supported by the transport network, and which may differ depending on the operating environment, topology and target use cases. The general concept and latency boundaries is based on eCPRI reference points for delay management definitions (See Figure B.1-1). However, the present document additionally differentiates between DL (See Figure B.1-2) and UL (See Figure B.1-3) latency boundaries. The parameters and how these are determined for a pre-defined latency configuration are explained below (an actual example of the parameters for a specific use case are presented in Annex B.2). Pre-defined latency is necessary when actual latency measurements are not provided; both the use of pre-defined latency value and use of a method for measuring actual network latency in the DL and UL are supported in the present document.

The following assumptions are considered for the delay boundaries definitions:

* + - Tcp\_adv\_dl: Smallest time advance to receive Downlink Data C-Plane message before the first IQ data can be processed
    - The fronthaul transmission delay behaviour for C-Plane for DL data, C-Plane for UL data, and U-Plane for DL data is equal. Thus, there is common usage of T12\_min and T12\_max parameters.
    - The transmission window (T1a\_max - T1a\_min) for C-Plane for DL data, C-Plane for UL data, and U-Plane for DL data all have the same length.
    - The reception window (T2a\_max - T2a\_min) for C-Plane for DL data, C-Plane for UL data, and U-Plane for DL data all have the same length.
    - T2a\_min\_cp\_ul: Latest availability at O-RU of C-Plane for UL data message before reception of the first IQ data sample of the respective user's U-Plane UL data packet is received over the air interface.

![](../assets/images/e45dc073c0f0.jpg)

O-DU

O-RU

**Figure B.1-1: Definition of reference points for delay management (adapted from [2])**

**t=-T1a\_max\_cp\_dl**

start of Tx window C-Plane DL

**t=-T1a\_min\_cp\_dl**

end of Tx window C-Plane DL

tDL=0

![](../assets/images/b3f73e6e6670.png)

F

**t=-T1a\_max\_up start of Tx window**

Transmission

Window

C-Plane DL

**t=-T1a\_min\_up end of Tx window**

**Transmission**

**Window**

C-Plane data **u-plane dl**

for symbol #n

**t=-T2a\_min\_cp\_dl (end of RX window C-Plane DL)**

**t=-T2a\_min\_up**

**end of Rx window u-plane dl**

IQ data for

Symbol #n **DL FH Delay DL FH Delay T12\_max**

**min DL**

**FH Delay T12\_min**

**T12\_max**

**T2a\_min\_up**

**Reception window u-plane dl**

**t=-T2a\_max\_up**

**Start of Rx window u-plane**

**T2a\_min\_cp\_dl**

**min DL**

**FH Delay T12\_min**

Reception window C-Plane DL

...

**t=-T2a\_max\_cp\_dl**

Symbol #n+1

Symbol #n

Symbol #n-1

Symbol #n-2

Symbol #n Processing

Symbol #n+1 Processing

c

u

c

u

![](../assets/images/1fe59dfb0f32.png)![](../assets/images/4f0cccd38ddc.png)

Ant Port

|  |  |
| --- | --- |
| O- DU | |
| H |  |
| O- RU | |

...

start of Rx window C-Plane DL

...

**DL frame timing at antenna ports (air interface)**

**Figure B.1-2: Timing relations per symbol IQ in DL direction (U-Plane and C-Plane)**

Figure B.1-2 is based on the eCPRI delay measurement model on timing relations in DL direction. More detail is added to illustrate the following data transfer timing relations:

* + - U-Plane DL data: Blue path
    - C-Plane for DL data: Green path

To understand this timing diagram, it is easier to work backward in timeline. For U-Plane DL data flow (use symbol #0 transmission as an example):

* + - t = 0: time of transmission (at air interface) of the first sample for symbol #0 (see tDL = 0)
    - t = - T2a\_min\_up: O-RU has a fixed data processing delay (T2a\_min\_up). In order to meet air interface time for symbol#0 transmission at t = 0, symbol#0 data is presented on time for the processing unit (yellow block).
      * For symbol#0, start of processing time t = (0 - T2a\_min\_up) = - T2a\_min\_up
    - End of reception window: The latest time that O-RU can accept U-Plane DL data for a specific symbol prior to start of data processing. If U-Plane DL data arrives earlier than this time and is within reception window range, DL data may wait inside reception window buffer until the start of processing time, hence - the end of reception window is the same time point as the start of processing time as described immediately above.
      * For symbol#0, end of reception window time t = (0 - T2a\_min\_up) = - T2a\_min\_up.
    - Start of reception window: This earliest time that O-RU can accept U-Plane DL data for a specific symbol prior to start of data processing. If U-Plane DL data arrives later than this time and is within reception window range, DL data will wait inside reception window buffer.
      * For symbol#0, start of reception window time t = (0 - T2a\_max\_up) = - T2a\_max\_up
    - O-RU reception window range = T2a\_max\_up - T2a\_min\_up
    - End of transmission window: The latest time that O-DU can send U-Plane DL data for a specific symbol out to transport interface.
      * For symbol#0, end of transmission window time t = (0 - T1a\_min\_up) = - T1a\_min\_up.
    - Start of transmission window: The earliest time that O-DU can send U-Plane DL for a specific symbol out to transport interface.
      * For symbol#0, start of transmission window time t = (0 - T1a\_max\_up) = - T1a\_max\_up.
    - O-DU transmission window range = (T1a\_max\_up - T1a\_min\_up)
    - DL FH transport delay: T12\_min and T12\_max is the min and max transport delay. When FH transport is behaving properly, it should guarantee each packet transport (carrying C-Plane or U-Plane DL packet) delay is within this min and max boundary.
    - O-DU transmission window, FH transport delay and O-RU reception window satisfy the following criteria for proper behaviour:
      * Start of reception window can accept a packet sent at start of transmission window AND experienced min FH transport delay
        + - T2a\_max\_up < (-T1a\_max\_up + T12\_min)
      * End of reception window can accept a packet sent at end of transmission window AND experienced max FH transport delay
        + - T2a\_min\_up > (-T1a\_min\_up + T12\_max)
      * Combining both criteria, the logical conclusion is as follows:
        + **O-RU reception window range > (O-DU transmission window + FH DL transport max-min)**
        + **(T2a\_max\_up - T2a\_min\_up) > ((T1a\_max\_up - T1a\_min\_up) + (T12\_max - T12\_min))**

In other words, the reception window at O-RU is greater than or equal to the total of the O-DU transmission variability and the Transport time variability.

For C-Plane to support DL data flow (use symbol #n = 0 transmission as an example):

* + - Focus on the green path, same principle is applied to relate reception window, transmission window and FH transport delay.
    - The logical conclusion is as follows:
      * **Reception window range > (Transmission window + FH DL transport max-min)**
      * **(T2a\_max\_cp\_dl - T2a\_min\_cp\_dl) > ((T1a\_max\_cp\_dl - T1a\_min\_cp\_dl) + (T12\_max - T12\_min))**

|  |  |  |  |
| --- | --- | --- | --- |
| Symbol #n-2 | Symbol #n-1 | Symbol #n | Symbol #n+1 |

**Figure B.1-3: Timing relations per symbol IQ in UL direction (U-Plane and C-Plane)**

![](../assets/images/077a7b8bf132.png)

**c**

#n

**c**

Symbol #n+1 Processing

Symbol #n Processing

O- RU

Reception Window C-Plane UL

c-plane data for symbol #n

O- DU

Transmission Window

C-Plane UL

tUL=0

Figure B.1-3 is based on the eCPRI delay measurement model on timing relations in UL direction. More detail is added to illustrate the following data transfer timing relations:

* + - U-Plane UL data: Blue path.
    - C-Plane for UL data: Green path.

To understand this timing diagram, it is easier to work forward in timeline for the U-Plane UL data and work backward in timeline for the C-Plane to support UL data flow. This example is applicable for non-PRACH channel.

For U-Plane UL data flow (use symbol #n = 0 reception as an example):

* + - t = 0: time of reception (at air interface) of the first sample for symbol #0 (see tUL = 0).
    - t = (0 + Ta3\_min\_up): O-RU has a fixed data processing delay (Ta3\_min\_up). Air interface data is immediately presented to data processing unit (yellow block).
      * For symbol#0, end of processing = 0 + Ta3\_min\_up = Ta3\_min\_up
    - Start of transmission window: The earliest time that O-RU can send U-Plane UL for a specific symbol out to transport interface. The earliest time is immediately after data processing.
      * For symbol#0, start of transmission window = (0 + Ta3\_min\_up = Ta3\_min\_up).
    - End of transmission window: The latest time that O-RU can send U-Plane UL data for a specific symbol out to transport interface.
      * For symbol#0, end of transmission window = (0 + Ta3\_max\_up = Ta3\_max\_up).
    - O-RU transmission window range = (Ta3\_max\_up - Ta3\_min\_up)
    - Start of Reception window: This earliest time that O-DU can accept U-Plane UL data for a specific symbol prior to start of O-DU data processing. If U-Plane DL data arrives later than this time and is within reception window range, UL data will wait inside reception window buffer.
      * For symbol#0, start of reception window = (0 + Ta4\_min) = Ta4\_min
    - End of Reception window: The latest time that O-DU can accept U-Plane UL data for a specific symbol prior to start of O-DU data processing.
      * For symbol#0, end of reception window = (0 + Ta4\_max) = Ta4\_max.
    - O-DU reception window range = (Ta4\_max - Ta4\_min)
    - UL FH Transport delay: T34\_min and T34\_max is the min and max transport delay. When FH transport is behaving properly, it should guarantee each packet transport (carrying U-Plane UL packet) delay is within this min and max boundary.
    - Transmission window, FH transport delay and reception window satisfies the following criteria for proper behaviour:
      * Start of reception window can accept a packet sent at start of transmission window AND experienced min FH transport delay:
        + Ta4\_min < (Ta3\_min\_up + T34\_min)
      * End of reception window can accept a packet sent at end of transmission window AND experienced max FH transport delay:
        + Ta4\_max > (Ta3\_max\_up + T34\_max)
      * Combining both criteria, the logical conclusion is as follows:
        + **O-DU reception window range > (O-RU transmission window + FH UL transport max-min)**
        + **(Ta4\_max - Ta4\_min) > ((Ta3\_max\_up - Ta3\_min\_up) + (T34\_max - T34\_min))**

In other words, the reception window at O-DU is greater than or equal to the total of the O-RU transmission variability and the Transport time variability.

For C-Plane to support UL data flow (use symbol #0 transmission as an example):

* + - Focus on the green path, same principle to C-Plane to support DL data is applied to relate reception window, transmission window and FH transport delay.
    - the logical conclusion is as follows:
      * **Reception window range > (Transmission window + FH transport min-max difference)**
      * **(T2a\_max\_cp\_ul - T2a\_min\_cp\_ul) > ((T1a\_max\_cp\_ul - T1a\_min\_cp\_ul) + (T12\_max - T12\_min))**

It is useful to consider several different delay management use cases because delay management, in particular the need to buffer large amounts of data within O-RUs, can have a significant cost and complexity impact on O-RU design. More specifically, accommodating long network delays (allowing long fibre lengths and/or many switch hops) can impose a significant buffering requirement on the O-RU while use cases involving short network delays e.g. an in-building application may allow much smaller in-O-RU buffering thereby allowing a lower-cost and lower-power design.

Additionally, the SCS may affect the transmission windows described above, and thus use cases may be SCS specific as well. Here it is assumed the DL buffering will be done in the O-RU, otherwise the O-DU would have to always implement extensive buffering to accommodate any O-RU use case which would increase overall costs.

In the case of using pre-defined network latency values per use case, the following is pre-defined (for measured- network-latency cases these same values are determined via the measurement process):

* + - T12\_min, T12\_max, T34\_min and T34\_max are determined based on the desired network configuration. Determination of T12\_min and T34\_min values includes transmission paths, both fibre and minimum switching delays. In addition, longest fibres, switching delays, and PDV introduced due to the variable delay nature of ethernet is accounted for in T12\_max and T34\_max.
    - T2a\_min\_up, T2a\_min\_cp\_ul, and Ta3\_min are determined across all O-RU equipment to be used in the system. The determined values are greater than or equal to the largest of these values across all supported equipment. Equipment with lower values need to have additional delay added to align with the determined values.

Similarly, the maximum transmission windows is determined across all O-DU and O-RU equipment. The transmission windows for DL UP, DL CP and UL CP are all assumed to be the same. However, this is the maximum transmission window. Equipment may use less time for transmission of any symbol.

Additionally, the advance between DL UP/ CP are determined. (Tcp\_adv\_dl)

Once the above parameters are determined, the remaining values are calculated as shown in the following Table B.1-1 through B.1-4:

**Downlink Data Direction**

**Table** **B.1-1: U-Plane DL delay boundaries**

|  |  |
| --- | --- |
| **Downlink** | **Method** |
| T1a\_max\_up | <= (T12\_min + T2a\_max\_up) |
| T1a\_min\_up | >= (T12\_max + T2a\_min\_up) |
| T2a\_max\_up | >= (T2a\_min\_up + (T12\_max - T12\_min) + O-DU Transmission Window) |
| T2a\_min\_up | Specified per Use Case |
| T12\_max | Specified per Use Case |
| T12\_min | Specified per Use Case |
| O-DU Transmission Window | Specified per Use Case |

**Table B.1-2: C-Plane DL delay boundaries**

|  |  |
| --- | --- |
| **Downlink** | **Method** |
| Tcp\_adv\_dl | Specified per Use Case |
| T1a\_max\_cp\_dl | >= (T1a\_max\_up + Tcp\_adv\_dl) |
| T1a\_min\_cp\_dl | (T1a\_min\_up + Tcp\_adv\_dl) |
| T2a\_max\_cp\_dl | >= (T2a\_max\_up + Tcp\_adv\_dl) |
| T2a\_min\_cp\_dl | (T2a\_min\_up + Tcp\_adv\_dl) |
| T12\_max | Same as U-Plane DL |
| T12\_min | Same as U-Plane DL |

**Uplink Data Direction** (need not be the same as the Downlink values)

**Table B.1-3: U-Plane Uplink delay boundaries**

|  |  |
| --- | --- |
| **Uplink** | **Method** |
| Ta3 max | <= (Ta3\_min + O-RU Transmission Window) |
| Ta3 min | Specified per Use Case |
| Ta4 max | >= (Ta3\_max + T34\_max) |
| Ta4 min | <= (Ta3\_min + T34\_min) |
| T34 max | Specified per Use Case |
| T34 min | Specified per Use Case |
| O-RU Transmission Window | Specified per Use Case |

**T****able B.1-4: C-Plane Uplink delay boundaries**

|  |  |
| --- | --- |
| **Downlink** | **Method** |
| T1a\_max\_cp\_ul | <= (T12\_min + T2a\_max\_cp\_ul) |
| T1a\_min\_cp\_ul | >= (T12\_max + T2a\_min\_cp\_ul) |
| T2a\_max\_cp\_ul | >= (T2a\_min\_cp\_ul + (T12\_max - T12\_min) + O-DU uplink C-Plane Transmission Window duration) |
| T2a\_min\_cp\_ul | Specified per Use Case |
| T12\_max | Specified per Use Case |
| T12\_min | Specified per Use Case |
| O-DU Transmission Window | Specified per Use Case |

## Latency categories and sub-categories

The O-DU and O-RU are defined to be in "delay categories" and "delay sub-categories" for the purposes of allowing a matching of O-DU and O-RU units that will operate properly together from the point of view of accommodating a customer's network delay. Network delay comprises the "time-of-flight" of signals through (typically) a fibre-optic cable (so can be known from the fibre length) added to the signal traversal latency through any switches in the network.

The delay category and delay sub-category values depend in part on the processing latency within the O-DU and O-RU. It may be expected especially for an O-RU that the processing latency may depend on the specific frequency band and sub-carrier spacing that is used. Further, a multi-band radio may experience different processing latencies for its different bands. Therefore, it may be expected that an O-RU (and perhaps more rarely an O-DU) will have different delay category and delay sub-category ratings for different bands.

O-DU categories are defined as A.##[##] (per direction, i.e. O-DU UL and O-DU DL are different categories):

* Prefix(blank/f): The prefix distinguishes the type of O-DU with dynamic/fixed timing advance/retard
* A: Category from [AAAA-N] per table below
* .##[##]: sub-category from [.00 - .1000] per tables below

O-RU categories are defined as X.##[##] (per direction, i.e. O-RU UL and O-RU DL are different categories):

* X: Category from [O-ZZ] per table below
* .##[##]: sub-category from [.00-.1000] per tables below

Table B.2-1 is used by equipment vendors to assign categories to their equipment based on design characteristics.

**Table** **B.2-1: O-DU and O-RU Delay Categories**

|  |  |  |  |
| --- | --- | --- | --- |
| **O-DU Category** | |  | |
| Category | * T1a\_max\_upO-DU - TxmaxO-DU * Ta4\_max\_upO-DU   [usec] |
| AAAA | >= 30000 |
| AAA | 10000 to 29999 | **O-RU Category** | |
| AA | 3000 to 9999 | Category | * T2a\_min\_up   OR   * Ta3\_max   [usec] |
| A | 400 to 2999 |
| B | 380 to 399 |
| C | 360 to 379 | O | 0 to 50 |
| D | 340 to 359 | P | 51 to 70 |
| Q | 71 to 90 |
| E | 320 to 339 |
| R | 91 to 110 |
| F | 300 to 319 |
| S | 111 to 130 |
| G | 280 to 299 |
| T | 131 to 150 |
| H | 260 to 279 |
| U | 151 to 170 |
| I | 240 to 259 |
| V | 171 to 190 |
| J | 220 to 239 |
| W | 191 to 210 |
| K | 200 to 219 | X | 211 to 230 |
| L | 180 to 199 | Y | 231 to 250 |
| M | 160 to 179 | Z | 251 to 270 |
| N | 0 to 159 | ZZ | >= 271 |

NOTE: Categories are defined to group endpoints with similar delay characteristics for easy evaluation relative to use cases. Specifically, categories AA-AAAA and ZZ are defined for non-ideal fronthaul. The calculated value for O-DU or O-RU falling anywhere within the range for the category indicates that the endpoint is classified as that category. It is NOT required that the endpoint be able to support the full range of the category.

Table B.2-2 and Table B.2-3 are intended for use by network providers to determine the best and worst case T12\_max/ T34\_max values that can be supported by a given equipment combination (excluding non-ideal fronthaul).

Alternatively, network providers may locate the desired T12\_max/ T34\_max and select from the equipment combinations meeting that criteria. Common criteria are identified by different colors on diagonals through the Table B.2-2 and Table B.2-3.

**Table B.2-2: Latency\_min (Minimum supported T12\_max/ T34\_max in us)**

|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
|  | **O-DU** | | | | | | | | | | | | | |
| **O-RU** | **A** | **B** | **C** | **D** | **E** | **F** | **G** | **H** | **I** | **J** | **K** | **L** | **M** | **N** |
| **O** | 350 | 330 | 310 | 290 | 270 | 250 | 230 | 210 | 190 | 170 | 150 | 130 | 110 | 0 |
| **P** | 330 | 310 | 290 | 270 | 250 | 230 | 210 | 190 | 170 | 150 | 130 | 110 | 90 | 0 |
| **Q** | 310 | 290 | 270 | 250 | 230 | 210 | 190 | 170 | 150 | 130 | 110 | 90 | 70 | 0 |
| **R** | 290 | 270 | 250 | 230 | 210 | 190 | 170 | 150 | 130 | 110 | 90 | 70 | 50 | 0 |
| **S** | 270 | 250 | 230 | 210 | 190 | 170 | 150 | 130 | 110 | 90 | 70 | 50 | 30 | 0 |
| **T** | 250 | 230 | 210 | 190 | 170 | 150 | 130 | 110 | 90 | 70 | 50 | 30 | 10 | 0 |
| **U** | 230 | 210 | 190 | 170 | 150 | 130 | 110 | 90 | 70 | 50 | 30 | 10 | 0 | 0 |
| **V** | 210 | 190 | 170 | 150 | 130 | 110 | 90 | 70 | 50 | 30 | 10 | 0 | 0 | 0 |
| **W** | 190 | 170 | 150 | 130 | 110 | 90 | 70 | 50 | 30 | 10 | 0 | 0 | 0 | 0 |
| **X** | 170 | 150 | 130 | 110 | 90 | 70 | 50 | 30 | 10 | 0 | 0 | 0 | 0 | 0 |
| **Y** | 150 | 130 | 110 | 90 | 70 | 50 | 30 | 10 | 0 | 0 | 0 | 0 | 0 | 0 |
| **Z** | 130 | 110 | 90 | 70 | 50 | 30 | 10 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |

**Table B.2-3: Latency\_max (Maximum supported T12\_max/ T34\_max in us)**

|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
|  | **O-DU** | | | | | | | | | | | | | |
| **O-RU** | **A** | **B** | **C** | **D** | **E** | **F** | **G** | **H** | **I** | **J** | **K** | **L** | **M** | **N** |
| **O** | 3000 | 399 | 379 | 359 | 339 | 319 | 299 | 279 | 259 | 239 | 219 | 199 | 179 | 159 |
| **P** | 2949 | 348 | 328 | 308 | 288 | 268 | 248 | 228 | 208 | 188 | 168 | 148 | 128 | 108 |
| **Q** | 2929 | 328 | 308 | 288 | 268 | 248 | 228 | 208 | 188 | 168 | 148 | 128 | 108 | 88 |
| **R** | 2909 | 308 | 288 | 268 | 248 | 228 | 208 | 188 | 168 | 148 | 128 | 108 | 88 | 68 |
| **S** | 2889 | 288 | 268 | 248 | 228 | 208 | 188 | 168 | 148 | 128 | 108 | 88 | 68 | 48 |
| **T** | 2869 | 268 | 248 | 228 | 208 | 188 | 168 | 148 | 128 | 108 | 88 | 68 | 48 | 28 |
| **U** | 2849 | 248 | 228 | 208 | 188 | 168 | 148 | 128 | 108 | 88 | 68 | 48 | 28 | 8 |
| **V** | 2829 | 228 | 208 | 188 | 168 | 148 | 128 | 108 | 88 | 68 | 48 | 28 | 8 | 0 |
| **W** | 2809 | 208 | 188 | 168 | 148 | 128 | 108 | 88 | 68 | 48 | 28 | 8 | 0 | 0 |
| **X** | 2789 | 188 | 168 | 148 | 128 | 108 | 88 | 68 | 48 | 28 | 8 | 0 | 0 | 0 |
| **Y** | 2769 | 168 | 148 | 128 | 108 | 88 | 68 | 48 | 28 | 8 | 0 | 0 | 0 | 0 |
| **Z** | 2749 | 148 | 128 | 108 | 88 | 68 | 48 | 28 | 8 | 0 | 0 | 0 | 0 | 0 |

**T****able B.2-4: Use Case Mapping (Based on Latency\_min)**

|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **Range** (KM) | **T12max**  **T34max**  (usec) | **Minimum T12Max Guaranteed for Category Combinations**  (Combinations may support larger T12max) | | | | | | | | | | | | |
| 50 | 250 | AO - AT | BO - BS | CO - CR | DO - DQ | EO - EP | FO |  |  |  |  |  |  |  |
| 45 | 225 | AU | BT | CS | DR | EQ | FP | GO |  |  |  |  |  |  |
| 40 | 200 | AV | BU | CT | DS | ER | FQ | GP | HO |  |  |  |  |  |
| 35 | 175 | AW | BV | CU | DT | ES | FR | GQ | HP | IO |  |  |  |  |
| 30 | 150 | AX - AY | BW - BX | CV - CW | DU - DV | ET - EU | FS - FT | GR - GS | HQ - HR | IP - IQ | JO - JP | KO |  |  |
| 25 | 125 | AZ | BY | CX | DW | EV | FU | GT | HS | IR | JQ | KP | LO |  |
| 20 | 100 |  | BZ | CY | DX | EW | FV | GU | HT | IS | JR | KQ | LP | MO |
| 15 | 75 |  |  | CZ | DY | EX | FW | GV | HU | IT | JS | KR | LQ | MP |
| 10 | 50 |  |  |  | DZ | EY - EZ | FX - FY | GW - GX | HV - HW | IU - IV | JT - JU | KS - KT | LR - LS | MQ - MR |
| 5 | 25 |  |  |  |  |  | FZ | GY | HX | IW | JV | KU | LT | MS |
| 0 | 0 |  |  |  |  |  |  | GZ | HY | IX | JW | KV | LU | MT |

NOTE: The Use Case Mapping Table B.2-4 can be used to determine the O-DU/ O-RU delay category combinations which are guaranteed to support a given latency use case. This is defined based on Latency\_min for the category. It may be possible for equipment from a lower category to support a higher use case, but cannot be guaranteed. To determine the exact maximum latency for an O-DU/ O-RU pair, it is necessary to calculate based on the delay parameter values for the paired equipment.

**Table** **B.2-5: O-DU and O-RU Tx/Rx Window Sub-Categories**

|  |  |  |  |
| --- | --- | --- | --- |
| **Receive Window Sub-Category** | |  | |
| Sub- Category | * T2a\_max\_up - T2a\_min\_up * RXmaxO-DU   [in usec] |
| **Transmit Window Sub-Category** | |
| .1000 | >= 10000 | Sub- Category | * TXmaxO-DU * Ta3\_max - Ta3\_min   [in usec] |
| .300 | 3000 to 9999 |
| .100 | 1000 to 2999 |
| .40 | 400 to 999 |
| .38 | 380 to 399 | .20 | >= 200 |
| .36 | 360 to 379 | .19 | 190 to 199 |
| .34 | 340 to 359 | .18 | 180 to 189 |
| .32 | 320 to 339 | .17 | 170 to 179 |
| .30 | 300 to 319 | .16 | 160 to 169 |
| .28 | 280 to 299 | .15 | 150 to 159 |
| .26 | 260 to 279 | .14 | 140 to 149 |
| .24 | 240 to 259 | .13 | 130 to 139 |
| .22 | 220 to 239 | .12 | 120 to 129 |
| .20 | 200 to 219 | .11 | 110 to 119 |
| .18 | 180 to 199 | .10 | 100 to 109 |
| .16 | 160 to 179 | .09 | 90 to 99 |
| .14 | 140 to 159 | .08 | 80 to 89 |
| .12 | 120 to 139 | .07 | 70 to 79 |
| .10 | 100 to 119 | .06 | 60 to 69 |
| .08 | 80 to 99 | .05 | 50 to 59 |
| .06 | 60 to 79 | .04 | 40 to 49 |
| .04 | 40 to 59 | .03 | 30 to 39 |
| .02 | 20 to 39 | .02 | 20 to 29 |
| .01 | 10 to 19 | .01 | 10 to 19 |
| .00 | 0 to 9 | .00 | 0 to 9 |

NOTE: Sub-categories (see Table B.2-5) are defined to group endpoints with similar delay characteristics for easy evaluation relative to use cases. Specifically, sub-categories .100 to .1000 are defined for non-ideal fronthaul. The calculated value for O-DU or O-RU falling anywhere within the range for the category indicates that the endpoint is classified as that sub-category. It is NOT required that the endpoint be able to support the full range of the sub-category.

Table B.2-6 is used by service providers to identify equipment sub-category combinations which meet the desired network variability (excluding non-ideal fronthaul). Variability is shown in km in the Table B.2-6. This range is based on 5 us per km.

**Table B.2-6: Dynamic Range (in km) for sub-category pairs**

|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
|  | **Receive Window** | | | | | | | | | | | | | | | | | | | | |
| **TxMax** | .40 | .38 | .36 | .34 | .32 | .30 | .28 | .26 | .24 | .22 | .20 | .18 | .16 | .14 | .12 | .10 | .08 | .06 | .04 | .02 | .01 |
| .20 | 40 | 36 | 32 | 28 | 24 | 20 | 16 | 12 | 8 | 4 |  |  |  |  |  |  |  |  |  |  |  |
| .19 | 42 | 38 | 34 | 30 | 26 | 22 | 18 | 14 | 10 | 6 | 2 |  |  |  |  |  |  |  |  |  |  |
| .18 | 44 | 40 | 36 | 32 | 28 | 24 | 20 | 16 | 12 | 8 | 4 |  |  |  |  |  |  |  |  |  |  |
| .17 | 46 | 42 | 38 | 34 | 30 | 26 | 22 | 18 | 14 | 10 | 6 | 2 |  |  |  |  |  |  |  |  |  |
| .16 | 48 | 44 | 40 | 36 | 32 | 28 | 24 | 20 | 16 | 12 | 8 | 4 |  |  |  |  |  |  |  |  |  |
| .15 | 50 | 46 | 42 | 38 | 34 | 30 | 26 | 22 | 18 | 14 | 10 | 6 | 2 |  |  |  |  |  |  |  |  |
| .14 | 52 | 48 | 44 | 40 | 36 | 32 | 28 | 24 | 20 | 16 | 12 | 8 | 4 |  |  |  |  |  |  |  |  |
| .13 | 54 | 50 | 46 | 42 | 38 | 34 | 30 | 26 | 22 | 18 | 14 | 10 | 6 | 2 |  |  |  |  |  |  |  |
| .12 | 56 | 52 | 48 | 44 | 40 | 36 | 32 | 28 | 24 | 20 | 16 | 12 | 8 | 4 |  |  |  |  |  |  |  |
| .11 | 58 | 54 | 50 | 46 | 42 | 38 | 34 | 30 | 26 | 22 | 18 | 14 | 10 | 6 | 2 |  |  |  |  |  |  |
| .10 | 60 | 56 | 52 | 48 | 44 | 40 | 36 | 32 | 28 | 24 | 20 | 16 | 12 | 8 | 4 |  |  |  |  |  |  |
| .09 | 62 | 58 | 54 | 50 | 46 | 42 | 38 | 34 | 30 | 26 | 22 | 18 | 14 | 10 | 6 | 2 |  |  |  |  |  |
| .08 | 64 | 60 | 56 | 52 | 48 | 44 | 40 | 36 | 32 | 28 | 24 | 20 | 16 | 12 | 8 | 4 |  |  |  |  |  |
| .07 | 66 | 62 | 58 | 54 | 50 | 46 | 42 | 38 | 34 | 30 | 26 | 22 | 18 | 14 | 10 | 6 | 2 |  |  |  |  |
| .06 | 68 | 64 | 60 | 56 | 52 | 48 | 44 | 40 | 36 | 32 | 28 | 24 | 20 | 16 | 12 | 8 | 4 |  |  |  |  |
| .05 | 70 | 66 | 62 | 58 | 54 | 50 | 46 | 42 | 38 | 34 | 30 | 26 | 22 | 18 | 14 | 10 | 6 | 2 |  |  |  |
| .04 | 72 | 68 | 64 | 60 | 56 | 52 | 48 | 44 | 40 | 36 | 32 | 28 | 24 | 20 | 16 | 12 | 8 | 4 |  |  |  |
| .03 | 74 | 70 | 66 | 62 | 58 | 54 | 50 | 46 | 42 | 38 | 34 | 30 | 26 | 22 | 18 | 14 | 10 | 6 | 2 |  |  |
| .02 | 76 | 72 | 68 | 64 | 60 | 56 | 52 | 48 | 44 | 40 | 36 | 32 | 28 | 24 | 20 | 16 | 12 | 8 | 4 |  |  |
| .01 | 78 | 74 | 70 | 66 | 62 | 58 | 54 | 50 | 46 | 42 | 38 | 34 | 30 | 26 | 22 | 18 | 14 | 10 | 6 | 2 |  |
| .00 | 80 | 76 | 72 | 68 | 64 | 60 | 56 | 52 | 48 | 44 | 40 | 36 | 32 | 28 | 24 | 20 | 16 | 12 | 8 | 4 | 2 |

## Example case: Evaluating O-DU / O-RU combinations

This example illustrates an O-RU and an O-DU, each supporting multiple SCS. It illustrates how the actual O-DU/ O- RU delay profiles map to categories, and then how the corresponding categories are used to evaluate the resulting transport network limitations. The values represented are exemplary only. The example is provided to illustrate:

* + - Interoperability across multiple SCS:
      * O-RU and O-DU will have multiple delay profiles.
      * Delay profiles are different for uplink and downlink.
    - applicability service provider use case.

Table B.3-1 and Table B.3-2, respectively, list an example O-RU and O-DU delay profile. This results in 6 different category combinations as described in Table B.3-3.

**Table** **B.3-1: Delay profiles for the example O-RU**

|  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- |
|  | **O-RU Parameters** | **30 kHz** | **120 kHz** |  | **15 kHz** |
| Downlink | T2a\_min\_up, | **50** | **50** |  | **205** |
| T2a\_max\_up, | 250 | 180 |  | 435 |
| T2a\_min\_cp\_dl, | 175 | 175 |  | 330 |
| T2a\_max\_cp\_dl, | 375 | 205 |  | 460 |
| Tcp\_adv\_dl | 125 | 125 |  | 125 |
| Category | O.20 (250-50)=200 | O.12 |  | W.22 |
| Uplink | Ta3\_min, | 50 | 50 |  | 70 |
| Ta3\_max | 100 | 70 |  | 235 |
| T2a\_min\_cp\_ul, | 125 | 125 |  | 125 |
| T2a\_max\_cp\_ul | 325 | 255 |  | 360 |
| Category | R.05 | P.02 |  | Y.16 |

**T****able B.3-2: Delay profiles for the example O-DU.**

|  |  |  |  |  |
| --- | --- | --- | --- | --- |
|  | **O-DU Parameters** | **30 kHz** | **120 kHz** | **15 kHz** |
| Downlink | T1a\_max\_upO-DU, | 250 | 180 | 435 |
| TXmaxO-DU | 40 | 20 | 70 |
| Category | K.04 | M.02 | C.07 |
| Uplink | Ta4\_maxO-DU, | 250 | 180 | 395 |
| RXmaxO-DU | **200** | **130** | 325 |
| Category | I.20 | L.12 | B.32 |

**Table** **B.3-3: Resulting 6 different category combinations**

|  |  |  |  |
| --- | --- | --- | --- |
|  | **30 kHz** | **120 kHz** | **15 kHz** |
| Downlink | KO | MO | CW |
| Uplink | IR | LP | BY |

The respective minimum and maximum T12max values are highlighted in the Table B.3-4 and Table B.3-5. Using the 30 kHz as an example, it can be seen that the range on the transport is limited by the uplink (IR) to between 130 us and 168 us. This means that this combination can be guaranteed to be able to support at least 130 us of delay, and may be capable of supporting up to 168 us of delay. Using the actual delay values for the combination at 30 kHz, the uplink is limited to (Ta4\_max - Ta3\_max) = (250 - 100) = 150 us. The downlink value is higher, so uplink becomes the limiting factor for this combination.

**Table** **B.3-4: Delay Category O-DU and O-RU with highlighted valid options for this example, minimum T12max**

|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
|  | **O-DU** | | | | | | | | | | | | | |
| **O-RU** | **A** | **B** | **C** | **D** | **E** | **F** | **G** | **H** | **I** | **J** | **K** | **L** | **M** | **N** |
| **O** | 350 | 330 | 310 | 290 | 270 | 250 | 230 | 210 | 190 | 170 | **150** | 130 | **110** | 0 |
| **P** | 330 | 310 | 290 | 270 | 250 | 230 | 210 | 190 | 170 | 150 | 130 | **110** | 90 | 0 |
| **Q** | 310 | 290 | 270 | 250 | 230 | 210 | 190 | 170 | 150 | 130 | 110 | 90 | 70 | 0 |
| **R** | 290 | 270 | 250 | 230 | 210 | 190 | 170 | 150 | **130** | 110 | 90 | 70 | 50 | 0 |
| **S** | 270 | 250 | 230 | 210 | 190 | 170 | 150 | 130 | 110 | 90 | 70 | 50 | 30 | 0 |
| **T** | 250 | 230 | 210 | 190 | 170 | 150 | 130 | 110 | 90 | 70 | 50 | 30 | 10 | 0 |
| **U** | 230 | 210 | 190 | 170 | 150 | 130 | 110 | 90 | 70 | 50 | 30 | 10 | 0 | 0 |
| **V** | 210 | 190 | 170 | 150 | 130 | 110 | 90 | 70 | 50 | 30 | 10 | 0 | 0 | 0 |
| **W** | 190 | 170 | **150** | 130 | 110 | 90 | 70 | 50 | 30 | 10 | 0 | 0 | 0 | 0 |
| **X** | 170 | 150 | 130 | 110 | 90 | 70 | 50 | 30 | 10 | 0 | 0 | 0 | 0 | 0 |
| **Y** | 150 | **130** | 110 | 90 | 70 | 50 | 30 | 10 | 0 | 0 | 0 | 0 | 0 | 0 |
| **Z** | 130 | 110 | 90 | 70 | 50 | 30 | 10 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |

**Table B.3-5: Delay Category O-DU and O-RU with highlighted valid options for this example, maximum T12max**

|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
|  | **O-DU** | | | | | | | | | | | | | |
| **O-RU** | **A** | **B** | **C** | **D** | **E** | **F** | **G** | **H** | **I** | **J** | **K** | **L** | **M** | **N** |
| **O** | 3000 | 399 | 379 | 359 | 339 | 319 | 299 | 279 | 259 | 239 | **219** | 199 | **179** | 159 |
| **P** | 2949 | 348 | 328 | 308 | 288 | 268 | 248 | 228 | 208 | 188 | 168 | **148** | 128 | 108 |
| **Q** | 2929 | 328 | 308 | 288 | 268 | 248 | 228 | 208 | 188 | 168 | 148 | 128 | 108 | 88 |
| **R** | 2909 | 308 | 288 | 268 | 248 | 228 | 208 | 188 | **168** | 148 | 128 | 108 | 88 | 68 |
| **S** | 2889 | 288 | 268 | 248 | 228 | 208 | 188 | 168 | 148 | 128 | 108 | 88 | 68 | 48 |
| **T** | 2869 | 268 | 248 | 228 | 208 | 188 | 168 | 148 | 128 | 108 | 88 | 68 | 48 | 28 |
| **U** | 2849 | 248 | 228 | 208 | 188 | 168 | 148 | 128 | 108 | 88 | 68 | 48 | 28 | 8 |
| **V** | 2829 | 228 | 208 | 188 | 168 | 148 | 128 | 108 | 88 | 68 | 48 | 28 | 8 | 0 |
| **W** | 2809 | 208 | **188** | 168 | 148 | 128 | 108 | 88 | 68 | 48 | 28 | 8 | 0 | 0 |
| **X** | 2789 | 188 | 168 | 148 | 128 | 108 | 88 | 68 | 48 | 28 | 8 | 0 | 0 | 0 |
| **Y** | 2769 | **168** | 148 | 128 | 108 | 88 | 68 | 48 | 28 | 8 | 0 | 0 | 0 | 0 |
| **Z** | 2749 | 148 | 128 | 108 | 88 | 68 | 48 | 28 | 8 | 0 | 0 | 0 | 0 | 0 |

Evaluating the overall combination across all SCS, it can be seen that the maximum possible range for this combination if all 3 SCS are to be used is 148 us (limited by the 120 kHz uplink) and the minimum guaranteed range is 110 us. (In actuality, the limit is 110 us for this combination.)

Similarly, there are 6 combinations of sub-categories to evaluate as shown in Table B.3-6. In this case, the sub-category combinations happen to be the same for 120 kHz uplink and downlink. In this case the different between T12max and T12min is limited by the 120 kHz delay profile, with a maximum range of ~20 km (~100 us).

**T****able B.3-6: Delay Sub-Category O-DU and O-RU with highlighted (in red) valid options for this example**

|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
|  | **Receive Window** | | | | | | | | | | | | | | | | | | | | |
| **TxMax** | .40 | .38 | .36 | .34 | .32 | .30 | .28 | .26 | .24 | .22 | .20 | .18 | .16 | .14 | .12 | .10 | .08 | .06 | .04 | .02 | .01 |
| .20 | 40 | 36 | 32 | 28 | 24 | 20 | 16 | 12 | 8 | 4 |  |  |  |  |  |  |  |  |  |  |  |
| .19 | 42 | 38 | 34 | 30 | 26 | 22 | 18 | 14 | 10 | 6 | 2 |  |  |  |  |  |  |  |  |  |  |
| .18 | 44 | 40 | 36 | 32 | 28 | 24 | 20 | 16 | 12 | 8 | 4 |  |  |  |  |  |  |  |  |  |  |
| .17 | 46 | 42 | 38 | 34 | 30 | 26 | 22 | 18 | 14 | 10 | 6 | 2 |  |  |  |  |  |  |  |  |  |
| .16 | 48 | 44 | 40 | 36 | **32** | 28 | 24 | 20 | 16 | 12 | 8 | 4 |  |  |  |  |  |  |  |  |  |
| .15 | 50 | 46 | 42 | 38 | 34 | 30 | 26 | 22 | 18 | 14 | 10 | 6 | 2 |  |  |  |  |  |  |  |  |
| .14 | 52 | 48 | 44 | 40 | 36 | 32 | 28 | 24 | 20 | 16 | 12 | 8 | 4 |  |  |  |  |  |  |  |  |
| .13 | 54 | 50 | 46 | 42 | 38 | 34 | 30 | 26 | 22 | 18 | 14 | 10 | 6 | 2 |  |  |  |  |  |  |  |
| .12 | 56 | 52 | 48 | 44 | 40 | 36 | 32 | 28 | 24 | 20 | 16 | 12 | 8 | 4 |  |  |  |  |  |  |  |
| .11 | 58 | 54 | 50 | 46 | 42 | 38 | 34 | 30 | 26 | 22 | 18 | 14 | 10 | 6 | 2 |  |  |  |  |  |  |
| .10 | 60 | 56 | 52 | 48 | 44 | 40 | 36 | 32 | 28 | 24 | 20 | 16 | 12 | 8 | 4 |  |  |  |  |  |  |
| .09 | 62 | 58 | 54 | 50 | 46 | 42 | 38 | 34 | 30 | 26 | 22 | 18 | 14 | 10 | 6 | 2 |  |  |  |  |  |
| .08 | 64 | 60 | 56 | 52 | 48 | 44 | 40 | 36 | 32 | 28 | 24 | 20 | 16 | 12 | 8 | 4 |  |  |  |  |  |
| .07 | 66 | 62 | 58 | 54 | 50 | 46 | 42 | 38 | 34 | **30** | 26 | 22 | 18 | 14 | 10 | 6 | 2 |  |  |  |  |
| .06 | 68 | 64 | 60 | 56 | 52 | 48 | 44 | 40 | 36 | 32 | 28 | 24 | 20 | 16 | 12 | 8 | 4 |  |  |  |  |
| .05 | 70 | 66 | 62 | 58 | 54 | 50 | 46 | 42 | 38 | 34 | **30** | 26 | 22 | 18 | 14 | 10 | 6 | 2 |  |  |  |
| .04 | 72 | 68 | 64 | 60 | 56 | 52 | 48 | 44 | 40 | 36 | **32** | 28 | 24 | 20 | 16 | 12 | 8 | 4 |  |  |  |
| .03 | 74 | 70 | 66 | 62 | 58 | 54 | 50 | 46 | 42 | 38 | 34 | 30 | 26 | 22 | 18 | 14 | 10 | 6 | 2 |  |  |
| .02 | 76 | 72 | 68 | 64 | 60 | 56 | 52 | 48 | 44 | 40 | 36 | 32 | 28 | 24 | **20** | 16 | 12 | 8 | 4 |  |  |
| .01 | 78 | 74 | 70 | 66 | 62 | 58 | 54 | 50 | 46 | 42 | 38 | 34 | 30 | 26 | 22 | 18 | 14 | 10 | 6 | 2 |  |
| .00 | 80 | 76 | 72 | 68 | 64 | 60 | 56 | 52 | 48 | 44 | 40 | 36 | 32 | 28 | 24 | 20 | 16 | 12 | 8 | 4 | 2 |

Using only the O-DU/ O-RU category/ sub-category combinations, if the corresponding O-DU/ O-RU is to be used across all 3 SCS, the resulting delay constraints limit the implementation to:

* + - 110 us <= T12max <= 148 us
    - T12min = (T12max - 100) us

The service provider can then use this analysis to determine if the resulting combination suits their target use case.

## Example case: Non-ideal transport O-DU/O-RU categories

This example illustrates the usage of the non-ideal transport delay categories and sub-categories included in Table B.2-1 and Table B.2-5 respectively. These categories and sub-categories were created to allow for the use of transport networks which have delay introduced at the MAC layer that is larger than the propagation delay e.g. DOCSIS networks, E/GPON networks, microwave links, or G.Fast networks. In such systems, delay is decoupled from the transport network length and therefore better specified in microseconds or milliseconds.

Non-ideal transport is defined by 3GPP in document TR 36.932 [i.2] per Table B.4-1**.**

**Table B.4-1: Non-Ideal transport categorization from 3GPP TR 36.932 [i.2] Table 6.1-1**

|  |  |  |  |
| --- | --- | --- | --- |
| **Backhaul Technology** | **Latency (One way)** | **Throughput** | **Priority (1 is the highest)** |
| Fiber Access 1 | 10-30 ms | 10M-10 Gbps | 1 |
| Fiber Access 2 | 5-10 ms | 100-1000 Mbps | 2 |
| Fiber Access 3 | 2-5 ms | 50M-10 Gbps | 1 |
| DSL Access | 15-60 ms | 10-100 Mbps | 1 |
| Cable | 25-35 ms | 10-100 Mbps | 2 |
| Wireless Backhaul | 5-35 ms | 10 Mbps - 100 Mbps typical, maybe up to Gbps range | 1 |

In Table B.4-2, example deployment use cases are used to illustrate O-DU/O-RU delay profile mapping. The values, while meant to representative, are exemplary only.

**Table B.4-2: Non-Ideal fronthaul O-DU/O-RU Delay Profiles by link type**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
|  |  | **DOCSIS** | | **Microwave** | | **PON** | | **G.Fast** | |
|  |  | T12 (DL) | T34 (UL) | T12 (DL) | T34 (UL) | T12 (DL) | T34 (UL) | T12 (DL) | T34 (UL) |
| Latency (RTT) | < 1 ms | < 29 ms | < 10 ms | <10 ms | < 500 us | < 2.5 ms | < 2 ms | < 2 ms |
| Jitter/PDV | < 320 us | < 9 ms | < 2.5 ms | <2.5 ms | < 1 ms | <1 ms | < 1 ms | < 1 ms |
| O-DU | T1a\_max\_up\_O-DU | 1,500 us | - | 12,500 us | - | 750 us | - | 2,250 us | - |
| TXmax\_O-DU | 50 us | - | 100 us | - | 50 us | - | 50 us | - |
| Ta4\_max\_O-DU | - | 29,500 us | - | 12,500 us | - | 2,750 us | - | 2,250 us |
| Rx\_max\_O-DU | - | 9,500 us | - | 3,250 us | - | 1,250 us | - | 1,250 us |
| **Category** | **A.05** | **AAA.300** | **AAA.10** | **AAA.300** | **A.05** | **A.100** | **A.05** | **A.100** |
| O-RU | T2a\_min\_up | 100 us | - | 50 us | - | 50 us | - | 70 us | - |
| T2a\_max\_up | 500 us | - | 2,650 us | - | 1,100 us | - | 1,200 us | - |
| Ta3\_min | - | 50 us | - | 50 us | - | 100 us | - | 70 us |
| Ta3\_max | - | 150 us | - | 200 us | - | 200 us | - | 200 us |
| **Category** | **R.40** | **T.10** | **O.100** | **W.15** | **O.40** | **W.10** | **P.100** | **W.13** |

The use of non-ideal transport links for fronthaul traffic comes with system performance tradeoffs. See Appendix L for further discussion of these considerations.

Annex C (informative):

Void

Annex D (informative):

IQ sample and exponent packetization for different bitwidths

## IQ sample ordering for big-endian byte order

As specified in clause 8.3.2, bit-ordering and packetization for I and Q samples and compression parameters follow patterns that repeat after every transmission of 12 resource elements. Tables D.1-1 through D.1-11 illustrate this

bit-ordering and repetition for big-endian byte order. The cells in the tables indicate the bit ordering for the following IEs:

* + - udCompParam (assumed to be one byte in the tables)
    - I samples denoted by Ibitwidth-1...I0
    - Q samples denoted by Qbitwidth-1...Q0

**Table D.1-1: IQ data samples bit-ordering (6-bit IQ bitwidth example)**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **Number of Octets** |  |
| ... |  |  |  |  |  |  |  |  |  |
| udCompParam | | | | | | | | 1 | Octet N |
| I5 | I4 | I3 | I2 | I1 | I0 | Q5 | Q4 | 1 | N+1 |
| Q3 | Q2 | Q1 | Q0 | ... |  |  |  | 1 | N+2 |
| ... |  |  |  |  |  |  |  |  |  |
|  |  |  | ... | I5 | I4 | I3 | I2 | 1 | N+17 |
| I1 | I0 | Q5 | Q4 | Q3 | Q2 | Q1 | Q0 | 1 | N+18 |
| udCompParam | | | | | | | | 1 | Octet M |
| I5 | I4 | I3 | I2 | I1 | I0 | Q5 | Q4 | 1 | M+1 |
| Q3 | Q2 | Q1 | Q0 | ... |  |  |  | 1 | M+2 |
| ... |  |  |  |  |  |  |  |  |  |
|  |  |  | ... | I5 | I4 | I3 | I2 | 1 | M+17 |
| I1 | I0 | Q5 | Q4 | Q3 | Q2 | Q1 | Q0 | 1 | M+18 |
| ... |  |  |  |  |  |  |  |  |  |

**Table D.1-2: IQ data samples bit-ordering (7-bit IQ bitwidth example)**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **Number of Octets** |  |
| ... |  |  |  |  |  |  |  |  |  |
| udCompParam | | | | | | | | 1 | Octet N |
| I6 | I5 | I4 | I3 | I2 | I1 | I0 | Q6 | 1 | N+1 |
| Q5 | Q4 | Q3 | Q2 | Q1 | Q0 | ... |  | 1 | N+2 |
| ... |  |  |  |  |  |  |  |  |  |
|  | ... | I6 | I5 | I4 | I3 | I2 | I1 | 1 | N+20 |
| I0 | Q6 | Q5 | Q4 | Q3 | Q2 | Q1 | Q0 | 1 | N+21 |
| udCompParam | | | | | | | | 1 | Octet M |
| I6 | I5 | I4 | I3 | I2 | I1 | I0 | Q6 | 1 | M+1 |
| Q5 | Q4 | Q3 | Q2 | Q1 | Q0 | ... |  | 1 | M+2 |
| ... |  |  |  |  |  |  |  |  |  |
|  | ... | I6 | I5 | I4 | I3 | I2 | I1 | 1 | M+20 |
| I0 | Q6 | Q5 | Q4 | Q3 | Q2 | Q1 | Q0 | 1 | M+21 |
| ... |  |  |  |  |  |  |  |  |  |

**Table D.1-3: IQ data samples bit-ordering (8-bit IQ bitwidth example)**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **Number of Octets** |  |
| ... |  |  |  |  |  |  |  |  |  |
| udCompParam | | | | | | | | 1 | Octet N |
| I7 | I6 | I5 | I4 | I3 | I2 | I1 | I0 | 1 | N+1 |
| Q7 | Q6 | Q5 | Q4 | Q3 | Q2 | Q1 | Q0 | 1 | N+2 |
| ... |  |  |  |  |  |  |  |  |  |
| I7 | I6 | I5 | I4 | I3 | I2 | I1 | I0 | 1 | N+23 |
| Q7 | Q6 | Q5 | Q4 | Q3 | Q2 | Q1 | Q0 | 1 | N+24 |
| udCompParam | | | | | | | | 1 | Octet M |
| I7 | I6 | I5 | I4 | I3 | I2 | I1 | I0 | 1 | M+1 |
| Q7 | Q6 | Q5 | Q4 | Q3 | Q2 | Q1 | Q0 | 1 | M+2 |
| ... |  |  |  |  |  |  |  |  |  |
| I7 | I6 | I5 | I4 | I3 | I2 | I1 | I0 | 1 | M+23 |
| Q7 | Q6 | Q5 | Q4 | Q3 | Q2 | Q1 | Q0 | 1 | M+24 |
| ... |  |  |  |  |  |  |  |  |  |

**Table D.1-4: IQ data samples bit-ordering (9-bit IQ bitwidth example)**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **Number of Octets** |  |
| ... |  |  |  |  |  |  |  |  |  |
| udCompParam | | | | | | | | 1 | Octet N |
| I8 | I7 | I6 | I5 | I4 | I3 | I2 | I1 | 1 | N+1 |
| I0 | Q8 | Q7 | Q6 | Q5 | Q4 | Q3 | Q2 | 1 | N+2 |
| Q1 | Q0 | ... |  |  |  |  |  | 1 | N+3 |
| ... |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  | ... | I8 | I7 | 1 | N+25 |
| I6 | I5 | I4 | I3 | I2 | I1 | I0 | Q8 | 1 | N+26 |
| Q7 | Q6 | Q5 | Q4 | Q3 | Q2 | Q1 | Q0 | 1 | N+27 |
| udCompParam | | | | | | | | 1 | Octet M |
| I8 | I7 | I6 | I5 | I4 | I3 | I2 | I1 | 1 | M+1 |
| I0 | Q8 | Q7 | Q6 | Q5 | Q4 | Q3 | Q2 | 1 | M+2 |
| Q1 | Q0 | ... |  |  |  |  |  | 1 |  |
| ... |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  | ... | I8 | I7 | 1 | M+25 |
| I6 | I5 | I4 | I3 | I2 | I1 | I0 | Q8 | 1 | M+26 |
| Q7 | Q6 | Q5 | Q4 | Q3 | Q2 | Q1 | Q0 | 1 | M+27 |
| ... |  |  |  |  |  |  |  |  |  |

**Table D.1-5: IQ data samples bit-ordering (10-bit IQ bitwidth example)**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **Number of Octets** |  |
| ... |  |  |  |  |  |  |  |  |  |
| udCompParam | | | | | | | | 1 | Octet N |
| I9 | I8 | I7 | I6 | I5 | I4 | I3 | I2 | 1 | N+1 |
| I1 | I0 | Q9 | Q8 | Q7 | Q6 | Q5 | Q4 | 1 | N+2 |
| Q3 | Q2 | Q1 | Q0 | ... |  |  |  | 1 | N+3 |
| ... |  |  |  |  |  |  |  |  |  |
|  |  |  | ... | I9 | I8 | I7 | I6 | 1 | N+28 |
| I5 | I4 | I3 | I2 | I1 | I0 | Q9 | Q8 | 1 | N+29 |
| Q7 | Q6 | Q5 | Q4 | Q3 | Q2 | Q1 | Q0 | 1 | N+30 |
| udCompParam | | | | | | | | 1 | Octet M |
| I9 | I8 | I7 | I6 | I5 | I4 | I3 | I2 | 1 | M+1 |
| I1 | I0 | Q9 | Q8 | Q7 | Q6 | Q5 | Q4 | 1 | M+2 |
| Q3 | Q2 | Q1 | Q0 | ... |  |  |  | 1 | M+3 |
| ... |  |  |  |  |  |  |  |  |  |
|  |  |  | ... | I9 | I8 | I7 | I6 | 1 | M+28 |
| I5 | I4 | I3 | I2 | I1 | I0 | Q9 | Q8 | 1 | M+29 |
| Q7 | Q6 | Q5 | Q4 | Q3 | Q2 | Q1 | Q0 | 1 | M+30 |
| ... |  |  |  |  |  |  |  |  |  |

**Table D.1-6: IQ data samples bit-ordering (11-bit IQ bitwidth example)**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **Number of Octets** |  |
| ... |  |  |  |  |  |  |  |  |  |
| udCompParam | | | | | | | | 1 | Octet N |
| I10 | I9 | I8 | I7 | I6 | I5 | I4 | I3 | 1 | N+1 |
| I2 | I1 | I0 | Q10 | Q9 | Q8 | Q7 | Q6 | 1 | N+2 |
| Q5 | Q4 | Q3 | Q2 | Q1 | Q0 | ... |  | 1 | N+3 |
| ... |  |  |  |  |  |  |  |  |  |
|  | ... | I10 | I9 | I8 | I7 | I6 | I5 | 1 | N+31 |
| I4 | I3 | I2 | I1 | I0 | Q10 | Q9 | Q8 | 1 | N+32 |
| Q7 | Q6 | Q5 | Q4 | Q3 | Q2 | Q1 | Q0 | 1 | N+33 |
| udCompParam | | | | | | | | 1 | Octet M |
| I10 | I9 | I8 | I7 | I6 | I5 | I4 | I3 | 1 | M+1 |
| I2 | I1 | I0 | Q10 | Q9 | Q8 | Q7 | Q6 | 1 | M+2 |
| Q5 | Q4 | Q3 | Q2 | Q1 | Q0 | ... |  | 1 | M+3 |
| ... |  |  |  |  |  |  |  |  |  |
|  | ... | I10 | I9 | I8 | I7 | I6 | I5 | 1 | M+31 |
| I4 | I3 | I2 | I1 | I0 | Q10 | Q9 | Q8 | 1 | M+32 |
| Q7 | Q6 | Q5 | Q4 | Q3 | Q2 | Q1 | Q0 | 1 | M+33 |
| ... |  |  |  |  |  |  |  |  |  |

**Table D.1-7: IQ data samples bit-ordering (12-bit IQ bitwidth example)**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **Number of Octets** |  |
| ... |  |  |  |  |  |  |  |  |  |
| udCompParam | | | | | | | | 1 | Octet N |
| I11 | I10 | I9 | I8 | I7 | I6 | I5 | I4 | 1 | N+1 |
| I3 | I2 | I1 | I0 | Q11 | Q10 | Q9 | Q8 | 1 | N+2 |
| Q7 | Q6 | Q5 | Q4 | Q3 | Q2 | Q1 | Q0 | 1 | N+3 |
| ... |  |  |  |  |  |  |  |  |  |
| I11 | I10 | I9 | I8 | I7 | I6 | I5 | I4 | 1 | N+34 |
| I3 | I2 | I1 | I0 | Q11 | Q10 | Q9 | Q8 | 1 | N+35 |
| Q7 | Q6 | Q5 | Q4 | Q3 | Q2 | Q1 | Q0 | 1 | N+36 |
| udCompParam | | | | | | | | 1 | Octet M |
| I11 | I10 | I9 | I8 | I7 | I6 | I5 | I4 | 1 | M+1 |
| I3 | I2 | I1 | I0 | Q11 | Q10 | Q9 | Q8 | 1 | M+2 |
| Q7 | Q6 | Q5 | Q4 | Q3 | Q2 | Q1 | Q0 | 1 | M+3 |
| ... |  |  |  |  |  |  |  |  |  |
| I11 | I10 | I9 | I8 | I7 | I6 | I5 | I4 | 1 | M+34 |
| I3 | I2 | I1 | I0 | Q11 | Q10 | Q9 | Q8 | 1 | M+35 |
| Q7 | Q6 | Q5 | Q4 | Q3 | Q2 | Q1 | Q0 | 1 | M+36 |
| ... |  |  |  |  |  |  |  |  |  |

**Table D.1-8: IQ data samples bit-ordering (13-bit IQ bitwidth example)**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **Number of Octets** |  |
| ... |  |  |  |  |  |  |  |  |  |
| udCompParam | | | | | | | | 1 | Octet N |
| I12 | I11 | I10 | I9 | I8 | I7 | I6 | I5 | 1 | N+1 |
| I4 | I3 | I2 | I1 | I0 | Q12 | Q11 | Q10 | 1 | N+2 |
| Q9 | Q8 | Q7 | Q6 | Q5 | Q4 | Q3 | Q2 | 1 | N+3 |
| Q1 | Q0 | ... |  |  |  |  |  | 1 | N+4 |
| ... |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  | ... | I12 | I11 | 1 | N+36 |
| I10 | I9 | I8 | I7 | I6 | I5 | I4 | I3 | 1 | N+37 |
| I2 | I1 | I0 | Q12 | Q11 | Q10 | Q9 | Q8 | 1 | N+38 |
| Q7 | Q6 | Q5 | Q4 | Q3 | Q2 | Q1 | Q0 | 1 | N+39 |
| udCompParam | | | | | | | | 1 | Octet M |
| I12 | I11 | I10 | I9 | I8 | I7 | I6 | I5 | 1 | M+1 |
| I4 | I3 | I2 | I1 | I0 | Q12 | Q11 | Q10 | 1 | M+2 |
| Q9 | Q8 | Q7 | Q6 | Q5 | Q4 | Q3 | Q2 | 1 | M+3 |
| Q1 | Q0 | ... |  |  |  |  |  | 1 | M+4 |
| ... |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  | ... | I12 | I11 | 1 | M+36 |
| I10 | I9 | I8 | I7 | I6 | I5 | I4 | I3 | 1 | M+37 |
| I2 | I1 | I0 | Q12 | Q11 | Q10 | Q9 | Q8 | 1 | M+38 |
| Q7 | Q6 | Q5 | Q4 | Q3 | Q2 | Q1 | Q0 | 1 | M+39 |
| ... |  |  |  |  |  |  |  |  |  |

**Table D.1-9: IQ data samples bit-ordering (14-bit IQ bitwidth example)**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **Number of Octets** |  |
| ... |  |  |  |  |  |  |  |  |  |
| udCompParam | | | | | | | | 1 | Octet N |
| I13 | I12 | I11 | I10 | I9 | I8 | I7 | I6 | 1 | N+1 |
| I5 | I4 | I3 | I2 | I1 | I0 | Q13 | Q12 | 1 | N+2 |
| Q11 | Q10 | Q9 | Q8 | Q7 | Q6 | Q5 | Q4 | 1 | N+3 |
| Q3 | Q2 | Q1 | Q0 | ... |  |  |  | 1 | N+4 |
| ... |  |  |  |  |  |  |  |  |  |
| ... |  |  |  | I13 | I12 | I11 | I10 | 1 | N+39 |
| I9 | I8 | I7 | I6 | I5 | I4 | I3 | I2 | 1 | N+40 |
| I1 | I0 | Q13 | Q12 | Q11 | Q10 | Q9 | Q8 | 1 | N+41 |
| Q7 | Q6 | Q5 | Q4 | Q3 | Q2 | Q1 | Q0 | 1 | N+42 |
| udCompParam | | | | | | | | 1 | Octet M |
| I13 | I12 | I11 | I10 | I9 | I8 | I7 | I6 | 1 | M+1 |
| I5 | I4 | I3 | I2 | I1 | I0 | Q13 | Q12 | 1 | M+2 |
| Q11 | Q10 | Q9 | Q8 | Q7 | Q6 | Q5 | Q4 | 1 | M+3 |
| Q3 | Q2 | Q1 | Q0 | ... |  |  |  | 1 | M+4 |
| ... |  |  |  |  |  |  |  |  |  |
| ... |  |  |  | I13 | I12 | I11 | I10 | 1 | M+39 |
| I9 | I8 | I7 | I6 | I5 | I4 | I3 | I2 | 1 | M+40 |
| I1 | I0 | Q13 | Q12 | Q11 | Q10 | Q9 | Q8 | 1 | M+41 |
| Q7 | Q6 | Q5 | Q4 | Q3 | Q2 | Q1 | Q0 | 1 | M+42 |
| ... |  |  |  |  |  |  |  |  |  |

**Table D.1-10: IQ data samples bit-ordering (15-bit IQ bitwidth example)**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **Number of Octets** |  |
| ... |  |  |  |  |  |  |  |  |  |
| udCompParam | | | | | | | | 1 | Octet N |
| I14 | I13 | I12 | I11 | I10 | I9 | I8 | I7 | 1 | N+1 |
| I6 | I5 | I4 | I3 | I2 | I1 | I0 | Q14 | 1 | N+2 |
| Q13 | Q12 | Q11 | Q10 | Q9 | Q8 | Q7 | Q6 | 1 | N+3 |
| Q5 | Q4 | Q3 | Q2 | Q1 | Q0 | ... |  | 1 | N+4 |
| ... |  |  |  |  |  |  |  |  |  |
| ... |  | I14 | I13 | I12 | I11 | I10 | I9 | 1 | N+42 |
| I8 | I7 | I6 | I5 | I4 | I3 | I2 | I1 | 1 | N+43 |
| I0 | Q14 | Q13 | Q12 | Q11 | Q10 | Q9 | Q8 | 1 | N+44 |
| Q7 | Q6 | Q5 | Q4 | Q3 | Q2 | Q1 | Q0 | 1 | N+45 |
| udCompParam | | | | | | | | 1 | Octet M |
| I14 | I13 | I12 | I11 | I10 | I9 | I8 | I7 | 1 | M+1 |
| I6 | I5 | I4 | I3 | I2 | I1 | I0 | Q14 | 1 | M+2 |
| Q13 | Q12 | Q11 | Q10 | Q9 | Q8 | Q7 | Q6 | 1 | M+3 |
| Q5 | Q4 | Q3 | Q2 | Q1 | Q0 | ... |  | 1 | M+4 |
| ... |  |  |  |  |  |  |  |  |  |
| ... |  | I14 | I13 | I12 | I11 | I10 | I9 | 1 | M+42 |
| I8 | I7 | I6 | I5 | I4 | I3 | I2 | I1 | 1 | M+43 |
| I0 | Q14 | Q13 | Q12 | Q11 | Q10 | Q9 | Q8 | 1 | M+44 |
| Q7 | Q6 | Q5 | Q4 | Q3 | Q2 | Q1 | Q0 | 1 | M+45 |
| ... |  |  |  |  |  |  |  |  |  |

**Table D.1-11: IQ data samples bit-ordering (16-bit IQ bitwidth example)**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **Number of Octets** |  |
| ... |  |  |  |  |  |  |  |  |  |
| udCompParam | | | | | | | | 1 | Octet N |
| I15 | I14 | I13 | I12 | I11 | I10 | I9 | I8 | 1 | N+1 |
| I7 | I6 | I5 | I4 | I3 | I2 | I1 | I0 | 1 | N+2 |
| Q15 | Q14 | Q13 | Q12 | Q11 | Q10 | Q9 | Q8 | 1 | N+3 |
| Q7 | Q6 | Q5 | Q4 | Q3 | Q2 | Q1 | Q0 | 1 | N+4 |
| ... |  |  |  |  |  |  |  |  |  |
| I15 | I14 | I13 | I12 | I11 | I10 | I9 | I8 | 1 | N+45 |
| I7 | I6 | I5 | I4 | I3 | I2 | I1 | I0 | 1 | N+46 |
| Q15 | Q14 | Q13 | Q12 | Q11 | Q10 | Q9 | Q8 | 1 | N+47 |
| Q7 | Q6 | Q5 | Q4 | Q3 | Q2 | Q1 | Q0 | 1 | N+48 |
| udCompParam | | | | | | | | 1 | Octet M |
| I15 | I14 | I13 | I12 | I11 | I10 | I9 | I8 | 1 | M+1 |
| I7 | I6 | I5 | I4 | I3 | I2 | I1 | I0 | 1 | M+2 |
| Q15 | Q14 | Q13 | Q12 | Q11 | Q10 | Q9 | Q8 | 1 | M+3 |
| Q7 | Q6 | Q5 | Q4 | Q3 | Q2 | Q1 | Q0 | 1 | M+4 |
| ... |  |  |  |  |  |  |  |  |  |
| I15 | I14 | I13 | I12 | I11 | I10 | I9 | I8 | 1 | M+45 |
| I7 | I6 | I5 | I4 | I3 | I2 | I1 | I0 | 1 | M+46 |
| Q15 | Q14 | Q13 | Q12 | Q11 | Q10 | Q9 | Q8 | 1 | M+47 |
| Q7 | Q6 | Q5 | Q4 | Q3 | Q2 | Q1 | Q0 | 1 | M+48 |
| ... |  |  |  |  |  |  |  |  |  |

## IQ sample ordering for little-endian byte order

When the optional "little endian byte order" format is used, the complex IQ data order is changed relative to that shown in Annex D.1. The Q data will be sent before I data, while within IQ data, the low byte is sent before high byte. All other conventions are observed same as in (Annex D.1) big-endian format. The usage of "little endian byte ordering" can be negotiated between the O-DU and O-RU via the M-Plane. Tables D.2-1 through D.2-11 illustrate different IQ bitwidths when data is sent in little-endian byte order. The cells in the tables indicate the bit ordering for the following IEs:

* + - udCompParam (assumed to be one byte)
    - I samples denoted by Ibitwidth-1...I0
    - Q samples denoted by Qbitwidth-1...Q0

Table D.2-1 through Table D.2-11 also apply to different IQ bitwidths for beamforming weights (Section Type 1 or 3, with Section Extension 1, 11 or 19) and channel information value (Section Type 6) when the optional "little endian byte order" is chosen via M-Plane. For beamforming weights, the udCompParam in the tables should be treated as bfwCompParam. Ibitwidth-1...I0 denotes bfwIbitwidth-1...bfwI0, and Qbitwidth-1...Q0 denotes bfwQbitwidth-1...bfwQ0. For channel information value, the udCompParam in the tables should be treated as ciCompParam. Ibitwidth-1...I0 denotes ciIsamplebitwidth-1...ciIsample0, and Qbitwidth-1...Q0 denotes ciQsamplebitwidth-1...ciQsample0.

**Table D.2-1: Bit order of IQ data samples in little endian mode (6-bit IQ bit width example)**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **Number of Octets** |  |
| ... |  |  |  |  |  |  |  |  |  |
| udCompParam | | | | | | | |  | Octet N |
| Q5 | Q4 | Q3 | Q2 | Q1 | Q0 | I5 | I4 | 1 | N+1 |
| I3 | I2 | I1 | I0 | ... |  |  |  | 1 | N+2 |
| ... |  |  |  |  |  |  |  |  |  |
|  |  |  | ... | Q5 | Q4 | Q3 | Q2 | 1 | N+17 |
| Q1 | Q0 | I5 | I4 | I3 | I2 | I1 | I0 | 1 | N+18 |
| udCompParam | | | | | | | | 1 | Octet M |
| Q5 | Q4 | Q3 | Q2 | Q1 | Q0 | I5 | I4 | 1 | M+1 |
| I3 | I2 | I1 | I0 | ... |  |  |  | 1 | M+2 |
| ... |  |  |  |  |  |  |  |  |  |
|  |  |  | ... | Q5 | Q4 | Q3 | Q2 | 1 | M+17 |
| Q1 | Q0 | I5 | I4 | I3 | I2 | I1 | I0 | 1 | M+18 |
| ... |  |  |  |  |  |  |  |  |  |

**Table D.2-2: Bit order of IQ data samples in little endian mode (7-bit IQ bitwidth example)**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **Number of Octets** |  |
| ... |  |  |  |  |  |  |  |  |  |
| udCompParam | | | | | | | |  | Octet N |
| Q6 | Q5 | Q4 | Q3 | Q2 | Q1 | Q0 | I6 | 1 | N+1 |
| I5 | I4 | I3 | I2 | I1 | I0 | ... |  | 1 | N+2 |
| ... |  |  |  |  |  |  |  |  |  |
|  | ... | Q6 | Q5 | Q4 | Q3 | Q2 | Q1 | 1 | N+20 |
| Q0 | I6 | I5 | I4 | I3 | I2 | I1 | I0 | 1 | N+21 |
| udCompParam | | | | | | | | 1 | Octet M |
| Q6 | Q5 | Q4 | Q3 | Q2 | Q1 | Q0 | I6 | 1 | M+1 |
| I5 | I4 | I3 | I2 | I1 | I0 | ... |  | 1 | M+2 |
| ... |  |  |  |  |  |  |  |  |  |
|  | ... | Q6 | Q5 | Q4 | Q3 | Q2 | Q1 | 1 | M+20 |
| Q0 | I6 | I5 | I4 | I3 | I2 | I1 | I0 | 1 | M+21 |
| ... |  |  |  |  |  |  |  |  |  |

**Table D.2-3: Bit order of IQ data samples in little endian mode (8-bit IQ bit width example)**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **Number of Octets** |  |
| ... |  |  |  |  |  |  |  |  |  |
| udCompParam | | | | | | | |  | Octet N |
| Q7 | Q6 | Q5 | Q4 | Q3 | Q2 | Q1 | Q0 | 1 | N+1 |
| I7 | I6 | I5 | I4 | I3 | I2 | I1 | I0 | 1 | N+2 |
| ... |  |  |  |  |  |  |  |  |  |
| Q7 | Q6 | Q5 | Q4 | Q3 | Q2 | Q1 | Q0 | 1 | N+23 |
| I7 | I6 | I5 | I4 | I3 | I2 | I1 | I0 | 1 | N+24 |
| udCompParam | | | | | | | | 1 | Octet M |
| Q7 | Q6 | Q5 | Q4 | Q3 | Q2 | Q1 | Q0 | 1 | M+1 |
| I7 | I6 | I5 | I4 | I3 | I2 | I1 | I0 | 1 | M+2 |
| ... |  |  |  |  |  |  |  |  |  |
| Q7 | Q6 | Q5 | Q4 | Q3 | Q2 | Q1 | Q0 | 1 | M+23 |
| I7 | I6 | I5 | I4 | I3 | I2 | I1 | I0 | 1 | M+24 |
| ... |  |  |  |  |  |  |  |  |  |

**Table D.2-4: Bit order of IQ data samples in little endian mode (9-bit IQ bitwidth example)**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **Number of Octets** |  |
| ... |  |  |  |  |  |  |  |  |  |
| udCompParam | | | | | | | |  | Octet N |
| Q7 | Q6 | Q5 | Q4 | Q3 | Q2 | Q1 | Q0 | 1 | N+1 |
| Q8 | I7 | I6 | I5 | I4 | I3 | I2 | I1 | 1 | N+2 |
| I0 | I8 | ... |  |  |  |  |  | 1 | N+3 |
| ... |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  | ... | Q7 | Q6 | 1 | N+25 |
| Q5 | Q4 | Q3 | Q2 | Q1 | Q0 | Q8 | I7 | 1 | N+26 |
| I6 | I5 | I4 | I3 | I2 | I1 | I0 | I8 | 1 | N+27 |
| udCompParam | | | | | | | | 1 | Octet M |
| Q7 | Q6 | Q5 | Q4 | Q3 | Q2 | Q1 | Q0 | 1 | M+1 |
| Q8 | I7 | I6 | I5 | I4 | I3 | I2 | I1 | 1 | M+2 |
| I0 | I8 | ... |  |  |  |  |  | 1 |  |
| ... |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  | ... | Q7 | Q6 | 1 | M+25 |
| Q5 | Q4 | Q3 | Q2 | Q1 | Q0 | Q8 | I7 | 1 | M+26 |
| I6 | I5 | I4 | I3 | I2 | I1 | I0 | I8 | 1 | M+27 |
| ... |  |  |  |  |  |  |  |  |  |

**Table D.2-5: Bit order of IQ data samples in little endian mode (10-bit IQ bitwidth example)**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **Number of Octets** |  |
| ... |  |  |  |  |  |  |  |  |  |
| udCompParam | | | | | | | |  | Octet N |
| Q7 | Q6 | Q5 | Q4 | Q3 | Q2 | Q1 | Q0 | 1 | N+1 |
| Q9 | Q8 | I7 | I6 | I5 | I4 | I3 | I2 | 1 | N+2 |
| I1 | I0 | I9 | I8 | ... |  |  |  | 1 | N+3 |
| ... |  |  |  |  |  |  |  |  |  |
|  |  |  | ... | Q7 | Q6 | Q5 | Q4 | 1 | N+28 |
| Q3 | Q2 | Q1 | Q0 | Q9 | Q8 | I7 | I6 | 1 | N+29 |
| I5 | I4 | I3 | I2 | I1 | I0 | I9 | I8 | 1 | N+30 |
| udCompParam | | | | | | | | 1 | Octet M |
| Q7 | Q6 | Q5 | Q4 | Q3 | Q2 | Q1 | Q0 | 1 | M+1 |
| Q9 | Q8 | I7 | I6 | I5 | I4 | I3 | I2 | 1 | M+2 |
| I1 | I0 | I9 | I8 | ... |  |  |  | 1 | M+3 |
| ... |  |  |  |  |  |  |  |  |  |
|  |  |  | ... | Q7 | Q6 | Q5 | Q4 | 1 | M+28 |
| Q3 | Q2 | Q1 | Q0 | Q9 | Q8 | I7 | I6 | 1 | M+29 |
| I5 | I4 | I3 | I2 | I1 | I0 | I9 | I8 | 1 | M+30 |
| ... |  |  |  |  |  |  |  |  |  |

**Table D.2-6: Bit order of IQ data samples in little endian mode (11-bit IQ bitwidth example)**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **Number of Octets** |  |
| ... |  |  |  |  |  |  |  |  |  |
| udCompParam | | | | | | | |  | Octet N |
| Q7 | Q6 | Q5 | Q4 | Q3 | Q2 | Q1 | Q0 | 1 | N+1 |
| Q10 | Q9 | Q8 | I7 | I6 | I5 | I4 | I3 | 1 | N+2 |
| I2 | I1 | I0 | I10 | I9 | I8 | ... |  | 1 | N+3 |
| ... |  |  |  |  |  |  |  |  |  |
|  | ... | Q7 | Q6 | Q5 | Q4 | Q3 | Q2 | 1 | N+31 |
| Q1 | Q0 | Q10 | Q9 | Q8 | I7 | I6 | I5 | 1 | N+32 |
| I4 | I3 | I2 | I1 | I0 | I10 | I9 | I8 | 1 | N+33 |
| udCompParam | | | | | | | | 1 | Octet M |
| Q7 | Q6 | Q5 | Q4 | Q3 | Q2 | Q1 | Q0 | 1 | M+1 |
| Q10 | Q9 | Q8 | I7 | I6 | I5 | I4 | I3 | 1 | M+2 |
| I2 | I1 | I0 | I10 | I9 | I8 | ... |  | 1 | M+3 |
| ... |  |  |  |  |  |  |  |  |  |
|  | ... | Q7 | Q6 | Q5 | Q4 | Q3 | Q2 | 1 | M+31 |
| Q1 | Q0 | Q10 | Q9 | Q8 | I7 | I6 | I5 | 1 | M+32 |
| I4 | I3 | I2 | I1 | I0 | I10 | I9 | I8 | 1 | M+33 |
| ... |  |  |  |  |  |  |  |  |  |

**Table D.2-7: Bit order of IQ data samples in little endian mode (12-bit IQ bitwidth example)**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **Number of Octets** |  |
| ... |  |  |  |  |  |  |  |  |  |
| udCompParam | | | | | | | |  | Octet N |
| Q7 | Q6 | Q5 | Q4 | Q3 | Q2 | Q1 | Q0 | 1 | N+1 |
| Q11 | Q10 | Q9 | Q8 | I7 | I6 | I5 | I4 | 1 | N+2 |
| I3 | I2 | I1 | I0 | I11 | I10 | I9 | I8 | 1 | N+3 |
| ... |  |  |  |  |  |  |  |  |  |
| Q7 | Q6 | Q5 | Q4 | Q3 | Q2 | Q1 | Q0 | 1 | N+34 |
| Q11 | Q10 | Q9 | Q8 | I7 | I6 | I5 | I4 | 1 | N+35 |
| I3 | I2 | I1 | I0 | I11 | I10 | I9 | I8 | 1 | N+36 |
| udCompParam | | | | | | | | 1 | Octet M |
| Q7 | Q6 | Q5 | Q4 | Q3 | Q2 | Q1 | Q0 | 1 | M+1 |
| Q11 | Q10 | Q9 | Q8 | I7 | I6 | I5 | I4 | 1 | M+2 |
| I3 | I2 | I1 | I0 | I11 | I10 | I9 | I8 | 1 | M+3 |
| ... |  |  |  |  |  |  |  |  |  |
| Q7 | Q6 | Q5 | Q4 | Q3 | Q2 | Q1 | Q0 | 1 | M+34 |
| Q11 | Q10 | Q9 | Q8 | I7 | I6 | I5 | I4 | 1 | M+35 |
| I3 | I2 | I1 | I0 | I11 | I10 | I9 | I8 | 1 | M+36 |
| ... |  |  |  |  |  |  |  |  |  |

**Table D.2-8: Bit order of IQ data samples in little endian mode (13-bit bitwidth mantissa example)**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **Number of Octets** |  |
| ... |  |  |  |  |  |  |  |  |  |
| udCompParam | | | | | | | |  | Octet N |
| Q7 | Q6 | Q5 | Q4 | Q3 | Q2 | Q1 | Q0 | 1 | N+1 |
| Q12 | Q11 | Q10 | Q9 | Q8 | I7 | I6 | I5 | 1 | N+2 |
| I4 | I3 | I2 | I1 | I0 | I12 | I11 | I10 | 1 | N+3 |
| I9 | I8 | ... |  |  |  |  |  | 1 | N+4 |
| ... |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  | ... | Q7 | Q6 | 1 | N+36 |
| Q5 | Q4 | Q3 | Q2 | Q1 | Q0 | Q12 | Q11 | 1 | N+37 |
| Q10 | Q9 | Q8 | I7 | I6 | I5 | I4 | I3 | 1 | N+38 |
| I2 | I1 | I0 | I12 | I11 | I10 | I9 | I8 | 1 | N+39 |
| udCompParam | | | | | | | | 1 | Octet M |
| Q7 | Q6 | Q5 | Q4 | Q3 | Q2 | Q1 | Q0 | 1 | M+1 |
| Q12 | Q11 | Q10 | Q9 | Q8 | I7 | I6 | I5 | 1 | M+2 |
| I4 | I3 | I2 | I1 | I0 | I12 | I11 | I10 | 1 | M+3 |
| I9 | I8 | ... |  |  |  |  |  | 1 | M+4 |
| ... |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  | ... | Q7 | Q6 | 1 | M+36 |
| Q5 | Q4 | Q3 | Q2 | Q1 | Q0 | Q12 | Q11 | 1 | M+37 |
| Q10 | Q9 | Q8 | I7 | I6 | I5 | I4 | I3 | 1 | M+38 |
| I2 | I1 | I0 | I12 | I11 | I10 | I9 | I8 | 1 | M+39 |
| ... |  |  |  |  |  |  |  |  |  |

**Table D.2-9: Bit order of IQ data samples in little endian mode (14-bit IQ bitwidth example)**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **Number of Octets** |  |
| ... |  |  |  |  |  |  |  |  |  |
| udCompParam | | | | | | | |  | Octet N |
| Q7 | Q6 | Q5 | Q4 | Q3 | Q2 | Q1 | Q0 | 1 | N+1 |
| Q13 | Q12 | Q11 | Q10 | Q9 | Q8 | I7 | I6 | 1 | N+2 |
| I5 | I4 | I3 | I2 | I1 | I0 | I13 | I12 | 1 | N+3 |
| I11 | I10 | I9 | I8 | ... |  |  |  | 1 | N+4 |
| ... |  |  |  |  |  |  |  |  |  |
| ... |  |  |  | Q7 | Q6 | Q5 | Q4 | 1 | N+39 |
| Q3 | Q2 | Q1 | Q0 | Q13 | Q12 | Q11 | Q10 | 1 | N+40 |
| Q9 | Q8 | I7 | I6 | I5 | I4 | I3 | I2 | 1 | N+41 |
| I1 | I0 | I13 | I12 | I11 | I10 | I9 | I8 | 1 | N+42 |
| udCompParam | | | | | | | | 1 | Octet M |
| Q7 | Q6 | Q5 | Q4 | Q3 | Q2 | Q1 | Q0 | 1 | M+1 |
| Q13 | Q12 | Q11 | Q10 | Q9 | Q8 | I7 | I6 | 1 | M+2 |
| I5 | I4 | I3 | I2 | I1 | I0 | I13 | I12 | 1 | M+3 |
| I11 | I10 | I9 | I8 | ... |  |  |  | 1 | M+4 |
| ... |  |  |  |  |  |  |  |  |  |
| ... |  |  |  | Q7 | Q6 | Q5 | Q4 | 1 | M+39 |
| Q3 | Q2 | Q1 | Q0 | Q13 | Q12 | Q11 | Q10 | 1 | M+40 |
| Q9 | Q8 | I7 | I6 | I5 | I4 | I3 | I2 | 1 | M+41 |
| I1 | I0 | I13 | I12 | I11 | I10 | I9 | I8 | 1 | M+42 |
| ... |  |  |  |  |  |  |  |  |  |

**Table D.2-10: Bit order of IQ data samples in little endian mode (15-bit IQ bitwidth example)**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **Number of Octets** |  |
| ... |  |  |  |  |  |  |  |  |  |
| udCompParam | | | | | | | |  | Octet N |
| Q7 | Q6 | Q5 | Q4 | Q3 | Q2 | Q1 | Q0 | 1 | N+1 |
| Q14 | Q13 | Q12 | Q11 | Q10 | Q9 | Q8 | I7 | 1 | N+2 |
| I6 | I5 | I4 | I3 | I2 | I1 | I0 | I14 | 1 | N+3 |
| I13 | I12 | I11 | I10 | I9 | I8 | ... |  | 1 | N+4 |
| ... |  |  |  |  |  |  |  |  |  |
| ... |  | Q7 | Q6 | Q5 | Q4 | Q3 | Q2 | 1 | N+42 |
| Q1 | Q0 | Q14 | Q13 | Q12 | Q11 | Q10 | Q9 | 1 | N+43 |
| Q8 | I7 | I6 | I5 | I4 | I3 | I2 | I1 | 1 | N+44 |
| I0 | I14 | I13 | I12 | I11 | I10 | I9 | I8 | 1 | N+45 |
| udCompParam | | | | | | | | 1 | Octet M |
| Q7 | Q6 | Q5 | Q4 | Q3 | Q2 | Q1 | Q0 | 1 | M+1 |
| Q14 | Q13 | Q12 | Q11 | Q10 | Q9 | Q8 | I7 | 1 | M+2 |
| I6 | I5 | I4 | I3 | I2 | I1 | I0 | I14 | 1 | M+3 |
| I13 | I12 | I11 | I10 | I9 | I8 | ... |  | 1 | M+4 |
| ... |  |  |  |  |  |  |  |  |  |
| ... |  | Q7 | Q6 | Q5 | Q4 | Q3 | Q2 | 1 | M+42 |
| Q1 | Q0 | Q14 | Q13 | Q12 | Q11 | Q10 | Q9 | 1 | M+43 |
| Q8 | I7 | I6 | I5 | I4 | I3 | I2 | I1 | 1 | M+44 |
| I0 | I14 | I13 | I12 | I11 | I10 | I9 | I8 | 1 | M+45 |
| ... |  |  |  |  |  |  |  |  |  |

**Table D.2-11: Bit order of IQ data samples in little endian mode (16-bit IQ bit width example)**

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **0 (msb)** | **1** | **2** | **3** | **4** | **5** | **6** | **7 (lsb)** | **Number of Octets** |  |
| ... |  |  |  |  |  |  |  |  |  |
| udCompParam | | | | | | | |  | Octet N |
| Q7 | Q6 | Q5 | Q4 | Q3 | Q2 | Q1 | Q0 | 1 | N+1 |
| Q15 | Q14 | Q13 | Q12 | Q11 | Q10 | Q9 | Q8 | 1 | N+2 |
| I7 | I6 | I5 | I4 | I3 | I2 | I1 | I0 | 1 | N+3 |
| I15 | I14 | I13 | I12 | I11 | I10 | I9 | I8 | 1 | N+4 |
| ... |  |  |  |  |  |  |  |  |  |
| Q7 | Q6 | Q5 | Q4 | Q3 | Q2 | Q1 | Q0 | 1 | N+45 |
| Q15 | Q14 | Q13 | Q12 | Q11 | Q10 | Q9 | Q8 | 1 | N+46 |
| I7 | I6 | I5 | I4 | I3 | I2 | I1 | I0 | 1 | N+47 |
| I15 | I14 | I13 | I12 | I11 | I10 | I9 | I8 | 1 | N+48 |
| udCompParam | | | | | | | | 1 | Octet M |
| Q7 | Q6 | Q5 | Q4 | Q3 | Q2 | Q1 | Q0 | 1 | M+1 |
| Q15 | Q14 | Q13 | Q12 | Q11 | Q10 | Q9 | Q8 | 1 | M+2 |
| I7 | I6 | I5 | I4 | I3 | I2 | I1 | I0 | 1 | M+3 |
| I15 | I14 | I13 | I12 | I11 | I10 | I9 | I8 | 1 | M+4 |
| ... |  |  |  |  |  |  |  |  |  |
| Q7 | Q6 | Q5 | Q4 | Q3 | Q2 | Q1 | Q0 | 1 | M+45 |
| Q15 | Q14 | Q13 | Q12 | Q11 | Q10 | Q9 | Q8 | 1 | M+46 |
| I7 | I6 | I5 | I4 | I3 | I2 | I1 | I0 | 1 | M+47 |
| I15 | I14 | I13 | I12 | I11 | I10 | I9 | I8 | 1 | M+48 |
| ... |  |  |  |  |  |  |  |  |  |

# Annex E (informative):

OFDM phase compensation

Consider the time interval t? <= t < t? + (N? + N? )T as defined in 3GPP TS 38.211 [4], clause 5.3.1,

start,l

start,l

u CP,l c

which corresponds to the transmission of the lth OFDM symbol with baseband waveform s(p,?)(t), and subcarrier

l

spacing configuration ?.

Suppose that the transmitter performs up-conversion of the signal s(p,?)(t) to RF centre frequency f , and the receiver

l 0

performs down-conversion from RF centre frequency f1. Unlike LTE, in NR it is possible that the transmitter and

receiver have different centre frequencies, f0 != f1, as for example can happen when a bandwidth part is configured, which motivates the introduction of OFDM phase compensation in NR.

Ignoring channel distortions and noise for simplicity, the baseband signal at the receiver in the same time interval can be written:

(p,?)

j2?(f -f )t

(p,?)

j?

j2?(f0-f1)(t-t? )

sl

(t) ? e

0 1 = sl

(t) ? e

l ? e

CP,l

where = 2?(f - f )t? and t? = t? + N? T is the time at the end of the cyclic prefix of OFDM symbol l.

l 0

1 CP,l

CP,l

start,l

CP,l c

It can be seen that each OFDM symbol is subjected to a phase shift l, which can result in large phase changes between successive OFDM symbols. This may cause problems for receiver processes such as channel estimation and frequency error tracking, which expect the channel to vary smoothly between symbols.

The solution adopted by 3GPP is to apply a phase pre-compensation term e-j2?f0t? at the transmitter and a phase post-compensation term ej2?f1t? at the receiver. These two terms together provide the required correction e-j? . The

CP,l

CP,l

l

phase pre-compensation requirement for the transmitter is specified in 3GPP TS 38.211 [4], clause 5.4. The phase compensation depends only on the starting time of each OFDM symbol, and is common for all subcarriers in that symbol transmitted using a given numerology ?, regardless of which NR physical channels they belong to, except for PRACH.

# Annex F (normative):

Beamforming attributes frame of reference

The beamforming attributes involving pointing angle (bfAzPt and bfZePt) specified in clause 7.7.2 are defined following 3GPP TR 38.901 [43], clause 7.1. Two coordinate systems are defined, the Global Coordinate System (GCS) and Local Coordinate System (LCS). The GCS applies across multiple BS and UT locations, while the LCS applies to a single array antenna. The GCS is defined as shown below in Figure F-1. In the GCS, ? refers to the azimuth angle and

? refers to the zenith angle.

The LCS is defined by a 3-parameter rotation of the GCS. The rotation with parameters ?, ?, ? is shown in Figure F-2 (left). The rotation parameters are defined as follows:

* ? is defined as the bearing angle (sector pointing angle)
* ? is defined as the downtilt angle
* ? is defined as the slant angle

A two-dimensional array antenna is defined such that the x?-axis is broadside to the array antenna. If an antenna architecture such as in 3GPP TR 38.901 [43] clause 7.3 is used, the horizontal direction is defined as y?and the vertical direction is defined as z?.

All parameters which relate to "peak" refer to the principal beam pointing in a particular direction. For a given beam configuration, the peak direction is the angle corresponding to maximum gain. Thus, bfAzPt specifies the pointing angle of maximum gain.

The pointing parameter bfAzPt is defined as ??. The pointing parameter bfZePt is defined as ?. The angles are shown in Figure F-2 (right).

The beamwidth parameters bfAz3dd and bfZe3dd are defined as the angular widths at which the beam falls to 3 dB below the peak beam gain on both sides of the peak direction, in azimuth and zenith, respectively.

The sidelobe parameters bfAzSl and bfZeSl are defined as the suppression level of the highest sidelobe relative to the peak gain in the azimuth and zenith principal planes, respectively.

*x*

*z*

*?*

*n*^

*?*^

*?*^

*?*

*y*

**Figure F-1: Global Coordinate System definition**

![](../assets/images/53d32bbbc6f9.png)![](../assets/images/1ed82d91b2f5.png)

**Figure F-2: Orienting the LCS (blue) with respect to the GCS (grey) by a sequence of 3 rotations (left); Definition of spherical coordinates and unit vectors in both the GCS and LCS (right)**

# Annex G (informative):

LAA Algorithms and Examples

An example PDSCH transmission algorithm showing message flow at the O-DU following clause 7.2.5.4.1 is shown in Figure G-1. The symbols used in Figure G-1 are defined in clause 7.2.5.3. The notation ?a? is the ceiling of number *a* to the nearest *x*, where *x* is 1 ms for normal SF and 0.5 ms for partially filled SF.

![](../assets/images/fb32bff9bd6d.png)

O-DU

O-DU

Figure G-1: PDSCH transmission algorithm O-DU flowchart

Similarly, an example PDSCH transmission algorithm showing message flow at the O-RU is shown in Figure G-2.

![](../assets/images/092197b64583.png)

O-RU start

O-RU end

**Figure G-2: PDSCH transmission algorithm O-RU flowchart**

For DRS Transmission Procedure, Figure G-3 shows an example O-DU flowchart. The corresponding O-RU example flow chart when using 25 us sensing is depicted in Figure G-4. An example flow chart for DRS transmission procedure at O-RU for LBT CAT 4 is shown in Figure G-5.

![](../assets/images/81459f211e1b.png)

O-DU

O-DU

**Figure G-3: DRS transmission procedure O-DU flowchart**

![](../assets/images/deb5c2b04242.png)

O-RU start

O-RU end

**Figure G-4: DRS transmission procedure O-RU flowchart - 25 ?s sensing**

![](../assets/images/5ae2cfb95061.png)

O-RU start

O-RU end

**Figure G-5: DRS transmission procedure O-RU flowchart - LBT Cat 4**

# Annex H (informative):

S-Plane detailed frequency and phase error budget analysis, and future ITU-T clock types and classes reference

## Void

## Frequency and time error budget analysis

#### Overview

This Annex provides the informative analysis to support budget allocation in clause 11.3.2 for a Full Timing Support network (as per Recommendation ITU-T G.8271.1 [22] for the limits, Recommendation ITU-T.G.8273.2 [28] for the clock definition). The analysis serves 2 purposes:

Considering T-BC Class B and C switches (as per Recommendation ITU-T G. 8273.2 [28]) in a Recommendation ITU- T G.8271.1 [22] compliant network, the number of allowed switches to satisfy the allocated network limit is computed in detail as an example.

NOTE: The following configurations are outside the scope of this annex:

* + - * Recommendation ITU-T G.8271.1 [22] compliant networks using class D T-BCs.
      * Recommendation ITU-T G.8271.1 [22] compliant networks using T-TCs instead of T-BCs.
      * Non-ITU-T G.8271.1 [22]-compliant networks, such as Recommendation ITU-T G.8271.2 [24] ones.
      * O-RU using SyncE/eSyncE . In the example below, only PTP is considered as synchronization source for O-RU.

Each network element in the fronthaul clock chain generates time error (including constant cTE and dynamic dTEH, dTEL), which accumulates through the entire clock chain and is present at the O-RU UNI, as described in Recommendation ITU-T G.8271.1 [22] Appendix IV. This Annex consider the accumulation of centred, symmetrical noise. In particular, accumulated dynamic time error causes O-RU synchronization receiver clock FFO (fractional frequency error) after clock recovery and filtering. Given that O-RU meets the 3GPP air interface frequency accuracy target (+-50 ppb), O-RU filtering is needed to filter the accumulated dynamic time error and reduce the frequency error down to an acceptable level. The allowed network limit (i.e. dynamic time error), reasonable O-RU filter bandwidth and acceptable frequency error after filtering are the result of a compromise exercise as shown in the following analysis.

The value of the O-RU filtering bandwidth is a key compromise, combined with the local oscillator thermal sensitivity under variable temperature profiles (such as the ones specified in Recommendation ITU-T G.8273 [27]):

* The higher filtering bandwidth, the faster frequency correction of the local oscillator thermal sensitivity and therefore the lower temporary accumulated time error under thermal variations, but the poorer efficiency in low pass filtering the dynamic noise seen on the UNI.
* The lower filtering bandwidth, the better efficiency in low pass filtering the dynamic noise seen on the UNI, but the poorer frequency correction of the local oscillator thermal sensitivity and therefore the higher temporary accumulated time error under thermal variations.

#### Network limit guidelines for frequency error budget (LLS-C1 and LLS-C2):

Based on the above compromise explanation, a practical expectation of O-RU filtering max BW is set to 75 mHz to start the analysis as shown in Table H.2.2-1.

**Table H.2.2-1: Network (LLS-C1/C2) Frequency Error Budget**

|  |  |  |
| --- | --- | --- |
| **Frequency error budget analysis considering O-DU class:** | **A** | **B** |
| Consider O-DU PTP/SyncE timeTransmitter max|frequency error| budget = .................. (refer to NOTE 1 in Table 11.3.2.1-1) | 15 ppb | 5 ppb |
| Consider Fronthaul and O-RU total max|frequency error| budget based on O-DU frequency  error budget taken away from the 3GPP air interface budget = ...................................... (NOTE 4) | 35 ppb | 45 ppb |
| Further split the Fronthaul and O-RU total frequency error budget as follows as an example of O-RU design:   * max|FFO\_FH| (see NOTE 1) = ................................................................... * max|FFO\_RU| (O-RU internal additive frequency noise generation) = ................. | 21 ppb  14 ppb | 27 ppb  18 ppb |
| The relationship between max|FFO\_FH| and the acceptable dynamic time error at the input of the O-RU is the following (NOTE 2):   * max|FFO\_FH| (in ppb) = ? ? max(dTE) (in ns) ? filter (in Hz) * max(dTE) = max| O\_ H| (? ? filter ) = ..................................................   max(dTE) is therefore the maximum allowed network Fronthaul network noise generation limit (between O-DU UNI and O-RU UNI) guaranteeing the 3GPP FFO limit at the air interface with such a 75 mHz BW O-RU.  It is up to O-RU vendor implementation to select filter BW (not necessarily 75 mHz) to trade off the internal budget split between max|FFO\_FH| and max|FFO\_RU| as long as the required frequency error budget is still met.  (NOTE 5) | 90 ns | 114 ns |
| Based on Recommendation ITU-T G.8271.1 [22] Appendix IV guidance and working assumptions to calculate accumulated error:  Total dynamic noise = RSS (dTE)   * max(dTE) = RSS (max(dTEL)) of all nodes excluding O-RU's T-TSC, and max(dTEH) of the last clock of the chain) = ................................................... | 90 ns | 114 ns |
| Considering the model of clock chain of n Class B T-BC clocks (between O-DU UNI to RU UNI), see NOTE 3:  max(dTEL) = 40 ns, max(dTEH) = 70 ns   * max(dTE) = sqrt [n\*402 + 702] = .................................................................. * n = (max(dTE)2 - 702)/402, .......................................................................... the maximum number of class B T-BCs in each chain (excluding O-DU)   Considering the model of clock chain of n Class C T-BC clocks (between O-DU UNI to RU UNI), see NOTE 3:  max(dTEL) = 10 ns, max(dTEH) = 30 ns   * max(dTE) = sqrt [n\*102 + 302] = .................................................................. * n = (max(dTE)2 - 302)/102, .......................................................................... the maximum number of class C T-BCs in each chain (excluding O-DU) | 90 ns | 114 ns |
| 2 | 5 |
| 90 ns | 114 ns |
| >>10 | >>10 |
| NOTE 1: This FFO\_FH contributor is generated by the fronthaul network elements under ideal O-DU output and filtered by ideal O-RU PTP clock. Such measurement output signal (e.g. 1PPS or PTP port) at the O-RU PTP clock output is optional and may therefore not exist on all O-RUs.  NOTE 2: The noise is generally assumed to be mainly centred. The impact of rare highly asymmetric events on the FFO is outside the scope of this edition of the document. As per clause 11.2.5.1 max(dTE) is peak-to-peak value. This limit mainly applies to the higher frequency range; for the lower frequency range, which depends on O-RU vendor-specific low pass filtering characteristics, a higher limit may be allowed.  NOTE 3: T-BC noise generation limits are provided by Recommendation ITU-T G.8273.2 [28] clause 7.1.  NOTE 4: All numbers in this table apply to a Wide Area Base Station (BS) with an air interface limit of 50 ppb (as per 3GPP TS [8], [9] clause 6.5.1). If Medium Range BS, Local Area BS or Home BS is used, the 3GPP budget is relaxed to 100 ppb or 250 ppb.  NOTE 5: The 3GPP budget relaxation applicable to non-Wide-Area BS can be split into the Fronthaul and O-RU budget differently, thus tolerating a higher limit for dTE. For example, allocating an FFO\_FH of 35 ppb results in a max(dTE) of 148 ns budget for the network, which will permit 10 class B T-BC switches. | | |

#### Network limit guidelines for time error budget (LLS-C1 and LLS-C2)

Using existing class B T-BCs, and considering no time error contribution by the fibre asymmetry nor from two timeTransmitter ports of the same T-BC, then:

Following Recommendation ITU-T G.8271.1 [23], Appendix IV guidance to calculate accumulated error with the following clock chain models as shown in Figure H.2.3-1, and Figure H.2.3-2.

UNI UNI

|  |  |  |  |  |
| --- | --- | --- | --- | --- |
|  | Path 1: Total |TE| | | |  |
| Common PTP/ SyncE timeTransmitter (O-DU or  T-BC) |
|  | n T-BC switches |  | O-RU1 |
|  |  |
| Path 2: Total |TE| | | | Relative |TE| |
|  | n T-BC switches |  | O-RU2 |
|  |  |
|  |  | | |  |

Relative |TE| 2x Total |TE|

NOTE 1: This picture does not show the port-to-port relative TE between two timeTransmitter ports of the common clock. O-DU is considered as having no such port-to-port relative time error. However, T-BCs as specified by Recommendation ITU-T G.8273.2 does not specify it, and it may be more prudent to consider the common T-BC inside the << n >> chain.

NOTE 2: This picture does not show the relative TE caused by asymmetry on the links, therefore some margin should be considered in the TE budget to take them into account

**Figure** **H.2.3-1: Clock chain model for analysis for two paths**

UNI

network |TE| UNI

|  |  |  |  |  |
| --- | --- | --- | --- | --- |
|  | Total |TE| | | |  |
| O-DU  PTP/SyncE timeTransmitter |
|  | n T-BC switches |  | O-RU1 |
|  |  |
| network |TE| = Total |TE| | | |  |

NOTE: This picture does not show the relative TE caused by asymmetry on the links, therefore some margin should be considered in the TE budget to take it into account.

**Figure H.2.3-2: Clock chain model for analysis**

As per Recommendation ITU-T G.8271.1 [23] Appendix IV formula IV-13 "case 1" with centred noise:

Total max|TE| = sum (max|cTE| of n nodes) +  1/2 .RSS sum (max(dTEL) of n nodes and max(dTEH) of last node)

= n.max|cTE| +  1/2 .sqrt (n.max(dTEL)2 + max(dTEH)2)

However, the O-RU's time error budget (max|cTE|, max(dTEL)2 + max(dTEH)2) has already been considered in the budget (see tables below), so only the T-BCs in the network are included in "n" and their contribution is limited to max|cTE| and max(dTEL). As a result, the above general formula can be further simplified for the chain of n T-BCs excluding the O-RU's T-TSC:

Total max|TEL| = n.max|cTE| +  1/2 .sqrt (n.max(dTEL)2)

Where a node is based on T-BC Class B switch with the following noise generation specification:

* Constant time error = max|cTE| = 20 ns for class B, 10 ns for class C
* Low-band dynamic error = max(dTEL) = 40 ns for class B, 10 ns for class C (considering centred noise) Using the above results in an O-RU TE budget as shown in Table H.2.3-1.

**Table H.2.3-1: O-RU Time Error Budget**

|  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- |
| **For O-RU type=**  **and overall relative |TEL| limit = to meet timing category**  **(NOTES 1, 2)** | **Enhanced 60 ns Cat A** | **Regular 100 ns Cat B** | **Enhanced 190 ns Cat B** | **Regular 95 ns Cat C** | **Enhanced 140 ns Cat C** |
| max|TEL| per branch (NOTE 2)  n.max|cTE| +  1/2 .sqrt (n.max(dTEL) 2) < limit per branch | 30 ns | 50 ns | 95 ns | 95 ns | 140 ns |
| Maximum number of class B T-BCs (n) on each branch from common network element (either O-  DU or T-BC) to O-RU: | 0 | 1 | 2 | 2 | 4 |
| Noise accumulation in each branch, calculated  using n.max|cTE| +  1/2 .sqrt (n.max(dTEL)2): | 0 ns | 40 ns | 68 ns | 68 ns | 120 ns |
| Remaining relative TE margin overall (NOTE 3): | 60 ns | 20 ns | 54 ns | 27 ns | 20 ns |
| Maximum number of class C T-BCs (n) on each branch from common network element (either O- DU or T-BC) to O-RU: | 1 | 3 | 7 | 7 | 11 |
| Noise accumulation in each branch, calculated  using n.max|cTE| +  1/2 .sqrt (n.max(dTEL)2): | 15 ns | 39 ns | 83 ns | 83 ns | 127 ns |
| Remaining relative TE margin overall (NOTE 3): | 30 ns | 22 ns | 24 ns | 12 ns | 13 ns |
| NOTE 1: Proposed maximum n values are conservative and leave at least 10 ns margin for fibre asymmetry or relative max|TEL| between two ports of the branching clock. It is therefore recommended to limit the number of fronthaul clocks to this value, although an additional one may still allow meeting the expected limits.  NOTE 2: For IEEE 802.1CM [11], [12] clause 6 timing categories A and B, the overall limit corresponds to the maximum relative |TEL| between two O-RU input ports (the end of two branches). The table calculates the noise accumulation in each branch separately, with the limit per branch equal to half o the overall limit. The two branches are then added linearly to calculate the remainder. A less conservative assumption, such as treating both branches as a single chain, could result in a larger margin for the remaining max|TE|.  For IEEE 802.1CM [11], [12] clause 6 timing category C, the overall limit corresponds to max|TERL| between the O-DU output and any O-RU input ports, and therefore the limit per branch is the same as the overall limit.  NOTE 3: For IEEE 802.1CM [11], [12] clause 6 timing categories A and B, the remaining relative TE should be assigned to fibre asymmetry in each of the branches from the common network element to the O-RU input ports, plus the relative TE between ports of the common network element  For category C, the remaining relative TE should be assigned to fibre asymmetry in the chain between the O-DU output port and the O-RU input ports. | | | | | |

#### Network limit guidelines for LLS-C1 and LLS-C2 based on the budget

The above budget can be translated into network limits at various points in the network. This is useful for measurement purposes. For the LLS-C1 and LLS-C2 configurations, a simplified version of the synchronization network can be

viewed as shown in Figure H.2.4-1 below. The numbers included are all quoted from Table 11.3.2.1-1, which is the normative source for LLS-C1 and LLS-C2.

**G.8271.1 or G.8271.2**

**Network Limit**

*(reference point C)*

![](../assets/images/6a730cd756e6.png)![](../assets/images/a917479c8150.png)![](../assets/images/f4cf3d83baec.png)![](../assets/images/615c616098a7.png)![](../assets/images/4369e38e1681.png)

or **114 ns** *(Class B O-DU);*

PRTC

Synchronization Network

O-DU

O-RAN Fronthaul Network

O-RU

**max|TEL|network <= 95 ns** *(regular O-RU)* or

**140 ns** *(enhanced O-RU)*

**max(dTE)network <= 90 ns** *(Class A O-DU)*

**max|FFOL| <= 15 ppb** *(Class A O-DU)*

or **5 ppb** *(Class B O-DU)*; **max|TEL| <= 1325 ns** *(LLS-C2)* or **1420 ns** *(LLS-C1)*

**max|TEL| <= 1420 ns**

*(regular O-RU)*

or **1465 ns** *(enhanced O- RU)*

**Figure H.2.4-1: Simplified view of LLS-C1 and LLS-C2 configurations, with network limits**

The limit at the output of the O-DU can be described in terms of MTIE (Maximum Time Interval Error). This is given in Table H.2.4-1 and Figure H.2.4-2 (for a Class A O-DU) and Table H.2.4-2 and Figure H.2.4-3 (for a Class B O-DU). In both cases, these are measured after filtering by a first-order low-pass filter of bandwidth 0.1 Hz (see Table

11.3.2.1-1, NOTE 1).

The maximum MTIE of 2840 ns in LLS-C1 and 2650 ns in LLS-C2 at long observation intervals is derived from the max|TEL| in Table 11.3.2.1-1 and is the absolute maximum for the O-DU output. This could be the case for an O-DU with minimized cTE and the ability to use the full TEL budget for frequency drift in both directions during multiple HOLDOVER events. For LOCKED operation the upper MTIE limit can be assumed to be lower and will depend on the input noise level from the synchronization source of the O-DU and the noise generation of the O-DU.

An unfiltered limit is also shown in each case for information, calculated by adding a constant value to the filtered limit representing the amount of noise that is expected to be removed by the measurement filter. The value to be added is calculated by using the equation quoted in Table H.2.2-1 above:

max(dTE) = max|FFO| ?f

/

m

where max|FFO| is the frequency accuracy budget of the O-DU, and *fm* is the bandwidth of the measurement filter. For an O-DU class A with a 15 ppb frequency accuracy budget, and a measurement filter of bandwidth 0.1 Hz, the max(dTE) is 48 ns, resulting in an addition of 48 ns to the filtered mask. For an O-DU class B, the addition to the mask is 16 ns.

**Table H.2.4-1: MTIE Limit at the output of an O-DU Class A**

![](../assets/images/ee1a691155f8.png)

**MTIE (ns)**

10000

1000

100

10

1

0,1

**?** **(s)**

0,1 1

10

15ppb Frequency Accuracy

100

1000

O-DU Output Class A LLS-C1 (filtered)

O-DU Output Class A LLS-C1 (unfiltered) O-DU Output Class A LLS-C2 (filtered)

O-DU Output Class A LLS-C2 (unfiltered)

|  |  |  |
| --- | --- | --- |
| **LLS-C1** | | |
| **Observation interval (s)** | **MTIE limit (0.1 Hz filtered) (ns)** | **MTIE limit (unfiltered) ns** |
| 0.1 < ? <= 189.33 | 15 ? | 48 + 15 ? |
| ? > 189.33 | 2840 | 2888 |
|  | | |
| **LLS-C2** | | |
| **Observation interval (s)** | **MTIE limit (0.1 Hz filtered) (ns)** | **MTIE limit (unfiltered) ns** |
| 0.1 < ? <= 176.66 | 15 ? | 48 + 15 ? |
| ? > 176.66 | 2650 | 2698 |

**Figure H.2.4-2: MTIE Limit at the output of an O-DU Class A Table H.2.4-2: MTIE Limit at the output of an O-DU Class B**

|  |  |  |
| --- | --- | --- |
| **LLS-C1** | | |
| **Observation interval (s)** | **MTIE limit (0.1 Hz filtered) (ns)** | **MTIE limit (unfiltered) ns** |
| 0.1 < ? <= 568 | 5 ? | 16 + 5 ? |
| ? > 568 | 2840 | 2856 |
|  | | |

|  |  |  |
| --- | --- | --- |
|  | **LLS-C2** |  |
| **Observation interval (s)** | **MTIE limit (0.1 Hz filtered) (ns)** | **MTIE limit (unfiltered) ns** |
| 0.1 < ? <= 530 | 5 ? | 16 + 5 ? |
| ? > 530 | 2650 | 2666 |

![](../assets/images/c37fddd8ebe0.png)

**MTIE (ns)**

10000

1000

100

10

1

0,1

**?** **(s)**

0,1 1

10

5ppb Frequency Accuracy

100

1000

O-DU Output Class B LLS-C1 (filtered)

O-DU Output Class B LLS-C1 (unfiltered) O-DU Output Class B LLS-C2 (filtered)

O-DU Output Class B LLS-C2 (unfiltered)

**Figure H.2.4-3: MTIE Limit at the output of an O-DU Class B**

Table H.2.2-1 makes assumptions about the bandwidth of the O-RU and the budget allocation for the FFO; however, designers are free to change these assumptions provided the overall performance requirements at the RF output are met. The only figures for the amount of noise in LLS-C2 that are quoted in the normative section (Table 11.3.2.1-1) are the two max(dTE) figures of 90 ns for an O-DU Class A, and 114 ns for an O-DU Class B.

The maximum limit at the input to an O-RU can then be calculated by adding these figures to the filtered LLS-C2 limit at the output of the O-DU. The filtered mask is used as according to Recommendation ITU-T G.8271.1 [22] Appendix IV it is assumed that only the dTEH of the last network element is visible at the O-RU input. For a worst-case input, linear addition is assumed, adding 90 ns for an O-DU Class A, and 114 ns for an O-DU Class B. Table H.2.4-3, and Table H.2.4-4, show an unfiltered measurement:

**Table H.2.4-3: MTIE Limit at the input to an O-RU (connected to an O-DU Class A in LLS-C2)**

|  |  |
| --- | --- |
| **Observation interval (s)** | **MTIE limit (unfiltered) ns** |
| 0.1 < ? <= 176.66 | 90 + 15 ? |
| ? > 176.66 | 2740 |

**Table H.2.4-4: MTIE Limit at the input to an O-RU (connected to an O-DU Class B in LLS-C2)**

|  |  |
| --- | --- |
| **Observation interval (s)** | **MTIE limit (unfiltered) ns** |
| 0.1 < ? <= 530 | 114 + 5 ? |
| ? > 530 | 2764 |

These unfiltered limits are shown in Figure H.2.4-4 below in the dotted green and blue lines. The 15 ppb and 5 ppb lines are shown for information only. It is not possible to calculate a filtered version of these limits without assuming something about the frequency accuracy of the various noise contributions (e.g. the budget figures used in Table H.2.2- [1]), therefore the unfiltered limits are the primary limits.

The LLS-C2 limit for a Class A O-DU is for medium observation intervals slightly higher than that for a Class B O-DU. For short and long observation intervals the Class B O-DU limit is higher. Since when an O-RU is designed it is not known what class of O-DU it will be deployed with, the maximum noise that an O-RU tolerates at its input is the maximum of the two curves in Figure H.2.4-4.

**MTIE (ns)**

10000

1000

100

10

1

**?** **(s)**

0,1

1

15ppb Frequency Accuracy

10

100 1000

5ppb Frequency Accuracy

O-RU input (unfiltered, Class A O-DU) O-RU input (unfiltered, Class B O-DU)

|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |

**Figure H.2.4-4: MTIE limit at the input to an O-RU (LLS-C2)**

The MTIE limits shown in Figure H.2.4-2, Figure H.2.4-3 and Figure H.2.4-4 are not new requirements. They are derived from the existing requirements documented in Table 11.3.2.1-1, and hence are a way of expressing those requirements using MTIE. These limits should not create compatibility issues for existing equipment tested to the parameters in Table 11.3.2.1-1.

#### Network limit guidelines for frequency error budget (LLS-C3)

* Based on the above compromise explanation, a practical expectation of O-RU filtering max BW is set to 75 mHz to start the analysis
* Based on Recommendation ITU-T G.8272, PRTC/T-GM MTIE (during lock) specification can be used to describe PRTC/T-GM dynamic noise generation, see Table H.2.5-1 and Table H.2.5-2:

**Table H.2.5-1: Wander generation (MTIE) for PRTC-A**

|  |  |
| --- | --- |
| **MTIE limit (us)** | **Observation interval (s)** |
| 0.275 x 10-3 ? + 0.025 | 0.1 < ? <= 273 |
| 0.10 | ? > 273 |

**Table H.2.5-2: Wander generation (MTIE) for PRTC-B**

|  |  |
| --- | --- |
| **MTIE limit (us)** | **Observation interval (s)** |
| 0.275 x 10-3 ? + 0.025 | 0.1 < ? <= 54.5 |
| 0.04 | ? > 54.5 |

* Given O-RU filtering max BW = 75 mHz, it corresponds to observation interval ? = 1/(?.75 mHz) = 4.2 s. From the above table, MTIE limit (with ? = 4.2 s) = 26.2 ns pk-pk for both PRTC-A and PRTC-B.

Besides MTIE, which can be treated as dynamic noise during lock condition, there is an additional consideration of PRTC/T-GM during HOLDOVER condition. Potential semi-static frequency drift could happen during HOLDOVER,

+-2 ppb is reserved based on Recommendation ITU-T G.8271.1 Appendix V PRTC failure scenario (b) which permits 400 ns HOLDOVER limit for short periods. Due to assumptions on lower dTE and max|TE| (as per Recommendation ITU-T G.8271.1 clause 7.3.2), a slightly larger budget can be allocated to the PRTC holdover, e.g. 500 ns, that would be accumulated over a period of 250 s, still remaining within the worst-case max|TE| specified by ITU-T Recommendation G.8271.1 (i.e. 1100 ns that is result of 600 ns max|TE| as per clause 7.3.2, increased by 500 ns).

Based on the above, the error budget is shown below in Table H.2.5-3.

**Table H.2.5-3: Network (LLS-C3) frequency error budget**

|  |  |
| --- | --- |
| **Frequency error budget analysis for PRTC class:** | **A** |
| Consider PRTC PTP/SyncE timeTransmitter max|frequency error| budget = .............................. (refer to NOTE 1 in Table 11.3.2.2-1) | 2 ppb |
| Consider Fronthaul and O-RU total frequency error budget based on PRTC frequency error budget taken away from the 3GPP air interface budget = ...................................................................  (NOTE 4) | 48 ppb |
| Further split the Fronthaul and O-RU total frequency error budget as follows as an example of O-RU design:   * max|FFO\_FH| (see NOTE 1) = ............................................................................... * max|FFO\_RU| (O-RU internal additive frequency noise generation) = ............................. | 30 ppb  18 ppb |
| The relationship between max|FFO\_FH| and the acceptable dynamic time error at the input of the O-RU is the following (NOTE 2): |  |

|  |  |
| --- | --- |
| * max|FFO\_FH| (in ppb) = ?.max(dTE) (in ns).filter BW (in Hz) * max(dTE) = max|FFO\_FH| / (?.filter BW) = ......................................................... | 126 ns |
| max(dTE) is therefore the maximum allowed Fronthaul network noise generation limit (between PRTC UNI and O-RU UNI) guaranteeing the 3GPP max|frequency error| limit at the air interface with such a 75 mHz BW O-RU.  It is up to O-RU vendor implementation to select filter BW (not necessarily 75mHz) to trade off the internal budget split between max|FFO\_FH| and max|FFO\_RU| as long as the required O-RU total max|frequency error| budget is still met.  (NOTE 5) |
| Based on Recommendation ITU-T G.8271.1 [22] Appendix IV guidance and working assumptions to calculate accumulated error (NOTE 6):   * Total dynamic noise = RSS (dTE) * max(dTE) = RSS (max(dTEL) of all nodes including PRTC/T-GM but not O-RU's T-TSC, and max(dTEH) of the last clock in the chain)   Considering class B T-BCs, see NOTE 3, with : max(dTEL) = 40 ns, max(dTEH) = 70ns   * max(dTE)= sqrt [262 + n.402 + 702] = ....................................................................... | 126 ns |
| * n= (max(dTE)2 - 702 - 262) / 402 = ............................................................................ the maximum number of class B T-BCs in each chain (after PRTC) | 6 |
| Considering class C T-BCs, see NOTE 3, with: max(dTEL) = 10 ns, max(dTEH) = 30 ns   * max(dTE) = sqrt (262 + n.102 +302) = ....................................................................... * n= (max(dTE)2 - 302 - 262) / 102 = ............................................................................ the maximum number of class C T-BCs in each chain (after PRTC) | 126 ns  >>10 |
| NOTE 1: This FFO\_FH contributor is generated by the fronthaul network elements under ideal PRTC/T-GM output and filtered by ideal O-RU PTP clock. Such measurement output signal (e.g. 1PPS or PTP port) at the O-RU PTP clock output is optional and may therefore not exist on all O-RUs  NOTE 2: The noise is generally assumed to be mainly centred. The impact of rare highly asymmetric events on the FFO is outside the scope of the present document. As per clause 11.2.5.1, max(dTE) is  peak-to-peak value.  This limit mainly applies to the higher frequency range; for the lower frequency range, which depends on O-RU vendor-specific low pass filtering characteristics, a higher limit may be allowed (still within the limits specified by Recommendation ITU-T G.8271.1 [23] clause 7.3 as worst case).  NOTE 3: T-BC noise generation limits are provided by Recommendation ITU-T G.8273.2 [28] clause 7.1.  NOTE 4: All numbers in this table apply to a Wide Area Base Station (BS) with an air interface limit of 50 ppb (as per 3GPP TS [8], [9] clause 6.5.1). If Medium Range BS, Local Area BS or Home BS is used, the 3GPP budget is relaxed to 100 ppb or 250 ppb.  NOTE 5: The 3GPP budget relaxation applicable to non-Wide-Area BS can be split into the Fronthaul and O-RU budget differently, thus tolerating a higher limit for dTE. For example, allocating an FFO\_FH of 35 ppb results in a max(dTE) of 148 ns budget for the network, which will permit 10 class B T-BC switches.  NOTE 6: Equation IV-13 in G.8271.1 [23] Appendix IV is used in these example calculations. This formula does not include the effect of network rearrangements. As also noted in Appendix IV.3, the actual noise may be higher than Equation IV-13 indicates, due to the possible presence of rearrangement transients. | |

The max(dTE) 126 ns network frequency error budget as calculated above and as per Table 11.3.2.2-1, plus the 2 ppb frequency error budget related to short holdover period (2 x 250 seconds, to take into account 2 periods of holdover

with time error accumulated with different signs) can be expressed in terms of unfiltered MTIE as shown in Table H.2.5-4 and Figure H.2.5-1 below. For deployment scenarios where larger budget can be allocated to holdover, the holdover period could be increased (i.e. longer than 2x 250s), that would result in larger MTIE for the longest observation intervals.

**MTIE (ns)**

10000,0

1000,0

100,0

10,0

0,1

1

10

100

1000

10000

**?** **?s)**

**Figure H.2.5****-1: MTIE limit at the input to an O-RU in LLS-C3 Table H.2.5****-4: MTIE Limit at the input to an O-RU (LLS-C3)**

|  |  |
| --- | --- |
| **Observation Interval (s)** | **MTIE limit unfiltered (ns)** |
| ??? ? ? <= 500 | 126 + 2 ? |
| ? > 500 | 1126 |

#### Time error budget for network limit (LLS-C3)

Recommendation ITU-T G.8271.1 [22] Appendix V (Example of design options) and Appendix XII (Examples of design options for fronthaul and clusters of base stations) provide guidelines on the number of switches that can be deployed in case of LLS-C3 for the different target requirements.

Appendix V is focusing on the absolute Time Error Requirement (Category C), while Appendix XII addresses also relative time error requirements applicable in fronthaul (Category A and B).

## Guidelines for the allowed number of switches:

The recommended guidance for maximum number of switches is shown in Table H.3-1 and H.3-2 and is determined based on the smallest allowed number constrained by

* Frequency error budget.
* Operator-chosen most constraint time error budget category.
* The class of network elements (The O-RU classes are examples proposed by IEEE 802.1 CM [11], [12]).

**Table H.3-1: Maximum number of T-BC switches based on Network frequency error budget**

|  |  |  |  |  |
| --- | --- | --- | --- | --- |
| **Frequency Error Network limit** | **LLS-C1 and LLS-C2,**  **class A O-DU** | **LLS-C1 and LLS-C2,**  **class B O-DU** | **LLS-C3** | **Comment** |
| Absolute Frequency error budget between time source and O-RU | 2  (class B T-BC)  >>10  (class C T-BC) | 5  (class B T-BC)  >>10  (class C T-BC) | NOTE 3 | No branch exceeds this number of T-BCs from O-DU or PRTC/T-GM to meet  50 ppb frequency accuracy at the air interface.  The numbers of Class B T- BC switches can be increased within network limits specified in Recommendation ITU-T G.8271.1 [22] and 3GPP  frequency error limit for non- Wide-Area BS. |

**Table H.3-2: Maximum number of T-BC switches based on Network time error budget**

|  |  |  |  |  |
| --- | --- | --- | --- | --- |
| **Time Error Network limit** | **LLS-C1 and LLS-C2,**  **class A O-DU** | **LLS-C1 and LLS-C2,**  **class B O-DU** | **LLS-C3** | **Comment** |
| Cat A Relative Time error budget (with enhanced O- RUs) between O-RUs | 0  (class B T-BC) 1  (class C T-BC) | 0  (class B T-BC) 1  (class C T-BC) | NOTE 3  NOTE 4 | No branch exceeds this number of T-BCs from common T-BC to meet target relative time error limit at the air interface. Value 0 means that only lls- C1 is supported |
| Cat B Relative Time error budget (with regular O-RUs) between O-RUs | 1  (class B T-BC) 3  (class C T-BC) | 1  (class B T-BC) 3  (class C O-RU) | NOTE 3 |
| Cat B Relative Time error budget (with enhanced O- RUs) between O-RUs | 2  (class B T-BC) 7  (class C T-BC) | 2  (class B T-BC) 7  (class C T-BC) | NOTE 3 |
| Cat C Absolute Time error budget (with regular O-RUs) between time source and  O-RU | 2  (class B T-BC) 7  (class C T-BC) | 2  (class B T-BC) 11  (class C T-BC) | NOTE 3 | No branch exceeds this number of T-BCs from O- DU or PRTC/T-GM to meet 1500 ns absolute time error limit at the air interface.  NOTE 1. |
| Cat C Absolute Time error budget (with enhanced O- RUs) between time source and O-RU | 4  (class B T-BC) (NOTE 5)  7  (class C T-BC) | 4  (class B T-BC) 11  (class C T-BC) | NOTE 3 |
| NOTE 1: Only applicable to lls-C1 and lls-C2: As indicated in Table 11.3.2.1-1, the max|TEL|O-DU at the output of the O-DU is 1420 ns for LLS-C1 and 1325 ns for LLS-C2. This limit considers that the input of the O- DU stays within the limits at Reference point C defined by Recommendation ITU-T G.8271.1 [22] or  Recommendation ITU-T G.8271.2 [24]. | | | | |
| NOTE 2: The analysis on the number of switches (for time error budget) is meant to be a rough estimate and excludes both fibre asymmetry factor and relative TER between two ports of the common network element. It is operator's responsibility to control these two parameters. The analysis for each time  error budget (specific category) has some left-over margin that could be used to cover them. If the left- over margin is not enough, the alternative is to reduce the allowed number of switches. | | | | |

|  |
| --- |
| NOTE 3: Network design guidelines for configuration LLS-C3 are provided in Recommendation ITU-T G.8271.1 [22] Appendix V (addressing IEEE 802.1CM [11], [12] synchronization Category C) and Appendix XII (addressing IEEE 802.1CM [11], [12] synchronization Category A and B) of Recommendation ITU-T G.8271.1 [22]. The guidelines in Appendix V includes an indication on allowed number of switches between the PRTC/T-GM and the O-RU. The guidelines in Recommendation ITU-T G.8271.1 [22] Appendix XII also includes an indication on allowed number of switches between a clock that is common for the cooperating O-RUs, and these O-RUs.  As an example:   * Iin order to meet the Cat B requirements with a regular O-RU, the number of T-BC class C switches, after the common switch (itself a class C T-BC), should be 3 or less, while there is no room for additional switches with T-BC class B clocks after the common switch (itself a class B T-BC). * In order to meet the Cat B requirements with an enhanced O-RU, the number of T-BC class C switches should be 6 or less after the common switch (itself a class C T-BC), and the number of T-BC class B switches after the common switch (itself a class B T-BC), should be 2 or less.   The minor differences between the maximum number of switches supported in LLS-C2 and LLS-C3 are due to different characteristics of the common clock (as indicated in Figure H.2.3-1, in LLS-C2, the O-DU has no relative time error between ports specified, while in LLS-C3, the Recommendation ITU-T G.8273.2 [28] T-BC takes this into account).  Recommendation ITU-T G.8271.1 [22] also presents the case of an alternative deployment with a short clock chain that has a maximum of 4 Class C T-BC, or 1 Class B T-BC between the PRTC/T-GM and the O-RU (see reference network model in Figure II.6 of Recommendation ITU-T G.8271.1 [22] with a PRTC-B/T-GM directly connected to the common T-BC). For this case the regular O-RU was considered as it represents the worst-case scenario. This deployment, in addition to meeting  IEEE 802.1CM [11,12] synchronization Category C, is also suitable to support IEEE 802.1CM [11, 12] synchronization Category B. |
| NOTE 4: Category A requirements are applicable to co-located O-RUs as per clause 7.6 in 3GPP TS 38.133 [37].  NOTE 5: For Wide Area BS the number of class B T-BC switches needs to be further limited to 2 due to the frequency error limit. |

# Annex I (informative):

Precoding and examples

## Case 1: Tx Diversity 1-CRS Port Ant0, 1 PRB

Case 1 is depicted in Figure I.1-1. At the O-DU:

* + - For single Tx case, *d* (*q*) (0),..., *d* (*q*) (*M* (q) ?1) M\_q\_sym modulation bits belonging to PDSCH ANT0 are

symb

packed into a PRB. All CRS REs for ANT0 are packed into a PRB for transmission and are unpacked at the O- RU.

At the O-RU:

* + - At the O-RU, for single antenna port single Tx a single layer is used and mapping is defined as.
    - O-RU needs to map CRS REs into antenna ports using crsReMask, crssymbolNumber and crsShift. Clause I.5 describes CRS RE mapping into antenna ports.

|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
|  | TxD 1 CRS Port ANT, 1 PRB | | | | | | | | | | | | |  |  |
|  |  | Subframe 0 | | | | | | | | | | | | | |
|  | Slot 0 | | | | | | | Slot 1 | | | | | | |
|  | 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 | 12 | 13 |
| 11 | PRB 0 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 10 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 9 |  |  |  |  | R0 |  |  |  |  |  |  | R0 |  |  |
| 8 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 7 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 6 | R0 |  |  |  |  |  |  | R0 |  |  |  |  |  |  |
| 5 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 4 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 3 |  |  |  |  | R0 |  |  |  |  |  |  | R0 |  |  |
| 2 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 1 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 0 | R0 |  |  |  |  |  |  | R0 |  |  |  |  |  |  |

|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
|  | TxD Ant0 | | | | | | | | | | | | |  |  |
|  |  | Subframe 0 | | | | | | | | | | | | | |
|  | Slot 0 | | | | | | | Slot 1 | | | | | | |
|  | 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 | 12 | 13 |
| 11 | PRB 0 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 10 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 9 |  |  |  |  | R0 |  |  |  |  |  |  | R0 |  |  |
| 8 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 7 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 6 | R0 |  |  |  |  |  |  | R0 |  |  |  |  |  |  |
| 5 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 4 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 3 |  |  |  |  | R0 |  |  |  |  |  |  | R0 |  |  |
| 2 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 1 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 0 | R0 |  |  |  |  |  |  | R0 |  |  |  |  |  |  |

|  |  |
| --- | --- |
|  | ModBits *d* (*q*) (0),..., *d* (*q*) (*M* (q) ?1)  symb |
| R0 | RS Ant0 |
|  | PDSCH Ant0 |
|  | PDCCH |
|  | Blank |

**Figure I.1-1: Single Tx 1-CRS Port Ant0, 1 PRB**

At O-DU(

).

O-RU

After antenna Mapping at O-RU

P R E C OD I NG

L A Y E R

M A P P I N G

AN TE NN A

M AP P

I NG

## Case 2: Tx Diversity 2-CRS Port Ant0, Ant1, and 1 PRB

Case 2 is depicted in Figure I.2-1. At the O-DU:

* + - For TxD case, *d* (*q*) (0),..., *d* (*q*) (*M* (q) ?1) M\_q\_sym modulation bits belonging to PDSCH are packed into a

symb

PRB. All CRS REs for ANT0 and ANT1 are packed into the same PRB for transmission and are unpacked at the O-RU.

At the O-RU:

* + - At the O-RU, for two antenna port TxD 2 layers are used and mapping is defined as *x*(0) (*i*) ? *d* (0) (2*i*)

*x*(1) (*i*) ? *d* (0) (2*i* ?1)

* + - For TxD, information for 2 layers are packed into a PRB for transmission and are unpacked at the O-RU. At the O-RU, after layer mapping and, precoding, CRS REs for 2 antenna ports are mapped to the appropriate RE positions and rest are left blank (grey-shaded REs) as illustrated below. Clause I.5 describes CRS RE mapping into antenna ports.

At O-DU(

).

O-RU

After antenna Mapping at O-RU

TxD Ant0

Subframe 0

Slot 0 Slot 1

TxD Ant1

Subframe 0

Slot 0 Slot 1

0 1 2 3 4 5 6 7 8 9 10 11 12 13 0 1 2 3 4 5 6 7 8 9 10 11 12 13

11

10

9

8

7

R0

R0

11

10

9

8

7

R1

R1

6 PRB 0 R0

R0

6 PRB 0

R1

R1

5

4

3

2

1

0

R0

R0

5

4

3

2

1

0

R1

R1

R0

R0

R1

R1

R1

R0

R1

R0

0

1

2

R0

R1

R0

R1

3

4

5

R1

R0

R1

R0

6

7

8

9

R0

R1

R0

R1

10

PRB 0

11

13

12

11

10

9

8

7

6

5

4

3

2

1

0

Slot 1

Slot 0

Subframe 0

TxD 2 CRS Port ANTs, 1 PRB

P R E C OD I NG

L A Y E R

M A P P I N G

A N TE N N A

M AP P

I N G

|  |  |
| --- | --- |
|  | ModBits *d* (*q*) (0),..., *d* (*q*) (*M* (q) ?1)  symb |
| R0 | RS Ant0 |
| R1 | RS Ant1 |
|  | PDSCH Ant0 |
|  | PDSCH Ant1 |
|  | PDCCH |
|  | Blank |

**Figure I.2-1: Tx Diversity 2-CRS Port Ant0, Ant1, and 1 PRB**

## Case 3: Tx Diversity 4-CRS Port Ant0,1,2,3 and 1 PRB

Case 3 layer mapping is depicted in Figure I.3-1.

![](../assets/images/cea8ed7dd7d3.jpg)

**Figure I.3-1: Case 3 Layer Mapping**

At the O-DU:

* + - For TxD case, *d* (*q*) (0),..., *d* (*q*) (*M* (q)

symb

?1) M\_q\_sym modulation bits belongs to PDSCH are packed to into a

PRB. All CRS RE's for ANT0, ANT1, ANT2 and ANT3 are packed into that same PRB for transmission and are unpacked at the O-RU.

At the O-RU:

* + - At the O-RU, for two antenna port TxD 4 layers are used and mapping is defined as

*x*(0) (*i*) ? *d* (0) (4*i*)

*x*(1) (*i*) ? *d* (0) (4*i* ?1)

*x*(2) (*i*) ? *d* (0) (4*i* ? 2)

*x*(3) (*i*) ? *d* (0) (4*i* ? 3)

* + - For TxD, user data RE's for 4 layers are packed into a PRB for transmission and are unpacked at the O-RU. At the O-RU, after layer mapping and precoding, CRS REs for 4 antenna ports are mapped to the appropriate RE position and rest are left blank as illustrated in Figure I.3-2.

|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
|  | TxD 4 CRS Port ANTs, 1 PRB | | | | | | | | | | | | |  |  |
|  |  | Subframe 0 | | | | | | | | | | | | | |
|  | Slot 0 | | | | | | | Slot 1 | | | | | | |
|  | 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 | 12 | 13 |
| 11 | PRB 0 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 10 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 9 | R1 | R3 |  |  | R0 |  |  | R1 | R2 |  |  | R0 |  |  |
| 8 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 7 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 6 | R0 | R2 |  |  | R1 |  |  | R0 | R3 |  |  | R1 |  |  |
| 5 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 4 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 3 | R1 | R3 |  |  | R0 |  |  | R1 | R2 |  |  | R0 |  |  |
| 2 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 1 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 0 | R0 | R2 |  |  | R1 |  |  | R0 | R3 |  |  | R1 |  |  |

|  |  |
| --- | --- |
|  | ModBits *d* (*q*) (0),...,*d* (*q*) (*M* (q) ?1)  symb |
| R0 | RS Ant0 |
| R1 | RS Ant1 |
| R2 | RS Ant2 |
| R3 | RS Ant3 |
|  | PDSCH Ant0 |
|  | PDSCH Ant1 |
|  | PDSCH Ant2 |
|  | PDSCH Ant3 |
|  | PDCCH |
|  | Blank |

**Figure I.3-2: Tx Diversity 4-CRS Port Ant0,1,2, 3, and 1 PRB**

After antenna Mapping at O-RU

At O-DU(

).

O-RU

R3

0

1

2

R3

3

4

5

R3

6

7

8

R3

9

10

PRB 0

11

13

12

11

10

9

8

7

6

5

4

3

2

1

0

Slot 1

Slot 0

Subframe 0

TxD Ant3

R2

0

1

2

R2

3

4

5

R2

6

7

8

R2

9

10

PRB 0

11

13

12

11

10

9

8

7

6

5

4

3

2

1

0

Slot 1

Slot 0

Subframe 0

TxD Ant2

R1

R1

0

1

2

R1

R1

3

4

5

R1

R1

6

7

8

R1

R1

9

10

PRB 0

11

13

12

11

10

9

8

7

6

5

4

3

2

1

0

Slot 1

Slot 0

Subframe 0

TxD Ant1

R0

R0

0

1

2

R0

R0

3

4

5

R0

R0

6

7

8

R0

R0

9

10

PRB 0

11

13

12

11

10

9

8

7

6

5

4

3

2

1

0

Slot 1

Slot 0

Subframe 0

TxD Ant0

P R E C OD I NG

L A Y E R

M A P P I N G

A N TE N N A

M AP P

I N G

![](../assets/images/d0de797e0fc9.png)

O-DU

O-RU

**Figure I.3-3: Tx Diversity - 4 CRS Ports**

## Case 4: TM3/TM4 3 layers, 4 antenna ports

One symbol from each of layers is linearly mapped to each antenna port as shown in Figure I.4-1.

![](../assets/images/320d5a0d1d76.jpg)

**Figure I.4-1: Case 4 Layer Mapping**

For TM3/TM4, REs belonging to all the antenna ports are mapped to the zeroth layer at the O-DU. The O-RU should consider layer zero's CRS REs for CRS mapping for all the antenna ports using reMask bit field; CRS RE positions in the non-zero layers can be ignored as illustrated below (grey-shared REs in the O-DU represent CRS RE positions that are not populated by the O-DU) in Figure I.4-2.

*x*(0) (*i*) ? *d* (0) (3*i*)

*x*(1) (*i*) ? *d* (0) (3*i* ? 1)

*x*(2) (*i*) ? *d* (0) (3*i* ? 2)

*M* layer ? *M* (0) 3

symb symb

|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
|  | TM3/4 Layer 1, 4 ANTs, (x0(0),x0(1),,,x0(i)) | | | | | | | | | | | | |  |  |
|  |  | Subframe 0 | | | | | | | | | | | | | |
|  | Slot 0 | | | | | | | Slot 1 | | | | | | |
|  | 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 | 12 | 13 |
| 11 | PRB 0 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 10 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 9 | R1 | R3 |  |  | R0 |  |  | R1 | R2 |  |  | R0 |  |  |
| 8 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 7 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 6 | R0 | R2 |  |  | R1 |  |  | R0 | R3 |  |  | R1 |  |  |
| 5 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 4 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 3 | R1 | R3 |  |  | R0 |  |  | R1 | R2 |  |  | R0 |  |  |
| 2 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 1 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 0 | R0 | R2 |  |  | R1 |  |  | R0 | R3 |  |  | R1 |  |  |
|  | TM3/4 Layer 1, 4 ANTs, (x1(0),x1(1),,,x1(i)) | | | | | | | | | | | | |  |  |
|  |  | Subframe 0 | | | | | | | | | | | | | |
|  | Slot 0 | | | | | | | Slot 1 | | | | | | |
|  | 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 | 12 | 13 |
| 11 | PRB 0 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 10 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 9 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 8 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 7 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 6 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 5 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 4 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 3 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 2 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 1 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 0 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
|  | TM3/4 Layer 1, 4 ANTs, (x2(0),x2(1),,,x2(i)) | | | | | | | | | | | | |  |  |
|  |  | Subframe 0 | | | | | | | | | | | | | |
|  | Slot 0 | | | | | | | Slot 1 | | | | | | |
|  | 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 | 12 | 13 |
| 11 | PRB 0 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 10 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 9 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 8 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 7 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 6 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 5 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 4 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 3 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 2 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 1 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 0 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |

![](../assets/images/5904a129b802.png)![](../assets/images/d4c3740de0ad.png)

P R E C O D I N G

A N T E N N A M A P P I N G

|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
|  | TM3/4 Ant0 | | | | | | | | | | | | |  |  |
|  |  | Subframe 0 | | | | | | | | | | | | | |
|  | Slot 0 | | | | | | | Slot 1 | | | | | | |
|  | 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 | 12 | 13 |
| 11 | PRB 0 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 10 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 9 |  |  |  |  | R0 |  |  |  |  |  |  | R0 |  |  |
| 8 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 7 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 6 | R0 |  |  |  |  |  |  | R0 |  |  |  |  |  |  |
| 5 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 4 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 3 |  |  |  |  | R0 |  |  |  |  |  |  | R0 |  |  |
| 2 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 1 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 0 | R0 |  |  |  |  |  |  | R0 |  |  |  |  |  |  |
|  | TM3/4 Ant1 | | | | | | | | | | | | |  |  |
|  |  | Subframe 0 | | | | | | | | | | | | | |
|  | Slot 0 | | | | | | | Slot 1 | | | | | | |
|  | 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 | 12 | 13 |
| 11 | PRB 0 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 10 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 9 | R1 |  |  |  |  |  |  | R1 |  |  |  |  |  |  |
| 8 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 7 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 6 |  |  |  |  | R1 |  |  |  |  |  |  | R1 |  |  |
| 5 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 4 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 3 | R1 |  |  |  |  |  |  | R1 |  |  |  |  |  |  |
| 2 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 1 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 0 |  |  |  |  | R1 |  |  |  |  |  |  | R1 |  |  |
|  | TM3/4 Ant2 | | | | | | | | | | | | |  |  |
|  |  | Subframe 0 | | | | | | | | | | | | | |
|  | Slot 0 | | | | | | | Slot 1 | | | | | | |
|  | 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 | 12 | 13 |
| 11 | PRB 0 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 10 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 9 |  |  |  |  |  |  |  |  | R2 |  |  |  |  |  |
| 8 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 7 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 6 |  | R2 |  |  |  |  |  |  |  |  |  |  |  |  |
| 5 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 4 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 3 |  |  |  |  |  |  |  |  | R2 |  |  |  |  |  |
| 2 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 1 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 0 |  | R2 |  |  |  |  |  |  |  |  |  |  |  |  |
|  | TM3/4 Ant3 | | | | | | | | | | | | |  |  |
|  |  | Subframe 0 | | | | | | | | | | | | | |
|  | Slot 0 | | | | | | | Slot 1 | | | | | | |
|  | 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 | 12 | 13 |
| 11 | PRB 0 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 10 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 9 |  | R3 |  |  |  |  |  |  |  |  |  |  |  |  |
| 8 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 7 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 6 |  |  |  |  |  |  |  |  | R3 |  |  |  |  |  |
| 5 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 4 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 3 |  | R3 |  |  |  |  |  |  |  |  |  |  |  |  |
| 2 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 1 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 0 |  |  |  |  |  |  |  |  | R3 |  |  |  |  |  |

|  |  |
| --- | --- |
|  | Layer0(x0\_0,x0\_1,..x0\_i) |
|  | Layer1(x1\_0,x1\_1,..x1\_i) |
|  | Layer2(x2\_0,x2\_1,..x2\_i) |
| R0 | RS Ant0 |
| R1 | RS Ant1 |
| R2 | RS Ant2 |
| R3 | RS Ant3 |
|  | PDSCH Ant0 |
|  | PDSCH Ant1 |
|  | PDSCH Ant2 |
|  | PDSCH Ant3 |
|  | PDCCH |
|  | Blank |

**Figure I.4-2: TM3/TM4, 3 Layers 4 Antenna Ports**

![](../assets/images/829981a61794.png)

O-DU

O-RU

**Figure I.4-3: TM3 rank 2/4 CRS ports**

## CRS location assignment

CRS shift pattern for antenna port 0 when 3 <= vshift <= 5 is same as 0 <= vshift <= 3 for antenna port 1 resulting in only three possible vshift for a 2-antenna port case and this holds good for 4-antenna port case as well. Hence the crsReMask is differentiated with the crsShift field. The CRS location for the different layers are described in Table I.5-1, Table I.5- [2] and Table I.5-3.

**Table** **I.5-1: CRS location assignment for layer1**

|  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- |
|  | **Layer1** | | | | |
|  |  | **crsSymNum 0 and 7** | | **crsSymNum 4 and 11** | |
| **vshift** | **crsShift** | **crsReMask** | **PosInd in Bit Ant 0** | **crsReMask** | **PosInd in Bit Ant 0** |
| 0 | 0 | 0000 0100 0001 | 0,6 | 0010 0000 1000 | 3,9 |
| 1 | 0 | 0000 1000 0010 | 1,7 | 0100 0001 0000 | 4,10 |
| 2 | 0 | 0001 0000 0100 | 2,8 | 0100 0010 0000 | 5,11 |
| 3 | 0 | 0010 0000 1000 | 3,9 | 0000 0100 0001 | 6,0 |
| 4 | 0 | 0100 0001 0000 | 4,10 | 0000 1000 0010 | 7,1 |
| 5 | 0 | 1000 0010 0000 | 5,11 | 0001 0000 0100 | 8,2 |
| NOTE: crsReMask is not repeated for all for vShift combinations, hence crsShift is always indicated as 0. | | | | | |

**Table I.5-2: CRS Location Assignment For layer2**

|  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- |
|  | **Layer2** | | | | | | |
|  |  | **crsSymNum 0 and 7** | | | **crsSymNum 4 and 11** | | |
| **vshift** | **crsShift** | **crsReMask** | **PosInd in Bit Ant 0** | **PosInd in Bit Ant 1** | **crsReMask** | **PosInd in Bit Ant 0** | **PosInd in Bit Ant 1** |
| 0 | 0 | 0010 0100 1001 | 0,6 | 3,9 | 0010 0100 1001 | 3,9 | 0,6 |
| 1 | 0 | 0100 1001 0010 | 1,7 | 4,10 | 0100 1001 0010 | 4,10 | 1,7 |
| 2 | 0 | 1001 0010 0100 | 2,8 | 5,11 | 1001 0010 0100 | 5,11 | 2,8 |
| 3 | 1 | 0010 0100 1001 | 3,9 | 6,0 | 0010 0100 1001 | 6,0 | 3,9 |
| 4 | 1 | 0100 1001 0010 | 4,10 | 7,1 | 0100 1001 0010 | 7,1 | 4,10 |
| 5 | 1 | 1001 0010 0100 | 5,11 | 8,2 | 1001 0010 0100 | 8,2 | 5,11 |
| NOTE: crsReMask for vShift 0 is same as for vShift 3 case but RE locations are different for Ant 0 and 1. Hence indicating 1 for 3, 4, 5 vShift cases, thereby O-RU picks the positions as interpreted here. | | | | | | | |

**Table I.5-3: CRS Location Assignment For layer4**

|  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
|  | **Layer4** | | | | | | | |
|  |  | **crsSymNum 0 and 7** | | | **crsSymNum 4 and 11** | | | |
| **vshift** | **crsShift** | **crsReMask** | **PosInd in Bit Ant 0** | **PosInd in Bit Ant 1** | **crsReMask** | **PosInd in Bit Ant 0** | | **PosInd in Bit Ant 1** |
| 0 | 0 | 0010 0100 1001 | 0,6 | 3,9 | 0010 0100 1001 | 3,9 | | 0,6 |
| 1 | 0 | 0100 1001 0010 | 1,7 | 4,10 | 0100 1001 0010 | 4,10 | | 1,7 |
| 2 | 0 | 1001 0010 0100 | 2,8 | 5,11 | 1001 0010 0100 | 5,11 | | 2,8 |
| 3 | 1 | 0010 0100 1001 | 3,9 | 6,0 | 0010 0100 1001 | 6,0 | | 3,9 |
| 4 | 1 | 0100 1001 0010 | 4,10 | 7,1 | 0100 1001 0010 | 7,1 | | 4,10 |
| 5 | 1 | 1001 0010 0100 | 5,11 | 8,2 | 1001 0010 0100 | 8,2 | | 5,11 |
|  | **Layer4** | | | | | | | |
|  |  | **crsSymNum 1** | | | **crsSymNum 8** | | | |
| **vshift** | **crsShift** | **crsReMask** | **PosInd in Bit Ant 2** | **PosInd in Bit Ant 3** | **crsReMask** | **PosInd in Bit Ant 3** | **PosInd in Bit Ant2** | |
| 0 | 0 | 0010 0100 1001 | 0,6 | 3,9 | 0010 0100 1001 | 0,6 | 3,9 | |
| 1 | 0 | 0100 1001 0010 | 1,7 | 4,10 | 0100 1001 0010 | 1,7 | 4,10 | |
| 2 | 0 | 1001 0010 0100 | 2,8 | 5,11 | 1001 0010 0100 | 2,8 | 5,11 | |
| 3 | 1 | 0010 0100 1001 | 3,9 | 6,0 | 0010 0100 1001 | 3,9 | 6,0 | |
| 4 | 1 | 0100 1001 0010 | 4,10 | 7,1 | 0100 1001 0010 | 4,10 | 7,1 | |
| 5 | 1 | 1001 0010 0100 | 5,11 | 8,2 | 1001 0010 0100 | 5,11 | 8,2 | |
| NOTE: crsReMask for vShift 0 is same as for vShift 3 case but RE locations are different for Ant 0 and 1. Hence indicating 1 for 3, 4, 5 vShift cases, thereby O-RU picks the positions as interpreted here. | | | | | | | | |

**Pseudo code to determine the CRS belongs to ANT port-N**

// Determine vShift = N\_CELL\_ID % 6

// Below pseudo code for Num Layer = 4 Switch(crsSymNum)

{

Case 0 || case 7:

if( vShift == 0 )

{

if (bitSet\_0 && bitSet\_6)

{

mapIQ of 0 and 6 to Ant0 //rest blank

}

if (bitSet\_3 && bitSet\_9)

{

mapIQ of 0 and 6 to Ant1 //rest blank

}

}

Break;

Case 1:

if( vShift == 0 )

{

if (bitSet\_0 && bitSet\_6)

{

mapIQ of 0 and 6 to Ant2

}

if (bitSet\_3 && bitSet\_9)

{

mapIQ of 3 and 9 to Ant3

}

}

Break;

Case 4 || case 11: if( vShift == 0 )

{

if (bitSet\_0 && bitSet\_6)

{

mapIQ of 0 and 6 to Ant1

}

if (bitSet\_3 && bitSet\_9)

{

mapIQ of 0 and 6 to Ant0

}

}

Break;

Case 8:

if( vShift == 0 )

{

if (bitSet\_0 && bitSet\_6)

{

mapIQ of 0 and 6 to Ant3

}

if (bitSet\_3 && bitSet\_9)

{

mapIQ of 3 and 9 to Ant2

}

}

Break;

}

## First data layer and non-first data layer association using static eAxC\_ID and layerId mapping

This clause shows an example with 3 UEs using LTE TM4, each scheduled with different number of layers. The example shows a specific order of C-Plane messages, where UE with maximum number of scheduled layers is sent first, in practical cases this order can be implementation specific and subject to reordering. The example is described in more details in Table I.6-1.

**Table I.6-1: C-Plane messages order**

|  |  |  |  |
| --- | --- | --- | --- |
| **UE1 scheduled with numLayers=4, TM4** | | **UE2 scheduled with numLayers=1, TM4** | **UE3 scheduled with numLayers=2, TM4** |
| C-Plane Section + long-format SE 3   * layerID = 0 ? eAxC\_ID: **10**   C-Plane Section + short-format SE 3   * layerID = 1 ? eAxC\_ID: **20**   C-Plane Section + short-format SE 3   * layerID = 2 ? eAxC\_ID: **30**   C-Plane Section + short-format SE 3   * layerID = 3 ? eAxC\_ID: **40** | | C-Plane Section + long-format SE 3   * layerID=0 ?   eAxC\_ID: 10 | C-Plane Section+long-format-SE 3   * layerID =0?eAxC\_ID: **10**   C-Plane Section+short-format SE 3   * layerID =1? eAxC\_ID: **20** |
| eAxC\_ID: **10** | layerID 0 | Re-use the mapping created for UE1 | Re-use the mapping created for UE1 |
| eAxC\_ID: **20** | layerID\_1 |
| eAxC\_ID: **30** | layerID\_2 |
| eAxC\_ID: **40** | layerID\_3 |

# Annex J (informative):

Beamforming methods description

## Introduction

Beams are RF energy directed in specific angular directions in space. Beamforming can generate energy lobes (maxima, or "peaks") and/or energy nulls (minima, or "valleys") in the spatial dimension. They can be formed using various methods in the analog domain, the digital domain, or a combination thereof. Beams and beamforming can further be used to re-utilize temporo-spectral (Time-Frequency) resources to achieve Spatial Multiplexing.

The present document has four distinct methods supported at the O-RU for beamforming.

## Predefined-beam beamforming

In this method, beam indices ("beamId" values) are conveyed from the O-DU to the O-RU to indicate which beam to apply to the DL or UL data. The beams are expected to be pre-defined within the O-RU and the method of beamforming is not specified. However, the O-DU still needs to know whether the beamforming is frequency-domain, time-domain or "hybrid" so the beamId values can be correctly applied e.g. to not apply different time-domain beamIds to subcarriers in the same OFDM symbol.

## Weight-based dynamic beamforming

In this method, beamforming weights are transmitted across the interface using C-Plane messages. For frequency-domain beamforming the operation may be considered as follows:

* + - X = [x0 x1 ... xP-1]represents the frequency domain IQ data in one data section, where P is the number of REs in the data section and xI is an RE, xi ? CL?1 , L is the number of streams.
    - W = [w0 w1 ... wP-1] represents the beamforming weights associated with the tx-array, where wI is a beamforming weight of RE xI, wI ? CK? L , K is the number of array elements.

NOTE: O-DU may send W per PRB or PRB bundle, and O-RU may apply W per PRB or PRB bundle.

The output after beamforming Y = [y0 y1 ... yP-1]is given by:

yi = wixi

where yI is a beamforming output for the RE xI , yi ? CK? 1 .

The equation above refers to DL beamforming, but the same principle is applied for UL as well.

Time-domain beamforming operation is similar to frequency-domain beamforming, however, instead of being applied per data section the beamforming is applied for the entire OFDM symbol:

* + - X = [x0 x1 ... xP-1]represents the frequency domain IQ data in one OFDM symbol, where P is the number of REs in the OFDM symbol and xI is an RE, xi ? CL?1 , L is the number of streams.
    - W = [w0 w1 ... wP-1] represents the beamforming weights associated with one tx-array, where wI is a beamforming weight of RE xI, wI ? CK ? L , K is the number of array elements.

The output after beamforming Y = [y0 y1 ... yP-1]is given by:

yi = wixi

where yI is a beamforming output for the RE xI , yi ? CK ? 1 .

The equation above refers to DL beamforming, but the same principle is applied for UL as well.

Hybrid beamforming operation involves the multiplication by frequency-domain weights and time-domain weights and may be considered as follows:

There are K number of time-domain weights (that is the same as the number of array elements) and K' number of frequency-domain weights (K' <= K, see clause 12.5.3). The K' frequency-domain weights are applied for the REs in a data section, and the K time-domain weights are applied for all the REs in the entire OFDM symbol.

* + - X = [x0 x1 ... xP-1]represents the frequency domain IQ data in one OFDM symbol, where P is the number of REs in the OFDM symbol and xI is an RE, xi ? CL ? 1 , L is the number of streams.
    - W = [w0 w1 ... wP-1] represents the beamforming weights in one OFDM symbol, where wI is a time-

domain beamforming weight of RE x , w ? CK? K? , K is the total number of array elements.

I I

* + - W? = [w?0 w?1 ... w? ] represents the beamforming weights in one OFDM symbol, where w? is a

i

P -1

frequency-domain beamforming weight of RE x , w? ? CK?? L.

I i

The output after beamforming Y = [y0 y1 ... yP-1]is given by:

yi = (wiw?)xi

i

where y is a beamforming output for the RE xI , yi ? CK ? 1 .

The equation above refers to DL beamforming, but the same principle is applied for UL as well.

## Attribute-based dynamic beamforming

In this method, beamforming attributes and/or their indices (if already known to the O-RU) are transmitted across the interface.

Whereas a beam index provides a pointer to a beamforming vector already known to the O-RU, and beamforming weight*s* specify an important method for how to form the beam, beamforming attributes specify the what, an inherently compact characterization of the desired beam pattern itself, to be formed directionally in space.

These beamforming attributes include:

* + - bfAzPt: the azimuth beamforming pointing angle in degrees
    - bfZePt: the zenith beamforming pointing angle in degrees
    - bfAz3dd: the azimuth beamforming 3dB down beam width in degrees
    - bfZe3dd: the zenith beamforming 3dB down beam width in degrees
    - bfAzSl: the azimuth beamforming sidelobe suppression value in dB
    - bfZeSl: the zenith beamforming sidelobe suppression value in dB

Multiple methods of forming the beam per the beam attributes are possible and are left as O-RU implementation choices. Some potential schemes are: beamforming phased array weights (analog or digital), holographic beamforming, Butler matrices, lenses, and other known and emerging techniques. These schemes may also be hybridized with "Channel-information-based beamforming" method.

## Channel-information-based beamforming

In this method, beamforming weights are calculated at the O-RU based on the channel estimates that are transmitted across the interface.

For UL:

Assuming L streams which are jointly scheduled in UL, let X = [x0 x1 ... xP-1] represent the frequency domain IQ data in one data section, where P is the number of REs in the data section and xi is an RE, xi ? CKx1 , a beamforming matrix *W =* [*w*1*,...,wK*] ? CL *?* K is applied to the frequency domain IQ data of RE xi for L streams, K is the number of array elements, and L is the number of streams.

H ? [h1 ... , hL] ? CK ? L is defined as the UL channel estimates of RE x for the L streams,and hi is the channel matrix conveyed via the Section Type 6 message and is identified via ueId.

When the C-Plane Section Extension = 16 is used, the UL channel for each stream is fetched according to the 'ueId' and the 'antMask' fields.

Multiple methods to calculate the beamforming weights for UL are possible and are left as the O-RU implementation choices. Some potential schemes are:

* MRC: W = HH ||H|| , ||H|| is the norm of H.
* Zero-forcing: W = (HH H)-1 HH
* Regularized zero-forcing/ MMSE: W = (HH H + ?IL )-1 HH ,

where ? is the regularization parameter. C-Plane Section Extension 8 allows configuration of regularization factor per ueId in UL.

The output after beamforming Y = [y0 y1 ... yP-1] is given by:

yi = Wxi

where y is a beamforming output for the RE xI, yi ? CL ? 1 . For DL:

Assuming L layers which are jointly scheduled in DL, let X = [x0 x1 ... xP-1] represent the frequency domain IQ data in one data section, where P is the number of REs in the data section and xi is an RE, xi ? CLx1 , L is the number of layers, a beamforming matrix *W =* [*w*1*, ..., w*L] ? CK ? L is applied to the frequency domain IQ data of RE x for L layers, K is the number of array elements.

H ? [hT , ... , hT T

L ? K is defined as the DL channel estimates of RE x for the L selected layers where

eff

eff,1

eff,L] ? C i

heff,i ? C1 ? K is the channel matrix conveyed via the Section Type 6 message and is identified via ueId.

Multiple methods to calculate the beamforming weights for DL are possible and are left as the O-RU implementation choices. Some potential schemes are:

* Zero-forcing: W = 1

H (H

??

H eff

eff

Heff

H)-1

* Regularized zero-forcing/ MMSE: W = 1

H (H

??

H eff

eff

HeffH

-1

+ ?IL) ,

? is the regularization parameter, and the normalization parameter ? can be chosen to satisfy the total power constraint

{*WW***H**} <= *M*.

The output after beamforming Y = [y0 y1 ... yP-1] is given by:

yi = Wxi

where y is a beamforming output for the RE xI, yi ? CK ?1.

C-Plane Section Extension 8 allows configuration of regularization factor per ueId in DL.

Assuming Y users' channel matrices each transmitting multiple layers' data considering transmit antenna switching (TAS), so Heff can be selected by using a proper sub-spacing function f(?) among Y user's channel matrices Hi where

i = 1, ... , Y, and f(?) ? CNi ? K where Ni is the number of antennas of *i*-th user. Define Si as the number of selected

layers for *i*-th user, and then S = ?Y

S and H

= [HT ... , HT ]Twhere H

= f(H ) ? CSi ? K and S

<= N .

i=1 i

eff

eff,S1

eff,S Y

eff,Si i

i i

# Annex K (informative):

Layers of array elements

## General

Figure K.1-1 shows an example of a rectangular array with 12 rows and 4 columns of array elements. There are four data converters (not shown in Figure K.1-1). Each data converter connects to all the 48 array elements (also known as the full-connection model in 3GPP). The array element contains 4 gain and phase control elements each connecting to one of the data converters. The gain and phase control element is used to apply time domain (TD) beamforming weights. This type of connection creates four overlapping arrays ("array-layers") by reusing the same array elements.

![](../assets/images/cfa8339844bd.jpg)

**Figure** **K.1-1: An example array**

On the transmit side each DAC can correspond to one layer, which is then connected to one of the overlapping Tx arrays. Hence the structure of the tx-array so constructed can support 4 layers. The 48 elements corresponding to layer *q*

= 0...3 receive the same input from DAC *q* and this input can be beamformed with a 48 element TD beamforming vector ( q,0, q,47) and a Frequency Domain (FD) beamforming weight q corresponding to layer q. Each array element hence can receive 4 equivalent beamforming weights 0 0,0 to 3 3,0 corresponding to 4 layers.

## Use Case A

Use case A is to send an eAxC flow via 48 elements. In this case, the eAxC flow is beamformed in frequency domain (FD) by 0and 48 complex weights corresponding to time domain (TD) using( 0,0, 0,47) as shown in Figure K.2-1. In this case, the O-RU has 4 simple tx-arrays with 48 elements each.

![](../assets/images/ec473244bd65.png)

**Figure K.2-1: Four tx-arrays with 48 elements each**

In the above case the 48 array elements each have one power amplifier which is shared across the four tx-arrays, conveyed over the M-Plane as the array elements being "shared" according to clause 12.5.5.

## Use Case B

Use case B is when one eAxC flow is sent over all the 4x48 elements. This can be accomplished by using 4 digital weights in FD and 4x48 TD weights (see Figure K.3-1). In this case, O-RU has one tx-array with 4x48 elements.

![](../assets/images/ceedf73e8519.png)![](../assets/images/557971a69b47.png)

**Figure K.3-1: Use case B**

In the above case the 48 array elements each have one power amplifier which is shared across the four array-layers

*q* = 0,...,3, conveyed over the M-Plane as independent-power-budget being false according to clause 12.5.3.

# Annex L (informative):

Considerations when operating in non-ideal transport environments

## General

The Intra-PHY lower layer fronthaul split has been optimized for operation using transport systems that are able to support tight latency and bandwidth requirements. However, this does not preclude operation of the lower layer split in environments where the transport systems are not able to meet tight latency and bandwidth requirements. This appendix is informative and describes those additional capabilities that may be included in an O-DU and/or O-RU to assist when operating in such circumstances.

Many of the following discussion points and examples assume an FDD cell configuration. FDD examples are used here as the timing aspects are easier to conceptualize. The same principles and approaches apply to TDD cells.

## Deployment scenarios and performance considerations

#### Low impact

There is a class of low mobility deployment scenarios characterized by slow fading, which provide a relatively stable radio channel at small time scales. When combined with low UE density, these scenarios see low (or no) performance impact from non-ideal fronthaul vRAN deployments.

Example deployment use cases include indoor femto cells, fixed wireless access, and outdoor pico cells in non-dense urban settings.

In such scenarios the benefit from HARQ is negligible, thus the performance impact of disabling HARQ retransmissions or using predictive HARQ is negligible. Further, the impact of a diminished UE attach ramp rate is negligible as well because UE ramp rate is not a performance design attribute for such deployments.

#### Medium impact

There is a second class of low mobility deployment scenarios where again, radio channels are predominately slow fading, but where UE density may be higher. In these scenarios, the UE attach ramp rate may be a performance attribute of higher importance and thus a larger impact from non-ideal fronthaul may be expected.

Example deployment use cases include venue deployments (e.g. stadiums or arenas), shopping malls, or airport terminals.

In such scenarios inter-cell interference may become significant and the benefit from HARQ may be greater and thus a noticeable degradation of system throughput would be observed when using non-ideal fronthaul. In addition, delays in NAS attach may become noticeable to users depending on the user behaviour given the increased UE density.

#### High impact

There also exists a class of deployments which are characterized by high mobility and/or fast fading. In these scenarios the performance impacts of using non-ideal fronthaul may be significant.

Example deployment use cases include freeway coverage macro cells, dense urban macro or small cells, or rural large ISD macros.

In these scenarios, HARQ often provides a benefit and thus prediction algorithms will likely result in a noticeable performance impact. In addition, the impact of delayed CSI feedback will further reduce system efficiency. Similarly, depending on the UE behaviour (i.e. traffic movement) UE attach ramp rate may be a metric of higher importance.

## HARQ

#### Introduction

Long latency fronthaul links may break traditional Hybrid ARQ timelines. The following clauses discuss the timelines in detail and cover techniques which can be used to minimize the impact of the timeline being broken.

#### Synchronous HARQ

Since FDD LTE offers 8 HARQ processes for each UE, one UE can be scheduled for PDSCH traffic in up to 8 different subframes simply by associating a different HARQ process to each subframe. Hence, the most demanding scenario in terms of processing timeline is given by a "full-buffer" UE continuously scheduled in consecutive subframes, which results in 8 subframes (i.e. 8 ms) of timeline budget for each HARQ process. Since the standard mandates that each ACK/NACK HARQ response is sent in uplink 4 subframes after the relevant downlink transmission, effectively only 4 ms of timeline budget are left for eNB-side operations.

The eNB can be expected to complete all tasks within the 4-ms timeline budget, with many eNB implementations taking more than than 3 ms in the worst load conditions. It is this argument that has generated the common perception according to which all sources of "extra" latency cannot exceed 0.5-1.0 ms, see Figure L.3.2-1.

![A screenshot of a video game  Description automatically generated](../assets/images/514c70c2a63b.png)

**Figure L.3.2-1: Synchronous Up-link HARQ Processing Budget**

In the strictest interpretation of this argument, the sub-ms upper bound includes occasional, short-term spikes, which effectively rules out virtual implementations of LTE L1 on commodity operative systems (OSs) and forces adoption of real-time OSs. Even in the broader interpretation, this argument rules out disruptive deployments such as split-7 architectures described in 3GPP TR 38.801 [13], clause 11.1.2.7, over high-latency fronthaul.

The following analysis challenges these often-cited assumptions, showing that, while they make sense for many legacy deployments, different scenarios exist in which forcing tight latency constraints is unnecessary and may be counterproductive to the exploration of innovative low-cost deployment scenarios.

#### HARQ interleaving

One option often mentioned in the context of latency-resistant LTE implementations is "HARQ (process) interleaving", which in essence requires waiting for the ACK/NACK response to be available before reusing a certain HARQ process, see Figure L.3.3-1.

Using this approach, the tolerated latency for O-DU processing time plus round trip frounthaul delay can be increased to 3 + n8 milli-seconds, where n is number of autonoms HARQ responses sent with the New Data Indication (NDI) not toggled, ensuring that the UE re-transmits the data until it receives ACK or NACK from the O-DU.

![A screen shot of a person  Description automatically generated](../assets/images/360c8927dba6.png)

**Figure L.3.3-1: Interleaved HARQ operation**

In the worst case in terms of timeline budget -- that of a single, full-buffer UE -- this option is very inefficient, resulting in only 8 every (8+n) subframes being used when the overall latency exceeds the 8-ms budget by n ms. For example, 8 ms of extra latency would lead to about 50% of the subframes being unused. Hence, while possibly appealing in deployments with latency typically below the desired limit except for a few occasional spikes, this option is certainly not viable for deployments in which high latency is the norm, such as split-7 architectures over high-latency fronthaul.

#### Predictive HARQ

Another option consists of, effectively, turning off HARQ, relying on upper layers for retransmissions (e.g. RLC-AM, or transport/application layer for RLC-TM and RLC-UM). In this technique, the eNB schedules each user as it would if it had received a timely ACK response for each PDSCH transmission, which results in no subframe left unnecessarily unused. see Figure L.3.4-1.

When the late HARQ response is actually received, two cases are possible. In one case, when the response is ACK, nothing else needs to be done since "prediction of ACK" was correct -- the eNB did everything correctly, without wasting time waiting for the actual response.

![A screenshot of a cell phone  Description automatically generated](../assets/images/12d575fc9dcf.jpg)

**Figure L.3.4-1: DL Predictive HARQ operation**

In the other case, when the response is NACK and the prediction was wrong, nothing else needs to be done, since this event is equivalent to an ACK-for-NACK decoding error, hence equivalent to an event that is typically caused by radio problems (e.g. fading, interference) against which LTE already has built-in robustness.

This simple technique performs well when NACK events are rare, most notably in peak-rate conditions, when NACK events are essentially absent even at maximum MCS. With proper tuning of the link adaptation parameters (e.g. lower target block error rate), it is possible to achieve full-buffer throughput performance within 10-15% of what an optimal, low-latency eNB can achieve in any given static/pedestrian radio conditions.

It is evident that, for these low-mobility scenarios, ruling out high-latency deployments is unnecessary: Many use cases exist in which a 10-15% throughput degradation does not justify more expensive infrastructures.

More advanced algorithms may be required for optimization of scenarios in which full-buffer throughput is not the key metric (e.g. RRC messages not protected by RLC-AM). For example, "prediction of NACK" may be used until an ACK response is actually received for a certain critical message.

While discussions of advanced techniques are beyond the scope of this clause -- and the scope of fronthaul protocol specifications -- it is critical to remark that innovative eNB vendors have the opportunity to unlock new use cases, using the longer latency O-DU and O-RU categories.

#### Asynchronous HARQ considerations

In the LTE down-link and in both 5G down-link and up-link, HARQ has been defined to be asynchronous. This means that a separate HARQ process identifier is included in the HARQ messages, thus avoiding the processing time limitations associated with synchronous up-link LTE operation.

## RACH considerations

#### Introduction

The LTE attach procedure starts with UEs performing a preamble transmission on the random access channel to identifying itself to the network. This call flow is usually described as "message 1" through "message 4" as:

1. RACH preamble from UE.
2. Random Access Response (RAR) from MAC.
3. PUSCH message from UE containing CCCH or MAC signalling.
4. Contention resolution Identity MAC CE for contention-based RACH procedure.

Following are the timers used in RACH procedure (specified as per 3GPP TS 36.331 [i.3]) apart from the PRACH configuration.

ra-ResponseWindowSize ENUMERATED {

sf2, sf3, sf4, sf5, sf6, sf7,sf8, sf10}, mac-ContentionResolutionTimer ENUMERATED {

sf8, sf16, sf24, sf32, sf40, sf48, sf56, sf64}

PRACH configuration allows the RACH occasions for UEs to be available in every UL subframe to every 20 UL subframes.

Even if the above timers are set to maximum value, timers would pose an issue with RACH handling for long latency fronthaul transport links. In particular, the ra-ResponseWindowSize timer maximum value is 10 ms (with timer starting 3 subframes after RACH transmission) from RACH preamble transmission occasion, see Figure L.4.1-1. During this time the vRAN system needs to handle the steps including:

1. Complete L1 processing of RACH detection.
2. Sending decoded RACH message to MAC (including fronthaul transport latency).
3. MAC processing to allocate DL (msg2, RAR) and UL (msg3 grant) resources .
4. Relaying of messages back to L1 (including fronthaul transport latency).

sf

![](../assets/images/6048bf6d255a.png)

RACH

transmission by UE

RAR message expected by UE

**Figure L.4.1-1: Traditional RACH timing diagram**

Therefore, in this process, there will be a 2-way delay (first in UL for RACH reception at MAC and second for sending RAR from MAC to L1) apart from the L1/MAC processing time. Without adjust to accommodate long latency fronthaul, this would lead to RACH procedure failure and UE will reattempt the RACH again (and would lead to same problem again) leading to UE not able to access the network.

#### Non-Ideal fronthaul RACH designs

###### Assumptions

When designing the RACH process for non-ideal, long latency fronthaul the following points are considered:

* + - * 1. The method should work assuming existing 3GPP specification.
        2. There should not be any impact to UE and 3GPP compliant UE should work with the method
        3. Currently PRACH Format-0 is considered in RACH analysis to consider FH latency requirements. Other preamble formats are not considered in this analysis.
        4. Current clause considers the msg2 handling to meet the FH latency requirements.
        5. Contention Based RACH procedure is considered in the present document.
        6. BI (Backoff indicator) not considered.
        7. HARQ timings for Msg3 and msg4 HARQ are considered in clause L.3.
        8. FDD Duplexing mode is considered.

With high fronthaul latency, alternative options are required to handle the RACH procedure. Two such options are discussed below.

###### Option 1: Semi-persistent resource allocation

Option 1 presents a semi-persistent allocation of resources that allows the O-DU to make RACH decisions without waiting for the reception of a RACH preamble. In this alternative, MAC allocates three types of resource for RAR messages:

* + - * 1. PDCCH resources for RAR:

RA-RNTI (0 - 9) being fixed and one-to-one mapping for RACH occasions in FDD mode.

Common search space resources for PDCCH carrying RAR (corresponding RA-RNTI).

Based on configured RACH configuration (RACH occasions), MAC reserves the PDCCH resources corresponding to RAR message in all required TTIs (For example, n+3rd TTI from every RACH preamble occasion).

The reservation of resources will be done at MAC regardless of the RACH triggered by UE.

DCI Format 1A.

* + - * 1. PDSCH resources for RAR:

Configured number of RACH to be entertained by MAC in one subframe.

Based on "Number of RACH" to be processed, MAC estimates the size of RAR PDU.

MAC reserves the PDSCH resources in all required TTIs similar to PDCCH.

Layer-1 updates the TC-RNTI (A pool of TC-RNTI available with L1 for CBR RACH) in RAR along with RAP-ID (Preamble ID) and TA value in RAR message (decoding of MAC PDU sent by MAC).

Layer-1 maintains the TC-RNTI pool.

* + - * 1. PUSCH resources for Msg3:

Based on "Number of RACH" to be processed in a subframe, MAC reserves the PUSCH resources

* + - * 1. All the above information (reserved by MAC) to L1 at cell configuration time. MAC will directly receive the PUSCH (Rx\_PUSCH.Indication) with TCRNTI (and corresponding subframe number) and TA value applied in RAR
        2. Considering maximum value of contention resolution timer, MAC will then normally schedule msg4.
        3. After successful msg4 procedure, MAC will start using C-RNTI
        4. In case of contention failure or UE release, MAC will inform Layer-1 to free the TC-RNTI

**Disadvantage:** This would waste PDCCH/PDSCH/PUSCH resources if there is no RACH procedure triggered. In addition, hard coding of the timing advance is an acceptable approach for small cell deployments, but in macro cells this will not work.

###### Option 2: RACH retransmission estimation

The following description addresses the flow driving Msg2 scheduling in a basic configuration (more complex flows also exist).

For simplicity, the description refers to an FDD LTE deployment with RACH configured with the greatest possible values for the maximum number of preamble retransmissions (50), the preamble periodicity (20 subframes) and the RAR window size (10 subframes).

* The O-DU stack detects that a RACH preamble was transmitted at UL subframe t.
* If the scheduling in advance (which is a function of the fronthaul latency) is such that the relevant message 2 can be transmitted over the air at DL subframe t+12 or earlier, the "regular" flow is possible. In particular, a message 2 with content corresponding to the preamble detected in UL subframe t is transmitted by DL subframe t+12.
* Else, the relevant message 2 cannot be delivered within the valid RAR window, in which case the terminal that transmitted a preamble at UL subframe t is mandated to transmit another preamble at UL subframe t+20, for which the valid RAR window ends at DL subframe t+32. In this case, O-DU skips the scheduling of the message 2 corresponding to the preamble transmitted at UL subframe t (since it would not be received within the valid RAR window) and directly schedules for DL subframe t+32 the message 2 corresponding to the preamble transmitted at UL subframe t+20, even before receiving and processing the samples for said UL subframe.

The flow described above assumes that the "effective fronthaul round-trip delay" is lower than 32 ms, that is, assumes that it is possible for O-DU to process the samples relative to UL subframe t and to compute the relevant response, and for the O-RU(s) to transmit said response at DL subframe t+32.

A simple extension of this flow makes it viable to complete the RACH procedure in the presence of an "effective fronthaul round-trip delay" as high as 52 ms, or even 72 ms, but deployments over such high-latency fronthauls are not recommended.

Some details are omitted in the description above to maintain the flow presentation as simple as possible. In practice, the latency-resistant RACH procedure is made slightly more complex by the fact that the terminal choses the preamble ID randomly at each retransmission, and that the content of message 2 has to include the preamble ID of the last transmission.

In the example above, at the time of scheduling message 2 for DL subframe t+32 (which refers to the preamble transmitted in UL subframe t+20), O-DU does not know what preamble ID to include in that message, since it has not processed yet the samples relative to said preamble transmission. The simplest method to this is to populate message 2 with the last seen preamble, see Figure L.4.2.3-1.

![](../assets/images/2faf6d8ec80c.png)

**Figure L.4.2.3-1: Long latency RAR "collision" operation**

By limiting the number of available preambles, the likelihood two subsequent UE RACH attempts using the same preamble can increased sufficiently to ensure successful RACH in a timely manner.

## Other latency related considerations

Supporting high latency requires careful system design to ensure seamless device connectivity while maintaining spectrum efficiency. In this clause, other system aspects that are impacted by high fronthaul latency are discussed.

Some of the issues can be resolved with upper layer protocols while some may not be relevant for certain deployment use cases. Proposed solutions for these issues are for future study to see if they require any additional information to be transmitted over the fronthaul interface:

* Link adaptation and scheduling:
  + Link adaptation is implemented at layer 2, where the eNB adapts in real-time the UEs' MCS based on the CQI. Scheduling (e.g. proportional fair scheduling) depends heavily on the channel quality between the eNB and the UE. Although this depends on the channel model, it has to be done on a relatively short time-scale. Link adaptation and scheduling have to be conservative for non-ideal fronthaul with split 7 since the channel can change significantly in the time period. This may reduce the benefit of frequency selective scheduling and high mobility support since it takes longer for the scheduler to respond to the channel variations under fading conditions. However, this may not be an issue for low mobility scenarios in a small cell environment.
* UL power control:
  + Another challenging issue for non-ideal fronthaul is UL power control. This also becomes challenging under high mobility and large latencies since it takes longer time to feedback this information to the scheduler to adjust the UE transmit power. However, for use cases with limited mobility, this may not be an issue.
* Beamforming and MU-MIMO:
  + Beamforming is becoming an important use case for interference mitigation and for multi-user MIMO support for LTE and NR for macros. This requires close interaction with the scheduler in order to suppress interference and pair users. If there is significant latency on the fronthaul, the beamforming and multi-user MIMO support becomes challenging under non-ideal conditions. This can be explored further. However, there are use cases with 2TRX/4TRX radios where beamforming support is not critical.
* COMP and advanced receiver support:
  + One of the main advantages of split 7 is centralized processing for features such as UL COMP and advanced receivers since signals from multiple base-stations can be combined and processed jointly.

However, under split 7 non-ideal fronthaul, these gains are not straightforward to attain in general since the latencies on the different links can have significant variations. Hence, innovation is needed to help achieve these gains. However, there can be mechanisms to exploit these gains via other means (e.g. solutions developed for inter-site COMP which can accommodate more latency). This is also not a requirement for all use cases.

* UE attach latency:
  + The UE attach process involves 5 steps of message exchanges between the eNB and the UE. While there are messages also dependent on the core network and RRC latency, most of these messages are handled by the MAC/PHY layers and this has an impact on UE attach time, specially under large latencies.

Again, this may not be relevant for low mobility use cases such as small cells.

To summarize, there are several other factors to consider for high latency support. However, such factors need not be relevant for all use cases and can be explored further in future versions.

## Bandwidth limitation considerations

In addition to accommodating extra latency in the fronthaul transport link, implementations may also support variable bandwidth as another aspect of non-ideal fronthaul transport. At a high level, two bandwidth related scenarios can exist; peak rate may be limited, or bandwidth resources may be shared and thus fluctuate over time. In either case, fronthaul implementations can be designed to handle these conditions.

To support limited or variable bandwidth transport links, the O-DU will need to produce estimates of the uplink and downlink available bandwidth at periodic intervals e.g. on a per slot or per TTI interval. The O-DU can then use these bandwidth estimates to inform the scheduling decisions.

In particular a bandwidth estimation function can simply return available bandwidth values in terms of bits per second in the next time interval. Alternatively, available bandwidth could also be expressed as a function of the following parameters including but not limited to:

* Real-time IQ sample variable-bit-width
* IQ Compression
* Variable bit width per channel
* MCS / Constellation of data
* Beam count / compression
* Beam forming related signalling overhead
* C-Plane signalling overhead (reMask, symInc support, etc)
* Number of PRBs scheduled

An example API implementation may take as inputs some or all of the above parameters and return simply *numPrbu*

available in the next interval.

The design goal in such implementations is to keep the cell up and active but limit the air interface user plane bandwidth to match the available fronthaul resources. Fronthaul data associated with air interface broadcast and control/reference signalling occupies a small fraction of the bandwidth needed to achieve full cell throughput. An example implementation of a fronthaul aware scheduler could prioritize broadcast and control signalling, allocating PDSCH and PUSCH resources only after fronthaul bandwidth resources for all broadcast and control signalling has been removed from the available bandwidth estimate.

The exact fronthaul aware scheduling algorithm used is out of scope for the present document.

# Annex M (informative):

Use case of selective transmission and reception

## General

In order to clarify how to transmit/receive signal when selective transmission and reception is used, some concrete examples of selective transmission and reception with beamId are illustrated in this clause.

* + 1. Selective transmission and reception with non beamforming O-RUs and 1-to-1 mapping of global beamId and local beamId.
    2. Selective transmission and reception with beamforming O-RUs and 1-to-N mapping of global beamId and local beamId.

## Selective transmission and reception with non beamforming O-RUs and 1-to-1 mapping of global beamId and local beamId

In this clause, it is assumed that the total number of beams is seven. Figure M.2-1 shows comparison of C/U-Plane processing and RF signal transmission/reception procedure between normal beamforming O-RU case with seven beam and selective transmission and reception with seven non beamforming O-RUs case.

![](../assets/images/77bf347d5b22.png)

**Figure M.2-1: C/U-Plane processing and RF signal transmission/reception procedure comparison (non BF O-RU case)**

First of all, the mapping table between global beamId/O-RU/local beamId is configured via M-Plane during start-up procedure. Table M.2-1 shows the mapping table for this example scenario. The mapping table is assumed to be created by operator based on what an operator would like to operate.

**Table M.2-1: Global beamId/O-RU/local beamId mapping table**

|  |  |  |
| --- | --- | --- |
| **Global beamId** | **O-RU** | **Local beamId** |
| Beam ID #1 | O-RU #1 | Beam ID #0 |
| Beam ID #2 | O-RU #2 | Beam ID #0 |
| Beam ID #3 | O-RU #3 | Beam ID #0 |
| Beam ID #4 | O-RU #4 | Beam ID #0 |
| Beam ID #5 | O-RU #5 | Beam ID #0 |
| Beam ID #6 | O-RU #6 | Beam ID #0 |
| Beam ID #7 | O-RU #7 | Beam ID #0 |

When SSB is transmitted, O-DU sends C-Plane message with beamId corresponds to a transmitting SSB before U-Plane transmission. FHM reads C-Plane header and routes it to corresponding O-RU(s). After that, U-Plane packet is routed in same manner and then O-RU transmits SSB. When the UE receives SSB, UE can obtain each SSB ID by decoding PBCH included in the SSB. If UE is before attaching, UE will transmit PRACH preamble on the PRACH occasion corresponding to the best SSB ID. Since PRACH occasion is linked to SSB ID and SSB ID is linked to global beamId one by one, O-DU knows which beam is used to receive PRACH preamble on each PRACH occasion. Therefore, O-DU can send C-Plane packet with appropriate beamId to receive PRACH preamble on each PRACH occasion. The C-Plane packet is routed to O-RU(s) by FHM and then the O-RU(s) try to receive PRACH preamble and sends U-Plane packet to FHM. After UE attaching, other shared channel and reference signal are transmitted/received as same manner.

## Selective transmission and reception with beamforming O- RUs and 1-to-N mapping of global beamId and local beamId

In this clause, it is assumed that the total number of beams is seven. Figure M.3-1 shows comparison of C/U-Plane processing and RF signal transmission/reception procedure between normal beamforming O-RU case with seven beam and selective transmission and reception with two beamforming O-RUs case. In this case, each beamforming O-RU for selective transmission and reception has 4 beams. Local beamId #4 of O-RU #1 and local beamId #1 of O-RU #2 are mapped to the same global beamId #4.

![](../assets/images/2fe8cdbe5e35.png)

**Figure M.3-1: C/U-Plane processing and RF signal transmission/reception procedure comparison (BF O-RU case)**

First of all, the mapping table between global beamId/O-RU/local beamId is configured via M-Plane during start-up procedure. Table M.3-1 shows the mapping table for this example scenario. The mapping table is assumed to be created by operator based on what an operator would like to operate.

**Table M.3-1: Global beamId/O-RU/local beamId mapping table**

|  |  |  |
| --- | --- | --- |
| **Global beamId** | **O-RU** | **Local beamId** |
| Beam ID #1 | O-RU #1 | Beam ID #1 |
| Beam ID #2 | O-RU #1 | Beam ID #2 |
| Beam ID #3 | O-RU #1 | Beam ID #3 |
| Beam ID #4 | O-RU #1 | Beam ID #4 |
| O-RU #2 | Beam ID #1 |
| Beam ID #5 | O-RU #2 | Beam ID #2 |
| Beam ID #6 | O-RU #2 | Beam ID #3 |
| Beam ID #7 | O-RU #2 | Beam ID #4 |

As shown in Table M.3-1, local beamId #4 of O-RU #1 and local beamId #1 of O-RU #2 are mapped to the same global beamId #4. This means O-RU #1 and O-RU #2 partially construct Shared cell area which is coverd by beam ID #4 of

O-RU #1 and beam ID #1 of O-RU #2. Therefore copy and combine function is applied for the signal transmit to/receive from this area. The detailed procedure of fronthaul interface and physical layer for transmitting SSB, receiving PRACH preamble, and for transmitting/receiving other shared channel are same as described in clause M.2.

# Revision history

|  |  |  |
| --- | --- | --- |
| **Date** | **Revision** | **Description** |
| 11.03.2019 | 01.00 | Final version 01.00 |
| 02.06.2019 | 01.00.01 | Updated with NOK-0006, NOK-0007, NOK-0008, NOK-0009, NOK-0010, NOK-0011, NOK- 0012, NOK-0013, ERI-0001, ERI-0002, INT-0001, SAM-0003, SAM-0004, CAB-0001, CAB-  0002 and CAB-0003, which include WI non-ideal fronthaul and several mandatory / optional modifications, as well as adding Section Extension 6 and 7. |
| 10.06.2019 | 01.00.02 | Accommodates review comments against v01.00.01. |
| 20.06.2019 | 01.00.03 | Updated with changes from Tokyo F2F meeting (see comment sheet), as well as NEC- 0003. |
| 27.06.2019 | 01.00.04 | Updated with comments #22 - #30 in the review comment sheet as well as based on discussions at the June 27 meeting. Most changes are related to mandatory/optional statements and conditions, and in 3.1.3.1.6 regarding endpoint use. |
| 02.08.2019 | 02.00 | Updated with CR FJT-0001 and NOK-0015 and NOK-0016 and comments #31 - #34 which are the final comments; updated version to v02.00 and created "tc" and clean versions for WG4 approval. |
| 14.02.2020 | 02.00.01 | Updated using the following CRs: NOK-0014, NOK-0017, NOK-0018, NOK-0019, NOK- 0023, NOK-0024, INT-0002, INT-0003, INT-0004, MAV-0001, MAV-0002, MAV-0003, MAV-  0004, ERI-0003, ERI-0006, ETR-0001, ETR-0002, ETR-0003 and MCS-0001, as well as  made minor grammatical corrections. |
| 21.02.2020 | 02.00.02 | Updated using the following CRs: DCM-0002, DCM-0003, NOK-0020, NOK-0026, NOK- 0029, ERI-0004, ETR-0006, SAM-0012, SAM-0013 and two comments received from Ericsson. |
| 28.02.2020 | 02.00.03 | Updated using the following CRs: ERI-0007, COM-0001, COM-0002 and SAM-0014 ... as well as comments from the comment review sheet. |
| 10.03.2020 | 02.00.04 | Updated using the following CRs: NOK-0021, MAV-0005, ERI-0009, SAM-0016, SAM-020, SAM-0021, SAM-0022 plus all comments from the comment sheet up to comment #42 |
| 26.03.2020 | 03.00 | Update from comments #43 - #55, accept all changes and fix figure and table numbering and table of contents as needed. Document approved by WG4. |
| 19.06.2020 | 03.00.01 | Updated doc version and this table (comment #1), included CRs: PIC-0001, KEY-0002, ATT-0001, INT-0005, QCM-0001, NOK-0027, NOK-0028, NOK-0031. |
| 26.06.2020 | 03.00.02 | Updated doc version and this table (comment #1), including CRs PIC-0003, NOK-0033, NOK-0035 and ERI-0010. Also included review comments 2-5 (all that were received). |
| 03.07.2020 | 03.00.03 | Updated this table including CRs NOK-0025, NOK-0032, NOK-0036, MAV-0006, MAV- 0007, SAM-0024, ERI-0011 & INT-0006. Also included review comments 6-55. |
| 30.07.2020 | 04.00 | Updated this table including review comments 56-77; accept all changes and update table of contents as needed; review is complete. Review comments 78-108, all typographical or formatting corrections, were received after the vote to approve was started and then approved for inclusion by WG4. |
| 15.10.2020 | 04.00.01 | Updated doc version and this table (comment #0), included CRs: NOK-0034, NOK-0038, MAV-0009, NOK-0041, NOK-0046, QCM-0002, fixed some grammatical errors. |
| 23.10.2020 | 04.00.02 | Updated doc version and this table (comment #0), included CRs: NOK-0042, SAM-0035, SAM-0036, SAM-0037, SAM-0039, ERI-0012, KEY-0002, CIS-0018. |
| 29.10.2020 | 04.00.03 | Updated doc version and this table. Added CRs: NOK-0047, ALS-0001, QCM-0003, DCM- 0005, DCM-0008, CUC-0001, NEC-0005, MAV-0014. |
| 19.11.2020 | 05.00 | Included review comments 4-122; accept all changes and formatting as needed. Document approved by WG4. |
| 19.02.2021 | 05.00.01 | Updated doc version and this table (review comment #0). Included review comment 1-14; included CRs: NOK-0048, NOK-0049, NOK-0054, MAV-0015, ERI-0014, ERI-0015, QCM- 0005, INT-0008, SAM-0045 |
| 26.02.2021 | 05.00.02 | Updated doc version and this table (review comment #18). Included CRs: KEY-0012, ERI- 0018, ERI-0017, QCM-0006, MAV-0016, SAM-0044, SAM-0046, DCM-0010, NOK-0053, NOK-0056. |

|  |  |  |
| --- | --- | --- |
| **Date** | **Revision** | **Description** |
| 01.03.2021 | 05.00.03 | Updated doc version and this table (review comment #29). Included CRs: ERI-0016. |
| 12.03.2021 | 06.00 | Included review comments 19-62; accept all changes and formatting as needed. Document approved by WG4. |
| 25.06.2021 | 06.00.01 | Updated doc version and this table (review comment #0). Added CRs: ADI-0001, MAV- 0018, MAV-0019, ERI-0020, QCM-0007, INT-0012, DCM-0011, SAM-0049, SAM-0050, NOK-0060, NOK-0064, NOK-0062, NOK-0071, QCM-0008, NOK-0069, INT-0010, INT- 0011, CAL-001, ALS-0002, NOK-0070, QCM-0011, SAM-0053, SAM-0054, SAM-0058, ETR-0013, MAV-0023, ERI-0031. |
| 28.06.2021 | 06.00.02 | Updated doc version and this table (review comment #2). Included review comment 1; included CRs: NOK-0063, QCM-0012. |
| 02.07.2021 | 06.00.03 | Included review comments 3-146. |
| 20.07.2021 | 07.00 | Included review comments 147-153; accept all changes and formatting as needed. Document approved by WG4. |
| 18.10.2021 | 07.00.01 | Created initial version, with change-marks from previous content. Implemented CRs: NOK- 0085, NOK-0086. |
| 27.10.2021 | 07.00.02 | Resolution of review comments: #1,3, 8-61, 63-66, 68, and 69. |
| 28.10.2021 | 07.01 | Incorporated review comments #5, 62, 67 and 71. Document approved by WG4. |
| 29.10.2021 | 07.01.01 | Created initial version, with change-marks enabled from version 07.01. Implemented CRs: NOK-0055, QCM-0014, QCM-0017, NEC-0012, SAM-0051, CAL-0003, INT-0017, CAL- 0002, ALS-0003, SAM-0056, MAV-0021, SAM-0057, QCM-0013, ERI-0034, NOK-0081, SOL-0005, CHM-003, ERI-0035. |
| 03.11.2021 | 07.01.02 | Implemented CRs: SOL-0004, QCM-0016 |
| 19.11.2021 | 08.00 | Incorporated review comments 1-93. Document approved by WG4. |
| 14.03.2022 | 08.00.01 | Created initial version, with change marks, from previous content. Implemented CRs: NOK- 0091, QCM-0034, QCM-0033, NOK-0089, SAM-0079, SAM-0080, SAM-0081, NOK-0092, NOK-0097, DCM-0020, QCM-0035, ERI-0042, ERI-0043, INT-0020, NOK-0094, NOK- 0095, DCM-0019, DCM-0018, NOK-0093, NOK-0104, MAV-0024, QCM-0015 |
| 18.03.2022 | 08.00.02 | Incorporated CRs: QCM-0026, QCM-0027, ERI-0044, NOK-0103, MAV-0029, NOK-0106,  QCM-0036, NOK-0108. Incorporated review comments 2-8, 10, 12, 14-16, 18-20. |
| 31.03.2022 | 09.00 | Incorporated review comments 11,13,17,21-472. Review comments 473-501 were received after the vote to approve was started and then approved for inclusion by WG4. |
| 04.07.2022 | 09.00.01 | Incorporated CRs: NOK-0096, ALS.AO-0004, SOL-0006, NOK-0088, SAM-0070, SAM- 0082, SOL-0011, NOK-0111, NOK-0112 |
| 07.07.2022 | 09.00.02 | Document adapted to new template. Incorporated CRs: QCM-0042, SAM-0071. Incorporated review comments #1-44, 46-79, 81-84, 88-92, 94-106 |
| 15.07.2022 | 09.00.03 | Incorporated review comments #107-124, 126-146, 148-175 |
| 21.07.2022 | 09.00.04 | Incorporated review comments #176-185, 187-194, 199, 201-217, 219-221 |
| 23.07.2022 | 10.00 | Incorporated review comments #222-229. |
| 27.10.2022 | 10.00.01 | Created initial draft, with change marks from v10.00. Incorporated CRs: ADI-0004, INT.AO- 0021, NEC-0019, NOK-0110, NOK-0117, QCM-0029, QCM-0039, QCM-0041, QCM-0043, QCM-0044, QCM-0053, SAM-0083, SAM-0089, SOL-0012 |
| 04.11.2022 | 10.00.02 | Incorporated review comments #2-58, 60-64. Incorporated CR QCM-0031 |
| 12.11.2022 | 11.00 | Incorporated review comments #59, 65-120, 121-136. Document approved by WG4 |
| 24.02.2023 | 11.00.01 | Created initial draft from v11.00. Incorporated CRs: ADI-0006, ATT.AO-0022, ERI-0069, NOK-0125, NOK-0128, NOK-0129, NOK-0131, QCM-0047, SAM.AO-0085, SAM-0078, SAM-0090, SAM-0092 |
| 02.03.2023 | 11.00.02 | Incorporated review comments #2-49 |
| 10.03.2023 | 11.00.03 | Incorporated review comments #50-120 |
| 18.03.2023 | 12.00 | Incorporated review comments #121-160. Document approved by WG4 |
| 07.07.2023 | 12.00.01 | Created initial draft, with change marks from v12.00. Incorporated CRs: ERI-0066, ERI- 0072, ERI-0076, NOK-0138, NOK.AO-0139, NOK-0141, QCM-0048, QCM-0049, QCM-  0050, QCM-0052, SAM-0097, SOL-0019. |

|  |  |  |
| --- | --- | --- |
| **Date** | **Revision** | **Description** |
| 14.07.2023 | 12.00.02 | Incorporated review comments #1-36. Incorporated CR QCM-0051 |
| 21.07.2023 | 13.00 | Incorporated review comments #37-109. Document approved by WG4 |
| 31.10.2023 | 13.00.01 | Created initial draft, with change marks from v13.00. Incorporated CRs: CAL-0009,  CAL-0010, DELL-0001, ERI-0074, ERI-0088, NOK.AO-0148, NOK-0143, NOK-0149, NOK- 0151, NOK-0153, NOK-0154, QCM-0055, QCM-0060, QCM-0068, QCM-0069, SAM.AO-  0103, SAM-0102, SOL-0021 |
| 07.11.2023 | 13.00.02 | Incorporated review comments #1-65 |
| 14.11.2023 | 14.00 | Incorporated review comments #66-88. Document approved by WG4 |
| 08.03.2024 | 14.00.01 | Created initial draft, with change marks from v14.00. Incorporated CRs: ADI.AO-0008, CAL- 0011, CAL-0012, CAL-0013, CAL-0017, COM-0005, NOK.AO-0156, NOK-0163,  NOK-0164, QCM-0061, QCM-0073, QCM-0074, SAM-0110, SAM-0111, SAM-0113, SOL- 0025 |
| 15.03.2024 | 14.00.02 | Incorporated CRs: NOK-0167, NOK-0168, SAM-0109. Incorporated review comments #1- 101 |
| 21.03.2024 | 15.00 | Incorporated review comments #102-121. Document approved by WG4 |
| 27.06.2024 | 15.00.01 | Created initial draft from NOK-0177. Incorporated ULPI CRs: ERI-0098, ERI-0100, NOK- 0160, NOK-0161, NOK-0162, QCM-0070, QCM-0071, QCM-0072, SAM-0106, SAM-0107 |
| 04.07.2024 | 15.00.02 | Incorporated review comments #2-108. Incorporated CRs: CAL-0018, ERI-0105, NOK.AO-0166, NOK-0176, NOK-0178, NOK-0182, NOK-0183, QCM-0077, QCM-0079, QCM-0081, SAM-0119, SAM-0122, SAM-0123, SOL-0026 |
| 12.07.2024 | 15.00.03 | Incorporated review comments #109-206 |
| 19.07.2024 | 16.00 | Incorporated review comments #207-315. Document approved by WG4 |
| 29.08.2024 | 16.01 | WG4 agreed to the inclusion of following CRs after review of document version 16.00 was concluded: ERI-0122, NOK-0187, NOK-0189, QCM-0084 |
| 15.11.2024 | 16.01.01 | Created initial draft, with change marks from v16.01. Incorporated CRs: ERI-0125, ERI- 0126, ERI-0121, NOK-0184, NOK-0193, NOK-0179, NOK-0195, NOK-0199, QCM-0083, SAM-0121, SOL-0031, SOL-0037 |
| 20.11.2024 | 16.01.02 | Included review comments #1-33 |
| 27.11.2024 | 17.00 | Included review comments #34-147 |
| 23.01.2025 | 17.01 | WG4 agreed to the inclusion of following CR after review of document version 17.00 was concluded: NOK-0203 |
---

- View in [Reader Mode](https://simewu.com/spec-reader/pages/08-WG4/O-RAN.WG4.TS.CUS.0-R004-v17.01.docx).
- Go back to [Table of Contents](../README.md).
- Download the [Original Document](https://github.com/Simewu/spec-reader/raw/refs/heads/main/documents/O-RAN.WG4.TS.CUS.0-R004-v17.01.docx).
